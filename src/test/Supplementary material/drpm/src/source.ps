%!PS-Adobe-3.0
%%BoundingBox: 18 36 577 806
%%Title: Enscript Output
%%Creator: GNU Enscript 1.6.5.90
%%CreationDate: Thu Apr 25 12:09:20 2024
%%Orientation: Portrait
%%Pages: (atend)
%%DocumentMedia: A4 595 842 0 () ()
%%DocumentNeededResources: (atend)
%%EndComments
%%BeginProlog
%%BeginResource: procset Enscript-Prolog 1.6.5 90
%
% Procedures.
%

/_S {	% save current state
  /_s save def
} def
/_R {	% restore from saved state
  _s restore
} def

/S {	% showpage protecting gstate
  gsave
  showpage
  grestore
} bind def

/MF {	% fontname newfontname -> -	make a new encoded font
  /newfontname exch def
  /fontname exch def

  /fontdict fontname findfont def
  /newfont fontdict maxlength dict def

  fontdict {
    exch
    dup /FID eq {
      % skip FID pair
      pop pop
    } {
      % copy to the new font dictionary
      exch newfont 3 1 roll put
    } ifelse
  } forall

  newfont /FontName newfontname put

  % insert only valid encoding vectors
  encoding_vector length 256 eq {
    newfont /Encoding encoding_vector put
  } if

  newfontname newfont definefont pop
} def

/MF_PS { % fontname newfontname -> -	make a new font preserving its enc
  /newfontname exch def
  /fontname exch def

  /fontdict fontname findfont def
  /newfont fontdict maxlength dict def

  fontdict {
    exch
    dup /FID eq {
      % skip FID pair
      pop pop
    } {
      % copy to the new font dictionary
      exch newfont 3 1 roll put
    } ifelse
  } forall

  newfont /FontName newfontname put

  newfontname newfont definefont pop
} def

/SF { % fontname width height -> -	set a new font
  /height exch def
  /width exch def

  findfont
  [width 0 0 height 0 0] makefont setfont
} def

/SUF { % fontname width height -> -	set a new user font
  /height exch def
  /width exch def

  /F-gs-user-font MF
  /F-gs-user-font width height SF
} def

/SUF_PS { % fontname width height -> -	set a new user font preserving its enc
  /height exch def
  /width exch def

  /F-gs-user-font MF_PS
  /F-gs-user-font width height SF
} def

/M {moveto} bind def
/s {show} bind def

/Box {	% x y w h -> -			define box path
  /d_h exch def /d_w exch def /d_y exch def /d_x exch def
  d_x d_y  moveto
  d_w 0 rlineto
  0 d_h rlineto
  d_w neg 0 rlineto
  closepath
} def

/bgs {	% x y height blskip gray str -> -	show string with bg color
  /str exch def
  /gray exch def
  /blskip exch def
  /height exch def
  /y exch def
  /x exch def

  gsave
    x y blskip sub str stringwidth pop height Box
    gray setgray
    fill
  grestore
  x y M str s
} def

/bgcs { % x y height blskip red green blue str -> -  show string with bg color
  /str exch def
  /blue exch def
  /green exch def
  /red exch def
  /blskip exch def
  /height exch def
  /y exch def
  /x exch def

  gsave
    x y blskip sub str stringwidth pop height Box
    red green blue setrgbcolor
    fill
  grestore
  x y M str s
} def

% Highlight bars.
/highlight_bars {	% nlines lineheight output_y_margin gray -> -
  gsave
    setgray
    /ymarg exch def
    /lineheight exch def
    /nlines exch def

    % This 2 is just a magic number to sync highlight lines to text.
    0 d_header_y ymarg sub 2 sub translate

    /cw d_output_w cols div def
    /nrows d_output_h ymarg 2 mul sub lineheight div cvi def

    % for each column
    0 1 cols 1 sub {
      cw mul /xp exch def

      % for each rows
      0 1 nrows 1 sub {
        /rn exch def
        rn lineheight mul neg /yp exch def
        rn nlines idiv 2 mod 0 eq {
	  % Draw highlight bar.  4 is just a magic indentation.
	  xp 4 add yp cw 8 sub lineheight neg Box fill
	} if
      } for
    } for

  grestore
} def

% Line highlight bar.
/line_highlight {	% x y width height gray -> -
  gsave
    /gray exch def
    Box gray setgray fill
  grestore
} def

% Column separator lines.
/column_lines {
  gsave
    .1 setlinewidth
    0 d_footer_h translate
    /cw d_output_w cols div def
    1 1 cols 1 sub {
      cw mul 0 moveto
      0 d_output_h rlineto stroke
    } for
  grestore
} def

% Column borders.
/column_borders {
  gsave
    .1 setlinewidth
    0 d_footer_h moveto
    0 d_output_h rlineto
    d_output_w 0 rlineto
    0 d_output_h neg rlineto
    closepath stroke
  grestore
} def

% Do the actual underlay drawing
/draw_underlay {
  ul_style 0 eq {
    ul_str true charpath stroke
  } {
    ul_str show
  } ifelse
} def

% Underlay
/underlay {	% - -> -
  gsave
    0 d_page_h translate
    d_page_h neg d_page_w atan rotate

    ul_gray setgray
    ul_font setfont
    /dw d_page_h dup mul d_page_w dup mul add sqrt def
    ul_str stringwidth pop dw exch sub 2 div ul_h_ptsize -2 div moveto
    draw_underlay
  grestore
} def

/user_underlay {	% - -> -
  gsave
    ul_x ul_y translate
    ul_angle rotate
    ul_gray setgray
    ul_font setfont
    0 0 ul_h_ptsize 2 div sub moveto
    draw_underlay
  grestore
} def

% Page prefeed
/page_prefeed {		% bool -> -
  statusdict /prefeed known {
    statusdict exch /prefeed exch put
  } {
    pop
  } ifelse
} def

% Wrapped line markers
/wrapped_line_mark {	% x y charwith charheight type -> -
  /type exch def
  /h exch def
  /w exch def
  /y exch def
  /x exch def

  type 2 eq {
    % Black boxes (like TeX does)
    gsave
      0 setlinewidth
      x w 4 div add y M
      0 h rlineto w 2 div 0 rlineto 0 h neg rlineto
      closepath fill
    grestore
  } {
    type 3 eq {
      % Small arrows
      gsave
        .2 setlinewidth
        x w 2 div add y h 2 div add M
        w 4 div 0 rlineto
        x w 4 div add y lineto stroke

        x w 4 div add w 8 div add y h 4 div add M
        x w 4 div add y lineto
	w 4 div h 8 div rlineto stroke
      grestore
    } {
      % do nothing
    } ifelse
  } ifelse
} def

% EPSF import.

/BeginEPSF {
  /b4_Inc_state save def    		% Save state for cleanup
  /dict_count countdictstack def	% Count objects on dict stack
  /op_count count 1 sub def		% Count objects on operand stack
  userdict begin
  /showpage { } def
  0 setgray 0 setlinecap
  1 setlinewidth 0 setlinejoin
  10 setmiterlimit [ ] 0 setdash newpath
  /languagelevel where {
    pop languagelevel
    1 ne {
      false setstrokeadjust false setoverprint
    } if
  } if
} bind def

/EndEPSF {
  count op_count sub { pos } repeat	% Clean up stacks
  countdictstack dict_count sub { end } repeat
  b4_Inc_state restore
} bind def

% Check PostScript language level.
/languagelevel where {
  pop /gs_languagelevel languagelevel def
} {
  /gs_languagelevel 1 def
} ifelse
%%EndResource
%%BeginResource: procset Enscript-Encoding-88591 1.6.5 90
/encoding_vector [
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/space        	/exclam       	/quotedbl     	/numbersign   	
/dollar       	/percent      	/ampersand    	/quoteright   	
/parenleft    	/parenright   	/asterisk     	/plus         	
/comma        	/hyphen       	/period       	/slash        	
/zero         	/one          	/two          	/three        	
/four         	/five         	/six          	/seven        	
/eight        	/nine         	/colon        	/semicolon    	
/less         	/equal        	/greater      	/question     	
/at           	/A            	/B            	/C            	
/D            	/E            	/F            	/G            	
/H            	/I            	/J            	/K            	
/L            	/M            	/N            	/O            	
/P            	/Q            	/R            	/S            	
/T            	/U            	/V            	/W            	
/X            	/Y            	/Z            	/bracketleft  	
/backslash    	/bracketright 	/asciicircum  	/underscore   	
/quoteleft    	/a            	/b            	/c            	
/d            	/e            	/f            	/g            	
/h            	/i            	/j            	/k            	
/l            	/m            	/n            	/o            	
/p            	/q            	/r            	/s            	
/t            	/u            	/v            	/w            	
/x            	/y            	/z            	/braceleft    	
/bar          	/braceright   	/tilde        	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/space        	/exclamdown   	/cent         	/sterling     	
/currency     	/yen          	/brokenbar    	/section      	
/dieresis     	/copyright    	/ordfeminine  	/guillemotleft	
/logicalnot   	/hyphen       	/registered   	/macron       	
/degree       	/plusminus    	/twosuperior  	/threesuperior	
/acute        	/mu           	/paragraph    	/bullet       	
/cedilla      	/onesuperior  	/ordmasculine 	/guillemotright	
/onequarter   	/onehalf      	/threequarters	/questiondown 	
/Agrave       	/Aacute       	/Acircumflex  	/Atilde       	
/Adieresis    	/Aring        	/AE           	/Ccedilla     	
/Egrave       	/Eacute       	/Ecircumflex  	/Edieresis    	
/Igrave       	/Iacute       	/Icircumflex  	/Idieresis    	
/Eth          	/Ntilde       	/Ograve       	/Oacute       	
/Ocircumflex  	/Otilde       	/Odieresis    	/multiply     	
/Oslash       	/Ugrave       	/Uacute       	/Ucircumflex  	
/Udieresis    	/Yacute       	/Thorn        	/germandbls   	
/agrave       	/aacute       	/acircumflex  	/atilde       	
/adieresis    	/aring        	/ae           	/ccedilla     	
/egrave       	/eacute       	/ecircumflex  	/edieresis    	
/igrave       	/iacute       	/icircumflex  	/idieresis    	
/eth          	/ntilde       	/ograve       	/oacute       	
/ocircumflex  	/otilde       	/odieresis    	/divide       	
/oslash       	/ugrave       	/uacute       	/ucircumflex  	
/udieresis    	/yacute       	/thorn        	/ydieresis    	
] def
%%EndResource
%%EndProlog
%%BeginSetup
%%IncludeResource: font Courier-Bold
%%IncludeResource: font Courier
/HFpt_w 10 def
/HFpt_h 10 def
/Courier-Bold /HF-gs-font MF
/HF /HF-gs-font findfont [HFpt_w 0 0 HFpt_h 0 0] makefont def
/Courier /F-gs-font MF
/F-gs-font 8 8 SF
/#copies 1 def
% Pagedevice definitions:
gs_languagelevel 1 gt {
  <<
    /PageSize [595 842] 
  >> setpagedevice
} if
/d_page_w 559 def
/d_page_h 770 def
/d_header_x 0 def
/d_header_y 770 def
/d_header_w 559 def
/d_header_h 0 def
/d_footer_x 0 def
/d_footer_y 0 def
/d_footer_w 559 def
/d_footer_h 0 def
/d_output_w 559 def
/d_output_h 770 def
/cols 1 def
%%EndSetup
%%Page: (1) 1
%%BeginPageSetup
_S
18 36 translate
/pagenum 1 def
/fname (mcmcloop.dependentpartition.ar1.c) def
/fdir (.) def
/ftail (mcmcloop.dependentpartition.ar1.c) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 759 M
(/*************************************************************) s
5 750 M
( * Copyright \(c\) 2018 Garritt Leland Page) s
5 741 M
( *) s
5 732 M
( * This file contains C code for an MCMC algorithm constructed) s
5 723 M
( * to fit a hierarchical model that incorporates the idea of) s
5 714 M
( * temporally dependent partitions.) s
5 705 M
( *) s
5 696 M
( * I will include model details at a later date) s
5 687 M
( *) s
5 678 M
( *************************************************************/) s
/F-gs-font 8 8 SF
0 setgray
5 660 M
(#) s
/Courier-Bold 8 8 SUF
0.372549 0.619608 0.627451 setrgbcolor
9.8 660 M
(include) s
/F-gs-font 8 8 SF
0 setgray
43.4 660 M
( ) s
/Courier-Bold 8 8 SUF
0.737255 0.560784 0.560784 setrgbcolor
48.2 660 M
("Rutil.h") s
/F-gs-font 8 8 SF
0 setgray
5 642 M
(#) s
/Courier-Bold 8 8 SUF
0.372549 0.619608 0.627451 setrgbcolor
9.8 642 M
(include) s
/F-gs-font 8 8 SF
0 setgray
43.4 642 M
( ) s
/Courier-Bold 8 8 SUF
0.737255 0.560784 0.560784 setrgbcolor
48.2 642 M
(<R_ext/Lapack.h>) s
/F-gs-font 8 8 SF
0 setgray
5 633 M
(#) s
/Courier-Bold 8 8 SUF
0.372549 0.619608 0.627451 setrgbcolor
9.8 633 M
(include) s
/F-gs-font 8 8 SF
0 setgray
43.4 633 M
( ) s
/Courier-Bold 8 8 SUF
0.737255 0.560784 0.560784 setrgbcolor
48.2 633 M
(<R.h>) s
/F-gs-font 8 8 SF
0 setgray
5 624 M
(#) s
/Courier-Bold 8 8 SUF
0.372549 0.619608 0.627451 setrgbcolor
9.8 624 M
(include) s
/F-gs-font 8 8 SF
0 setgray
43.4 624 M
( ) s
/Courier-Bold 8 8 SUF
0.737255 0.560784 0.560784 setrgbcolor
48.2 624 M
(<Rmath.h>) s
/F-gs-font 8 8 SF
0 setgray
5 606 M
(#) s
/Courier-Bold 8 8 SUF
0.372549 0.619608 0.627451 setrgbcolor
9.8 606 M
(include) s
/F-gs-font 8 8 SF
0 setgray
43.4 606 M
( ) s
/Courier-Bold 8 8 SUF
0.737255 0.560784 0.560784 setrgbcolor
48.2 606 M
(<stdio.h>) s
/F-gs-font 8 8 SF
0 setgray
5 597 M
(#) s
/Courier-Bold 8 8 SUF
0.372549 0.619608 0.627451 setrgbcolor
9.8 597 M
(include) s
/F-gs-font 8 8 SF
0 setgray
43.4 597 M
( ) s
/Courier-Bold 8 8 SUF
0.737255 0.560784 0.560784 setrgbcolor
48.2 597 M
(<stdlib.h>) s
/F-gs-font 8 8 SF
0 setgray
5 588 M
(#) s
/Courier-Bold 8 8 SUF
0.372549 0.619608 0.627451 setrgbcolor
9.8 588 M
(include) s
/F-gs-font 8 8 SF
0 setgray
43.4 588 M
( ) s
/Courier-Bold 8 8 SUF
0.737255 0.560784 0.560784 setrgbcolor
48.2 588 M
(<time.h>) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 570 M
(/*****************************************************************************************) s
5 561 M
(* The following are the inputs of the function that are read from R) s
5 552 M
(*) s
5 543 M
(* draws = total number of MCMC draws) s
5 534 M
(* burn = number of MCMC draws discarded as burn-in) s
5 525 M
(* thin = indicates how much MCMC chain should be thinned) s
5 516 M
(*) s
5 507 M
(* nsubject = integer for the number of subjects/units in data set) s
5 498 M
(* ntime = integer for the number of time points) s
5 489 M
(* y = double nsubject x ntime matrix containing response for each subject at time t) s
5 480 M
(* s1 = nsubject x 1 vector containing spatial coordinate one) s
5 471 M
(* s2 = nsubject x 1 vector containing spatial coordinate two) s
5 462 M
(* s1p = nsubject x 1 vector containing spatial coordinate one for prediction \(currently not used\)) s
5 453 M
(* s2p = nsubject x 1 vector containing spatial coordinate two for prediction \(currently not used\)) s
5 444 M
(*) s
5 435 M
(* M = double - indicating value of M associated with cohesion \(scale parameter of DP\).) s
5 426 M
(* alpha = double - prior probability of being pegged, starting value only if  is TRUE) s
5 417 M
(* modelPrior = vector - containing values for prior distributions as follows) s
5 408 M
(*       m0 - mean phi0, s20 - variance of phi0) s
5 399 M
(*       A - upper bound of sigma*_{jt}) s
5 390 M
(*       A0 - upper bound of tau) s
5 381 M
(*   Al - upper bound of lam) s
5 372 M
(*       a - alpha_t shape 1 parameter, b - alpha_t shape 2 parameter) s
5 363 M
(*   be - scale parameter of eta.) s
5 354 M
(*) s
5 345 M
(* global_alpha = integer - logical indicating wether to make alpha time-specific or one global alpha.) s
5 336 M
(* alpha_0 = integer - logical indicating whether  alpha = 0 or not.) s
5 327 M
(* eta1_0 = integer - logical indicating whether  eta1 = 0 or not.) s
5 318 M
(* phi1_0 = integer - logical indicating whether  phi1 = 0 or not.) s
5 309 M
(* sPPM = integer - logical indicating whether to use spatial information or not) s
5 300 M
(*) s
5 291 M
(* SpatialCohesion = integer indication which cohesion to use) s
5 282 M
(*       1 -Auxiliary) s
5 273 M
(*       2- Double dipper) s
5 264 M
(*) s
5 255 M
(* cParms - vector holding values employed in the cohesion) s
5 246 M
(* mh -) s
5 237 M
(* verbose  - logical indicating if information should be printed to screen) s
5 228 M
(*) s
5 219 M
(* OUTPUT) s
5 210 M
(* Si -) s
5 201 M
(* mu -) s
5 192 M
(* sig2 -) s
5 183 M
(* eta1) s
5 174 M
(* theta -) s
5 165 M
(* tau2 -) s
5 156 M
(* phi0 -) s
5 147 M
(* phi1 -) s
5 138 M
(* lam2 -) s
5 129 M
(* gamma -) s
5 120 M
(* alpha.out -) s
5 111 M
(* like) s
5 102 M
(* lpml -) s
5 93 M
(* waic -) s
5 84 M
(*****************************************************************************************/) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
5 48 M
(void) s
/F-gs-font 8 8 SF
0 setgray
24.2 48 M
( ) s
/Courier-Bold 8 8 SUF
0 0 1 setrgbcolor
29 48 M
(mcmc_drpm_ar1) s
/F-gs-font 8 8 SF
0 setgray
91.4 48 M
(\() s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
96.2 48 M
(int) s
/F-gs-font 8 8 SF
0 setgray
110.6 48 M
( *draws, ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
153.8 48 M
(int) s
/F-gs-font 8 8 SF
0 setgray
168.2 48 M
( *burn, ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
206.6 48 M
(int) s
/F-gs-font 8 8 SF
0 setgray
221 48 M
( *thin, ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
259.4 48 M
(int) s
/F-gs-font 8 8 SF
0 setgray
273.8 48 M
( *nsubject, ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
331.4 48 M
(int) s
/F-gs-font 8 8 SF
0 setgray
345.8 48 M
( *ntime,) s
5 39 M
(                          ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
129.8 39 M
(double) s
/F-gs-font 8 8 SF
0 setgray
158.6 39 M
( *y, ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
182.6 39 M
(double) s
/F-gs-font 8 8 SF
0 setgray
211.4 39 M
( *s1, ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
240.2 39 M
(double) s
/F-gs-font 8 8 SF
0 setgray
269 39 M
( *s2, ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
297.8 39 M
(double) s
/F-gs-font 8 8 SF
0 setgray
326.6 39 M
( *M,) s
5 30 M
(                          ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
129.8 30 M
(double) s
/F-gs-font 8 8 SF
0 setgray
158.6 30 M
( *modelPriors,) s
5 21 M
(                          ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
129.8 21 M
(int) s
/F-gs-font 8 8 SF
0 setgray
144.2 21 M
( *global_alpha, ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
221 21 M
(int) s
/F-gs-font 8 8 SF
0 setgray
235.4 21 M
( *alpha_0, ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
288.2 21 M
(int) s
/F-gs-font 8 8 SF
0 setgray
302.6 21 M
( *eta1_0, ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
350.6 21 M
(int) s
/F-gs-font 8 8 SF
0 setgray
365 21 M
( *phi1_0,) s
5 12 M
(                          ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
129.8 12 M
(int) s
/F-gs-font 8 8 SF
0 setgray
144.2 12 M
( *sPPM, ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
182.6 12 M
(int) s
/F-gs-font 8 8 SF
0 setgray
197 12 M
( *SpatialCohesion, ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
288.2 12 M
(double) s
/F-gs-font 8 8 SF
0 setgray
317 12 M
( *cParms, ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
365 12 M
(double) s
/F-gs-font 8 8 SF
0 setgray
393.8 12 M
( *mh, ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
422.6 12 M
(int) s
/F-gs-font 8 8 SF
0 setgray
437 12 M
( *verbose,) s
5 3 M
(                          ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
129.8 3 M
(int) s
/F-gs-font 8 8 SF
0 setgray
144.2 3 M
( *Si, ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
173 3 M
(double) s
/F-gs-font 8 8 SF
0 setgray
201.8 3 M
( *mu, ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
230.6 3 M
(double) s
/F-gs-font 8 8 SF
0 setgray
259.4 3 M
( *sig2, ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
297.8 3 M
(double) s
/F-gs-font 8 8 SF
0 setgray
326.6 3 M
( *eta1, ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
365 3 M
(double) s
/F-gs-font 8 8 SF
0 setgray
393.8 3 M
( *theta, ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
437 3 M
(double) s
/F-gs-font 8 8 SF
0 setgray
465.8 3 M
( *tau2,) s
_R
S
%%Page: (2) 2
%%BeginPageSetup
_S
18 36 translate
/pagenum 2 def
/fname (mcmcloop.dependentpartition.ar1.c) def
/fdir (.) def
/ftail (mcmcloop.dependentpartition.ar1.c) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 759 M
(                          ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
129.8 759 M
(double) s
/F-gs-font 8 8 SF
0 setgray
158.6 759 M
( *phi0, ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
197 759 M
(double) s
/F-gs-font 8 8 SF
0 setgray
225.8 759 M
( *phi1, ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
264.2 759 M
(double) s
/F-gs-font 8 8 SF
0 setgray
293 759 M
( *lam2, ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
331.4 759 M
(int) s
/F-gs-font 8 8 SF
0 setgray
345.8 759 M
( *gamma, ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
389 759 M
(double) s
/F-gs-font 8 8 SF
0 setgray
417.8 759 M
( *alpha_out,) s
5 750 M
(                          ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
129.8 750 M
(double) s
/F-gs-font 8 8 SF
0 setgray
158.6 750 M
( *fitted, ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
206.6 750 M
(double) s
/F-gs-font 8 8 SF
0 setgray
235.4 750 M
( *llike, ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
278.6 750 M
(double) s
/F-gs-font 8 8 SF
0 setgray
307.4 750 M
( *lpml, ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
345.8 750 M
(double) s
/F-gs-font 8 8 SF
0 setgray
374.6 750 M
( *waic\){) s
5 705 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 705 M
(// i - MCMC iterate) s
/F-gs-font 8 8 SF
0 setgray
5 696 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 696 M
(// ii - MCMC iterate that is saved) s
/F-gs-font 8 8 SF
0 setgray
5 687 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 687 M
(// j - subject iterate) s
/F-gs-font 8 8 SF
0 setgray
5 678 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 678 M
(// jj - second subject iterate) s
/F-gs-font 8 8 SF
0 setgray
5 669 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 669 M
(// t - time iterate) s
/F-gs-font 8 8 SF
0 setgray
5 660 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 660 M
(// k - cluster iterate) s
/F-gs-font 8 8 SF
0 setgray
5 651 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 651 M
(// p - prediction iterate) s
/F-gs-font 8 8 SF
0 setgray
5 633 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 633 M
(int) s
/F-gs-font 8 8 SF
0 setgray
57.8 633 M
( i, ii, j, jj, t, k;) s
5 624 M
(        ii = 0;) s
5 606 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 606 M
(int) s
/F-gs-font 8 8 SF
0 setgray
57.8 606 M
( nout = \(*draws - *burn\)/\(*thin\);) s
5 588 M
(    ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
24.2 588 M
(if) s
/F-gs-font 8 8 SF
0 setgray
33.8 588 M
(\(*verbose\){) s
5 579 M
(          Rprintf\() s
/Courier-Bold 8 8 SUF
0.737255 0.560784 0.560784 setrgbcolor
91.4 579 M
("nsubject = %d\\n") s
/F-gs-font 8 8 SF
0 setgray
173 579 M
(, *nsubject\);) s
5 570 M
(          Rprintf\() s
/Courier-Bold 8 8 SUF
0.737255 0.560784 0.560784 setrgbcolor
91.4 570 M
("ntime = %d\\n") s
/F-gs-font 8 8 SF
0 setgray
158.6 570 M
(, *ntime\);) s
5 561 M
(          Rprintf\() s
/Courier-Bold 8 8 SUF
0.737255 0.560784 0.560784 setrgbcolor
91.4 561 M
("nout = %d\\n") s
/F-gs-font 8 8 SF
0 setgray
153.8 561 M
(, nout\);) s
5 552 M
(        }) s
5 534 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 534 M
(// ===================================================================================) s
/F-gs-font 8 8 SF
0 setgray
5 525 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 525 M
(//) s
/F-gs-font 8 8 SF
0 setgray
5 516 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 516 M
(// Memory vectors to hold MCMC iterates for non cluster specific parameters) s
/F-gs-font 8 8 SF
0 setgray
5 507 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 507 M
(//) s
/F-gs-font 8 8 SF
0 setgray
5 498 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 498 M
(// ===================================================================================) s
/F-gs-font 8 8 SF
0 setgray
5 480 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 480 M
(// This variable is used to create a "buffer" zone of memory so that updating) s
/F-gs-font 8 8 SF
0 setgray
5 471 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 471 M
(// things on time boundary do not need special attention in the algorithm since) s
/F-gs-font 8 8 SF
0 setgray
5 462 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 462 M
(// I have to look at time period before and after when updating partitions) s
/F-gs-font 8 8 SF
0 setgray
5 453 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 453 M
(int) s
/F-gs-font 8 8 SF
0 setgray
57.8 453 M
( ntime1 = *ntime + 1;) s
5 435 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 435 M
(// I am adding one more year as an empty vector) s
/F-gs-font 8 8 SF
0 setgray
5 426 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 426 M
(// so that the C program does not crash.) s
/F-gs-font 8 8 SF
0 setgray
5 417 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 417 M
(int) s
/F-gs-font 8 8 SF
0 setgray
57.8 417 M
( gamma_iter[\(*nsubject\)*\(ntime1\)];) s
5 408 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 408 M
(int) s
/F-gs-font 8 8 SF
0 setgray
57.8 408 M
( Si_iter[\(*nsubject\)*\(ntime1\)];) s
5 399 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 399 M
(int) s
/F-gs-font 8 8 SF
0 setgray
57.8 399 M
( nclus_iter[ntime1];) s
5 381 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 381 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 381 M
( *eta1_iter = R_VectorInit\(*nsubject, 0.0\);) s
5 372 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 372 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 372 M
( *theta_iter = R_VectorInit\(ntime1, 0.0\);) s
5 363 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 363 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 363 M
( *tau2_iter = R_VectorInit\(ntime1, 1.0\);) s
5 345 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 345 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 345 M
( phi0_iter = 0.0;) s
5 336 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 336 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 336 M
( phi1_iter = 0.0;) s
5 327 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 327 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 327 M
( lam2_iter = 1.0;) s
5 309 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 309 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 309 M
( *alpha_iter = R_VectorInit\(ntime1, 0.0\);) s
5 291 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 291 M
(// ===================================================================================) s
/F-gs-font 8 8 SF
0 setgray
5 282 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 282 M
(//) s
/F-gs-font 8 8 SF
0 setgray
5 273 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 273 M
(// Memory vectors to hold MCMC iterates for cluster specific parameters) s
/F-gs-font 8 8 SF
0 setgray
5 264 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 264 M
(//) s
/F-gs-font 8 8 SF
0 setgray
5 255 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 255 M
(// ===================================================================================) s
/F-gs-font 8 8 SF
0 setgray
5 237 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 237 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 237 M
( *muh = R_VectorInit\(\(*nsubject\)*\(ntime1\), 0.0\);) s
5 228 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 228 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 228 M
( *sig2h = R_VectorInit\(\(*nsubject\)*\(ntime1\), 0.5\);) s
5 201 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 201 M
(int) s
/F-gs-font 8 8 SF
0 setgray
57.8 201 M
( nh[\(*nsubject\)*\(ntime1\)];) s
5 174 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 174 M
(// ===================================================================================) s
/F-gs-font 8 8 SF
0 setgray
5 165 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 165 M
(//) s
/F-gs-font 8 8 SF
0 setgray
5 156 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 156 M
(// Initialize a few parameter vectors) s
/F-gs-font 8 8 SF
0 setgray
5 147 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 147 M
(//) s
/F-gs-font 8 8 SF
0 setgray
5 138 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 138 M
(// ===================================================================================) s
/F-gs-font 8 8 SF
0 setgray
5 120 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 120 M
(// Initialize Si according to covariates) s
/F-gs-font 8 8 SF
0 setgray
5 111 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 111 M
(// I am adding one time period here to have) s
/F-gs-font 8 8 SF
0 setgray
5 102 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 102 M
(// scratch memory \(never filled in\) so that) s
/F-gs-font 8 8 SF
0 setgray
5 93 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 93 M
(// I can avoid dealing with boundaries in algorithm) s
/F-gs-font 8 8 SF
0 setgray
5 84 M
(        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
43.4 84 M
(for) s
/F-gs-font 8 8 SF
0 setgray
57.8 84 M
(\(j = 0; j < *nsubject; j++\){) s
5 75 M
(                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
81.8 75 M
(for) s
/F-gs-font 8 8 SF
0 setgray
96.2 75 M
(\(t = 0; t < ntime1; t++\){ ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
221 75 M
(// Note I am not initializing the "added time memory") s
/F-gs-font 8 8 SF
0 setgray
5 66 M
(                        Si_iter[j*\(ntime1\) + t] = 1;) s
5 57 M
(                        gamma_iter[j*\(ntime1\) + t] = 0;) s
5 48 M
(                        nh[j*\(ntime1\) + t] = 0;) s
5 39 M
(                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
120.2 39 M
(if) s
/F-gs-font 8 8 SF
0 setgray
129.8 39 M
(\(t==1\) Si_iter[j*ntime1 + t] = 1;) s
5 30 M
(                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
120.2 30 M
(if) s
/F-gs-font 8 8 SF
0 setgray
129.8 30 M
(\(t==*ntime\) Si_iter[j*\(ntime1\) + t] = 0;) s
5 12 M
(                }) s
5 3 M
(        }) s
_R
S
%%Page: (3) 3
%%BeginPageSetup
_S
18 36 translate
/pagenum 3 def
/fname (mcmcloop.dependentpartition.ar1.c) def
/fdir (.) def
/ftail (mcmcloop.dependentpartition.ar1.c) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 750 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 750 M
(// Initial enumeration of number of subjects per cluster;) s
/F-gs-font 8 8 SF
0 setgray
5 741 M
(        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
43.4 741 M
(for) s
/F-gs-font 8 8 SF
0 setgray
57.8 741 M
(\(j = 0; j < *nsubject; j++\){) s
5 732 M
(                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
81.8 732 M
(for) s
/F-gs-font 8 8 SF
0 setgray
96.2 732 M
(\(t = 0; t < *ntime; t++\){) s
5 723 M
(                        nh[\(Si_iter[j*\(ntime1\)+t]-1\)*\(ntime1\) + t] = nh[\(Si_iter[j*\(ntime1\)+t]-1\)*\(ntime1\) + t] + ) s
5 714 M
(1;) s
5 705 M
(                }) s
5 696 M
(        }) s
5 678 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 678 M
(// Initialize the number of clusters) s
/F-gs-font 8 8 SF
0 setgray
5 669 M
(        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
43.4 669 M
(for) s
/F-gs-font 8 8 SF
0 setgray
57.8 669 M
(\(t = 0; t < *ntime; t++\){) s
5 660 M
(        nclus_iter[t] = 0;) s
5 651 M
(                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
81.8 651 M
(for) s
/F-gs-font 8 8 SF
0 setgray
96.2 651 M
(\(j = 0; j < *nsubject; j++\){) s
5 642 M
(                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
120.2 642 M
(if) s
/F-gs-font 8 8 SF
0 setgray
129.8 642 M
(\(nh[j*\(ntime1\) + t] > 0\) nclus_iter[t] = nclus_iter[t] + 1;) s
5 633 M
(                }) s
5 624 M
(        }) s
5 615 M
(        nclus_iter[*ntime] = 0;) s
5 588 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 588 M
(// ===================================================================================) s
/F-gs-font 8 8 SF
0 setgray
5 579 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 579 M
(//) s
/F-gs-font 8 8 SF
0 setgray
5 570 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 570 M
(// scratch vectors of memory needed to update parameters) s
/F-gs-font 8 8 SF
0 setgray
5 561 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 561 M
(//) s
/F-gs-font 8 8 SF
0 setgray
5 552 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 552 M
(// ===================================================================================) s
/F-gs-font 8 8 SF
0 setgray
5 534 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 534 M
(// stuff needed to update gamma vectors) s
/F-gs-font 8 8 SF
0 setgray
5 525 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 525 M
(int) s
/F-gs-font 8 8 SF
0 setgray
57.8 525 M
( nclus_red=0, nh_red[*nsubject], n_red=0, gt;) s
5 516 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 516 M
(int) s
/F-gs-font 8 8 SF
0 setgray
57.8 516 M
( nclus_redtmp=0, nh_redtmp[*nsubject], n_redtmp=0, nh_tmp[*nsubject];) s
5 507 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 507 M
(int) s
/F-gs-font 8 8 SF
0 setgray
57.8 507 M
( nh_redtmp_no_zero[*nsubject], nh_red_no_zero[*nsubject],nh_tmp_no_zero[*nsubject];) s
5 498 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 498 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 498 M
( lpp_full=0.0, lpp_red=0.0;) s
5 480 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 480 M
(int) s
/F-gs-font 8 8 SF
0 setgray
57.8 480 M
( nh_red_1[*nsubject];) s
5 471 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 471 M
(int) s
/F-gs-font 8 8 SF
0 setgray
57.8 471 M
( nclus_redtmp_1=0, nh_redtmp_1[*nsubject], n_redtmp_1=0, nh_tmp_1[*nsubject];) s
5 462 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 462 M
(int) s
/F-gs-font 8 8 SF
0 setgray
57.8 462 M
( nh_redtmp_no_zero_1[*nsubject], nh_red_no_zero_1[*nsubject],nh_tmp_no_zero_1[*nsubject];) s
5 453 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 453 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 453 M
( lpp_full_1=0.0, lpp_red_1=0.0;) s
5 435 M
(        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
43.4 435 M
(for) s
/F-gs-font 8 8 SF
0 setgray
57.8 435 M
(\(j=0; j<*nsubject; j++\){) s
5 426 M
(                nh_tmp[j] = 0; nh_red[j] = 0; nh_redtmp[j] = 0;) s
5 417 M
(                nh_redtmp_no_zero[j] = 0; nh_red_no_zero[j] = 0; nh_tmp_no_zero[j] = 0;) s
5 399 M
(                nh_tmp_1[j] = 0; nh_red_1[j] = 0; nh_redtmp_1[j] = 0;) s
5 390 M
(                nh_redtmp_no_zero_1[j] = 0; nh_red_no_zero_1[j] = 0; nh_tmp_no_zero_1[j] = 0;) s
5 381 M
(        }) s
5 363 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 363 M
(// stuff that I need to update Si \(the parition\);) s
/F-gs-font 8 8 SF
0 setgray
5 354 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 354 M
(int) s
/F-gs-font 8 8 SF
0 setgray
57.8 354 M
( comp1t[\(*nsubject\)],comptm1[\(*nsubject\)],comp2t[\(*nsubject\)],comptp1[\(*nsubject\)];) s
5 345 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 345 M
(int) s
/F-gs-font 8 8 SF
0 setgray
57.8 345 M
( rho_tmp[*nsubject], Si_tmp[*nsubject], Si_tmp2[*nsubject];) s
5 336 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 336 M
(int) s
/F-gs-font 8 8 SF
0 setgray
57.8 336 M
( oldLab[*nsubject], reorder[*nsubject];) s
5 327 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 327 M
(int) s
/F-gs-font 8 8 SF
0 setgray
57.8 327 M
( iaux, Rindx1, Rindx2, n_tmp, nclus_tmp, n_tmp_1, nclus_tmp_1,rho_comp, indx;) s
5 318 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 318 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 318 M
( auxm, auxs, mudraw, sigdraw, maxph, denph, cprobh, uu, lCo, lCn, lCn_1;) s
5 309 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 309 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 309 M
( *ph = R_VectorInit\(*nsubject, 0.0\);) s
5 300 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 300 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 300 M
( *phtmp = R_VectorInit\(*nsubject, 0.0\);) s
5 291 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 291 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 291 M
( *probh = R_VectorInit\(*nsubject, 0.0\);) s
5 282 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 282 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 282 M
( *s1o = R_Vector\(*nsubject\);) s
5 273 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 273 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 273 M
( *s2o = R_Vector\(*nsubject\);) s
5 264 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 264 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 264 M
( *s1n = R_Vector\(*nsubject\);) s
5 255 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 255 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 255 M
( *s2n = R_Vector\(*nsubject\);) s
5 237 M
(        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
43.4 237 M
(for) s
/F-gs-font 8 8 SF
0 setgray
57.8 237 M
(\(j=0; j<\(*nsubject\); j++\){) s
5 228 M
(                comp1t[j] = 0; comptm1[j] = 0, comp2t[j]=0, comptp1[j]=0;) s
5 219 M
(        }) s
5 192 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 192 M
(// stuff I need to update eta1) s
/F-gs-font 8 8 SF
0 setgray
5 183 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 183 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 183 M
( e1o, e1n, logito, logitn, one_phisq;) s
5 165 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 165 M
(// stuff I need to update muh and sig2h) s
/F-gs-font 8 8 SF
0 setgray
5 156 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 156 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 156 M
( mstar, s2star, sumy, sume2;) s
5 147 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 147 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 147 M
( nsig, osig, llo, lln, llr;) s
5 138 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 138 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 138 M
( *mu_tmp = R_VectorInit\(*nsubject, 0.0\);) s
5 129 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 129 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 129 M
( *sig2_tmp = R_VectorInit\(*nsubject, 1.0\);) s
5 111 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 111 M
(// stuff that I need for theta and lam2) s
/F-gs-font 8 8 SF
0 setgray
5 102 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 102 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 102 M
( summu, nt, ot, lam2tmp, phi1sq, sumt, op1, np1, ol, nl;) s
5 84 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 84 M
(// stuff that I need to update alpha) s
/F-gs-font 8 8 SF
0 setgray
5 75 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 75 M
(int) s
/F-gs-font 8 8 SF
0 setgray
57.8 75 M
( sumg;) s
5 66 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 66 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 66 M
( astar, bstar,alpha_tmp;) s
5 48 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 48 M
(// Stuff to compute lpml, likelihood, and WAIC) s
/F-gs-font 8 8 SF
0 setgray
5 39 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 39 M
(int) s
/F-gs-font 8 8 SF
0 setgray
57.8 39 M
( like0, nout_0=0;) s
5 30 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 30 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 30 M
( lpml_iter, elppdWAIC;) s
5 21 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 21 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 21 M
( *CPO = R_VectorInit\(\(*nsubject\)*\(ntime1\), 0.0\);) s
5 12 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 12 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 12 M
( *like_iter = R_VectorInit\(\(*nsubject\)*\(ntime1\), 0.0\);) s
5 3 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 3 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 3 M
( *fitted_iter = R_VectorInit\(\(*nsubject\)*\(ntime1\), 0.0\);) s
_R
S
%%Page: (4) 4
%%BeginPageSetup
_S
18 36 translate
/pagenum 4 def
/fname (mcmcloop.dependentpartition.ar1.c) def
/fdir (.) def
/ftail (mcmcloop.dependentpartition.ar1.c) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 759 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 759 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 759 M
( *mnlike = R_VectorInit\(\(*nsubject\)*\(ntime1\), 0.0\);) s
5 750 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 750 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 750 M
( *mnllike = R_VectorInit\(\(*nsubject\)*\(ntime1\), 0.0\);) s
5 732 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 732 M
(// stuff to predict) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 723 M
(//      int gpred[*nsubject], nh_pred[*nsubject], predSi_iter[*nsubject];) s
/F-gs-font 8 8 SF
0 setgray
5 696 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 696 M
(// ===================================================================================) s
/F-gs-font 8 8 SF
0 setgray
5 687 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 687 M
(//) s
/F-gs-font 8 8 SF
0 setgray
5 678 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 678 M
(// Prior parameter values) s
/F-gs-font 8 8 SF
0 setgray
5 669 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 669 M
(//) s
/F-gs-font 8 8 SF
0 setgray
5 660 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 660 M
(// ===================================================================================) s
/F-gs-font 8 8 SF
0 setgray
5 642 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 642 M
(// upper bound for sig, tau, lam) s
/F-gs-font 8 8 SF
0 setgray
5 633 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 633 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 633 M
( A=modelPriors[2];) s
5 624 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 624 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 624 M
( A0=modelPriors[3];) s
5 615 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 615 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 615 M
( Al=modelPriors[4];) s
5 597 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 597 M
(// priors for phi0) s
/F-gs-font 8 8 SF
0 setgray
5 588 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 588 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 588 M
( m0 = modelPriors[0], s20 = modelPriors[1];) s
5 570 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 570 M
(// priors for alpha) s
/F-gs-font 8 8 SF
0 setgray
5 561 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 561 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 561 M
( a = modelPriors[5], b = modelPriors[6];) s
5 543 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 543 M
(//priors for eta1) s
/F-gs-font 8 8 SF
0 setgray
5 534 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 534 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 534 M
( b_eta1 = modelPriors[7];) s
5 516 M
(    ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
24.2 516 M
(if) s
/F-gs-font 8 8 SF
0 setgray
33.8 516 M
(\(*verbose\){) s
5 507 M
(          Rprintf\() s
/Courier-Bold 8 8 SUF
0.737255 0.560784 0.560784 setrgbcolor
91.4 507 M
("Prior values: m0 = %.2f, s20 = %.2f\\n \\v Asig = %.2f, Atau = %.2f, Alam = %.2f,\\n \\t a = %.2f, ) s
5 498 M
(b = %.2f, b_eta1 = %.2f\\n") s
/F-gs-font 8 8 SF
0 setgray
129.8 498 M
(,) s
5 489 M
(                   m0, s20, A, A0, Al, a, b, b_eta1\);) s
5 480 M
(    }) s
5 471 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 471 M
(// DP weight parameter) s
/F-gs-font 8 8 SF
0 setgray
5 462 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 462 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 462 M
( Mdp = *M;) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 444 M
(//      Rprintf\("Mdp = %f\\n", Mdp\);) s
/F-gs-font 8 8 SF
0 setgray
5 426 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 426 M
(// Cohesion auxiliary model paramaters for Cohesions 3 and 4) s
/F-gs-font 8 8 SF
0 setgray
5 417 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 417 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 417 M
( k0=cParms[1], v0=cParms[2];) s
5 408 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 408 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 408 M
( *mu0 = R_VectorInit\(2,cParms[0]\);) s
5 399 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 399 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 399 M
( *L0 = R_VectorInit\(2*2,0.0\);) s
5 390 M
(        L0[0] = cParms[3]; L0[3] = cParms[3];) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 381 M
(//      Rprintf\("k0 = %f\\n", k0\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 372 M
(//      RprintVecAsMat\("L0", L0, 2, 2\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 345 M
(//      RprintVecAsMat\("mh", mh, 1, 5\);) s
/F-gs-font 8 8 SF
0 setgray
5 336 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 336 M
(// M-H step tunning parameter) s
/F-gs-font 8 8 SF
0 setgray
5 327 M
(        ) s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
43.4 327 M
(double) s
/F-gs-font 8 8 SF
0 setgray
72.2 327 M
( csigSIG=mh[0], csigTAU=mh[1], csigLAM=mh[2], csigETA1=mh[3], csigPHI1=mh[4];) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 309 M
(//      Rprintf\("csigETA1 = %f\\n", csigETA1\);) s
/F-gs-font 8 8 SF
0 setgray
5 273 M
(        GetRNGstate\(\);) s
5 246 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 246 M
(// ===================================================================================) s
/F-gs-font 8 8 SF
0 setgray
5 237 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 237 M
(//) s
/F-gs-font 8 8 SF
0 setgray
5 228 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 228 M
(// start of the mcmc algorithm;) s
/F-gs-font 8 8 SF
0 setgray
5 219 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 219 M
(//) s
/F-gs-font 8 8 SF
0 setgray
5 210 M
(        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
43.4 210 M
(// ===================================================================================) s
/F-gs-font 8 8 SF
0 setgray
5 192 M
(        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
43.4 192 M
(for) s
/F-gs-font 8 8 SF
0 setgray
57.8 192 M
(\(i = 0; i < *draws; i++\){) s
5 174 M
(                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
81.8 174 M
(if) s
/F-gs-font 8 8 SF
0 setgray
91.4 174 M
(\(*verbose\){) s
5 165 M
(                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
120.2 165 M
(if) s
/F-gs-font 8 8 SF
0 setgray
129.8 165 M
(\(\(i+1\) % 5000 == 0\){) s
5 156 M
(                                time_t now;) s
5 147 M
(                                time\(&now\);) s
5 129 M
(                                Rprintf\() s
/Courier-Bold 8 8 SUF
0.737255 0.560784 0.560784 setrgbcolor
197 129 M
("mcmc iter = %d =========================================== \\n") s
/F-gs-font 8 8 SF
0 setgray
499.4 129 M
(, i+1\);) s
5 120 M
(                                Rprintf\() s
/Courier-Bold 8 8 SUF
0.737255 0.560784 0.560784 setrgbcolor
197 120 M
("%s") s
/F-gs-font 8 8 SF
0 setgray
216.2 120 M
(, ctime\(&now\)\);) s
5 111 M
(                        }) s
5 93 M
(                }) s
5 66 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 66 M
(// Start updating gamma and partition for each time period) s
/F-gs-font 8 8 SF
0 setgray
5 57 M
(                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
81.8 57 M
(for) s
/F-gs-font 8 8 SF
0 setgray
96.2 57 M
(\(t = 0; t < *ntime; t++\){) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 39 M
(//                      Rprintf\("t = %d\\n", t\);) s
/F-gs-font 8 8 SF
0 setgray
5 12 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 12 M
(//////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 3 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 3 M
(//) s
_R
S
%%Page: (5) 5
%%BeginPageSetup
_S
18 36 translate
/pagenum 5 def
/fname (mcmcloop.dependentpartition.ar1.c) def
/fdir (.) def
/ftail (mcmcloop.dependentpartition.ar1.c) def
/Courier-Oblique 8 8 SUF
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
0.698039 0.133333 0.133333 setrgbcolor
/F-gs-font 8 8 SF
0 setgray
5 759 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 759 M
(// begin by updating gamma \(pegged\) parameters) s
/F-gs-font 8 8 SF
0 setgray
5 750 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 750 M
(//) s
/F-gs-font 8 8 SF
0 setgray
5 741 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 741 M
(//////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 723 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 723 M
(// The complete partition does not change as gammas change) s
/F-gs-font 8 8 SF
0 setgray
5 714 M
(                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
120.2 714 M
(for) s
/F-gs-font 8 8 SF
0 setgray
134.6 714 M
(\(j=0;j<*nsubject;j++\){) s
5 705 M
(                                nh_red[j]=0; nh_redtmp[j]=0; nh_tmp[j] = 0;) s
5 696 M
(                        }) s
5 678 M
(                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
120.2 678 M
(for) s
/F-gs-font 8 8 SF
0 setgray
134.6 678 M
(\(k = 0; k < nclus_iter[t]; k++\){) s
5 669 M
(                                nh_tmp[k] = nh[k*\(ntime1\) + t];) s
5 660 M
(                        }) s
5 633 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 633 M
(// Note this value does not change even as gamma changes.  The only) s
/F-gs-font 8 8 SF
0 setgray
5 624 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 624 M
(// concern is that rho_t-1 and rho_t are compatible.) s
/F-gs-font 8 8 SF
0 setgray
5 615 M
(                        lpp_full = partition_prob_crp\(nh_tmp, nclus_iter[t], Mdp, *nsubject, 1\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 597 M
(//                      Rprintf\("lpp_full = %f\\n", lpp_full\);) s
/F-gs-font 8 8 SF
0 setgray
5 561 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 561 M
(//////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 552 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 552 M
(// find the reduced partition information) s
/F-gs-font 8 8 SF
0 setgray
5 543 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 543 M
(// i.e., number of units clustered, number of clusters, size of clusters;) s
/F-gs-font 8 8 SF
0 setgray
5 534 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 534 M
(//////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 525 M
(                        n_red = 0; n_redtmp=0;) s
5 516 M
(                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
120.2 516 M
(for) s
/F-gs-font 8 8 SF
0 setgray
134.6 516 M
(\(j = 0; j < *nsubject; j++\){) s
5 507 M
(                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
158.6 507 M
(if) s
/F-gs-font 8 8 SF
0 setgray
168.2 507 M
(\(gamma_iter[j*\(ntime1\) + t] == 1\){) s
5 498 M
(                                        nh_red[Si_iter[j*\(ntime1\) + t]-1] = nh_red[Si_iter[j*\(ntime1\) + t]-1]+1;) s
5 489 M
(                                        n_red=n_red+1;) s
5 471 M
(                                        nh_redtmp[Si_iter[j*\(ntime1\) + t]-1] = nh_redtmp[Si_iter[j*\(ntime1\) + t]-1) s
5 462 M
(]+1;) s
5 453 M
(                                        n_redtmp=n_redtmp+1;) s
5 444 M
(                                }) s
5 426 M
(                        }) s
5 390 M
(                        nclus_red = 0, nclus_redtmp=0;) s
5 381 M
(                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
120.2 381 M
(for) s
/F-gs-font 8 8 SF
0 setgray
134.6 381 M
(\(j = 0; j < *nsubject; j++\){) s
5 372 M
(                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
158.6 372 M
(if) s
/F-gs-font 8 8 SF
0 setgray
168.2 372 M
(\(nh_red[j] > 0\) nclus_red = nclus_red + 1;) s
5 363 M
(                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
158.6 363 M
(if) s
/F-gs-font 8 8 SF
0 setgray
168.2 363 M
(\(nh_redtmp[j] > 0\) nclus_redtmp = nclus_redtmp + 1;) s
5 354 M
(                        }) s
5 345 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 345 M
(//////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 327 M
(//                      Rprintf\("nclus_red = %d\\n", nclus_red\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 318 M
(//                      Rprintf\("n_red = %d\\n \\n \\n \\n", n_red\);) s
/F-gs-font 8 8 SF
0 setgray
5 291 M
(                        remove_zero\(nh_red, *nsubject, nh_red_no_zero\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 273 M
(//                      RprintIVecAsMat\("nh_red_no_zero", nh_red_no_zero, 1, *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 255 M
(//                      RprintIVecAsMat\("gamma_iter", gamma_iter, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 246 M
(//                      RprintIVecAsMat\("Si_iter", Si_iter, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
5 219 M
(                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
120.2 219 M
(for) s
/F-gs-font 8 8 SF
0 setgray
134.6 219 M
(\(j = 0; j < *nsubject; j++\){) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 210 M
(//                              Rprintf\("t = %d\\n", t\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 201 M
(//                              Rprintf\("j = %d\\n", j\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 174 M
(//                              RprintIVecAsMat\("gamma_iter", gamma_iter, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 165 M
(//                              Rprintf\("gamma_iter[j*\(ntime1\) + t] = %d\\n", gamma_iter[j*\(ntime1\) + t]\);) s
/F-gs-font 8 8 SF
0 setgray
5 147 M
(                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
158.6 147 M
(// at time period one, all gammas are zero \(none are ``pegged''\)) s
/F-gs-font 8 8 SF
0 setgray
5 138 M
(                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
158.6 138 M
(if) s
/F-gs-font 8 8 SF
0 setgray
168.2 138 M
(\(t == 0\){) s
5 129 M
(                                        gamma_iter[j*\(ntime1\) + t] = 0;) s
5 120 M
(                                } ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
168.2 120 M
(else) s
/F-gs-font 8 8 SF
0 setgray
187.4 120 M
( {) s
5 102 M
(                                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
197 102 M
(// this may need to be updated depending on if the value of gamma changes) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 84 M
(//                                      RprintIVecAsMat\("nh_red_no_zero", nh_red_no_zero, 1, *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
5 66 M
(                                        lpp_red = partition_prob_crp\(nh_red_no_zero, nclus_red, Mdp, n_red, 1\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 39 M
(//                                      Rprintf\("lpp_full = %f\\n", lpp_full\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 30 M
(//                                      Rprintf\("lpp_red = %f\\n", lpp_red\);) s
/F-gs-font 8 8 SF
0 setgray
5 12 M
(                                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
197 12 M
(// If gamma is 1 at current MCMC iterate, then there are no) s
/F-gs-font 8 8 SF
0 setgray
5 3 M
(                                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
197 3 M
(// concerns about partitions being incompatible as gamma changes) s
_R
S
%%Page: (6) 6
%%BeginPageSetup
_S
18 36 translate
/pagenum 6 def
/fname (mcmcloop.dependentpartition.ar1.c) def
/fdir (.) def
/ftail (mcmcloop.dependentpartition.ar1.c) def
/Courier-Oblique 8 8 SUF
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
0.698039 0.133333 0.133333 setrgbcolor
/F-gs-font 8 8 SF
0 setgray
5 759 M
(                                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
197 759 M
(// from 1 to 0.) s
/F-gs-font 8 8 SF
0 setgray
5 732 M
(                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
197 732 M
(if) s
/F-gs-font 8 8 SF
0 setgray
206.6 732 M
(\(gamma_iter[j*\(ntime1\) + t] == 1\){) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 714 M
(//                                              Rprintf\("Starting at gamma=1 and staying at gamma=1 \\n"\);) s
/F-gs-font 8 8 SF
0 setgray
5 705 M
(                                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
235.4 705 M
(// if gamma remains 1, then no changes) s
/F-gs-font 8 8 SF
0 setgray
5 696 M
(                                                ph[1] = lpp_full - lpp_red + log\(alpha_iter[t]\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 687 M
(//                                              Rprintf\("ph[1] = %f\\n", ph[1]\);) s
/F-gs-font 8 8 SF
0 setgray
5 660 M
(                                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
235.4 660 M
(// if gamme moves from 1 to 0 need to remove one unit from) s
/F-gs-font 8 8 SF
0 setgray
5 651 M
(                                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
235.4 651 M
(// rho_t.R) s
/F-gs-font 8 8 SF
0 setgray
5 633 M
(                                                nh_redtmp[Si_iter[j*ntime1+t]-1] = nh_red[Si_iter[j*ntime1+t]-1] -) s
5 624 M
( 1      ;) s
5 615 M
(                                                n_redtmp = n_redtmp - 1;) s
5 597 M
(                                                remove_zero\(nh_redtmp, *nsubject, nh_redtmp_no_zero\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 579 M
(//                                              RprintIVecAsMat\("nh_redtmp", nh_redtmp, 1, *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 561 M
(//                                              RprintIVecAsMat\("nh_redtmp_no_zero", nh_redtmp, 1, *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
5 543 M
(                                                nclus_redtmp=0;) s
5 534 M
(                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
235.4 534 M
(for) s
/F-gs-font 8 8 SF
0 setgray
249.8 534 M
(\(jj = 0; jj < *nsubject; jj++\){) s
5 525 M
(                                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
273.8 525 M
(if) s
/F-gs-font 8 8 SF
0 setgray
283.4 525 M
(\(nh_redtmp[jj] > 0\) nclus_redtmp = nclus_redtmp + 1;) s
5 516 M
(                                                }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 498 M
(//                                              Rprintf\("Starting at gamma=1 and moving to gamma=0 \\n"\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 480 M
(//                                              RprintIVecAsMat\("nh_red", nh_red, 1, *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 471 M
(//                                              RprintIVecAsMat\("nh_redtmp", nh_redtmp, 1, *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 453 M
(//                                              Rprintf\("lpp_full = %f\\n", lpp_full\);) s
/F-gs-font 8 8 SF
0 setgray
5 444 M
(                                                lpp_red = partition_prob_crp\(nh_redtmp_no_zero, nclus_redtmp, Mdp,) s
5 435 M
( n_redtmp, 1\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 417 M
(//                                              Rprintf\("llp_red = %f\\n", lpp_red\);) s
/F-gs-font 8 8 SF
0 setgray
5 399 M
(                                                ph[0] = lpp_full - lpp_red + log\(1-alpha_iter[t]\);) s
5 372 M
(                                        }) s
5 327 M
(                                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
197 327 M
(// if gamma's current value is 0, then care must be taken when) s
/F-gs-font 8 8 SF
0 setgray
5 318 M
(                                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
197 318 M
(// trying to change from gamma=0 to gamma=1 as the partitions may) s
/F-gs-font 8 8 SF
0 setgray
5 309 M
(                                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
197 309 M
(// no longer be compatible) s
/F-gs-font 8 8 SF
0 setgray
5 300 M
(                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
197 300 M
(if) s
/F-gs-font 8 8 SF
0 setgray
206.6 300 M
(\(gamma_iter[j*\(ntime1\) + t] == 0\){) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 282 M
(//                                              Rprintf\("lpp_red = %f\\n", lpp_red\);) s
/F-gs-font 8 8 SF
0 setgray
5 273 M
(                                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
235.4 273 M
(// if gamma remains zero.  nothing changes to evaluate) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 264 M
(//                                              Rprintf\("Starting at zero and staying at zero \\n"\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 246 M
(//                                              Rprintf\("lpp_full = %f\\n", lpp_full\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 237 M
(//                                              Rprintf\("lpp_red = %f\\n", lpp_red\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 228 M
(//                                              Rprintf\("log\(1-alpha_iter[t]\) = %f\\n", log\(1-alpha_iter[t]\)\);) s
/F-gs-font 8 8 SF
0 setgray
5 210 M
(                                                ph[0] = lpp_full - lpp_red + log\(1-alpha_iter[t]\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 192 M
(//                                              Rprintf\("ph[0] = %f\\n", ph[0]\);) s
/F-gs-font 8 8 SF
0 setgray
5 183 M
(                                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
235.4 183 M
(// to move from gamma=0 to gamma=1 need to make sure that partitio) s
5 174 M
(ns) s
/F-gs-font 8 8 SF
0 setgray
5 165 M
(                                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
235.4 165 M
(// remain compatible, if compatible .) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 147 M
(//                                              RprintIVecAsMat\("Si_iter", Si_iter, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
5 129 M
(                                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
235.4 129 M
(// to move from gamma=0 to gamma=1 need to add unit to rho_t.R) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 111 M
(//                                              Rprintf\("Starting at zero and moving to one \\n"\);) s
/F-gs-font 8 8 SF
0 setgray
5 93 M
(                                                nh_redtmp[Si_iter[j*ntime1 + t] - 1] = nh_red[Si_iter[j*ntime1+t]-) s
5 84 M
(1] + 1;) s
5 75 M
(                                                n_redtmp = n_red + 1;) s
5 66 M
(                                                nclus_redtmp=0;) s
5 57 M
(                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
235.4 57 M
(for) s
/F-gs-font 8 8 SF
0 setgray
249.8 57 M
(\(jj = 0; jj < *nsubject; jj++\){) s
5 48 M
(                                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
273.8 48 M
(if) s
/F-gs-font 8 8 SF
0 setgray
283.4 48 M
(\(nh_redtmp[jj] > 0\) nclus_redtmp = nclus_redtmp + 1;) s
5 39 M
(                                                }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 21 M
(//                                              RprintIVecAsMat\("nh_redtmp", nh_redtmp, 1, *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 12 M
(//                                              Rprintf\("n_redtmp = %d\\n", n_redtmp\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 3 M
(//                                              Rprintf\("nclus_redtmp = %d\\n", nclus_redtmp\);) s
_R
S
%%Page: (7) 7
%%BeginPageSetup
_S
18 36 translate
/pagenum 7 def
/fname (mcmcloop.dependentpartition.ar1.c) def
/fdir (.) def
/ftail (mcmcloop.dependentpartition.ar1.c) def
/Courier-Oblique 8 8 SUF
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
0.698039 0.133333 0.133333 setrgbcolor
/F-gs-font 8 8 SF
0 setgray
5 750 M
(                                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
235.4 750 M
(// To determine compatibility, I need to make sure that) s
/F-gs-font 8 8 SF
0 setgray
5 741 M
(                                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
235.4 741 M
(// comparison of the reduced partitios is being made with) s
/F-gs-font 8 8 SF
0 setgray
5 732 M
(                                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
235.4 732 M
(// correct cluster labeling.  I try to do this by identifying) s
/F-gs-font 8 8 SF
0 setgray
5 723 M
(                                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
235.4 723 M
(// the sets of units and sequentially assigning "cluster labels") s
/F-gs-font 8 8 SF
0 setgray
5 714 M
(                                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
235.4 714 M
(// starting with set that contains the first unit. I wonder if) s
/F-gs-font 8 8 SF
0 setgray
5 705 M
(                                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
235.4 705 M
(// there is a way to do this in C with out using loops?  Who) s
/F-gs-font 8 8 SF
0 setgray
5 696 M
(                                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
235.4 696 M
(// can I ask about this?) s
/F-gs-font 8 8 SF
0 setgray
5 678 M
(                                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
235.4 678 M
(// Get rho_t | gamma_t = 1 and rho_{t-1} | gamma_t = 1) s
/F-gs-font 8 8 SF
0 setgray
5 669 M
(                                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
235.4 669 M
(// when gamma_{it} = 1;) s
/F-gs-font 8 8 SF
0 setgray
5 660 M
(                                                Rindx1 = 0;) s
5 651 M
(                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
235.4 651 M
(for) s
/F-gs-font 8 8 SF
0 setgray
249.8 651 M
(\(jj = 0; jj < *nsubject; jj++\){) s
5 642 M
(                                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
273.8 642 M
(if) s
/F-gs-font 8 8 SF
0 setgray
283.4 642 M
(\(gamma_iter[jj*ntime1 + \(t\)] == 1\){) s
5 633 M
(                                                                comptm1[Rindx1] = Si_iter[jj*ntime1 + \(t-1\)];) s
5 624 M
(                                                                comp1t[Rindx1] = Si_iter[jj*ntime1 + \(t\)];) s
5 615 M
(                                                                Rindx1 = Rindx1 + 1;) s
5 606 M
(                                                        }) s
5 597 M
(                                                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
273.8 597 M
(// I need to include this because determine what happens w) s
5 588 M
(hen) s
/F-gs-font 8 8 SF
0 setgray
5 579 M
(                                                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
273.8 579 M
(// gamma goes from 0 to 1;) s
/F-gs-font 8 8 SF
0 setgray
5 570 M
(                                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
273.8 570 M
(if) s
/F-gs-font 8 8 SF
0 setgray
283.4 570 M
(\(jj == j\){) s
5 561 M
(                                                                comptm1[Rindx1] = Si_iter[jj*ntime1 + \(t-1\)];) s
5 552 M
(                                                                comp1t[Rindx1] = Si_iter[jj*ntime1 + \(t\)];) s
5 543 M
(                                                                Rindx1 = Rindx1 + 1;) s
5 534 M
(                                                        }) s
5 525 M
(                                                }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 507 M
(//                                              Rprintf\("Rindx1 = %d\\n", Rindx1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 498 M
(//                                              RprintIVecAsMat\("comptm1", comptm1, 1, *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 489 M
(//                                              RprintIVecAsMat\("comp1t", comp1t, 1, *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
5 471 M
(                                                rho_comp = compatibility\(comptm1, comp1t, Rindx1\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 453 M
(//                                              Rprintf\("rho_comp = %d\\n", rho_comp\);) s
/F-gs-font 8 8 SF
0 setgray
5 444 M
(                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
235.4 444 M
(if) s
/F-gs-font 8 8 SF
0 setgray
245 444 M
(\(rho_comp==1\){) s
5 426 M
(                                                        remove_zero\(nh_redtmp, *nsubject, nh_redtmp_no_zero\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 408 M
(//                                                      RprintIVecAsMat\("nh_redtmp_no_zero", nh_redtmp_no_zero, 1,) s
5 399 M
( *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
5 381 M
(                                                        lpp_red = partition_prob_crp\(nh_redtmp_no_zero, nclus_redt) s
5 372 M
(mp, Mdp, n_redtmp, 1\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 354 M
(//                                                      Rprintf\("lpp_full = %f\\n", lpp_full\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 345 M
(//                                                      Rprintf\("lpp_red = %f\\n", lpp_red\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 336 M
(//                                                      Rprintf\("log\(alpha_iter[t]\) = %f\\n", log\(alpha_iter[t]\)\);) s
/F-gs-font 8 8 SF
0 setgray
5 318 M
(                                                        ph[1] = lpp_full - lpp_red + log\(alpha_iter[t]\);) s
5 300 M
(                                                } ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
245 300 M
(else) s
/F-gs-font 8 8 SF
0 setgray
264.2 300 M
( {) s
5 282 M
(                                                        ph[1] = log\(0\); ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
350.6 282 M
(// partitions are not compatible) s
/F-gs-font 8 8 SF
0 setgray
5 264 M
(                                                }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 246 M
(//                                              Rprintf\("ph[0] = %f\\n", ph[0]\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 219 M
(//                                              RprintVecAsMat\("ph", ph, 1, 2\);) s
/F-gs-font 8 8 SF
0 setgray
5 183 M
(                                        }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 156 M
(//                                      RprintVecAsMat\("ph = ", ph, 1, 2\);) s
/F-gs-font 8 8 SF
0 setgray
5 138 M
(                                        maxph = ph[0]; ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
269 138 M
(if) s
/F-gs-font 8 8 SF
0 setgray
278.6 138 M
(\(maxph < ph[1]\) maxph=ph[1];) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 129 M
(//                                      Rprintf\("maxph = %f\\n", maxph\);) s
/F-gs-font 8 8 SF
0 setgray
5 111 M
(                                        ph[0] = exp\(ph[0] - maxph\); ph[1] = exp\(ph[1] - maxph\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 93 M
(//                                      RprintVecAsMat\("ph = ", ph, 1, 2\);) s
/F-gs-font 8 8 SF
0 setgray
5 75 M
(                                        probh[1] = ph[1]/\(ph[0] + ph[1]\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 57 M
(//                                      RprintVecAsMat\("probh = ", probh, 1, 2\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 39 M
(//                                      Rprintf\("probh[1] = %f\\n", probh[1]\);) s
/F-gs-font 8 8 SF
0 setgray
5 21 M
(                                        gt = rbinom\(1,probh[1]\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 3 M
(//                                      Rprintf\("gt = %d\\n", gt\);) s
_R
S
%%Page: (8) 8
%%BeginPageSetup
_S
18 36 translate
/pagenum 8 def
/fname (mcmcloop.dependentpartition.ar1.c) def
/fdir (.) def
/ftail (mcmcloop.dependentpartition.ar1.c) def
/Courier-Oblique 8 8 SUF
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
0.698039 0.133333 0.133333 setrgbcolor
/F-gs-font 8 8 SF
0 setgray
5 750 M
(                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
197 750 M
(if) s
/F-gs-font 8 8 SF
0 setgray
206.6 750 M
(\(gt != gamma_iter[j*\(ntime1\) + t]\){) s
5 732 M
(                                                gamma_iter[j*\(ntime1\) + t] = gt;) s
5 723 M
(                                                n_red = n_redtmp;) s
5 714 M
(                                                nclus_red = nclus_redtmp;) s
5 705 M
(                                                nh_red[Si_iter[j*\(ntime1\)+t]-1] = nh_redtmp[Si_iter[j*\(ntime1\)+t]-) s
5 696 M
(1];) s
5 678 M
(                                        } ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
206.6 678 M
(else) s
/F-gs-font 8 8 SF
0 setgray
225.8 678 M
( {) s
5 660 M
(                                                nh_redtmp[Si_iter[j*\(ntime1\)+t]-1] = nh_red[Si_iter[j*\(ntime1\)+t]-) s
5 651 M
(1];) s
5 642 M
(                                                nclus_redtmp = nclus_red;) s
5 633 M
(                                                n_redtmp = n_red;) s
5 624 M
(                                        }) s
5 606 M
(                                }) s
5 588 M
(                                remove_zero\(nh_red, *nsubject, nh_red_no_zero\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 561 M
(//                              Rprintf\("gamma_iter[j*\(ntime1\) + t] = %d\\n", gamma_iter[j*\(ntime1\) + t]\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 552 M
(//                              Rprintf\("nclus_red = %d\\n", nclus_red\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 543 M
(//                              Rprintf\("n_red = %d\\n", n_red\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 534 M
(//                              RprintIVecAsMat\("nh_red = ", nh_red, 1, *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 525 M
(//                              RprintIVecAsMat\("gamma_iter", gamma_iter, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 516 M
(//                              RprintIVecAsMat\("Si_iter", Si_iter, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
5 498 M
(                        }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 471 M
(//                      RprintIVecAsMat\("Si_iter", Si_iter, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 462 M
(//                      RprintIVecAsMat\("gamma_iter", gamma_iter, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 435 M
(//                      Rprintf\("Begin updating partition for time %d\\n", t+1\);) s
/F-gs-font 8 8 SF
0 setgray
5 408 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 408 M
(//////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 399 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 399 M
(//) s
/F-gs-font 8 8 SF
0 setgray
5 390 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 390 M
(// update partition) s
/F-gs-font 8 8 SF
0 setgray
5 381 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 381 M
(//) s
/F-gs-font 8 8 SF
0 setgray
5 372 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 372 M
(//////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 363 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 363 M
(// The cluster probabilities depend on four partition probabilities) s
/F-gs-font 8 8 SF
0 setgray
5 354 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 354 M
(//) s
/F-gs-font 8 8 SF
0 setgray
5 345 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 345 M
(// rho_t) s
/F-gs-font 8 8 SF
0 setgray
5 336 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 336 M
(// rho_t.R) s
/F-gs-font 8 8 SF
0 setgray
5 327 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 327 M
(// rho_t+1) s
/F-gs-font 8 8 SF
0 setgray
5 318 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 318 M
(// rho_t+1.R) s
/F-gs-font 8 8 SF
0 setgray
5 309 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 309 M
(//) s
/F-gs-font 8 8 SF
0 setgray
5 300 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 300 M
(// I have switched a number of times on which of these needs to be computed) s
/F-gs-font 8 8 SF
0 setgray
5 291 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 291 M
(// and which one can be absorbed in the normalizing constant.  Right now I am) s
/F-gs-font 8 8 SF
0 setgray
5 282 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 282 M
(// leaning towards Pr\(rho_t+1\) and Pr\(rho_t+1.R\) can be absorbed.  But I need) s
/F-gs-font 8 8 SF
0 setgray
5 273 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 273 M
(// to use rho_t.R and rho_t+1.R to check compatibility as I update rho_t.) s
/F-gs-font 8 8 SF
0 setgray
5 264 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 264 M
(//) s
/F-gs-font 8 8 SF
0 setgray
5 255 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 255 M
(//////////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 237 M
(                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
120.2 237 M
(for) s
/F-gs-font 8 8 SF
0 setgray
134.6 237 M
(\(jj = 0; jj < *nsubject; jj++\){) s
5 219 M
(                                rho_tmp[jj] = Si_iter[jj*\(ntime1\) + t];) s
5 201 M
(                        }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 183 M
(//                      RprintIVecAsMat\("rho_tmp", rho_tmp, 1, *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
5 165 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 165 M
(// It seems to me that I can use some of the structure used to carry) s
/F-gs-font 8 8 SF
0 setgray
5 156 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 156 M
(// out Algorithm 8 from previous code to keep track of empty clusters) s
/F-gs-font 8 8 SF
0 setgray
5 147 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 147 M
(// etc.) s
/F-gs-font 8 8 SF
0 setgray
5 138 M
(                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
120.2 138 M
(for) s
/F-gs-font 8 8 SF
0 setgray
134.6 138 M
(\(j = 0; j < *nsubject; j++\){) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 129 M
(//                              Rprintf\("t ======= %d\\n", t\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 120 M
(//                              Rprintf\("j ======= %d\\n", j\);) s
/F-gs-font 8 8 SF
0 setgray
5 102 M
(                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
158.6 102 M
(// Only need to update partition relative to units that are not pegged) s
/F-gs-font 8 8 SF
0 setgray
5 93 M
(                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
158.6 93 M
(if) s
/F-gs-font 8 8 SF
0 setgray
168.2 93 M
(\(gamma_iter[j*\(ntime1\) + t] == 0\){) s
5 75 M
(                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
197 75 M
(if) s
/F-gs-font 8 8 SF
0 setgray
206.6 75 M
(\(nh[\(Si_iter[j*\(ntime1\) + t]-1\)*\(ntime1\) + t] > 1\){) s
5 57 M
(                                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
235.4 57 M
(// Observation belongs to a non-singleton ...) s
/F-gs-font 8 8 SF
0 setgray
5 48 M
(                                                nh[\(Si_iter[j*\(ntime1\) + t]-1\)*\(ntime1\) + t] = nh[\(Si_iter[j*\(ntim) s
5 39 M
(e1\) + t]-1\)*\(ntime1\) + t] - 1;) s
5 21 M
(                                        }) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
201.8 21 M
(else) s
/F-gs-font 8 8 SF
0 setgray
221 21 M
({) s
5 3 M
(                                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
235.4 3 M
(// Observation is a member of a singleton cluster ...) s
_R
S
%%Page: (9) 9
%%BeginPageSetup
_S
18 36 translate
/pagenum 9 def
/fname (mcmcloop.dependentpartition.ar1.c) def
/fdir (.) def
/ftail (mcmcloop.dependentpartition.ar1.c) def
/Courier-Oblique 8 8 SUF
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
0.698039 0.133333 0.133333 setrgbcolor
/F-gs-font 8 8 SF
0 setgray
5 750 M
(                                                iaux = Si_iter[j*\(ntime1\) + t];) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 741 M
(//                                              Rprintf\("iaux = %d\\n", iaux\);) s
/F-gs-font 8 8 SF
0 setgray
5 732 M
(                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
235.4 732 M
(if) s
/F-gs-font 8 8 SF
0 setgray
245 732 M
(\(iaux < nclus_iter[t]\){) s
5 714 M
(                                                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
273.8 714 M
(// Need to relabel clusters. I will do this by swapping cl) s
5 705 M
(uster labels) s
/F-gs-font 8 8 SF
0 setgray
5 696 M
(                                                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
273.8 696 M
(// Si_iter[j] and nclus_iter along with cluster specific p) s
5 687 M
(arameters;) s
/F-gs-font 8 8 SF
0 setgray
5 660 M
(                                                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
273.8 660 M
(// All members of last cluster will be assigned subject j') s
5 651 M
(s label) s
/F-gs-font 8 8 SF
0 setgray
5 642 M
(                                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
273.8 642 M
(for) s
/F-gs-font 8 8 SF
0 setgray
288.2 642 M
(\(jj = 0; jj < *nsubject; jj++\){) s
5 624 M
(                                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
312.2 624 M
(if) s
/F-gs-font 8 8 SF
0 setgray
321.8 624 M
(\(Si_iter[jj*\(ntime1\) + t] == nclus_iter[t]\){) s
5 606 M
(                                                                        Si_iter[jj*\(ntime1\) + t] = iaux;) s
5 588 M
(                                                                }) s
5 570 M
(                                                        }) s
5 543 M
(                                                        Si_iter[j*\(ntime1\) + t] = nclus_iter[t];) s
5 525 M
(                                                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
273.8 525 M
(// The following steps swaps order of cluster specific par) s
5 516 M
(ameters) s
/F-gs-font 8 8 SF
0 setgray
5 507 M
(                                                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
273.8 507 M
(// so that the newly labeled subjects from previous step r) s
5 498 M
(etain) s
/F-gs-font 8 8 SF
0 setgray
5 489 M
(                                                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
273.8 489 M
(// their correct cluster specific parameters) s
/F-gs-font 8 8 SF
0 setgray
5 480 M
(                                                        auxs = sig2h[\(iaux-1\)*ntime1 + t];) s
5 471 M
(                                                        sig2h[\(iaux-1\)*ntime1 + t] = sig2h[\(nclus_iter[t]-1\)*\(ntim) s
5 462 M
(e1\)+t];) s
5 453 M
(                                                        sig2h[\(nclus_iter[t]-1\)*\(ntime1\)+t] = auxs;) s
5 435 M
(                                                        auxm = muh[\(iaux-1\)*ntime1 + t];) s
5 426 M
(                                                        muh[\(iaux-1\)*ntime1 + t] = muh[\(nclus_iter[t]-1\)*\(ntime1\)+) s
5 417 M
(t];) s
5 408 M
(                                                        muh[\(nclus_iter[t]-1\)*\(ntime1\)+t] = auxm;) s
5 381 M
(                                                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
273.8 381 M
(// the number of members in cluster is also swapped with t) s
5 372 M
(he last) s
/F-gs-font 8 8 SF
0 setgray
5 363 M
(                                                        nh[\(iaux-1\)*\(ntime1\)+t] = nh[\(nclus_iter[t]-1\)*\(ntime1\)+t]) s
5 354 M
(;) s
5 345 M
(                                                        nh[\(nclus_iter[t]-1\)*\(ntime1\)+t] = 1;) s
5 327 M
(                                                }) s
5 300 M
(                                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
235.4 300 M
(// Now remove the ith obs and last cluster;) s
/F-gs-font 8 8 SF
0 setgray
5 291 M
(                                                nh[\(nclus_iter[t]-1\)*\(ntime1\)+t] = nh[\(nclus_iter[t]-1\)*\(ntime1\)+t) s
5 282 M
(] - 1;) s
5 273 M
(                                                nclus_iter[t] = nclus_iter[t] - 1;) s
5 246 M
(                                        }) s
5 228 M
(                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
197 228 M
(for) s
/F-gs-font 8 8 SF
0 setgray
211.4 228 M
(\(jj = 0; jj < *nsubject; jj++\){) s
5 210 M
(                                                rho_tmp[jj] = Si_iter[jj*\(ntime1\) + t];) s
5 192 M
(                                        }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 174 M
(//                                      RprintIVecAsMat\("Si_iter", Si_iter, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 165 M
(//                                      RprintIVecAsMat\("nh ", nh,  *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 156 M
(//                                      RprintIVecAsMat\("rho_tmp", rho_tmp, 1, *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 138 M
(//                                      Rprintf\("nclus_iter[t] = %d\\n", nclus_iter[t]\);) s
/F-gs-font 8 8 SF
0 setgray
5 102 M
(                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
197 102 M
(for) s
/F-gs-font 8 8 SF
0 setgray
211.4 102 M
(\(k = 0; k < nclus_iter[t]; k++\){) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 93 M
(//                                              Rprintf\("k === %d\\n\\n", k\);) s
/F-gs-font 8 8 SF
0 setgray
5 75 M
(                                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
235.4 75 M
(// Beginning of spatial part) s
/F-gs-font 8 8 SF
0 setgray
5 66 M
(                                                lCo = lCn = 0.0;) s
5 57 M
(                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
235.4 57 M
(if) s
/F-gs-font 8 8 SF
0 setgray
245 57 M
(\(*sPPM==1\){) s
5 48 M
(                                                        indx = 0;) s
5 39 M
(                                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
273.8 39 M
(for) s
/F-gs-font 8 8 SF
0 setgray
288.2 39 M
(\(jj = 0; jj < *nsubject; jj++\){) s
5 21 M
(                                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
312.2 21 M
(if) s
/F-gs-font 8 8 SF
0 setgray
321.8 21 M
(\(Si_iter[jj*\(ntime1\) + t] == k+1 & j != jj\){) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 3 M
(//                                                                      Rprintf\("indx = %d\\n", indx\);) s
_R
S
%%Page: (10) 10
%%BeginPageSetup
_S
18 36 translate
/pagenum 10 def
/fname (mcmcloop.dependentpartition.ar1.c) def
/fdir (.) def
/ftail (mcmcloop.dependentpartition.ar1.c) def
/Courier-Oblique 8 8 SUF
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
0.698039 0.133333 0.133333 setrgbcolor
/F-gs-font 8 8 SF
0 setgray
5 750 M
(                                                                        s1o[indx] = s1[jj];) s
5 741 M
(                                                                        s2o[indx] = s2[jj];) s
5 723 M
(                                                                        s1n[indx] = s1[jj];) s
5 714 M
(                                                                        s2n[indx] = s2[jj];) s
5 696 M
(                                                                        indx = indx+1;) s
5 687 M
(                                                                }) s
5 678 M
(                                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
312.2 678 M
(if) s
/F-gs-font 8 8 SF
0 setgray
321.8 678 M
(\(j == jj\){) s
5 669 M
(                                                                        s1n[nh[k*\(ntime1\) + t]] = s1[jj];) s
5 660 M
(                                                                        s2n[nh[k*\(ntime1\) + t]] = s2[jj];) s
5 642 M
(                                                                }) s
5 615 M
(                                                        }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 606 M
(//                                                      RprintVecAsMat\("s1o", s1o, 1, nh[k*\(ntime1\) + t]\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 597 M
(//                                                      RprintVecAsMat\("s2o", s2o, 1, nh[k*\(ntime1\) + t]\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 588 M
(//                                                      RprintVecAsMat\("s1n", s1n, 1, nh[k*\(ntime1\) + t]+1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 579 M
(//                                                      RprintVecAsMat\("s2n", s2n, 1, nh[k*\(ntime1\) + t]+1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 570 M
(//                                                      Rprintf\("Cohesion = %d\\n", *SpatialCohesion\);) s
/F-gs-font 8 8 SF
0 setgray
5 552 M
(                                                        lCo = Cohesion3_4\(s1o, s2o, mu0, k0, v0, L0, nh[k*\(ntime1\)) s
5 543 M
( + t], *SpatialCohesion, 1\);) s
5 534 M
(                                                        lCn = Cohesion3_4\(s1n, s2n, mu0, k0, v0, L0, nh[k*\(ntime1\)) s
5 525 M
( + t]+1,*SpatialCohesion, 1\);) s
5 516 M
(                                                }) s
5 507 M
(                                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
235.4 507 M
(// End of spatial part) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 489 M
(//                                              Rprintf\("lCo = %f\\n", lCo\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 480 M
(//                                              Rprintf\("lCn = %f\\n", lCn\);) s
/F-gs-font 8 8 SF
0 setgray
5 471 M
(                                                rho_tmp[j] = k+1;) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 453 M
(//                                              RprintIVecAsMat\("rho_tmp", rho_tmp, 1, *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 444 M
(//                                              RprintIVecAsMat\("gamma_iter", gamma_iter, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 435 M
(//                                              RprintIVecAsMat\("Si_iter", Si_iter, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
5 408 M
(                                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
235.4 408 M
(// First need to check compatability) s
/F-gs-font 8 8 SF
0 setgray
5 399 M
(                                                Rindx2=0;) s
5 390 M
(                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
235.4 390 M
(for) s
/F-gs-font 8 8 SF
0 setgray
249.8 390 M
(\(jj = 0; jj < *nsubject; jj++\){) s
5 381 M
(                                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
273.8 381 M
(if) s
/F-gs-font 8 8 SF
0 setgray
283.4 381 M
(\(gamma_iter[jj*ntime1 + \(t+1\)] == 1\){) s
5 372 M
(                                                                comp2t[Rindx2] = rho_tmp[jj];) s
5 363 M
(                                                                comptp1[Rindx2] = Si_iter[jj*ntime1 + \(t+1\)];) s
5 354 M
(                                                                Rindx2 = Rindx2 + 1;) s
5 345 M
(                                                        }) s
5 336 M
(                                                }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 309 M
(//                                              Rprintf\("Rindx2 = %d\\n", Rindx2\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 300 M
(//                                              RprintIVecAsMat\("comp2t", comp2t, 1, *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 291 M
(//                                              RprintIVecAsMat\("comptp1", comptp1, 1, *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
5 273 M
(                                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
235.4 273 M
(// check for compatibility) s
/F-gs-font 8 8 SF
0 setgray
5 264 M
(                                                rho_comp = compatibility\(comp2t, comptp1, Rindx2\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 246 M
(//                                              Rprintf\("rho_comp = %d\\n", rho_comp\);) s
/F-gs-font 8 8 SF
0 setgray
5 219 M
(                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
235.4 219 M
(if) s
/F-gs-font 8 8 SF
0 setgray
245 219 M
(\(rho_comp != 1\){) s
5 201 M
(                                                        ph[k] = log\(0\); ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
350.6 201 M
(// Not compatible) s
/F-gs-font 8 8 SF
0 setgray
5 183 M
(                                                } ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
245 183 M
(else) s
/F-gs-font 8 8 SF
0 setgray
264.2 183 M
( {) s
5 174 M
(                                                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
273.8 174 M
(// Need to compute Pr\(rhot\), Pr\(rhot.R\), Pr\(rhot+1\), Pr\(rh) s
5 165 M
(ot+1.R\)) s
/F-gs-font 8 8 SF
0 setgray
5 147 M
(                                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
273.8 147 M
(for) s
/F-gs-font 8 8 SF
0 setgray
288.2 147 M
(\(jj = 0; jj < *nsubject; jj++\){) s
5 138 M
(                                                                nh_tmp[jj] = 0;) s
5 129 M
(                                                                nh_redtmp[jj] = 0;) s
5 120 M
(                                                                nh_tmp_1[jj] = 0;) s
5 111 M
(                                                                nh_redtmp_1[jj] = 0;) s
5 102 M
(                                                        }) s
5 93 M
(                                                        n_tmp = 0;) s
5 84 M
(                                                        n_redtmp = 0;) s
5 75 M
(                                                        n_tmp_1 = 0;) s
5 66 M
(                                                        n_redtmp_1 = 0;) s
5 48 M
(                                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
273.8 48 M
(for) s
/F-gs-font 8 8 SF
0 setgray
288.2 48 M
(\(jj = 0; jj < *nsubject; jj++\){) s
5 39 M
(                                                                nh_tmp[rho_tmp[jj]-1] = nh_tmp[rho_tmp[jj]-1]+1;) s
5 30 M
(                                                                n_tmp=n_tmp+1;) s
5 21 M
(                                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
312.2 21 M
(if) s
/F-gs-font 8 8 SF
0 setgray
321.8 21 M
(\(gamma_iter[jj*ntime1 + t] == 1\){) s
5 12 M
(                                                                        nh_redtmp[rho_tmp[jj]-1] = nh_redtmp[rho_t) s
5 3 M
(mp[jj]-1]+1;) s
_R
S
%%Page: (11) 11
%%BeginPageSetup
_S
18 36 translate
/pagenum 11 def
/fname (mcmcloop.dependentpartition.ar1.c) def
/fdir (.) def
/ftail (mcmcloop.dependentpartition.ar1.c) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 759 M
(                                                                        n_redtmp = n_redtmp+1;) s
5 750 M
(                                                                }) s
5 732 M
(                                                                nh_tmp_1[Si_iter[jj*ntime1 + \(t+1\)]-1] = nh_tmp_1[) s
5 723 M
(Si_iter[jj*ntime1 + \(t+1\)]-1]+1;) s
5 714 M
(                                                                n_tmp_1=n_tmp_1+1;) s
5 705 M
(                                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
312.2 705 M
(if) s
/F-gs-font 8 8 SF
0 setgray
321.8 705 M
(\(gamma_iter[jj*ntime1 + t+1] == 1\){) s
5 696 M
(                                                                        nh_redtmp_1[Si_iter[jj*ntime1 + \(t+1\)]-1] ) s
5 687 M
(= nh_redtmp_1[Si_iter[jj*ntime1 + \(t+1\)]-1]+1;) s
5 678 M
(                                                                        n_redtmp_1 = n_redtmp_1+1;) s
5 669 M
(                                                                }) s
5 651 M
(                                                        }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 633 M
(//                                                      RprintIVecAsMat\("nh_tmp", nh_tmp, 1, *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 624 M
(//                                                      RprintIVecAsMat\("nh_redtmp", nh_redtmp, 1, *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 606 M
(//                                                      Rprintf\("nsubject = %d\\n", *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 597 M
(//                                                      Rprintf\("n_redtmp = %d\\n", n_redtmp\);) s
/F-gs-font 8 8 SF
0 setgray
5 579 M
(                                                        remove_zero\(nh_tmp, *nsubject, nh_tmp_no_zero\);) s
5 570 M
(                                                        remove_zero\(nh_redtmp, *nsubject, nh_redtmp_no_zero\);) s
5 552 M
(                                                        remove_zero\(nh_tmp_1, *nsubject, nh_tmp_no_zero_1\);) s
5 543 M
(                                                        remove_zero\(nh_redtmp_1, *nsubject, nh_redtmp_no_zero_1\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 525 M
(//                                                      RprintIVecAsMat\("nh_tmp_no_zero",nh_tmp_no_zero, 1, *nsubj) s
5 516 M
(ect\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 507 M
(//                                                      RprintIVecAsMat\("nh_redtmp_no_zero", nh_redtmp_no_zero, 1,) s
5 498 M
( *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
5 480 M
(                                                        nclus_redtmp=0;) s
5 471 M
(                                                        nclus_tmp=0;) s
5 462 M
(                                                        nclus_redtmp_1=0;) s
5 453 M
(                                                        nclus_tmp_1=0;) s
5 444 M
(                                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
273.8 444 M
(for) s
/F-gs-font 8 8 SF
0 setgray
288.2 444 M
(\(jj = 0; jj < *nsubject; jj++\){) s
5 435 M
(                                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
312.2 435 M
(if) s
/F-gs-font 8 8 SF
0 setgray
321.8 435 M
(\(nh_redtmp[jj] > 0\) nclus_redtmp = nclus_redtmp ) s
5 426 M
(+ 1;) s
5 417 M
(                                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
312.2 417 M
(if) s
/F-gs-font 8 8 SF
0 setgray
321.8 417 M
(\(nh_tmp[jj] > 0\) nclus_tmp = nclus_tmp + 1;) s
5 408 M
(                                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
312.2 408 M
(if) s
/F-gs-font 8 8 SF
0 setgray
321.8 408 M
(\(nh_redtmp_1[jj] > 0\) nclus_redtmp_1 = nclus_red) s
5 399 M
(tmp_1 + 1;) s
5 390 M
(                                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
312.2 390 M
(if) s
/F-gs-font 8 8 SF
0 setgray
321.8 390 M
(\(nh_tmp_1[jj] > 0\) nclus_tmp_1 = nclus_tmp_1 + 1) s
5 381 M
(;) s
5 363 M
(                                                        }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 345 M
(//                                                      Rprintf\("nclus_tmp = %d\\n", nclus_tmp\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 336 M
(//                                                      Rprintf\("nclus_redtmp = %d\\n", nclus_redtmp\);) s
/F-gs-font 8 8 SF
0 setgray
5 318 M
(                                                        lpp_full = partition_prob_crp\(nh_tmp_no_zero, nclus_tmp, M) s
5 309 M
(dp, *nsubject, 1\);) s
5 300 M
(                                                        lpp_red = partition_prob_crp\(nh_redtmp_no_zero, nclus_redt) s
5 291 M
(mp, Mdp, n_redtmp, 1\);) s
5 264 M
(                                                        lpp_full_1 = partition_prob_crp\(nh_tmp_no_zero_1, nclus_tm) s
5 255 M
(p_1, Mdp, *nsubject, 1\);) s
5 246 M
(                                                        lpp_red_1 = partition_prob_crp\(nh_redtmp_no_zero_1, nclus_) s
5 237 M
(redtmp_1, Mdp, n_redtmp_1, 1\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 210 M
(//                                                      Rprintf\("lpp_full = %f\\n", lpp_full\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 201 M
(//                                                      Rprintf\("lpp_red = %f\\n", lpp_red\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 183 M
(//                                                      Rprintf\("lpp_full_1 = %f\\n", lpp_full_1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 174 M
(//                                                      Rprintf\("lpp_red_1 = %f\\n", lpp_red_1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 147 M
(//                                                      Rprintf\("lpp_full = %f\\n", lpp_full\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 138 M
(//                                                      Rprintf\("lpp_red = %f\\n", lpp_red\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 111 M
(//                                                      Rprintf\("muh[k*\(ntime1\) + t] = %f\\n", muh[k*\(ntime1\) + t]\)) s
5 102 M
(;) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 93 M
(//                                                      Rprintf\("sigh[k*\(ntime1\) + t] = %f\\n", sqrt\(sig2h[k*\(ntime) s
5 84 M
(1\) + t]\)\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 75 M
(//                                                      Rprintf\("y[j*\(*ntime\) + t] = %f\\n", y[j*\(*ntime\) + t]\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 66 M
(//                                                      Rprintf\("nh[k] = %d\\n", nh_tmp[k]\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 57 M
(//                                                      Rprintf\("dnorm\(y[j*\(*ntime\) + t], muh[k*\(ntime1\) + t], sqr) s
5 48 M
(t\(sig2h[k*\(ntime1\) + t]\), 1\) = %f\\n", dnorm\(y[j*\(*ntime\) + t], muh[k*\(ntime1\) + t], sqrt\(sig2h[k*\(ntime1\) + t]\), 1) s
5 39 M
(\)\);) s
/F-gs-font 8 8 SF
0 setgray
5 21 M
(                                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
273.8 21 M
(if) s
/F-gs-font 8 8 SF
0 setgray
283.4 21 M
(\(t==0\){) s
5 3 M
(                                                                ph[k] = dnorm\(y[j*\(*ntime\) + t],) s
_R
S
%%Page: (12) 12
%%BeginPageSetup
_S
18 36 translate
/pagenum 12 def
/fname (mcmcloop.dependentpartition.ar1.c) def
/fdir (.) def
/ftail (mcmcloop.dependentpartition.ar1.c) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 759 M
(                                                                               muh[k*\(ntime1\) + t],) s
5 750 M
(                                                                               sqrt\(sig2h[k*\(ntime1\) + t]\), 1\) +) s
5 741 M
(                                                                        lpp_full - lpp_red +) s
5 732 M
(                                                                        lpp_full_1 - lpp_red_1 +) s
5 723 M
(                                                                        lCn - lCo; ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
403.4 723 M
(// Spatial part of cohesion fun) s
5 714 M
(ction;) s
/F-gs-font 8 8 SF
0 setgray
5 705 M
(                                                        }) s
5 696 M
(                                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
273.8 696 M
(if) s
/F-gs-font 8 8 SF
0 setgray
283.4 696 M
(\(t > 0\){) s
5 687 M
(                                                                ph[k] = dnorm\(y[j*\(*ntime\) + t],) s
5 678 M
(                                                                                muh[k*\(ntime1\) + t] +) s
5 669 M
(                                                                                        eta1_iter[j]*y[j*\(*ntime\) ) s
5 660 M
(+ t-1],) s
5 651 M
(                                                                                sqrt\(sig2h[k*\(ntime1\) + t]*) s
5 642 M
(                                                                                        \(1-eta1_iter[j]*eta1_iter[) s
5 633 M
(j]\)\), 1\) +) s
5 624 M
(                                                                        lpp_full - lpp_red +) s
5 615 M
(                                                                        lpp_full_1 - lpp_red_1 +) s
5 606 M
(                                                                        lCn - lCo; ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
403.4 606 M
(// Spatial part of cohesion fun) s
5 597 M
(ction;) s
/F-gs-font 8 8 SF
0 setgray
5 588 M
(                                                        }) s
5 570 M
(                                                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
273.8 570 M
(// use this to test if MCMC draws from prior are correct) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 561 M
(//                                                      ph[k] =  lpp_full - lpp_red + lpp_full_1 - lpp_red_1;) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 534 M
(//                                                      Rprintf\("ph[k] = %f\\n", ph[k]\);) s
/F-gs-font 8 8 SF
0 setgray
5 516 M
(                                                }) s
5 498 M
(                                        }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 480 M
(//                                      RprintVecAsMat\("ph = ", ph, 1, nclus_iter[t] \);) s
/F-gs-font 8 8 SF
0 setgray
5 453 M
(                                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
197 453 M
(// Determine if E.U. gets allocated to a new cluster) s
/F-gs-font 8 8 SF
0 setgray
5 444 M
(                                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
197 444 M
(// Need to check compatibility first) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 426 M
(//                                      Rprintf\("nclus_iter[t] = %d\\n", nclus_iter[k]\);) s
/F-gs-font 8 8 SF
0 setgray
5 408 M
(                                        rho_tmp[j] = nclus_iter[t]+1;) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 390 M
(//                                      RprintIVecAsMat\("rho_tmp", rho_tmp, 1, *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 381 M
(//                                      RprintIVecAsMat\("gamma_iter", gamma_iter, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
5 363 M
(                                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
197 363 M
(// First need to check compatability) s
/F-gs-font 8 8 SF
0 setgray
5 354 M
(                                        Rindx1 = 0, Rindx2=0;) s
5 345 M
(                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
197 345 M
(for) s
/F-gs-font 8 8 SF
0 setgray
211.4 345 M
(\(jj = 0; jj < *nsubject; jj++\){) s
5 336 M
(                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
235.4 336 M
(if) s
/F-gs-font 8 8 SF
0 setgray
245 336 M
(\(gamma_iter[jj*ntime1 + \(t+1\)] == 1\){) s
5 327 M
(                                                        comp2t[Rindx2] = rho_tmp[jj];) s
5 318 M
(                                                        comptp1[Rindx2] = Si_iter[jj*ntime1 + \(t+1\)];) s
5 309 M
(                                                        Rindx2 = Rindx2 + 1;) s
5 300 M
(                                                }) s
5 291 M
(                                        }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 273 M
(//                                      Rprintf\("Rindx2 = %d\\n", Rindx2\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 264 M
(//                                      RprintIVecAsMat\("comp2t", comp2t, 1, *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 255 M
(//                                      RprintIVecAsMat\("comptp1", comptp1, 1, *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
5 228 M
(                                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
197 228 M
(// check for compatibility) s
/F-gs-font 8 8 SF
0 setgray
5 219 M
(                                        rho_comp = compatibility\(comp2t, comptp1, Rindx2\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 192 M
(//                                      Rprintf\("rho_comp = %d\\n", rho_comp\);) s
/F-gs-font 8 8 SF
0 setgray
5 174 M
(                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
197 174 M
(if) s
/F-gs-font 8 8 SF
0 setgray
206.6 174 M
(\(rho_comp != 1\){) s
5 165 M
(                                                ph[nclus_iter[t]] = log\(0\); ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
369.8 165 M
(// going to own cluster is not compati) s
5 156 M
(ble;) s
/F-gs-font 8 8 SF
0 setgray
5 147 M
(                                        } ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
206.6 147 M
(else) s
/F-gs-font 8 8 SF
0 setgray
225.8 147 M
( {) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 129 M
(//                                              RprintIVecAsMat\("nh ", nh,  *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 111 M
(//                                              Rprintf\("mu_iter[t] = %f\\n", theta_iter[t]\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 102 M
(//                                              Rprintf\("sqrt\(tau2_iter[t]\) = %f\\n", sqrt\(tau2_iter[t]\)\);) s
/F-gs-font 8 8 SF
0 setgray
5 84 M
(                                                mudraw = rnorm\(theta_iter[t], sqrt\(tau2_iter[t]\)\);) s
5 75 M
(                                                sigdraw = runif\(0, A\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 57 M
(//                                              Rprintf\("mudraw = %f\\n", mudraw\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 48 M
(//                                              Rprintf\("sigdraw = %f\\n", sigdraw\);) s
/F-gs-font 8 8 SF
0 setgray
5 39 M
( ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
9.8 39 M
(//                             Rprintf\("y[j*\(*ntime\) + t] = %f\\n", y[j*\(*ntime\) + t]\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 21 M
(//                                              RprintIVecAsMat\("nh_tmp", nh_tmp, 1, nclus_iter[t]\);) s
/F-gs-font 8 8 SF
0 setgray
_R
S
%%Page: (13) 13
%%BeginPageSetup
_S
18 36 translate
/pagenum 13 def
/fname (mcmcloop.dependentpartition.ar1.c) def
/fdir (.) def
/ftail (mcmcloop.dependentpartition.ar1.c) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 759 M
(                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
235.4 759 M
(for) s
/F-gs-font 8 8 SF
0 setgray
249.8 759 M
(\(jj = 0; jj < *nsubject; jj++\){) s
5 750 M
(                                                        nh_tmp[jj] = 0;) s
5 741 M
(                                                        nh_redtmp[jj] = 0;) s
5 732 M
(                                                        nh_tmp_1[jj] = 0;) s
5 723 M
(                                                        nh_redtmp_1[jj] = 0;) s
5 714 M
(                                                }) s
5 705 M
(                                                n_tmp = 0;) s
5 696 M
(                                                n_redtmp = 0;) s
5 687 M
(                                                n_tmp_1 = 0;) s
5 678 M
(                                                n_redtmp_1 = 0;) s
5 660 M
(                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
235.4 660 M
(for) s
/F-gs-font 8 8 SF
0 setgray
249.8 660 M
(\(jj = 0; jj < *nsubject; jj++\){) s
5 651 M
(                                                        nh_tmp[rho_tmp[jj]-1] = nh_tmp[rho_tmp[jj]-1]+1;) s
5 642 M
(                                                        n_tmp=n_tmp+1;) s
5 633 M
(                                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
273.8 633 M
(if) s
/F-gs-font 8 8 SF
0 setgray
283.4 633 M
(\(gamma_iter[jj*ntime1 + t] == 1\){) s
5 624 M
(                                                                nh_redtmp[rho_tmp[jj]-1] = nh_redtmp[rho_tmp[jj]-1) s
5 615 M
(]+1;) s
5 606 M
(                                                                n_redtmp = n_redtmp+1;) s
5 597 M
(                                                        }) s
5 579 M
(                                                        nh_tmp_1[Si_iter[jj*ntime1 + \(t+1\)]-1] = nh_tmp_1[Si_iter[) s
5 570 M
(jj*ntime1 + \(t+1\)]-1]+1;) s
5 561 M
(                                                        n_tmp_1=n_tmp_1+1;) s
5 552 M
(                                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
273.8 552 M
(if) s
/F-gs-font 8 8 SF
0 setgray
283.4 552 M
(\(gamma_iter[jj*ntime1 + t+1] == 1\){) s
5 543 M
(                                                                nh_redtmp_1[Si_iter[jj*ntime1 + \(t+1\)]-1] = nh_red) s
5 534 M
(tmp_1[Si_iter[jj*ntime1 + \(t+1\)]-1]+1;) s
5 525 M
(                                                                n_redtmp_1 = n_redtmp_1+1;) s
5 516 M
(                                                        }) s
5 498 M
(                                                }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 480 M
(//                                              RprintIVecAsMat\("nh_tmp", nh_tmp, 1, *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 471 M
(//                                              RprintIVecAsMat\("nh_redtmp", nh_redtmp, 1, *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
5 453 M
(                                                remove_zero\(nh_tmp, *nsubject, nh_tmp_no_zero\);) s
5 444 M
(                                                remove_zero\(nh_redtmp, *nsubject, nh_redtmp_no_zero\);) s
5 426 M
(                                                remove_zero\(nh_tmp_1, *nsubject, nh_tmp_no_zero_1\);) s
5 417 M
(                                                remove_zero\(nh_redtmp_1, *nsubject, nh_redtmp_no_zero_1\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 399 M
(//                                              RprintIVecAsMat\("nh_tmp_no_zero",nh_tmp_no_zero, 1, *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 390 M
(//                                              RprintIVecAsMat\("nh_redtmp_no_zero", nh_redtmp_no_zero, 1, *nsubje) s
5 381 M
(ct\);) s
/F-gs-font 8 8 SF
0 setgray
5 363 M
(                                                nclus_redtmp=0;) s
5 354 M
(                                                nclus_tmp=0;) s
5 345 M
(                                                nclus_redtmp_1=0;) s
5 336 M
(                                                nclus_tmp_1=0;) s
5 327 M
(                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
235.4 327 M
(for) s
/F-gs-font 8 8 SF
0 setgray
249.8 327 M
(\(jj = 0; jj < *nsubject; jj++\){) s
5 318 M
(                                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
273.8 318 M
(if) s
/F-gs-font 8 8 SF
0 setgray
283.4 318 M
(\(nh_redtmp[jj] > 0\) nclus_redtmp = nclus_redtmp + 1;) s
5 309 M
(                                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
273.8 309 M
(if) s
/F-gs-font 8 8 SF
0 setgray
283.4 309 M
(\(nh_tmp[jj] > 0\) nclus_tmp = nclus_tmp + 1;) s
5 300 M
(                                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
273.8 300 M
(if) s
/F-gs-font 8 8 SF
0 setgray
283.4 300 M
(\(nh_redtmp_1[jj] > 0\) nclus_redtmp_1 = nclus_redtmp_1 + ) s
5 291 M
(1;) s
5 282 M
(                                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
273.8 282 M
(if) s
/F-gs-font 8 8 SF
0 setgray
283.4 282 M
(\(nh_tmp_1[jj] > 0\) nclus_tmp_1 = nclus_tmp_1 + 1;) s
5 264 M
(                                                }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 246 M
(//                                              Rprintf\("nclus_tmp = %d\\n", nclus_tmp\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 237 M
(//                                              Rprintf\("nclus_redtmp = %d\\n", nclus_redtmp\);) s
/F-gs-font 8 8 SF
0 setgray
5 219 M
(                                                lpp_full = partition_prob_crp\(nh_tmp_no_zero, nclus_tmp, Mdp, *nsu) s
5 210 M
(bject, 1\);) s
5 201 M
(                                                lpp_red = partition_prob_crp\(nh_redtmp_no_zero, nclus_redtmp, Mdp,) s
5 192 M
( n_redtmp, 1\);) s
5 174 M
(                                                lpp_full_1 = partition_prob_crp\(nh_tmp_no_zero_1, nclus_tmp_1, Mdp) s
5 165 M
(, *nsubject, 1\);) s
5 156 M
(                                                lpp_red_1 = partition_prob_crp\(nh_redtmp_no_zero_1, nclus_redtmp_1) s
5 147 M
(, Mdp, n_redtmp_1, 1\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 129 M
(//                                              RprintIVecAsMat\("nh_tmp", nh_tmp, 1, nclus_iter[t]+1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 120 M
(//                                              Rprintf\("nclus_iter = %d\\n", nclus_iter[t]+1\);) s
/F-gs-font 8 8 SF
0 setgray
5 102 M
(                                                lpp_full = partition_prob_crp\(nh_tmp_no_zero, nclus_tmp, Mdp, *nsu) s
5 93 M
(bject, 1\);) s
5 84 M
(                                                lpp_red = partition_prob_crp\(nh_redtmp_no_zero, nclus_redtmp, Mdp,) s
5 75 M
( n_redtmp, 1\);) s
5 57 M
(                                                lpp_full_1 = partition_prob_crp\(nh_tmp_no_zero_1, nclus_tmp_1, Mdp) s
5 48 M
(, *nsubject, 1\);) s
5 39 M
(                                                lpp_red_1 = partition_prob_crp\(nh_redtmp_no_zero_1, nclus_redtmp_1) s
5 30 M
(, Mdp, n_redtmp_1, 1\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 12 M
(//                                              Rprintf\("lpp_full = %f\\n", lpp_full\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 3 M
(//                                              Rprintf\("lpp_red = %f\\n", lpp_red\);) s
_R
S
%%Page: (14) 14
%%BeginPageSetup
_S
18 36 translate
/pagenum 14 def
/fname (mcmcloop.dependentpartition.ar1.c) def
/fdir (.) def
/ftail (mcmcloop.dependentpartition.ar1.c) def
/Courier-Oblique 8 8 SUF
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
0.698039 0.133333 0.133333 setrgbcolor
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 750 M
(//                                              Rprintf\("lpp_full_1 = %f\\n", lpp_full_1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 741 M
(//                                              Rprintf\("lpp_red_1 = %f\\n", lpp_red_1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 723 M
(//                                              Rprintf\("dnorm\(y[j*\(*ntime\) + t], mudraw, sigdraw, 1\) = %f\\n", dno) s
5 714 M
(rm\(y[j*\(*ntime\) + t], mudraw, sigdraw, 1\)\);) s
/F-gs-font 8 8 SF
0 setgray
5 687 M
(                                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
235.4 687 M
(// spatial part) s
/F-gs-font 8 8 SF
0 setgray
5 678 M
(                                                lCn_1 = 0.0;) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 669 M
(//                                              Rprintf\("lCn_1 = %f\\n", lCn_1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 660 M
(//                                              Rprintf\("sPPM = %d\\n", *sPPM\);) s
/F-gs-font 8 8 SF
0 setgray
5 651 M
(                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
235.4 651 M
(if) s
/F-gs-font 8 8 SF
0 setgray
245 651 M
(\(*sPPM==1\){) s
5 642 M
(                                                        s1o[0] = s1[j];) s
5 633 M
(                                                        s2o[0] = s2[j];) s
5 624 M
(                                                        lCn_1 = Cohesion3_4\(s1o, s2o, mu0, k0, v0, L0, 1, *Spatial) s
5 615 M
(Cohesion, 1\);) s
5 606 M
(                                                }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 588 M
(//                                              Rprintf\("lCn_1 = %f\\n", lCn_1\);) s
/F-gs-font 8 8 SF
0 setgray
5 570 M
(                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
235.4 570 M
(if) s
/F-gs-font 8 8 SF
0 setgray
245 570 M
(\(t==0\){) s
5 561 M
(                                                        ph[nclus_iter[t]] = dnorm\(y[j*\(*ntime\) + t], mudraw, sigdr) s
5 552 M
(aw, 1\) +) s
5 543 M
(                                                                                                        lpp_full -) s
5 534 M
( lpp_red +) s
5 525 M
(                                                                                                        lpp_full_1) s
5 516 M
( - lpp_red_1 +) s
5 507 M
(                                                                                                        lCn_1; ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
537.8 507 M
(//t) s
5 498 M
(his is spatial part) s
/F-gs-font 8 8 SF
0 setgray
5 489 M
(                                                }) s
5 480 M
(                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
235.4 480 M
(if) s
/F-gs-font 8 8 SF
0 setgray
245 480 M
(\(t > 0\){) s
5 462 M
(                                                        ph[nclus_iter[t]] = dnorm\(y[j*\(*ntime\) + t],) s
5 453 M
(                                                                                mudraw + eta1_iter[j]*y[j*\(*ntime\)) s
5 444 M
( + t-1],) s
5 435 M
(                                                                                sigdraw*sqrt\(1-eta1_iter[j]*eta1_i) s
5 426 M
(ter[j]\), 1\) +) s
5 417 M
(                                                                                                        lpp_full -) s
5 408 M
( lpp_red +) s
5 399 M
(                                                                                                        lpp_full_1) s
5 390 M
( - lpp_red_1 +) s
5 381 M
(                                                                                                        lCn_1; ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
537.8 381 M
(//t) s
5 372 M
(his is spatial part) s
/F-gs-font 8 8 SF
0 setgray
5 354 M
(                                                }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 336 M
(//                                              ph[nclus_iter[t]] =  lpp_full - lpp_red + lpp_full_1 - lpp_red_1;) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 309 M
(//                                              Rprintf\("ph[nclus_iter[t]] = %f\\n", ph[nclus_iter[t]]\);) s
/F-gs-font 8 8 SF
0 setgray
5 291 M
(                                        }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 273 M
(//                                      RprintVecAsMat\("ph = ", ph, 1, nclus_iter[t] + 1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 264 M
(//                                      RprintIVecAsMat\("rhotmp = ", rho_tmp, 1, *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
5 246 M
(                                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
197 246 M
(// Now compute the probabilities) s
/F-gs-font 8 8 SF
0 setgray
5 237 M
(                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
197 237 M
(for) s
/F-gs-font 8 8 SF
0 setgray
211.4 237 M
(\(k = 0; k < nclus_iter[t]+1; k++\) phtmp[k] = ph[k];) s
5 210 M
(                                        R_rsort\(phtmp,  nclus_iter[t]+1\) ;) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 192 M
(//                                      RprintVecAsMat\("phtmp ", phtmp, 1, nclus_iter[t]+1\);) s
/F-gs-font 8 8 SF
0 setgray
5 165 M
(                                        maxph = phtmp[nclus_iter[t]];) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 147 M
(//                                      Rprintf\("maxph = %f\\n", maxph\);) s
/F-gs-font 8 8 SF
0 setgray
5 129 M
(                                        denph = 0.0;) s
5 120 M
(                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
197 120 M
(for) s
/F-gs-font 8 8 SF
0 setgray
211.4 120 M
(\(k = 0; k < nclus_iter[t]+1; k++\){) s
5 102 M
(                                                ph[k] = exp\(ph[k] - maxph\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 93 M
(//                                              ph[k] = pow\(exp\(ph[k] - maxph\), \(1 - exp\(-0.0001*\(i+1\)\)\)\);) s
/F-gs-font 8 8 SF
0 setgray
5 84 M
(                                                denph = denph + ph[k];) s
5 66 M
(                                        }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 48 M
(//                                      RprintVecAsMat\("ph", ph, 1, nclus_iter[t]+1\);) s
/F-gs-font 8 8 SF
0 setgray
5 30 M
(                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
197 30 M
(for) s
/F-gs-font 8 8 SF
0 setgray
211.4 30 M
(\(k = 0; k < nclus_iter[t]+1; k++\){) s
5 12 M
(                                                probh[k] = ph[k]/denph;) s
_R
S
%%Page: (15) 15
%%BeginPageSetup
_S
18 36 translate
/pagenum 15 def
/fname (mcmcloop.dependentpartition.ar1.c) def
/fdir (.) def
/ftail (mcmcloop.dependentpartition.ar1.c) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 759 M
(                                        }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 750 M
(//                                      Rprintf\("denph = %f\\n", denph\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 732 M
(//                                      RprintVecAsMat\("probh", probh, 1, nclus_iter[t]+1\);) s
/F-gs-font 8 8 SF
0 setgray
5 714 M
(                                        uu = runif\(0.0,1.0\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 705 M
(//                                      Rprintf\("uu = %f\\n", uu\);) s
/F-gs-font 8 8 SF
0 setgray
5 687 M
(                                        cprobh= 0.0;;) s
5 678 M
(                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
197 678 M
(for) s
/F-gs-font 8 8 SF
0 setgray
211.4 678 M
(\(k = 0; k < nclus_iter[t]+1; k++\){) s
5 660 M
(                                                cprobh = cprobh + probh[k];) s
5 642 M
(                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
235.4 642 M
(if) s
/F-gs-font 8 8 SF
0 setgray
245 642 M
( \(uu < cprobh\){) s
5 624 M
(                                                        iaux = k+1;) s
5 615 M
(                                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
273.8 615 M
(break) s
/F-gs-font 8 8 SF
0 setgray
297.8 615 M
(;) s
5 606 M
(                                                }) s
5 597 M
(                                        }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 570 M
(//                                      Rprintf\("iaux = %d\\n \\n \\n", iaux\);) s
/F-gs-font 8 8 SF
0 setgray
5 552 M
(                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
197 552 M
(if) s
/F-gs-font 8 8 SF
0 setgray
206.6 552 M
(\(iaux <= nclus_iter[t]\){) s
5 534 M
(                                                Si_iter[j*\(ntime1\) + t] = iaux;) s
5 525 M
(                                                nh[\(Si_iter[j*\(ntime1\) + t]-1\)*\(ntime1\)+t] = nh[\(Si_iter[j*\(ntime1) s
5 516 M
(\) + t]-1\)*\(ntime1\)+t] + 1;) s
5 507 M
(                                                rho_tmp[j] = iaux;) s
5 498 M
(                                        }) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
201.8 498 M
(else) s
/F-gs-font 8 8 SF
0 setgray
221 498 M
({) s
5 480 M
(                                                nclus_iter[t] = nclus_iter[t] + 1;) s
5 471 M
(                                                Si_iter[j*\(ntime1\) + t] = nclus_iter[t];) s
5 462 M
(                                                nh[\(Si_iter[j*\(ntime1\) + t]-1\)*\(ntime1\)+t] = 1;) s
5 453 M
(                                                rho_tmp[j] = nclus_iter[t];) s
5 435 M
(                                                muh[\(Si_iter[j*\(ntime1\) + t]-1\)*\(ntime1\) + t] = mudraw;) s
5 426 M
(                                                sig2h[\(Si_iter[j*\(ntime1\) + t]-1\)*\(ntime1\) + t] = sigdraw*sigdraw;) s
5 408 M
(                                        }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 390 M
(//                                      Rprintf\("Si_iter[j*\(ntime1\) + t] = %d\\n", Si_iter[j*\(ntime1\) + t]\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 381 M
(//                                      RprintVecAsMat\("muh", muh, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 372 M
(//                                      RprintVecAsMat\("sig2h", sig2h, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 363 M
(//                                      RprintIVecAsMat\("Si_iter ", Si_iter, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 354 M
(//                                      RprintIVecAsMat\("gamma_iter", gamma_iter, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 345 M
(//                                      RprintIVecAsMat\("nh ", nh, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 336 M
(//                                      RprintIVecAsMat\("nclus_iter", nclus_iter, 1, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
5 318 M
(                                }) s
5 291 M
(                        }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 282 M
(//                      RprintIVecAsMat\("gamma_iter", gamma_iter, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 273 M
(//                      RprintIVecAsMat\("Si_iter ", Si_iter, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 264 M
(//                      RprintIVecAsMat\("nh ", nh, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 255 M
(//                      RprintIVecAsMat\("nclus_iter", nclus_iter, 1, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
5 219 M
(                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
120.2 219 M
(for) s
/F-gs-font 8 8 SF
0 setgray
134.6 219 M
(\(j = 0; j < *nsubject; j++\){) s
5 210 M
(                                Si_tmp[j] = Si_iter[j*\(ntime1\) + t];) s
5 201 M
(                                Si_tmp2[j] = 0;) s
5 192 M
(                                reorder[j] = 0;) s
5 183 M
(                        }) s
5 156 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 156 M
(// I believe that I have to make sure that groups are order so that) s
/F-gs-font 8 8 SF
0 setgray
5 147 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 147 M
(// EU one is always in the group one, and then the smallest index not) s
/F-gs-font 8 8 SF
0 setgray
5 138 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 138 M
(// with group 1 anchors group 2 etc.) s
/F-gs-font 8 8 SF
0 setgray
5 120 M
(                        relabel\(Si_tmp, *nsubject, Si_tmp2, reorder, oldLab\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 102 M
(//                      RprintIVecAsMat\("gamma_iter", gamma_iter, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 93 M
(//                      RprintIVecAsMat\("Si_tmp2", Si_tmp2, 1, *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 84 M
(//                      RprintIVecAsMat\("reorder", reorder, 1, *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 75 M
(//                      RprintIVecAsMat\("oldLab", oldLab, 1, nclus_iter[t]\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 48 M
(//                      RprintIVecAsMat\("Si_iter ", Si_iter, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 39 M
(//                      RprintIVecAsMat\("nh ", nh, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 30 M
(//                      RprintIVecAsMat\("nclus_iter", nclus_iter, 1, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 3 M
(//                      RprintVecAsMat\("muh", muh, *nsubject, ntime1\);) s
_R
S
%%Page: (16) 16
%%BeginPageSetup
_S
18 36 translate
/pagenum 16 def
/fname (mcmcloop.dependentpartition.ar1.c) def
/fdir (.) def
/ftail (mcmcloop.dependentpartition.ar1.c) def
/Courier-Oblique 8 8 SUF
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
0.698039 0.133333 0.133333 setrgbcolor
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 759 M
(//                      RprintVecAsMat\("sig2h", sig2h, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
5 741 M
(                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
120.2 741 M
(for) s
/F-gs-font 8 8 SF
0 setgray
134.6 741 M
(\(j=0; j<*nsubject; j++\){) s
5 732 M
(                                Si_iter[j*\(ntime1\) + t] = Si_tmp2[j];) s
5 723 M
(                        }) s
5 705 M
(                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
120.2 705 M
(for) s
/F-gs-font 8 8 SF
0 setgray
134.6 705 M
(\(k = 0; k < nclus_iter[t]; k++\){) s
5 696 M
(                                mu_tmp[k] = muh[k*\(ntime1\)+t];) s
5 687 M
(                                sig2_tmp[k] = sig2h[k*\(ntime1\)+t];) s
5 678 M
(                        }) s
5 660 M
(                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
120.2 660 M
(for) s
/F-gs-font 8 8 SF
0 setgray
134.6 660 M
(\(k = 0; k < nclus_iter[t]; k++\){) s
5 651 M
(                                nh[k*\(ntime1\)+t] = reorder[k];) s
5 642 M
(                                muh[k*\(ntime1\)+t] = mu_tmp[\(oldLab[k]-1\)];) s
5 633 M
(                                sig2h[k*\(ntime1\)+t] = sig2_tmp[\(oldLab[k]-1\)];) s
5 624 M
(                        }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 597 M
(//                      RprintIVecAsMat\("Si_iter ", Si_iter, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 588 M
(//                      RprintIVecAsMat\("nh ", nh, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 579 M
(//                      RprintIVecAsMat\("nclus_iter", nclus_iter, 1, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 561 M
(//                      RprintVecAsMat\("muh", muh, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 552 M
(//                      RprintVecAsMat\("sig2h", sig2h, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 534 M
(//                      for\(k = 0; k < nclus_iter[t]; k++\) sig2h[k*\(ntime1\)+t] = 1.0;) s
/F-gs-font 8 8 SF
0 setgray
5 489 M
(                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
120.2 489 M
(for) s
/F-gs-font 8 8 SF
0 setgray
134.6 489 M
(\(k = 0; k < nclus_iter[t]; k++\){) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 471 M
(//                              Rprintf\("k = %d\\n", k\);) s
/F-gs-font 8 8 SF
0 setgray
5 453 M
(                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
158.6 453 M
(/////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 444 M
(                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
158.6 444 M
(//                                                                         //) s
/F-gs-font 8 8 SF
0 setgray
5 435 M
(                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
158.6 435 M
(// udate muh                                               //) s
/F-gs-font 8 8 SF
0 setgray
5 426 M
(                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
158.6 426 M
(//                                                                         //) s
/F-gs-font 8 8 SF
0 setgray
5 417 M
(                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
158.6 417 M
(/////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 399 M
(//                              Rprintf\("sumy = %f\\n", sumy\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 390 M
(//                              Rprintf\("nh[k*\(ntime1\)+t] = %d\\n",  nh[k*\(ntime1\)+t]\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 381 M
(//                              Rprintf\("sig2h[k*\(ntime1\) + t] = %f\\n",  sig2h[k*\(ntime1\) + t]\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 372 M
(//                              Rprintf\("tau2_iter[t] = %f\\n",  tau2_iter[t]\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 363 M
(//                              Rprintf\("theta_iter[t] = %f\\n",  theta_iter[t]\);) s
/F-gs-font 8 8 SF
0 setgray
5 345 M
(                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
158.6 345 M
(if) s
/F-gs-font 8 8 SF
0 setgray
168.2 345 M
(\(t==0\){) s
5 327 M
(                                        sumy = 0.0;) s
5 318 M
(                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
197 318 M
(for) s
/F-gs-font 8 8 SF
0 setgray
211.4 318 M
(\(j = 0; j < *nsubject; j++\){) s
5 309 M
(                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
235.4 309 M
(if) s
/F-gs-font 8 8 SF
0 setgray
245 309 M
(\(Si_iter[j*\(ntime1\) + t] == k+1\){) s
5 300 M
(                                                        sumy = sumy + y[j*\(*ntime\)+t];) s
5 291 M
(                                                }) s
5 273 M
(                                        }) s
5 264 M
(                                        s2star = 1/\(\() s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
259.4 264 M
(double) s
/F-gs-font 8 8 SF
0 setgray
288.2 264 M
(\) nh[k*\(ntime1\)+t]/sig2h[k*\(ntime1\) + t] + 1/tau2_iter[) s
5 255 M
(t]\);) s
5 246 M
(                                        mstar = s2star*\( \(1/sig2h[k*\(ntime1\) + t]\)*sumy + \(1/tau2_iter[t]\)*theta_i) s
5 237 M
(ter[t]\);) s
5 228 M
(                                }) s
5 219 M
(                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
158.6 219 M
(if) s
/F-gs-font 8 8 SF
0 setgray
168.2 219 M
(\(t > 0\){) s
5 201 M
(                                        sumy = 0.0;) s
5 192 M
(                                        sume2 = 0.0;) s
5 183 M
(                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
197 183 M
(for) s
/F-gs-font 8 8 SF
0 setgray
211.4 183 M
(\(j = 0; j < *nsubject; j++\){) s
5 174 M
(                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
235.4 174 M
(if) s
/F-gs-font 8 8 SF
0 setgray
245 174 M
(\(Si_iter[j*\(ntime1\) + t] == k+1\){) s
5 165 M
(                                                        sume2 = sume2 + 1.0/\(1-eta1_iter[j]*eta1_iter[j]\);) s
5 156 M
(                                                        sumy = sumy + \(y[j*\(*ntime\)+t] - eta1_iter[j]*y[j*\(*ntime\)) s
5 147 M
(+t-1]\)/) s
5 138 M
(                                                                       \(1-eta1_iter[j]*eta1_iter[j]\);) s
5 129 M
(                                                }) s
5 111 M
(                                        }) s
5 84 M
(                                        s2star = 1/\( \(1.0/sig2h[k*\(ntime1\) + t]\)*sume2  + 1/tau2_iter[t]\);) s
5 75 M
(                                        mstar = s2star*\( \(1.0/sig2h[k*\(ntime1\) + t]\)*sumy + \(1/tau2_iter[t]\)*theta) s
5 66 M
(_iter[t]\);) s
5 48 M
(                                }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 39 M
(//                              Rprintf\("sume2 = %f\\n", sume2\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 30 M
(//                              Rprintf\("sumy = %f\\n", sumy\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 21 M
(//                              Rprintf\("mstar = %f\\n", mstar\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 12 M
(//                              Rprintf\("sqrt\(s2star\) = %f\\n", sqrt\(s2star\)\);) s
/F-gs-font 8 8 SF
0 setgray
_R
S
%%Page: (17) 17
%%BeginPageSetup
_S
18 36 translate
/pagenum 17 def
/fname (mcmcloop.dependentpartition.ar1.c) def
/fdir (.) def
/ftail (mcmcloop.dependentpartition.ar1.c) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 759 M
(                                muh[k*\(ntime1\) + t] = rnorm\(mstar, sqrt\(s2star\)\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 741 M
(//                              muh[k] = 0.0;) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 732 M
(//                              Rprintf\("muh[k*\(ntime1\) + t] = %f\\n", muh[k*\(ntime1\) + t]\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 714 M
(//                              RprintVecAsMat\("muh", muh, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
5 687 M
(                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
158.6 687 M
(/////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 678 M
(                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
158.6 678 M
(//                                                                         //) s
/F-gs-font 8 8 SF
0 setgray
5 669 M
(                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
158.6 669 M
(// udate sig2h                                             //) s
/F-gs-font 8 8 SF
0 setgray
5 660 M
(                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
158.6 660 M
(//                                                                         //) s
/F-gs-font 8 8 SF
0 setgray
5 651 M
(                                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
158.6 651 M
(/////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 642 M
(                                osig = sqrt\(sig2h[k*\(ntime1\) + t]\);) s
5 633 M
(                                nsig = rnorm\(osig,csigSIG\);) s
5 615 M
(                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
158.6 615 M
(if) s
/F-gs-font 8 8 SF
0 setgray
168.2 615 M
(\(nsig > 0.0 & nsig < A\){) s
5 597 M
(                                        lln = 0.0;) s
5 588 M
(                                        llo = 0.0;) s
5 579 M
(                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
197 579 M
(if) s
/F-gs-font 8 8 SF
0 setgray
206.6 579 M
(\(t == 0\){) s
5 570 M
(                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
235.4 570 M
(for) s
/F-gs-font 8 8 SF
0 setgray
249.8 570 M
(\(j = 0; j < *nsubject; j++\){) s
5 561 M
(                                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
273.8 561 M
(if) s
/F-gs-font 8 8 SF
0 setgray
283.4 561 M
(\(Si_iter[j*\(ntime1\) + t] == k+1\){) s
5 552 M
(                                                                llo = llo + dnorm\(y[j*\(*ntime\)+t], muh[k*\(ntime1\) ) s
5 543 M
(+ t], osig,1\);) s
5 534 M
(                                                                lln = lln + dnorm\(y[j*\(*ntime\)+t], muh[k*\(ntime1\) ) s
5 525 M
(+ t], nsig,1\);) s
5 516 M
(                                                        }) s
5 507 M
(                                                }) s
5 498 M
(                                        }) s
5 489 M
(                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
197 489 M
(if) s
/F-gs-font 8 8 SF
0 setgray
206.6 489 M
(\(t > 0\){) s
5 480 M
(                                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
235.4 480 M
(for) s
/F-gs-font 8 8 SF
0 setgray
249.8 480 M
(\(j = 0; j < *nsubject; j++\){) s
5 471 M
(                                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
273.8 471 M
(if) s
/F-gs-font 8 8 SF
0 setgray
283.4 471 M
(\(Si_iter[j*\(ntime1\) + t] == k+1\){) s
5 462 M
(                                                                llo = llo + dnorm\(y[j*\(*ntime\)+t], muh[k*\(ntime1\) ) s
5 453 M
(+ t] +) s
5 444 M
(                                                                                                                  ) s
5 435 M
(                eta1_iter[j]*y[j*\(*ntime\) + t-1],) s
5 426 M
(                                                                                                                  ) s
5 417 M
(           osig*sqrt\(1-eta1_iter[j]*eta1_iter[j]\),1\);) s
5 408 M
(                                                                lln = lln + dnorm\(y[j*\(*ntime\)+t], muh[k*\(ntime1\) ) s
5 399 M
(+ t] +) s
5 390 M
(                                                                                                                  ) s
5 381 M
(                eta1_iter[j]*y[j*\(*ntime\) + t-1],) s
5 372 M
(                                                                                                                  ) s
5 363 M
(           nsig*sqrt\(1-eta1_iter[j]*eta1_iter[j]\),1\);) s
5 354 M
(                                                        }) s
5 345 M
(                                                }) s
5 336 M
(                                        }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 318 M
(//                                      Rprintf\("ms = %f\\n", ms\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 309 M
(//                                      Rprintf\("osig = %f\\n", osig\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 300 M
(//                                      Rprintf\("nsig = %f\\n", nsig\);) s
/F-gs-font 8 8 SF
0 setgray
5 291 M
(                                        llo = llo + dunif\(osig, 0.0, A, 1\);) s
5 282 M
(                                        lln = lln + dunif\(nsig, 0.0, A, 1\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 255 M
(//                                      Rprintf\("llo = %f\\n", llo\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 246 M
(//                                      Rprintf\("lln = %f\\n", lln\);) s
/F-gs-font 8 8 SF
0 setgray
5 228 M
(                                        llr = lln - llo;) s
5 219 M
(                                        uu = runif\(0,1\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 201 M
(//                                      Rprintf\("llr = %f\\n", llr\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 192 M
(//                                      Rprintf\("log\(uu\) = %f\\n", log\(uu\)\);) s
/F-gs-font 8 8 SF
0 setgray
5 174 M
(                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
197 174 M
(if) s
/F-gs-font 8 8 SF
0 setgray
206.6 174 M
(\(log\(uu\) < llr\){) s
5 165 M
(                                                sig2h[k*\(ntime1\) + t] = nsig*nsig;) s
5 156 M
(                                        }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 138 M
(//                                      sig2h[k*\(ntime1\) + t] = 1.0;) s
/F-gs-font 8 8 SF
0 setgray
5 120 M
(                                }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 102 M
(//                              Rprintf\("sig2h[k*\(ntime1\) + t] = %f\\n", sig2h[k*\(ntime1\) + t]\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 84 M
(//                              RprintVecAsMat\("sig2h", sig2h, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
5 48 M
(                        }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 21 M
(//                      RprintVecAsMat\("muh", muh, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 12 M
(//                      RprintVecAsMat\("sig2h", sig2h, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
_R
S
%%Page: (18) 18
%%BeginPageSetup
_S
18 36 translate
/pagenum 18 def
/fname (mcmcloop.dependentpartition.ar1.c) def
/fdir (.) def
/ftail (mcmcloop.dependentpartition.ar1.c) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 750 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 750 M
(//////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 741 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 741 M
(//                                                                                        ) s
5 732 M
(                                                        //) s
/F-gs-font 8 8 SF
0 setgray
5 723 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 723 M
(// update theta \(mean of mh\)                                                              ) s
5 714 M
(                        //) s
/F-gs-font 8 8 SF
0 setgray
5 705 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 705 M
(//                                                                                        ) s
5 696 M
(                                                        //) s
/F-gs-font 8 8 SF
0 setgray
5 687 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 687 M
(//////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 678 M
(                        summu = 0.0;) s
5 669 M
(                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
120.2 669 M
(for) s
/F-gs-font 8 8 SF
0 setgray
134.6 669 M
(\(k = 0; k < nclus_iter[t]; k++\){) s
5 660 M
(                                summu = summu + muh[k*\(ntime1\) + t];) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 651 M
(//                              Rprintf\("nh[k*\(ntime1\)+t] = %d\\n",  nh[k*\(ntime1\)+t]\);) s
/F-gs-font 8 8 SF
0 setgray
5 642 M
(                        }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 633 M
(//                      Rprintf\("summu = %f\\n", summu\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 624 M
(//                      Rprintf\("nclus_iter[t] = %d\\n",  nclus_iter[t]\);) s
/F-gs-font 8 8 SF
0 setgray
5 606 M
(                        phi1sq = phi1_iter*phi1_iter;) s
5 597 M
(                        lam2tmp = lam2_iter*\(1.0 - phi1sq\);) s
5 579 M
(                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
120.2 579 M
(if) s
/F-gs-font 8 8 SF
0 setgray
129.8 579 M
(\(t==0\){) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 570 M
(//                              Rprintf\("t = %d\\n", t\);) s
/F-gs-font 8 8 SF
0 setgray
5 552 M
(                                s2star = 1.0/\(\() s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
230.6 552 M
(double) s
/F-gs-font 8 8 SF
0 setgray
259.4 552 M
(\) nclus_iter[t]/tau2_iter[t] + 1.0/lam2_iter + phi1sq/lam2tmp) s
5 543 M
(\);) s
5 534 M
(                                mstar = s2star*\( \(1.0/tau2_iter[t]\)*summu +) s
5 525 M
(                                                 \(1.0/lam2_iter\)*phi0_iter +) s
5 516 M
(                                                 \(1.0/lam2tmp\)*phi1_iter*\(theta_iter[t+1]-phi0_iter*\(1-phi1_iter\)\)) s
5 507 M
(\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 489 M
(//                              Rprintf\("mstar = %f\\n", mstar\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 480 M
(//                              Rprintf\("sqrt\(s2star\) = %f\\n", sqrt\(s2star\)\);) s
/F-gs-font 8 8 SF
0 setgray
5 462 M
(                        } ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
129.8 462 M
(else) s
/F-gs-font 8 8 SF
0 setgray
149 462 M
( ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
153.8 462 M
(if) s
/F-gs-font 8 8 SF
0 setgray
163.4 462 M
(\(t==\(*ntime-1\)\){) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 444 M
(//                              Rprintf\("t = %d\\n", t\);) s
/F-gs-font 8 8 SF
0 setgray
5 435 M
(                                s2star = 1.0/\(\() s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
230.6 435 M
(double) s
/F-gs-font 8 8 SF
0 setgray
259.4 435 M
(\) nclus_iter[t]/tau2_iter[t] + 1.0/lam2tmp\);) s
5 426 M
(                                mstar = s2star*\(\(1.0/tau2_iter[t]\)*summu +) s
5 417 M
(                                                \(1.0/lam2tmp\)*\(phi0_iter*\(1-phi1_iter\) + phi1_iter*theta_iter[t-1]) s
5 408 M
(\)\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 399 M
(//                              Rprintf\("mstar = %f\\n", mstar\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 390 M
(//                              Rprintf\("sqrt\(s2star\) = %f\\n", sqrt\(s2star\)\);) s
/F-gs-font 8 8 SF
0 setgray
5 372 M
(                        } ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
129.8 372 M
(else) s
/F-gs-font 8 8 SF
0 setgray
149 372 M
( {) s
5 354 M
(                                s2star = 1.0/\(\() s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
230.6 354 M
(double) s
/F-gs-font 8 8 SF
0 setgray
259.4 354 M
(\) nclus_iter[t]/tau2_iter[t] + \(1.0 + phi1sq\)/lam2tmp\);) s
5 345 M
(                                mstar = s2star*\( \(1.0/tau2_iter[t]\)*summu +) s
5 336 M
(                                                 \(1.0/lam2tmp\)*\(phi1_iter*\(theta_iter[t-1] + theta_iter[t+1]\) +) s
5 327 M
(                                                                phi0_iter*\(1.0 - phi1_iter\)*\(1.0 - phi1_iter\)\)\);) s
5 309 M
(                        }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 291 M
(//                      Rprintf\("mstar = %f\\n", mstar\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 282 M
(//                      Rprintf\("sqrt\(s2star\) = %f\\n", sqrt\(s2star\)\);) s
/F-gs-font 8 8 SF
0 setgray
5 264 M
(                        theta_iter[t] = rnorm\(mstar, sqrt\(s2star\)\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 246 M
(//                      Rprintf\("theta_iter = %f\\n", theta_iter[t]\);) s
/F-gs-font 8 8 SF
0 setgray
5 219 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 219 M
(//////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 210 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 210 M
(//                                                                                        ) s
5 201 M
(                                                        //) s
/F-gs-font 8 8 SF
0 setgray
5 192 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 192 M
(// update tau2 \(variance of mh\)                                                           ) s
5 183 M
(                        //) s
/F-gs-font 8 8 SF
0 setgray
5 174 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 174 M
(//                                                                                        ) s
5 165 M
(                                                        //) s
/F-gs-font 8 8 SF
0 setgray
5 156 M
(                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
120.2 156 M
(//////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 147 M
(                        ot = sqrt\(tau2_iter[t]\);) s
5 138 M
(                        nt = rnorm\(ot,csigTAU\);) s
5 120 M
(                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
120.2 120 M
(if) s
/F-gs-font 8 8 SF
0 setgray
129.8 120 M
(\(nt > 0\){) s
5 102 M
(                                lln = 0.0;) s
5 93 M
(                                llo = 0.0;) s
5 84 M
(                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
158.6 84 M
(for) s
/F-gs-font 8 8 SF
0 setgray
173 84 M
(\(k = 0; k < nclus_iter[t]; k++\){) s
5 66 M
(                                        llo = llo + dnorm\(muh[k*\(ntime1\) + t], theta_iter[t], ot,1\);) s
5 57 M
(                                        lln = lln + dnorm\(muh[k*\(ntime1\) + t], theta_iter[t], nt,1\);) s
5 48 M
(                                }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 30 M
(//                              Rprintf\("ms = %f\\n", ms\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 21 M
(//                              Rprintf\("osig = %f\\n", osig\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 12 M
(//                              Rprintf\("nsig = %f\\n", nsig\);) s
/F-gs-font 8 8 SF
0 setgray
5 3 M
(                                llo = llo + dunif\(ot, 0.0, A0, 1\);) s
_R
S
%%Page: (19) 19
%%BeginPageSetup
_S
18 36 translate
/pagenum 19 def
/fname (mcmcloop.dependentpartition.ar1.c) def
/fdir (.) def
/ftail (mcmcloop.dependentpartition.ar1.c) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 759 M
(                                lln = lln + dunif\(nt, 0.0, A0, 1\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 732 M
(//                              Rprintf\("llo = %f\\n", llo\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 723 M
(//                              Rprintf\("lln = %f\\n", lln\);) s
/F-gs-font 8 8 SF
0 setgray
5 705 M
(                                llr = lln - llo;) s
5 696 M
(                                uu = runif\(0,1\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 678 M
(//                              Rprintf\("llr = %f\\n", llr\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 669 M
(//                              Rprintf\("log\(uu\) = %f\\n", log\(uu\)\);) s
/F-gs-font 8 8 SF
0 setgray
5 651 M
(                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
158.6 651 M
(if) s
/F-gs-font 8 8 SF
0 setgray
168.2 651 M
(\(log\(uu\) < llr\){) s
5 633 M
(                                        tau2_iter[t] = nt*nt;) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 615 M
(//                                      tau2_iter[t] = 5*5;) s
/F-gs-font 8 8 SF
0 setgray
5 606 M
(                                }) s
5 579 M
(                        }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 552 M
(//                      Rprintf\("tau2_iter = %f\\n", tau2_iter[t]\);) s
/F-gs-font 8 8 SF
0 setgray
5 525 M
(                }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 498 M
(//              RprintIVecAsMat\("Si_iter ", Si_iter, *nsubject, ntime1\);) s
/F-gs-font 8 8 SF
0 setgray
5 480 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 480 M
(//////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 471 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 471 M
(//                                                                                                ) s
5 462 M
(                                                //) s
/F-gs-font 8 8 SF
0 setgray
5 453 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 453 M
(// update eta1 \(temporal correlation parameter at likelihood\)                           //) s
/F-gs-font 8 8 SF
0 setgray
5 444 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 444 M
(//                                                                                                ) s
5 435 M
(                                                //) s
/F-gs-font 8 8 SF
0 setgray
5 426 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 426 M
(//////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 417 M
(                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
81.8 417 M
(if) s
/F-gs-font 8 8 SF
0 setgray
91.4 417 M
(\(*eta1_0==0\){) s
5 408 M
(                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
120.2 408 M
(for) s
/F-gs-font 8 8 SF
0 setgray
134.6 408 M
(\(j = 0; j < *nsubject; j++\){) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 399 M
(//                              Rprintf\("j = %d\\n", j\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 381 M
(//                              Rprintf\("eta1_iter = %f\\n", eta1_iter[j]\);) s
/F-gs-font 8 8 SF
0 setgray
5 363 M
(                                e1o = eta1_iter[j];) s
5 354 M
(                                e1n = rnorm\(e1o, csigETA1\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 336 M
(//                              Rprintf\("e1o = %f\\n", e1o\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 327 M
(//                              Rprintf\("e1n = %f\\n", e1n\);) s
/F-gs-font 8 8 SF
0 setgray
5 309 M
(                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
158.6 309 M
(if) s
/F-gs-font 8 8 SF
0 setgray
168.2 309 M
(\(e1n < 1 & e1n > -1\){) s
5 291 M
(                                        llo=lln=0.0;) s
5 282 M
(                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
197 282 M
(for) s
/F-gs-font 8 8 SF
0 setgray
211.4 282 M
(\(t=1; t<*ntime; t++\){) s
5 264 M
(                                                llo = llo + dnorm\(y[j*\(*ntime\)+t],) s
5 255 M
(                                                                                                muh[\(Si_iter[j*\(nt) s
5 246 M
(ime1\) + t]-1\)*\(ntime1\) + t] +) s
5 237 M
(                                                                            e1o*y[j*\(*ntime\)+t-1],) s
5 228 M
(                                                                        sqrt\(sig2h[\(Si_iter[j*\(ntime1\) + t]-1\)*\(nt) s
5 219 M
(ime1\) + t]*) s
5 210 M
(                                                                                  \(1-e1o*e1o\)\), 1\);) s
5 192 M
(                                                lln = lln + dnorm\(y[j*\(*ntime\)+t],) s
5 183 M
(                                                                                                muh[\(Si_iter[j*\(nt) s
5 174 M
(ime1\) + t]-1\)*\(ntime1\) + t] +) s
5 165 M
(                                                                            e1n*y[j*\(*ntime\)+t-1],) s
5 156 M
(                                                                            sqrt\(sig2h[\(Si_iter[j*\(ntime1\) + t]-1\)) s
5 147 M
(*\(ntime1\) + t]*) s
5 138 M
(                                                                              \(1-e1n*e1n\)\), 1\);) s
5 120 M
(                                        }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 102 M
(//                                      Rprintf\("llo = %f\\n", llo\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 93 M
(//                                      Rprintf\("lln = %f\\n", lln\);) s
/F-gs-font 8 8 SF
0 setgray
5 75 M
(                                        logito = log\(0.5*\(e1o + 1\)\) - log\(1 - 0.5*\(e1o+1\)\);) s
5 66 M
(                                        logitn = log\(0.5*\(e1n + 1\)\) - log\(1 - 0.5*\(e1n+1\)\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 48 M
(//                                      Rprintf\("logito = %f\\n", logito\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 39 M
(//                                      Rprintf\("logitn = %f\\n", logitn\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 21 M
(//                                      Rprintf\("\(1/b_eta1\)*fabs\(logito - 0.0\) = %f\\n", \(1/b_eta1\)*fabs\(logito - 0) s
5 12 M
(.0\)\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 3 M
(//                                      Rprintf\("\(1/b_eta1\)*fabs\(logitn - 0.0\) = %f\\n", \(1/b_eta1\)*fabs\(logitn - 0) s
_R
S
%%Page: (20) 20
%%BeginPageSetup
_S
18 36 translate
/pagenum 20 def
/fname (mcmcloop.dependentpartition.ar1.c) def
/fdir (.) def
/ftail (mcmcloop.dependentpartition.ar1.c) def
/Courier-Oblique 8 8 SUF
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
0.698039 0.133333 0.133333 setrgbcolor
5 759 M
(.0\)\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 741 M
(//                                      Rprintf\("fabs\(logito - 0.0\) = %f\\n", fabs\(logito - 0.0\)\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 732 M
(//                                      Rprintf\("fabs\(logitn - 0.0\) = %f\\n", fabs\(logitn - 0.0\)\);) s
/F-gs-font 8 8 SF
0 setgray
5 714 M
(                                        llo = llo + -log\(2*b_eta1\) - \(1/b_eta1\)*fabs\(logito - 0.0\);) s
5 705 M
(                                        lln = lln + -log\(2*b_eta1\) - \(1/b_eta1\)*fabs\(logitn - 0.0\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 687 M
(//                                      Rprintf\("llo = %f\\n", llo\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 678 M
(//                                      Rprintf\("lln = %f\\n", lln\);) s
/F-gs-font 8 8 SF
0 setgray
5 660 M
(                                        llr = lln - llo;) s
5 651 M
(                                        uu = runif\(0,1\);) s
5 624 M
(                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
197 624 M
(if) s
/F-gs-font 8 8 SF
0 setgray
206.6 624 M
(\(llr > log\(uu\)\) eta1_iter[j] = e1n;) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 606 M
(//                                      Rprintf\("eta1_iter = %f\\n", eta1_iter[j]\);) s
/F-gs-font 8 8 SF
0 setgray
5 597 M
(                                }) s
5 588 M
(                        }) s
5 579 M
(                }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 561 M
(//              RprintVecAsMat\("eta1", eta1_iter, 1, *nsubject\);) s
/F-gs-font 8 8 SF
0 setgray
5 543 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 543 M
(//////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 534 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 534 M
(//                                                                                                ) s
5 525 M
(                                                //) s
/F-gs-font 8 8 SF
0 setgray
5 516 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 516 M
(// update alpha                                                                                   ) s
5 507 M
(                                //) s
/F-gs-font 8 8 SF
0 setgray
5 498 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 498 M
(//                                                                                                ) s
5 489 M
(                                                //) s
/F-gs-font 8 8 SF
0 setgray
5 480 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 480 M
(//////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 471 M
(                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
81.8 471 M
(if) s
/F-gs-font 8 8 SF
0 setgray
91.4 471 M
(\(*alpha_0 == 0\){) s
5 462 M
(                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
120.2 462 M
(if) s
/F-gs-font 8 8 SF
0 setgray
129.8 462 M
(\(*global_alpha == 1\){) s
5 453 M
(                                sumg = 0;) s
5 444 M
(                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
158.6 444 M
(for) s
/F-gs-font 8 8 SF
0 setgray
173 444 M
(\(j = 0; j < *nsubject; j++\){) s
5 435 M
(                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
197 435 M
(for) s
/F-gs-font 8 8 SF
0 setgray
211.4 435 M
(\(t = 1; t < *ntime; t++\){) s
5 417 M
(                                                sumg = sumg + gamma_iter[j*ntime1 + t];) s
5 399 M
(                                        }) s
5 372 M
(                                }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 354 M
(//                              Rprintf\("sumg = %d\\n", sumg\);) s
/F-gs-font 8 8 SF
0 setgray
5 345 M
(                                astar = \() s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
201.8 345 M
(double) s
/F-gs-font 8 8 SF
0 setgray
230.6 345 M
(\) sumg + a;) s
5 336 M
(                                bstar = \() s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
201.8 336 M
(double) s
/F-gs-font 8 8 SF
0 setgray
230.6 336 M
(\) \(\(*nsubject\)*\(*ntime-1\) - sumg\) + b;) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 318 M
(//                              Rprintf\("astar = %f\\n", astar\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 309 M
(//                              Rprintf\("bstar = %f\\n", bstar\);) s
/F-gs-font 8 8 SF
0 setgray
5 291 M
(                                alpha_tmp = rbeta\(astar, bstar\);) s
5 273 M
(                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
158.6 273 M
(for) s
/F-gs-font 8 8 SF
0 setgray
173 273 M
(\(t=0;t<*ntime;t++\){alpha_iter[t] = alpha_tmp;}) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 264 M
(//                              Rprintf\("alpha_iter = %f\\n", alpha_iter\);) s
/F-gs-font 8 8 SF
0 setgray
5 246 M
(                        } ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
129.8 246 M
(else) s
/F-gs-font 8 8 SF
0 setgray
149 246 M
( {) s
5 228 M
(                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
158.6 228 M
(for) s
/F-gs-font 8 8 SF
0 setgray
173 228 M
(\(t = 0; t < *ntime; t++\){) s
5 219 M
(                                        sumg = 0;) s
5 210 M
(                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
197 210 M
(for) s
/F-gs-font 8 8 SF
0 setgray
211.4 210 M
(\(j = 0; j < *nsubject; j++\){) s
5 201 M
(                                                sumg = sumg + gamma_iter[j*ntime1 + t];) s
5 192 M
(                                        }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 165 M
(//                                      Rprintf\("sumg = %d\\n", sumg\);) s
/F-gs-font 8 8 SF
0 setgray
5 147 M
(                                        astar = \() s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
240.2 147 M
(double) s
/F-gs-font 8 8 SF
0 setgray
269 147 M
(\) sumg + a;) s
5 138 M
(                                        bstar = \() s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
240.2 138 M
(double) s
/F-gs-font 8 8 SF
0 setgray
269 138 M
(\) \(\(*nsubject\) - sumg\) + b;) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 120 M
(//                                      Rprintf\("astar = %f\\n", astar\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 111 M
(//                                      Rprintf\("bstar = %f\\n", bstar\);) s
/F-gs-font 8 8 SF
0 setgray
5 84 M
(                                        alpha_iter[t] = rbeta\(astar, bstar\);) s
5 66 M
(                                }) s
5 48 M
(                        }) s
5 30 M
(                        alpha_iter[0] = 0.0;) s
5 12 M
(                }) s
_R
S
%%Page: (21) 21
%%BeginPageSetup
_S
18 36 translate
/pagenum 21 def
/fname (mcmcloop.dependentpartition.ar1.c) def
/fdir (.) def
/ftail (mcmcloop.dependentpartition.ar1.c) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 759 M
(//              RprintVecAsMat\("alpha_iter", alpha_iter, 1, *ntime\);) s
/F-gs-font 8 8 SF
0 setgray
5 732 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 732 M
(//////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 723 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 723 M
(//                                                                                                ) s
5 714 M
(                                                //) s
/F-gs-font 8 8 SF
0 setgray
5 705 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 705 M
(// update phi0                                                                                    ) s
5 696 M
(                                //) s
/F-gs-font 8 8 SF
0 setgray
5 687 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 687 M
(//                                                                                                ) s
5 678 M
(                                                //) s
/F-gs-font 8 8 SF
0 setgray
5 669 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 669 M
(//////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 660 M
(                phi1sq = phi1_iter*phi1_iter;) s
5 651 M
(                one_phisq = \(1-phi1_iter\)*\(1-phi1_iter\);) s
5 642 M
(                lam2tmp = lam2_iter*\(1.0 - phi1sq\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 633 M
(//              Rprintf\("lam2tmp = %f\\n", lam2tmp\);) s
/F-gs-font 8 8 SF
0 setgray
5 624 M
(                sumt = 0.0;) s
5 615 M
(                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
81.8 615 M
(for) s
/F-gs-font 8 8 SF
0 setgray
96.2 615 M
(\(t=1; t<*ntime; t++\){) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 606 M
(//                      Rprintf\("t = %d\\n", t\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 597 M
(//                      Rprintf\("theta_iter[t] = %f\\n", theta_iter[t]\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 588 M
(//                      Rprintf\("theta_iter[t-1] = %f\\n", theta_iter[t-1]\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 579 M
(//                      Rprintf\("phi1_iter = %f\\n", phi1_iter\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 570 M
(//                      Rprintf\("\(theta_iter[t] - phi1_iter*theta_iter[t-1]\) = %f\\n",\(theta_iter[t] - phi1_iter*th) s
5 561 M
(eta_iter[t-1]\)\);) s
/F-gs-font 8 8 SF
0 setgray
5 543 M
(                        sumt = sumt + \(theta_iter[t] - phi1_iter*theta_iter[t-1]\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 534 M
(//                      Rprintf\("sumt = %f\\n", sumt\);) s
/F-gs-font 8 8 SF
0 setgray
5 525 M
(                }) s
5 507 M
(                s2star = 1.0/\(\(*ntime-1\)*\(one_phisq/lam2tmp\) + \(1/lam2_iter\) + \(1/s20\)\);) s
5 498 M
(                mstar = s2star*\(\(\(1.0-phi1_iter\)/lam2tmp\)*sumt + \(1/lam2_iter\)*theta_iter[0] + \(1/s20\)*m0\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 480 M
(//              Rprintf\("sumt = %f\\n", sumt\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 471 M
(//              Rprintf\("mstar = %f\\n", mstar\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 462 M
(//              Rprintf\("s2star = %f\\n", s2star\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 444 M
(//              Rprintf\("m0 = %f\\n", m0\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 435 M
(//              Rprintf\("s20 = %f\\n", s20\);) s
/F-gs-font 8 8 SF
0 setgray
5 417 M
(                phi0_iter = rnorm\(mstar, sqrt\(s2star\)\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 399 M
(//              Rprintf\("phi0_iter = %f\\n", phi0_iter\);) s
/F-gs-font 8 8 SF
0 setgray
5 381 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 381 M
(//////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 372 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 372 M
(//                                                                                                ) s
5 363 M
(                                                //) s
/F-gs-font 8 8 SF
0 setgray
5 354 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 354 M
(// update phi1                                                                                    ) s
5 345 M
(                                //) s
/F-gs-font 8 8 SF
0 setgray
5 336 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 336 M
(//                                                                                                ) s
5 327 M
(                                                //) s
/F-gs-font 8 8 SF
0 setgray
5 318 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 318 M
(//////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 300 M
(                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
81.8 300 M
(if) s
/F-gs-font 8 8 SF
0 setgray
91.4 300 M
(\(*phi1_0==0\){) s
5 291 M
(                        op1 = phi1_iter;) s
5 282 M
(                        np1 = rnorm\(op1, csigPHI1\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 264 M
(//                      Rprintf\("op1 = %f\\n", op1\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 255 M
(//                      Rprintf\("np1 = %f\\n", np1\);) s
/F-gs-font 8 8 SF
0 setgray
5 237 M
(                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
120.2 237 M
(if) s
/F-gs-font 8 8 SF
0 setgray
129.8 237 M
(\(np1 > -1 & np1 < 1\){) s
5 228 M
(                                llo = 0.0, lln = 0.0;) s
5 219 M
(                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
158.6 219 M
(for) s
/F-gs-font 8 8 SF
0 setgray
173 219 M
(\(t=1; t < *ntime; t++\){) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 210 M
(//                                      Rprintf\("t = %d\\n", t\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 201 M
(//                                      Rprintf\("theta_iter[t] = %f\\n", theta_iter[t]\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 192 M
(//                                      Rprintf\("theta_iter[t-1] = %f\\n", theta_iter[t-1]\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 183 M
(//                                      Rprintf\("lam2_iter = %f\\n", lam2_iter\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 174 M
(//                                      Rprintf\("lam2_iter*\(1.0 - op1*op1\) = %f\\n", lam2_iter*\(1.0 - op1*op1\)\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 165 M
(//                                      Rprintf\("lam2_iter*\(1.0 - np1*np1\) = %f\\n", lam2_iter*\(1.0 - np1*np1\)\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 156 M
(//                                      Rprintf\("phi0_iter + op1*theta_iter[t-1] = %f\\n", phi0_iter + op1*theta_it) s
5 147 M
(er[t-1]\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 138 M
(//                                      Rprintf\("phi0_iter + np1*theta_iter[t-1] = %f\\n", phi0_iter + np1*theta_it) s
5 129 M
(er[t-1]\);) s
/F-gs-font 8 8 SF
0 setgray
5 111 M
(                                        llo = llo + dnorm\(theta_iter[t], phi0_iter*\(1-op1\) + op1*theta_iter[t-1],) s
5 102 M
(                                                                     sqrt\(lam2_iter*\(1.0 - op1*op1\)\), 1\);) s
5 93 M
(                                        lln = lln + dnorm\(theta_iter[t], phi0_iter*\(1-np1\) + np1*theta_iter[t-1],) s
5 84 M
(                                                                         sqrt\(lam2_iter*\(1.0 - np1*np1\)\), 1\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 66 M
(//                                      Rprintf\("llo = %f\\n", llo\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 57 M
(//                                      Rprintf\("lln = %f\\n", lln\);) s
/F-gs-font 8 8 SF
0 setgray
5 48 M
(                                }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 39 M
(//                              Rprintf\("llo = %f\\n", llo\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 30 M
(//                              Rprintf\("lln = %f\\n", lln\);) s
/F-gs-font 8 8 SF
0 setgray
5 21 M
(                                llo = llo + dunif\(op1, -1,1, 1\);) s
5 12 M
(                                lln = lln + dunif\(np1, -1,1, 1\);) s
_R
S
%%Page: (22) 22
%%BeginPageSetup
_S
18 36 translate
/pagenum 22 def
/fname (mcmcloop.dependentpartition.ar1.c) def
/fdir (.) def
/ftail (mcmcloop.dependentpartition.ar1.c) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 759 M
(                                llr = lln - llo;) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 750 M
(//                              Rprintf\("llr = %f\\n", llr\);) s
/F-gs-font 8 8 SF
0 setgray
5 741 M
(                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
158.6 741 M
(if) s
/F-gs-font 8 8 SF
0 setgray
168.2 741 M
(\(llr > log\(runif\(0,1\)\)\) phi1_iter = np1;) s
5 732 M
(                        }) s
5 723 M
(                }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 714 M
(//              Rprintf\("phi1_iter = %f\\n", phi1_iter\);) s
/F-gs-font 8 8 SF
0 setgray
5 696 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 696 M
(//////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 687 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 687 M
(//                                                                                                ) s
5 678 M
(                                                //) s
/F-gs-font 8 8 SF
0 setgray
5 669 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 669 M
(// update lam2                                                                                    ) s
5 660 M
(                                //) s
/F-gs-font 8 8 SF
0 setgray
5 651 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 651 M
(//                                                                                                ) s
5 642 M
(                                                //) s
/F-gs-font 8 8 SF
0 setgray
5 633 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 633 M
(//////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 624 M
(//              phi1sq = phi1_iter*phi1_iter;) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 615 M
(//              ssq = 0.0;) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 606 M
(//              for\(t=1; t<*ntime; t++\){) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 597 M
(//                      ssq = ssq + \(theta_iter[t] - \(phi0_iter*\(1-phi1_iter\) + phi1_iter*theta_iter[t-1]\)\)*) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 588 M
(//                                  \(theta_iter[t] - \(phi0_iter*\(1-phi1_iter\) + phi1_iter*theta_iter[t-1]\)\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 579 M
(//              }) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 570 M
(//              ssq = 1.0/\(1.0 - phi1sq\)*ssq + \(theta_iter[0]-phi0_iter\)*\(theta_iter[0]-phi0_iter\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 552 M
(//              astar = 0.5*\(*ntime\) + al;) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 543 M
(//              bstar = 0.5*ssq + 1/bl;) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 525 M
(//              lam2_iter = 1.0/rgamma\(astar, 1/bstar\);) s
/F-gs-font 8 8 SF
0 setgray
5 507 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 507 M
(// Update lambda with a MH step) s
/F-gs-font 8 8 SF
0 setgray
5 498 M
(                phi1sq = phi1_iter*phi1_iter;) s
5 480 M
(                ol = sqrt\(lam2_iter\);) s
5 471 M
(                nl = rnorm\(ol, csigLAM\);) s
5 462 M
(                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
81.8 462 M
(if) s
/F-gs-font 8 8 SF
0 setgray
91.4 462 M
(\(nl > 0.0\){) s
5 453 M
(                        lln = 0.0;) s
5 444 M
(                        llo = 0.0;) s
5 435 M
(                    ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
101 435 M
(for) s
/F-gs-font 8 8 SF
0 setgray
115.4 435 M
(\(t=1; t<*ntime; t++\){) s
5 426 M
(                                llo = llo + dnorm\(theta_iter[t],) s
5 417 M
(                                                  phi0_iter*\(1-phi1_iter\) + phi1_iter*theta_iter[t-1], ol*sqrt\(1-p) s
5 408 M
(hi1sq\),1\);) s
5 399 M
(                                lln = lln + dnorm\(theta_iter[t],) s
5 390 M
(                                                  phi0_iter*\(1-phi1_iter\) + phi1_iter*theta_iter[t-1], nl*sqrt\(1-p) s
5 381 M
(hi1sq\),1\);) s
5 372 M
(                        }) s
5 363 M
(                        llo = llo + dnorm\(theta_iter[0], phi0_iter, ol, 1\) + dunif\(ol, 0.0, Al, 1\);) s
5 354 M
(                        lln = lln + dnorm\(theta_iter[0], phi0_iter, nl, 1\) + dunif\(nl, 0.0, Al, 1\);) s
5 336 M
(                        llr = lln - llo;) s
5 327 M
(                        uu = runif\(0,1\);) s
5 309 M
(                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
120.2 309 M
(if) s
/F-gs-font 8 8 SF
0 setgray
129.8 309 M
(\(log\(uu\) < llr\){) s
5 300 M
(                                lam2_iter = nl*nl;) s
5 291 M
(                        }) s
5 282 M
(                }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 237 M
(//              Rprintf\("lam2_iter = %f\\n", lam2_iter\);) s
/F-gs-font 8 8 SF
0 setgray
5 219 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 219 M
(//////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 210 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 210 M
(//) s
/F-gs-font 8 8 SF
0 setgray
5 201 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 201 M
(// predict partition for new time period) s
/F-gs-font 8 8 SF
0 setgray
5 192 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 192 M
(//) s
/F-gs-font 8 8 SF
0 setgray
5 183 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 183 M
(// THIS HAS YET TO BE FINISHED) s
/F-gs-font 8 8 SF
0 setgray
5 174 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 174 M
(//) s
/F-gs-font 8 8 SF
0 setgray
5 165 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 165 M
(//////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 156 M
(/*) s
5 147 M
(                for\(p = 0; p < *npred; p++\){) s
5 129 M
(                        for\(j=0; j<*nsubject; j++\){) s
5 120 M
(                                nh_pred[j] = 0;) s
5 111 M
(                                predSi_iter[j*\(*npred\) + p] = 0;) s
5 102 M
(                        }) s
5 93 M
(//                      RprintIVecAsMat\("nh_pred", nh_pred, 1, *nsubject\);) s
5 75 M
(                        if\(*alpha_0 == 1\){) s
5 66 M
(                                n_red = 0;) s
5 57 M
(                                for\(j=0;j<*nsubject;j++\){) s
5 39 M
(                                        gpred[j] = rbinom\(1,0.0\);) s
5 21 M
(                                        if\(gpred[j] == 1\){) s
5 12 M
(                                                nh_pred[Si_iter[j*\(ntime1\)+\(*ntime\)-1] - 1] = nh_pred[Si_iter[j*\(n) s
5 3 M
(time1\)+\(*ntime\)-1] - 1] + 1;) s
_R
S
%%Page: (23) 23
%%BeginPageSetup
_S
18 36 translate
/pagenum 23 def
/fname (mcmcloop.dependentpartition.ar1.c) def
/fdir (.) def
/ftail (mcmcloop.dependentpartition.ar1.c) def
/Courier-Oblique 8 8 SUF
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
0.698039 0.133333 0.133333 setrgbcolor
5 759 M
(                                                n_red = n_red + 1;) s
5 741 M
(                                                predSi_iter[j*\(*npred\) + p] = Si_iter[j*\(ntime1\)+\(*ntime\)-1];) s
5 732 M
(                                        }) s
5 723 M
(                                }) s
5 705 M
(                        }) s
5 678 M
(                        if\(*alpha_0 == 0\){) s
5 669 M
(                                if\(*global_alpha == 1\){) s
5 642 M
(                                        n_red = 0;) s
5 633 M
(                                        for\(j=0;j<*nsubject;j++\){) s
5 615 M
(                                                gpred[j] = rbinom\(1,alpha_iter[1]\);) s
5 597 M
(                                                if\(gpred[j] == 1\){) s
5 588 M
(                                                        nh_pred[Si_iter[j*\(ntime1\)+\(*ntime\)-1] - 1] = nh_pred[Si_i) s
5 579 M
(ter[j*\(ntime1\)+\(*ntime\)-1] - 1] + 1;) s
5 570 M
(                                                        n_red = n_red + 1;) s
5 552 M
(                                                        predSi_iter[j*\(*npred\) + p] = Si_iter[j*\(ntime1\)+\(*ntime\)-) s
5 543 M
(1];) s
5 534 M
(                                                }) s
5 525 M
(                                        }) s
5 507 M
(                                }else {) s
5 489 M
(                                }) s
5 480 M
(                        }) s
5 462 M
(//                      RprintIVecAsMat\("predSi_iter", predSi_iter, *npred, *nsubject\);) s
5 453 M
(//                      RprintIVecAsMat\("gpred", gpred, 1, *nsubject\);) s
5 444 M
(//                      RprintIVecAsMat\("nh_pred", nh_pred, 1, *nsubject\);) s
5 435 M
(//                      Rprintf\("n_red = %d\\n", n_red\);) s
5 417 M
(                        remove_zero\(nh_pred, *nsubject, nh_tmp_no_zero\);) s
5 408 M
(//                      RprintIVecAsMat\("nh_tmp_no_zero", nh_tmp_no_zero, 1, *nsubject\);) s
5 390 M
(                        nclus_tmp = 0;) s
5 381 M
(                        for\(j=0; j<*nsubject;j++\){) s
5 372 M
(                                if\(nh_tmp_no_zero[j] > 0\){) s
5 363 M
(                                        nclus_tmp = nclus_tmp + 1;) s
5 354 M
(                                }else{) s
5 345 M
(                                        break;) s
5 336 M
(                                }) s
5 327 M
(                        }) s
5 309 M
(//                      Rprintf\("nclus_tmp = %d\\n", nclus_tmp\);) s
5 291 M
(                        for\(j=0;j<*nsubject;j++\){) s
5 282 M
(//                              Rprintf\("j = %d\\n", j\);) s
5 273 M
(                                if\(gpred[j] == 0\){) s
5 264 M
(                                        for\(k = 0; k < nclus_tmp; k++\){) s
5 255 M
(                                                probh[k] = nh_pred[k]/\(n_red + Mdp\);) s
5 246 M
(                                        }) s
5 237 M
(                                        probh[nclus_tmp] = Mdp/\(n_red + Mdp\);) s
5 219 M
(//                                      RprintVecAsMat\("probh = ", probh, 1, nclus_tmp+1\);) s
5 201 M
(                                        uu = runif\(0.0,1.0\);) s
5 183 M
(                                        cprobh= 0.0;;) s
5 174 M
(                                        for\(k = 0; k < nclus_tmp+1; k++\){) s
5 156 M
(                                                cprobh = cprobh + probh[k];) s
5 138 M
(                                                if \(uu < cprobh\){) s
5 120 M
(                                                        iaux = k+1;) s
5 111 M
(                                                        break;) s
5 102 M
(                                                }) s
5 93 M
(                                        }) s
5 75 M
(//                                      Rprintf\("iaux = %d\\n", iaux\);) s
5 66 M
(                                        if\(iaux <= nclus_tmp\){) s
5 48 M
(                                                predSi_iter[j*\(*npred\) + p] = iaux;) s
5 39 M
(                                                nh_pred[iaux-1] = nh_pred[iaux-1] + 1;) s
5 30 M
(                                        }else{) s
5 12 M
(                                                nclus_tmp = nclus_tmp + 1;) s
5 3 M
(                                                predSi_iter[j*\(*npred\) + p] = nclus_tmp;) s
_R
S
%%Page: (24) 24
%%BeginPageSetup
_S
18 36 translate
/pagenum 24 def
/fname (mcmcloop.dependentpartition.ar1.c) def
/fdir (.) def
/ftail (mcmcloop.dependentpartition.ar1.c) def
/Courier-Oblique 8 8 SUF
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
0.698039 0.133333 0.133333 setrgbcolor
5 759 M
(                                                nh_pred[\(predSi_iter[j*\(*npred\) + p]-1\)*\(*npred\)+p] = 1;) s
5 741 M
(                                        }) s
5 732 M
(                                        n_red = n_red + 1;) s
5 714 M
(//                                      RprintIVecAsMat\("predSi_iter", predSi_iter, *npred, *nsubject\);) s
5 705 M
(//                                      RprintIVecAsMat\("nh_pred", nh_pred, 1, *nsubject\);) s
5 696 M
(//                                      Rprintf\("nclus_tmp = %d\\n", nclus_tmp\);) s
5 687 M
(//                                      Rprintf\("n_red = %d\\n", n_red\);) s
5 678 M
(                                }) s
5 669 M
(                        }) s
5 660 M
(                }) s
5 651 M
(*/) s
/F-gs-font 8 8 SF
0 setgray
5 642 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 642 M
(////////////////////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 633 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 633 M
(//) s
/F-gs-font 8 8 SF
0 setgray
5 624 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 624 M
(// evaluating likelihood that will be used to calculate LPML and WAIC?) s
/F-gs-font 8 8 SF
0 setgray
5 615 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 615 M
(// \(see page 81 Christensen Hansen and Johnson\)) s
/F-gs-font 8 8 SF
0 setgray
5 606 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 606 M
(//) s
/F-gs-font 8 8 SF
0 setgray
5 597 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 597 M
(////////////////////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 588 M
(                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
81.8 588 M
(if) s
/F-gs-font 8 8 SF
0 setgray
91.4 588 M
(\(\(i > \(*burn-1\)\) & \(\(i+1\)  % \(*thin\) == 0\)\){) s
5 570 M
(                        like0=0;) s
5 561 M
(                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
120.2 561 M
(for) s
/F-gs-font 8 8 SF
0 setgray
134.6 561 M
(\(j = 0; j < *nsubject; j++\){) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 552 M
(//                              Rprintf\("j = %d\\n", j\);) s
/F-gs-font 8 8 SF
0 setgray
5 543 M
(                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
158.6 543 M
(for) s
/F-gs-font 8 8 SF
0 setgray
173 543 M
(\(t = 0; t < *ntime; t++\){) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 534 M
(//                                      Rprintf\("t = %d\\n", t\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 516 M
(//                                      Rprintf\("Si_iter[j*\(ntime1\) + t] = %d\\n", Si_iter[j*\(ntime1\) + t]\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 507 M
(//                                      Rprintf\("\(Si_iter[j*\(ntime1\) + t]-1\)*\(ntime1\) + t = %d\\n", \(Si_iter[j*\(nti) s
5 498 M
(me1\) + t]-1\)*\(ntime1\) + t\);) s
/F-gs-font 8 8 SF
0 setgray
5 480 M
(                                        mudraw = muh[\(Si_iter[j*\(ntime1\) + t]-1\)*\(ntime1\) + t];) s
5 471 M
(                                        sigdraw = sqrt\(sig2h[\(Si_iter[j*\(ntime1\) + t]-1\)*\(ntime1\) + t]\);) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 453 M
(//                                      Rprintf\("mudraw = %f\\n", mudraw\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 444 M
(//                                      Rprintf\("sigdraw = %f\\n", sigdraw\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 435 M
(//                                      Rprintf\("eta1_iter[j] = %f\\n", eta1_iter[j]\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 426 M
(//                                      Rprintf\("y[j*\(*ntime\)+t] = %f\\n", y[j*\(*ntime\)+t]\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 417 M
(//                                      Rprintf\("y[j*\(*ntime\)+t-1] = %f\\n",y[j*\(*ntime\)+t-1]\);) s
/F-gs-font 8 8 SF
0 setgray
5 399 M
(                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
197 399 M
(if) s
/F-gs-font 8 8 SF
0 setgray
206.6 399 M
(\(t == 0\){) s
5 390 M
( ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
9.8 390 M
(//                                       Rprintf\("mudraw = %f\\n", mudraw\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 381 M
(//                                        Rprintf\("sigdraw = %f\\n", sigdraw\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 372 M
(//                                        Rprintf\("y[j*\(*ntime\)+t] = %f\\n", y[j*\(*ntime\)+t]\);) s
/F-gs-font 8 8 SF
0 setgray
5 354 M
(                                          like_iter[j*\(*ntime\)+t] = dnorm\(y[j*\(*ntime\)+t], mudraw, sigdraw, 1\);) s
5 345 M
(                      fitted_iter[j*\(*ntime\)+t] = mudraw;) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 336 M
(//                                        Rprintf\("like_iter = %f\\n", like_iter[j*\(*ntime\)+t]\);) s
/F-gs-font 8 8 SF
0 setgray
5 327 M
(                                        }) s
5 318 M
(                                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
197 318 M
(if) s
/F-gs-font 8 8 SF
0 setgray
206.6 318 M
(\(t > 0\){) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 300 M
(//                                              Rprintf\("mudraw + eta1_iter[j]*y[j*\(*ntime\)+t-1] = %f\\n", mudraw +) s
5 291 M
( eta1_iter[j]*y[j*\(*ntime\)+t-1]\);) s
/F-gs-font 8 8 SF
0 setgray
5 282 M
(                                                like_iter[j*\(*ntime\)+t] = dnorm\(y[j*\(*ntime\)+t],) s
5 273 M
(                                                                                                        mudraw + e) s
5 264 M
(ta1_iter[j]*y[j*\(*ntime\)+t-1],) s
5 255 M
(                                                                                                        sigdraw*sq) s
5 246 M
(rt\(1-eta1_iter[j]*eta1_iter[j]\), 1\);) s
5 237 M
(                        fitted_iter[j*\(*ntime\)+t] = mudraw + eta1_iter[j]*y[j*\(*ntime\)+t-1];) s
5 219 M
(                                        }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 201 M
(//                                      Rprintf\("like_iter = %f\\n", like_iter[j*\(*ntime\)+t]\);) s
/F-gs-font 8 8 SF
0 setgray
5 183 M
(                                        ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
197 183 M
(// These are needed for WAIC) s
/F-gs-font 8 8 SF
0 setgray
5 174 M
(                                        mnlike[j*\(*ntime\)+t] = mnlike[j*\(*ntime\)+t] + exp\(like_iter[j*\(*ntime\)+t]\)) s
5 165 M
(/\() s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
14.6 165 M
(double) s
/F-gs-font 8 8 SF
0 setgray
43.4 165 M
(\) nout;) s
5 156 M
(                                        mnllike[j*\(*ntime\)+t] = mnllike[j*\(*ntime\)+t] + \(like_iter[j*\(*ntime\)+t]\)/) s
5 147 M
(\() s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
9.8 147 M
(double) s
/F-gs-font 8 8 SF
0 setgray
38.6 147 M
(\) nout;) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 120 M
(//                                      Rprintf\("mnlike = %f\\n", mnlike[j*\(*ntime\)+t]\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 111 M
(//                                      Rprintf\("mnllike = %f\\n", mnllike[j*\(*ntime\)+t]\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 93 M
(//                                      if\(exp\(like_iter[j*\(*ntime\)+t]\) < 1e-320\) like0=1;) s
/F-gs-font 8 8 SF
0 setgray
5 75 M
(                                        CPO[j*\(*ntime\)+t] = CPO[j*\(*ntime\)+t] + \(1/\() s
/Courier-Bold 8 8 SUF
0.133333 0.545098 0.133333 setrgbcolor
408.2 75 M
(double) s
/F-gs-font 8 8 SF
0 setgray
437 75 M
(\) nout\)*\(1/exp\(like_iter) s
5 66 M
([j*\(*ntime\)+t]\)\);) s
5 48 M
(                                }) s
5 39 M
(                        }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 30 M
(//                      Rprintf\("like0 = %d\\n", like0\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 21 M
(//                      if\(like0==1\) nout_0 = nout_0 + 1;) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 12 M
(//                      if\(i == \(*draws-1\)\) Rprintf\("xb = %f\\n", xb\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 3 M
(//                      Rprintf\("nout_0 = %d\\n", nout_0\);) s
_R
S
%%Page: (25) 25
%%BeginPageSetup
_S
18 36 translate
/pagenum 25 def
/fname (mcmcloop.dependentpartition.ar1.c) def
/fdir (.) def
/ftail (mcmcloop.dependentpartition.ar1.c) def
/Courier-Oblique 8 8 SUF
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
0.698039 0.133333 0.133333 setrgbcolor
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 750 M
(//                      if\(like0==0\){) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 741 M
(//                              Rprintf\("nout - nout_0 = %d\\n", nout - nout_0\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 732 M
(//                              for\(j = 0; j < *nsubject; j++\){) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 723 M
(//                                      for\(t = 0; t < *ntime; t++\){) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 714 M
(//                                              Rprintf\("like_iter[j*\(*ntime\)+t] = %f\\n", like_iter[j*\(*ntime\)+t]\)) s
5 705 M
(;) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 696 M
(//                                              Rprintf\("exp\(like_iter[j*\(*ntime\)+t]\) = %f\\n", exp\(like_iter[j*\(*n) s
5 687 M
(time\)+t]\)\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 678 M
(//                                              CPO[j*\(*ntime\)+t] = CPO[j*\(*ntime\)+t] + \(1/exp\(like_iter[j*\(*ntime) s
5 669 M
(\)+t]\)\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 651 M
(//                                              Rprintf\("CPO = %f\\n", CPO[j*\(*ntime\)+t]\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 633 M
(//                                      }) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 624 M
(//                              }) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 615 M
(//                      }) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 606 M
(//            RprintVecAsMat\("llike", like_iter, *nsubject, *ntime\);) s
/F-gs-font 8 8 SF
0 setgray
5 597 M
(                }) s
5 561 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 561 M
(//////////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 552 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 552 M
(//                                                                                                ) s
5 543 M
(                                                        //) s
/F-gs-font 8 8 SF
0 setgray
5 534 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 534 M
(// Save MCMC iterates                                                                             ) s
5 525 M
(                                //) s
/F-gs-font 8 8 SF
0 setgray
5 516 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 516 M
(//                                                                                                ) s
5 507 M
(                                                        //) s
/F-gs-font 8 8 SF
0 setgray
5 498 M
(                ) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
81.8 498 M
(//////////////////////////////////////////////////////////////////////////////////) s
/F-gs-font 8 8 SF
0 setgray
5 489 M
(                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
81.8 489 M
(if) s
/F-gs-font 8 8 SF
0 setgray
91.4 489 M
(\(\(i > \(*burn-1\)\) & \(\(i+1\) % *thin == 0\)\){) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 462 M
(//                      Rprintf\("ii = %d\\n", ii\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 453 M
(//                      RprintVecAsMat\("theta", theta_iter, 1, *ntime\);) s
/F-gs-font 8 8 SF
0 setgray
5 435 M
(                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
120.2 435 M
(for) s
/F-gs-font 8 8 SF
0 setgray
134.6 435 M
(\(t = 0; t < *ntime; t++\){) s
5 426 M
(                                alpha_out[ii*\(*ntime\) + t] = alpha_iter[t];) s
5 417 M
(                                theta[ii*\(*ntime\) + t] = theta_iter[t];) s
5 408 M
(                                tau2[ii*\(*ntime\) + t] = tau2_iter[t];) s
5 390 M
(                                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
158.6 390 M
(for) s
/F-gs-font 8 8 SF
0 setgray
173 390 M
(\(j = 0; j < *nsubject; j++\){) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 381 M
(//                                      Rprintf\("\(Si_iter[j]-1\)*\(ntime1\) + t = %d\\n", \(Si_iter[j*\(ntime1\) + t]-1\)*) s
5 372 M
(\(ntime1\) + t\);) s
/F-gs-font 8 8 SF
0 setgray
5 363 M
(                                        sig2[\(ii*\(*nsubject\) + j\)*\(*ntime\) + t] = sig2h[\(Si_iter[j*\(ntime1\) + t]-1) s
5 354 M
(\)*\(ntime1\) + t];) s
5 345 M
(                                        mu[\(ii*\(*nsubject\) + j\)*\(*ntime\) + t] = muh[\(Si_iter[j*\(ntime1\) + t]-1\)*\(n) s
5 336 M
(time1\) + t];) s
5 327 M
(                                        Si[\(ii*\(*nsubject\) + j\)*\(*ntime\) + t] = Si_iter[j*ntime1 + t];) s
5 318 M
(                                        gamma[\(ii*\(*nsubject\) + j\)*\(*ntime\) + t] = gamma_iter[j*ntime1 + t];) s
5 300 M
(                                        llike[\(ii*\(*nsubject\) + j\)*\(*ntime\) + t] = like_iter[j*\(*ntime\)+t];) s
5 291 M
(                                        fitted[\(ii*\(*nsubject\) + j\)*\(*ntime\) + t] = fitted_iter[j*\(*ntime\)+t];) s
5 273 M
(                                }) s
5 255 M
(                        }) s
5 237 M
(                        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
120.2 237 M
(for) s
/F-gs-font 8 8 SF
0 setgray
134.6 237 M
(\(j=0; j<*nsubject; j++\){) s
5 219 M
(                                eta1[ii*\(*nsubject\) + j] = eta1_iter[j];) s
5 210 M
(                        }) s
5 183 M
(                        phi1[ii] = phi1_iter;) s
5 174 M
(                        phi0[ii] = phi0_iter;) s
5 165 M
(                        lam2[ii] = lam2_iter;) s
5 147 M
(                        ii = ii+1;) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 138 M
(//                      Rprintf\("ii = %d\\n", ii\);) s
/F-gs-font 8 8 SF
0 setgray
5 120 M
(                }) s
5 75 M
(        }) s
5 39 M
(        lpml_iter=0.0;) s
5 30 M
(        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
43.4 30 M
(for) s
/F-gs-font 8 8 SF
0 setgray
57.8 30 M
(\(t = 0; t < *ntime; t++\){) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 21 M
(//              Rprintf\("t = %d\\n", t\);) s
/F-gs-font 8 8 SF
0 setgray
5 12 M
(                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
81.8 12 M
(for) s
/F-gs-font 8 8 SF
0 setgray
96.2 12 M
(\(j = 0; j < *nsubject; j++\){) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 3 M
(//                      Rprintf\("j = %d\\n", j\);) s
_R
S
%%Page: (26) 26
%%BeginPageSetup
_S
18 36 translate
/pagenum 26 def
/fname (mcmcloop.dependentpartition.ar1.c) def
/fdir (.) def
/ftail (mcmcloop.dependentpartition.ar1.c) def
/Courier-Oblique 8 8 SUF
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
0.698039 0.133333 0.133333 setrgbcolor
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 750 M
(//                      Rprintf\("CPO = %f\\n", CPO[j*\(*ntime\)+t]\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 732 M
(//                      lpml_iter = lpml_iter - log\(\(1/\(double\) nout-nout_0\)*CPO[j*\(*ntime\)+t]\);) s
/F-gs-font 8 8 SF
0 setgray
5 723 M
(                        lpml_iter = lpml_iter - log\(CPO[j*\(*ntime\)+t]\);) s
5 705 M
(                }) s
5 696 M
(        }) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 687 M
(//      Rprintf\("nout_0 = %d\\n", nout_0\);) s
/F-gs-font 8 8 SF
0 setgray
5 678 M
(        lpml[0] = lpml_iter;) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 669 M
(//      Rprintf\("lpml_iter = %f\\n", lpml_iter\);) s
/F-gs-font 8 8 SF
0 setgray
5 642 M
(        elppdWAIC = 0.0;) s
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 633 M
(//      RprintVecAsMat\("mnlike",mnlike, 1,\(*nsubject\)*\(ntime1\)\);) s
/F-gs-font 8 8 SF
0 setgray
/Courier-Oblique 8 8 SUF
0.698039 0.133333 0.133333 setrgbcolor
5 624 M
(//      RprintVecAsMat\("mnllike", mnllike, 1, \(*nsubject\)*\(ntime1\)\);) s
/F-gs-font 8 8 SF
0 setgray
5 606 M
(        ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
43.4 606 M
(for) s
/F-gs-font 8 8 SF
0 setgray
57.8 606 M
(\(j = 0; j < *nsubject; j++\){) s
5 597 M
(                ) s
/Courier-Bold 8 8 SUF
0.627451 0.12549 0.941176 setrgbcolor
81.8 597 M
(for) s
/F-gs-font 8 8 SF
0 setgray
96.2 597 M
(\(t = 0; t < *ntime; t++\){) s
5 588 M
(                        elppdWAIC = elppdWAIC + \(2*mnllike[j*\(*ntime\)+t] - log\(mnlike[j*\(*ntime\)+t]\)\);) s
5 579 M
(                }) s
5 570 M
(        }) s
5 561 M
(        waic[0] = -2*elppdWAIC;) s
5 534 M
(        PutRNGstate\(\);) s
5 489 M
(}) s
_R
S
%%Trailer
%%Pages: 26
%%DocumentNeededResources: font Courier-Oblique Courier-Bold Courier 
%%EOF
