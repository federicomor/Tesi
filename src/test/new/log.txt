LOG FILE
current seed = 306.0

▶ iteration 1.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
muh_iter
5×4 Matrix{Float64}:
 0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0
sig2h_iter
5×4 Matrix{Float64}:
 1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0
alpha_iter
4-element Vector{Float64}:
 0.5
 0.5
 0.5
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
rho_tmp = [2, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 2
Si_iter[:, t] = [1, 1, 1, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  1  0
 2  1  1  0
 1  1  1  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  1  0
 2  1  1  0
 1  1  1  0
rho_tmp = [1, 1, 1, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  1  0
 2  1  1  0
 1  1  1  0
rho_tmp = [1, 1, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.5
sampled gamma:
probh = 0.5
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.5
sampled gamma:
probh = 0.5
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.5
sampled gamma:
probh = 0.5
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27049442218439607, 0.7295055778156039]
probh = 0.7870951517289406
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.272906953528583, 0.727093046471417]
probh = 0.7856033759796294
sampled gamma:
probh = 0.7856033759796294
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 0, 1]
												[update rho]
movable_units = [1, 2, 4]
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  1  0
 2  1  1  0
 1  1  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  1  0
 2  1  1  0
 1  1  1  0
rho_tmp = [2, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 2]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  1  0
 2  2  1  0
 1  2  1  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  1  0
 2  2  1  0
 1  2  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  1  0
 2  2  1  0
 1  2  1  0
rho_tmp = [1, 3, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 2]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  1  0
 2  2  1  0
 1  2  1  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  1  0
 2  2  1  0
 1  2  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  1  0
 2  2  1  0
 1  2  1  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.5
sampled gamma:
probh = 0.5
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.5
sampled gamma:
probh = 0.5
gt = true
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2641153918314374, 0.7358846081685626]
probh = 0.7910670232020593
sampled gamma:
probh = 0.7910670232020593
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4809479558687055, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.39940857143489605, 0.600591428565104]
probh = 0.7145875910811673
sampled gamma:
probh = 0.7145875910811673
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.493139943485671, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.40233675694331344, 0.5976632430566866]
probh = 0.7130954779932528
sampled gamma:
probh = 0.7130954779932528
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update rho]
movable_units = [1, 4, 5]
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  1  0
 2  2  1  0
 1  2  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  1  0
 2  2  1  0
 1  2  1  0
rho_tmp = [2, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 2]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 1  2  2  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 1  2  2  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 1  2  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 2]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 1  2  2  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 1  2  2  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 1  2  2  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 2.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 1  2  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
muh_iter
5×4 Matrix{Float64}:
 -0.500385  1.11955  0.0685878  0.0
  0.740459  0.0      0.0        0.0
  0.0       0.0      0.0        0.0
  0.0       0.0      0.0        0.0
  0.0       0.0      0.0        0.0
sig2h_iter
5×4 Matrix{Float64}:
 0.138919  0.553217  0.716836  1.0
 0.310192  9.10995   0.572547  1.0
 1.0       1.0       1.0       1.0
 1.0       1.0       1.0       1.0
 1.0       1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.19651591086093806
 0.4722988137245639
 0.356820957943851
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 1, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 1  2  1  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 1  2  1  0
rho_tmp = [2, 1, 1, 2, 1]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 1  2  1  0
rho_tmp = [3, 1, 1, 2, 1]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 1  2  1  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 1  2  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 1  2  1  0
rho_tmp = [1, 3, 1, 2, 1]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 1  2  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 1  2  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 1]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 1  2  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [3, 1]
Si_comp2 = [2, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 1  2  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 1  2  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 1  2  1  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 1, 3, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 3  2  2  0
 1  2  1  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 3  2  2  0
 1  2  1  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = [1, 2]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 3  2  2  0
 1  2  1  0
rho_tmp = [1, 2, 1, 3, 3]
Si_comp1 = [1, 3]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 3  2  2  0
 1  2  1  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = [1, 4]
Si_comp2 = [2, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 3, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.4830789743074355, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.39991987245586275, 0.6000801275441373]
probh = 0.5986333031621577
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3995264050768606, 0.6004735949231395]
probh = 0.6913753577836224
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2641153918314374, 0.7358846081685626]
probh = 0.7721428822996974
sampled gamma:
probh = 0.7721428822996974
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4809479558687055, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.39940857143489605, 0.600591428565104]
probh = 0.6914382950450966
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.272906953528583, 0.727093046471417]
probh = 0.7663305417653902
sampled gamma:
probh = 0.7663305417653902
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 0, 1]
												[update rho]
movable_units = [1, 2, 4]
Si_iter[:, t] = [1, 2, 2, 2, 2]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  2  1  0
 2  1  2  0
 1  1  2  0
 3  1  2  0
 1  1  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  2  1  0
 2  1  2  0
 1  1  2  0
 3  1  2  0
 1  1  1  0
rho_tmp = [2, 1, 1, 1, 1]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  1  2  0
 3  1  2  0
 1  1  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  1  2  0
 3  1  2  0
 1  1  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [2, 1]
Si_comp2 = [2, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf]
After exp and normalization:
ph = [1.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  1  2  0
 3  1  2  0
 1  1  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  1  2  0
 3  1  2  0
 1  1  1  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 2
Si_iter[:, t] = [1, 1, 1, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21316540189401498, 0.21316540189401498, 0.5736691962119701]
probh = 0.7224200755530695
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2705913586595647, 0.7294086413404354]
probh = 0.6721568662332462
sampled gamma:
probh = 0.6721568662332462
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.356820957943851
sampled gamma:
probh = 0.356820957943851
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.356820957943851
sampled gamma:
probh = 0.356820957943851
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.356820957943851
sampled gamma:
probh = 0.356820957943851
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  1  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  1  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  1  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  1  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  1  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  1  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  1  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  1  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  1  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 2, 1]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  1  1  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  1  1  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  1  1  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 1, 1]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  1  1  0
 3  2  1  0
 1  1  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  1  1  0
 3  2  1  0
 1  1  1  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  1  1  0
 3  2  1  0
 1  1  1  0
rho_tmp = [1, 2, 1, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 1, 1, 3]

▶ iteration 3.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  1  1  0
 3  2  1  0
 1  1  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
muh_iter
5×4 Matrix{Float64}:
 -0.0511504  0.0      0.0685878  0.0
 -0.515212   1.50899  0.0        0.0
  0.473628   0.0      1.00964    0.0
  0.0        0.0      0.0        0.0
  0.0        0.0      0.0        0.0
sig2h_iter
5×4 Matrix{Float64}:
 16.8246    1.02979  0.140219  1.0
  2.74018  14.8537   0.667106  1.0
 11.7488    1.0      4.22337   1.0
  1.0       1.0      1.0       1.0
  1.0       1.0      1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.03629889731280575
 0.45273038754178485
 0.30133628058869505
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 1, 3, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  1  1  0
 3  2  1  0
 1  1  3  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  1  1  0
 3  2  1  0
 1  1  3  0
rho_tmp = [2, 2, 1, 3, 1]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  1  1  0
 3  2  1  0
 1  1  3  0
rho_tmp = [3, 2, 1, 3, 1]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  1  1  0
 3  2  1  0
 1  1  3  0
rho_tmp = [4, 2, 1, 3, 1]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  1  2  0
 3  1  1  0
 2  2  1  0
 3  1  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [3, 3]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  1  2  0
 3  1  1  0
 2  2  1  0
 3  1  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [3, 3]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  1  2  0
 3  1  1  0
 2  2  1  0
 3  1  3  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = [3, 3]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  1  2  0
 3  1  1  0
 2  2  1  0
 3  1  3  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = [3, 3]
Si_comp2 = [1, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  1  0
 3  2  1  0
 2  1  3  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  1  0
 3  2  1  0
 2  1  3  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [2, 2]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  1  0
 3  2  1  0
 2  1  3  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [3, 2]
Si_comp2 = [1, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  1  0
 3  2  1  0
 2  1  3  0
rho_tmp = [1, 2, 4, 3, 2]
Si_comp1 = [4, 2]
Si_comp2 = [1, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  1  0
 3  2  1  0
 2  1  3  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [2, 2]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  1  0
 3  2  1  0
 2  1  3  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [2, 2]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  1  0
 3  2  1  0
 2  1  3  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [2, 2]
Si_comp2 = [1, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  1  0
 3  2  1  0
 2  1  3  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [2, 1]
Si_comp2 = [1, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  1  0
 3  2  1  0
 2  1  3  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [2, 2]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  1  0
 3  2  1  0
 2  1  3  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = [2, 3]
Si_comp2 = [1, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  1  0
 3  2  1  0
 2  1  3  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [2, 4]
Si_comp2 = [1, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 3, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21316540189401498, 0.21316540189401498, 0.5736691962119701]
probh = 0.7951156794995514
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21296489765602558, 0.21296489765602558, 0.5740702046879489]
probh = 0.7952689397686941
sampled gamma:
probh = 0.7952689397686941
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20893297679794065, 0.20893297679794065, 0.5821340464041186]
probh = 0.7983634244757335
sampled gamma:
probh = 0.7983634244757335
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3266626967668691, 0.18213398477324527, 0.49120331845988574]
probh = 0.8195597911445794
sampled gamma:
probh = 0.8195597911445794
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.493139943485671, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.40233675694331344, 0.5976632430566866]
probh = 0.6727877901643555
sampled gamma:
probh = 0.6727877901643555
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update rho]
movable_units = [1, 4]
Si_iter[:, t] = [1, 1, 1, 2, 1]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  1  0
 3  2  1  0
 2  1  3  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  1  0
 3  2  1  0
 2  1  3  0
rho_tmp = [2, 1, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  1  0
 3  2  1  0
 2  1  3  0
rho_tmp = [3, 1, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 3  3  1  0
 2  2  3  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 3  3  1  0
 2  2  3  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 3  3  1  0
 2  2  3  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.30133628058869505
sampled gamma:
probh = 0.30133628058869505
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.30133628058869505
sampled gamma:
probh = 0.30133628058869505
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.30133628058869505
sampled gamma:
probh = 0.30133628058869505
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27049442218439607, 0.7295055778156039]
probh = 0.6145694962194124
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.272906953528583, 0.727093046471417]
probh = 0.372328160689175
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update rho]
movable_units = [1, 2, 4, 5]
Si_iter[:, t] = [1, 2, 1, 1, 3]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 3  3  1  0
 2  2  3  0
rho_tmp = [1, 2, 1, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 3  3  1  0
 2  2  3  0
rho_tmp = [2, 2, 1, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 3  3  1  0
 2  2  3  0
rho_tmp = [3, 2, 1, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 3  3  1  0
 2  2  3  0
rho_tmp = [4, 2, 1, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  4  0
 2  2  3  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  4  0
 2  2  3  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  4  0
 2  2  3  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 3, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  4  0
 2  2  3  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 4, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  2  0
 2  2  3  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  2  0
 2  2  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  2  0
 2  2  3  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  2  0
 2  2  3  0
rho_tmp = [1, 1, 2, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 3]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  3  0
 2  2  3  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  3  0
 2  2  3  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  3  0
 2  2  3  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  3  0
 2  2  3  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 3]

▶ iteration 4.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  3  0
 2  2  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
muh_iter
5×4 Matrix{Float64}:
 -0.194774  -1.83459  0.381562   0.0
  0.606644   0.0      0.0685878  0.0
 -0.712134  -1.29048  1.00964    0.0
 -0.515212   0.0      0.0        0.0
  0.0        0.0      0.0        0.0
sig2h_iter
5×4 Matrix{Float64}:
 0.368462   1.09508   1.53238   1.0
 0.932001   0.664669  0.222353  1.0
 0.817607  10.3862    0.981384  1.0
 2.74018    1.0       0.667106  1.0
 1.0        1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.2552752357875589
 0.7671577396194573
 0.19896023804882149
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
 2  2  3  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [2, 2, 2]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
 2  2  3  0
rho_tmp = [2, 2, 2, 1, 2]
Si_comp1 = [2, 2, 2]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
 2  2  3  0
rho_tmp = [3, 2, 2, 1, 2]
Si_comp1 = [2, 2, 2]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 1, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 2  3  3  0
 1  2  3  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 2  3  3  0
 1  2  3  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [2, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 2  3  3  0
 1  2  3  0
rho_tmp = [1, 3, 1, 2, 1]
Si_comp1 = [3, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 2  3  3  0
 1  2  3  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 2  3  3  0
 1  2  3  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 2  3  3  0
 1  2  3  0
rho_tmp = [1, 1, 3, 2, 1]
Si_comp1 = [1, 3, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 2  3  3  0
 1  2  3  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 2  3  3  0
 1  2  3  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  3  3  0
 1  2  3  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  3  3  0
 1  2  3  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [2, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf]
After exp and normalization:
ph = [1.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1757100899524644, 0.1757100899524644, 0.1757100899524644, 0.4728697301426069]
probh = 0.9493698435647435
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21296489765602558, 0.21296489765602558, 0.5740702046879489]
probh = 0.9392867662383698
sampled gamma:
probh = 0.9392867662383698
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20893297679794065, 0.20893297679794065, 0.5821340464041186]
probh = 0.9403676650153735
sampled gamma:
probh = 0.9403676650153735
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3266626967668691, 0.18213398477324527, 0.49120331845988574]
probh = 0.9476157882791136
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.493139943485671, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.40233675694331344, 0.5976632430566866]
probh = 0.8911747396836678
sampled gamma:
probh = 0.8911747396836678
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update rho]
movable_units = [1, 4]
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  3  1  0
 1  2  1  0
 1  2  2  0
 1  1  3  0
 1  2  3  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  3  1  0
 1  2  1  0
 1  2  2  0
 1  1  3  0
 1  2  3  0
rho_tmp = [2, 2, 2, 1, 2]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  3  1  0
 1  2  1  0
 1  2  2  0
 1  1  3  0
 1  2  3  0
rho_tmp = [3, 2, 2, 1, 2]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  3  3  0
 1  2  3  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  3  3  0
 1  2  3  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  3  3  0
 1  2  3  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2709151356678167, 0.7290848643321833]
probh = 0.4782996578306382
sampled gamma:
probh = 0.4782996578306382
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2705913586595647, 0.7294086413404354]
probh = 0.47859806193605325
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.19896023804882149
sampled gamma:
probh = 0.19896023804882149
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.19896023804882149
sampled gamma:
probh = 0.19896023804882149
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.19896023804882149
sampled gamma:
probh = 0.19896023804882149
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 3, 3]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  3  0
 1  2  3  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  3  0
 1  2  3  0
rho_tmp = [2, 1, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  3  0
 1  2  3  0
rho_tmp = [3, 1, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  3  0
 1  2  3  0
rho_tmp = [4, 1, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 1, 1]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  3  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  3  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  3  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
rho_tmp = [1, 3, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 1, 1]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 1, 1]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 1]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 1  2  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 1  2  1  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 1  2  1  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 2]

▶ iteration 5.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
muh_iter
5×4 Matrix{Float64}:
 -0.955342  -1.04052   1.00964   0.0
  0.685575   0.0      -0.508933  0.0
 -0.194774  -1.29048   0.381562  0.0
 -0.515212   0.0       0.0       0.0
  0.0        0.0       0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 27.9286     1.04468  2.97809   1.0
  0.817607  23.0787   0.745277  1.0
  0.368462  10.3862   1.53238   1.0
  2.74018    1.0      0.667106  1.0
  1.0        1.0      1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.19869228119848126
 0.7308847075340349
 0.15358561816205593
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
rho_tmp = [2, 1, 1, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [2, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf]
After exp and normalization:
ph = [1.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf]
After exp and normalization:
ph = [1.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 2
Si_iter[:, t] = [1, 1, 1, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 2  2  2  0
 1  2  2  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 2  2  2  0
 1  2  2  0
rho_tmp = [1, 1, 1, 2, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [2, 2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 2  2  2  0
 1  2  2  0
rho_tmp = [1, 1, 1, 2, 3]
Si_comp1 = [1, 1, 3]
Si_comp2 = [2, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.713706587908492, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22113415318903495, 0.18375120443554996, 0.5951146423754151]
probh = 0.9247078226877495
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3995264050768606, 0.6004735949231395]
probh = 0.8717578330103053
sampled gamma:
probh = 0.8717578330103053
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.44837626606234, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.39162143252303233, 0.6083785674769677]
probh = 0.8739754419121442
sampled gamma:
probh = 0.8739754419121442
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.8600581338155395, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.4927955425216583, 0.5072044574783418]
probh = 0.8464177471747274
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.493139943485671, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.40233675694331344, 0.5976632430566866]
probh = 0.8709721446402314
sampled gamma:
probh = 0.8709721446402314
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update rho]
movable_units = [1, 4]
Si_iter[:, t] = [1, 2, 2, 2, 2]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  2  1  0
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  1  2  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  2  1  0
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  1  2  0
rho_tmp = [2, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  1  2  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  1  2  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.15358561816205593
sampled gamma:
probh = 0.15358561816205593
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.15358561816205593
sampled gamma:
probh = 0.15358561816205593
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.15358561816205593
sampled gamma:
probh = 0.15358561816205593
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.15358561816205593
sampled gamma:
probh = 0.15358561816205593
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.15358561816205593
sampled gamma:
probh = 0.15358561816205593
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 2, 2]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  1  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  1  2  0
rho_tmp = [2, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  1  2  0
rho_tmp = [3, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 1, 1]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  1  1  0
 2  1  1  0
 1  1  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  1  1  0
 2  1  1  0
 1  1  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  1  0
 2  1  1  0
 1  1  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  1  0
 2  1  1  0
 1  1  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 1, 1]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 2  1  1  0
 1  1  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 2  1  1  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 2  1  1  0
 1  1  1  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 1, 1]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 2  1  1  0
 1  1  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 2  1  1  0
 1  1  1  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 2  1  1  0
 1  1  1  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 1, 3]

▶ iteration 6.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 2  1  1  0
 1  1  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
muh_iter
5×4 Matrix{Float64}:
 -0.211531   0.0      -0.508933  0.0
  1.05566   -1.04052  -0.62771   0.0
 -0.367172  -1.29048   0.537512  0.0
 -0.515212   0.0       0.0       0.0
  0.0        0.0       0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 2.95108    6.17492  0.318732  1.0
 0.488914   1.04468  1.87512   1.0
 0.368462  10.3862   0.429798  1.0
 2.74018    1.0      0.667106  1.0
 1.0        1.0      1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.3856745843251642
 0.3793086046501272
 0.3541273560876076
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 1, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 2  1  1  0
 1  1  3  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [1, 1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 2  1  1  0
 1  1  3  0
rho_tmp = [2, 1, 1, 2, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [1, 1, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 2  1  1  0
 1  1  3  0
rho_tmp = [3, 1, 1, 2, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [1, 1, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 2  1  1  0
 1  1  3  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [1, 1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 2  1  1  0
 1  1  3  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [2, 1, 1]
Si_comp2 = [1, 1, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 2  1  1  0
 1  1  3  0
rho_tmp = [1, 3, 1, 2, 1]
Si_comp1 = [3, 1, 1]
Si_comp2 = [1, 1, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 2  1  1  0
 1  1  3  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [1, 1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 2  1  1  0
 1  1  3  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 1, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 2  1  1  0
 1  1  3  0
rho_tmp = [1, 1, 3, 2, 1]
Si_comp1 = [1, 3, 1]
Si_comp2 = [1, 1, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 2  1  1  0
 1  1  3  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [1, 1, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 2  1  1  0
 1  1  3  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [1, 1, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  1  1  0
 1  1  3  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [1, 1, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  1  1  0
 1  1  3  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf]
After exp and normalization:
ph = [1.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.862189152254271, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.49332819449865906, 0.5066718055013409]
probh = 0.5533206672273243
sampled gamma:
probh = 0.5533206672273243
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.8605493258781385, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.4929183154743703, 0.5070816845256296]
probh = 0.5535260924249067
sampled gamma:
probh = 0.5535260924249067
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.827486444009176, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.4846569400110208, 0.5153430599889791]
probh = 0.5576993348586878
sampled gamma:
probh = 0.5576993348586878
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.8600581338155395, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.4927955425216583, 0.5072044574783418]
probh = 0.5535876540710986
sampled gamma:
probh = 0.5535876540710986
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.872250121432507, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.4958431365503173, 0.5041568634496827]
probh = 0.5520635465330166
sampled gamma:
probh = 0.5520635465330166
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 1, 0]
												[update rho]
movable_units = [3, 5]
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  1  1  0
 1  1  3  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  1  1  0
 1  1  3  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  1  1  0
 1  1  3  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  1  1  0
 1  1  3  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 2
Si_iter[:, t] = [1, 1, 1, 1, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.3541273560876076
sampled gamma:
probh = 0.3541273560876076
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.3541273560876076
sampled gamma:
probh = 0.3541273560876076
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.3541273560876076
sampled gamma:
probh = 0.3541273560876076
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.3541273560876076
sampled gamma:
probh = 0.3541273560876076
gt = true
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.272906953528583, 0.727093046471417]
probh = 0.42990349394294547
sampled gamma:
probh = 0.42990349394294547
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update rho]
movable_units = [1, 2, 3, 5]
Si_iter[:, t] = [1, 1, 2, 1, 3]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  1  1  0
 1  2  3  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  1  1  0
 1  2  3  0
rho_tmp = [2, 1, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  1  1  0
 1  2  3  0
rho_tmp = [3, 1, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  1  1  0
 1  2  3  0
rho_tmp = [4, 1, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 2, 1]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  1  3  0
 1  1  2  0
 1  2  1  0
rho_tmp = [1, 1, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  1  3  0
 1  1  2  0
 1  2  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  1  3  0
 1  1  2  0
 1  2  1  0
rho_tmp = [1, 3, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  1  3  0
 1  1  2  0
 1  2  1  0
rho_tmp = [1, 4, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 1]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  3  0
 1  1  2  0
 1  2  1  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  3  0
 1  1  2  0
 1  2  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  3  0
 1  1  2  0
 1  2  1  0
rho_tmp = [1, 1, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 1]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  1  2  0
 1  2  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  1  2  0
 1  2  1  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  1  2  0
 1  2  1  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 2, 3]

▶ iteration 7.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  1  2  0
 1  2  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
muh_iter
5×4 Matrix{Float64}:
 -1.44375    0.0       0.537512  0.0
  0.230532  -3.84904  -0.508933  0.0
 -1.22487   -1.29048  -1.87048   0.0
 -0.515212   0.0       0.0       0.0
  0.0        0.0       0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 34.2438    16.4269   1.38901   1.0
  0.488914   2.42975  0.560886  1.0
  0.368462  10.3862   0.235115  1.0
  2.74018    1.0      0.667106  1.0
  1.0        1.0      1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.025350127681249376
 0.33492959304087444
 0.07109251439258328
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  1  2  0
 1  2  3  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [1, 1, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  1  2  0
 1  2  3  0
rho_tmp = [2, 1, 1, 1, 1]
Si_comp1 = [2, 1, 1]
Si_comp2 = [1, 1, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf]
After exp and normalization:
ph = [1.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  1  2  0
 1  2  3  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [1, 1, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  1  2  0
 1  2  3  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 1, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf]
After exp and normalization:
ph = [1.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  1  2  0
 1  2  3  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [1, 1, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  1  2  0
 1  2  3  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [1, 1, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  1  2  0
 1  2  3  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [1, 1, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  1  2  0
 1  2  3  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf]
After exp and normalization:
ph = [1.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  1  2  0
 1  2  3  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [1, 1, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  1  2  0
 1  2  3  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 1, 1]
Si_comp2 = [1, 1, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.39991987245586275, 0.6000801275441373]
probh = 0.5573757765917062
sampled gamma:
probh = 0.5573757765917062
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2705913586595647, 0.7294086413404354]
probh = 0.6504852655481176
sampled gamma:
probh = 0.6504852655481176
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2641153918314374, 0.7358846081685626]
probh = 0.65597235089752
sampled gamma:
probh = 0.65597235089752
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27049442218439607, 0.7295055778156039]
probh = 0.650566722965088
sampled gamma:
probh = 0.650566722965088
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.40233675694331344, 0.5976632430566866]
probh = 0.45729312608189254
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 1, 0]
												[update rho]
movable_units = [1, 2, 5]
Si_iter[:, t] = [1, 1, 1, 1, 2]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  1  2  0
 1  2  3  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  1  2  0
 1  2  3  0
rho_tmp = [2, 1, 1, 1, 2]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  1  2  0
 1  2  3  0
rho_tmp = [3, 1, 1, 1, 2]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 1  1  3  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 1  1  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 1  1  3  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  3  2  0
 1  3  2  0
 1  1  3  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [3]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  3  2  0
 1  3  2  0
 1  1  3  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [3]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  3  2  0
 1  3  2  0
 1  1  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [3]
Si_comp2 = [2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  3  2  0
 1  3  2  0
 1  1  3  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [3]
Si_comp2 = [2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 3, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2709151356678167, 0.7290848643321833]
probh = 0.09499966413049862
sampled gamma:
probh = 0.09499966413049862
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2705913586595647, 0.7294086413404354]
probh = 0.09496149922193436
sampled gamma:
probh = 0.09496149922193436
gt = true
gamma_iter[:, t] = Bool[0, 1, 0, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20893297679794065, 0.20893297679794065, 0.5821340464041186]
probh = 0.26809970773064834
sampled gamma:
probh = 0.26809970773064834
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21290484827105935, 0.21290484827105935, 0.5741903034578812]
probh = 0.26442065934944214
sampled gamma:
probh = 0.26442065934944214
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21439662402037066, 0.21439662402037066, 0.5712067519592587]
probh = 0.11815457579161945
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update rho]
movable_units = [1, 4, 5]
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  3  2  0
 1  3  2  0
 1  2  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  3  2  0
 1  3  2  0
 1  2  3  0
rho_tmp = [2, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  3  2  0
 1  3  2  0
 1  2  3  0
rho_tmp = [3, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  3  2  0
 1  3  2  0
 1  2  3  0
rho_tmp = [4, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  3  3  0
 1  3  3  0
 1  2  1  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  3  3  0
 1  3  3  0
 1  2  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  3  3  0
 1  3  3  0
 1  2  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  3  3  0
 1  3  3  0
 1  2  1  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  3  3  0
 1  3  3  0
 1  2  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  3  3  0
 1  3  3  0
 1  2  1  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  3  3  0
 1  3  3  0
 1  2  1  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  3  3  0
 1  3  3  0
 1  2  1  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]

▶ iteration 8.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  3  3  0
 1  3  3  0
 1  2  4  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
muh_iter
5×4 Matrix{Float64}:
 -0.979399  -3.84904   -1.87048    0.0
 -1.89477    0.144518   0.537512   0.0
  0.469324   0.0       -0.508933   0.0
 -0.938604   0.0        0.0897645  0.0
  0.0        0.0        0.0        0.0
sig2h_iter
5×4 Matrix{Float64}:
 2.12461    3.396    0.89      1.0
 0.488914   1.25172  0.995524  1.0
 0.368462  10.9277   0.42421   1.0
 2.74018    1.0      0.503613  1.0
 1.0        1.0      1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.21572777028089501
 0.4938486267740817
 0.7882505018394974
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  3  3  0
 1  3  3  0
 1  2  4  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1]
Si_comp2 = [3, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  3  3  0
 1  3  3  0
 1  2  4  0
rho_tmp = [2, 1, 1, 1, 1]
Si_comp1 = [1, 1]
Si_comp2 = [3, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 2  3  3  0
 2  2  4  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [2, 2]
Si_comp2 = [3, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 2  3  3  0
 2  2  4  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [2, 2]
Si_comp2 = [3, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 2  3  3  0
 2  2  4  0
rho_tmp = [1, 3, 2, 2, 2]
Si_comp1 = [2, 2]
Si_comp2 = [3, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  3  3  0
 2  2  4  0
rho_tmp = [1, 1, 1, 2, 2]
Si_comp1 = [1, 2]
Si_comp2 = [3, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  3  3  0
 2  2  4  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [2, 2]
Si_comp2 = [3, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  3  3  0
 2  2  4  0
rho_tmp = [1, 1, 3, 2, 2]
Si_comp1 = [3, 2]
Si_comp2 = [3, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  3  3  0
 2  2  4  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [2, 1]
Si_comp2 = [3, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  3  3  0
 2  2  4  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [2, 2]
Si_comp2 = [3, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  3  3  0
 2  2  4  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [2, 3]
Si_comp2 = [3, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  3  3  0
 2  2  4  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [2, 2]
Si_comp2 = [3, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  3  3  0
 2  2  4  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [2, 2]
Si_comp2 = [3, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  3  3  0
 2  2  4  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [2, 2]
Si_comp2 = [3, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 2, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21316540189401498, 0.21316540189401498, 0.5736691962119701]
probh = 0.6297386134356436
sampled gamma:
probh = 0.6297386134356436
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21296489765602558, 0.21296489765602558, 0.5740702046879489]
probh = 0.8208359186092133
sampled gamma:
probh = 0.8208359186092133
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20893297679794065, 0.20893297679794065, 0.5821340464041186]
probh = 0.8236296644905011
sampled gamma:
probh = 0.8236296644905011
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21290484827105935, 0.21290484827105935, 0.5741903034578812]
probh = 0.8208773882026617
sampled gamma:
probh = 0.8208773882026617
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.908954409619434, 4.7237675570867275, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22245943551218425, 0.18485244646254548, 0.5926881180252703]
probh = 0.8143313588068019
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update rho]
movable_units = [1, 5]
Si_iter[:, t] = [1, 2, 3, 3, 2]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  3  1  0
 1  2  2  0
 2  1  3  0
 2  1  3  0
 3  2  4  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = [2, 1]
Si_comp2 = [2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  3  1  0
 1  2  2  0
 2  1  3  0
 2  1  3  0
 3  2  4  0
rho_tmp = [2, 2, 1, 1, 2]
Si_comp1 = [2, 1]
Si_comp2 = [2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  3  1  0
 1  2  2  0
 2  1  3  0
 2  1  3  0
 3  2  4  0
rho_tmp = [3, 2, 1, 1, 2]
Si_comp1 = [2, 1]
Si_comp2 = [2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 2]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  3  3  0
 3  2  4  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [2, 3]
Si_comp2 = [2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  3  3  0
 3  2  4  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [2, 3]
Si_comp2 = [2, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  3  3  0
 3  2  4  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [2, 3]
Si_comp2 = [2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  3  3  0
 3  2  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [2, 3]
Si_comp2 = [2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21316540189401498, 0.21316540189401498, 0.5736691962119701]
probh = 0.9458383637173572
sampled gamma:
probh = 0.9458383637173572
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21296489765602558, 0.21296489765602558, 0.5740702046879489]
probh = 0.9458865515803037
sampled gamma:
probh = 0.9458865515803037
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20893297679794065, 0.20893297679794065, 0.5821340464041186]
probh = 0.8647676571335181
sampled gamma:
probh = 0.8647676571335181
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17553301775860286, 0.17553301775860286, 0.17553301775860286, 0.4734009467241914]
probh = 0.954969531179795
sampled gamma:
probh = 0.954969531179795
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.7202825890277875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18207272735753605, 0.18207272735753605, 0.15076681739057302, 0.4850877278943548]
probh = 0.8847128843972016
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update rho]
movable_units = [5]
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  3  3  0
 3  3  4  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  3  3  0
 3  3  4  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  3  3  0
 3  3  4  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  3  3  0
 3  3  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 3, 1]

▶ iteration 9.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  3  3  0
 3  3  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
muh_iter
5×4 Matrix{Float64}:
 -1.91766   -0.0377796  -1.87048    0.0
 -0.384495   0.144518    0.537512   0.0
  0.455868   0.0        -0.508933   0.0
 -0.938604   0.0         0.0897645  0.0
  0.0        0.0         0.0        0.0
sig2h_iter
5×4 Matrix{Float64}:
 0.17451   0.601271  0.687955  1.0
 0.63188   1.23136   1.05839   1.0
 0.475968  4.35043   0.327251  1.0
 2.74018   1.0       0.503613  1.0
 1.0       1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.15867214495389123
 0.7502486028322598
 0.8966470478221784
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  3  3  0
 3  3  1  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 2, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  3  3  0
 3  3  1  0
rho_tmp = [2, 1, 2, 2, 3]
Si_comp1 = [1, 2, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  3  3  0
 3  3  1  0
rho_tmp = [3, 1, 2, 2, 3]
Si_comp1 = [1, 2, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  3  3  0
 3  3  1  0
rho_tmp = [4, 1, 2, 2, 3]
Si_comp1 = [1, 2, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  3  1  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 3, 3]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  3  1  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [2, 3, 3]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  3  1  0
rho_tmp = [1, 3, 3, 3, 2]
Si_comp1 = [3, 3, 3]
Si_comp2 = [2, 3, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  3  1  0
rho_tmp = [1, 4, 3, 3, 2]
Si_comp1 = [4, 3, 3]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.0, 0.3333333333333333]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  3  1  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = [2, 1, 3]
Si_comp2 = [2, 3, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  3  1  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [2, 2, 3]
Si_comp2 = [2, 3, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  3  1  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [2, 3, 3]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  3  1  0
rho_tmp = [1, 2, 4, 3, 4]
Si_comp1 = [2, 4, 3]
Si_comp2 = [2, 3, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  3  1  0
rho_tmp = [1, 2, 5, 3, 4]
Si_comp1 = [2, 5, 3]
Si_comp2 = [2, 3, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  3  1  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [2, 3, 1]
Si_comp2 = [2, 3, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  3  1  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [2, 3, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  3  1  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [2, 3, 3]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  3  1  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [2, 3, 4]
Si_comp2 = [2, 3, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  3  1  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = [2, 3, 5]
Si_comp2 = [2, 3, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  3  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [2, 3, 3]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  3  1  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [2, 3, 3]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  3  1  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [2, 3, 3]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  3  1  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [2, 3, 3]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1757100899524644, 0.1757100899524644, 0.1757100899524644, 0.4728697301426069]
probh = 0.9447398971888735
sampled gamma:
probh = 0.9447398971888735
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1755738340553516, 0.1755738340553516, 0.1755738340553516, 0.47327849783394516]
probh = 0.9447803828431451
sampled gamma:
probh = 0.9447803828431451
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17282428456152657, 0.17282428456152657, 0.17282428456152657, 0.48152714631542043]
probh = 0.9455980974011006
sampled gamma:
probh = 0.9455980974011006
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17553301775860286, 0.17553301775860286, 0.17553301775860286, 0.4734009467241914]
probh = 0.944792511246706
sampled gamma:
probh = 0.944792511246706
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.7202825890277875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18207272735753605, 0.18207272735753605, 0.15076681739057302, 0.4850877278943548]
probh = 0.9522095592991382
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update rho]
movable_units = [5]
Si_iter[:, t] = [1, 2, 3, 3, 3]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  3  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  3  1  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  3  1  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  3  1  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1757100899524644, 0.1757100899524644, 0.1757100899524644, 0.4728697301426069]
probh = 0.9801486516090604
sampled gamma:
probh = 0.9801486516090604
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1755738340553516, 0.1755738340553516, 0.1755738340553516, 0.47327849783394516]
probh = 0.9801637401501548
sampled gamma:
probh = 0.9801637401501548
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17282428456152657, 0.17282428456152657, 0.17282428456152657, 0.48152714631542043]
probh = 0.9804683157451337
sampled gamma:
probh = 0.9804683157451337
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17553301775860286, 0.17553301775860286, 0.17553301775860286, 0.4734009467241914]
probh = 0.980168260106388
sampled gamma:
probh = 0.980168260106388
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.7202825890277875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18207272735753605, 0.18207272735753605, 0.15076681739057302, 0.4850877278943548]
probh = 0.9794445904982817
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update rho]
movable_units = [5]
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  1  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  1  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  1  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 3]

▶ iteration 10.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
muh_iter
5×4 Matrix{Float64}:
  0.0972846  -0.0377796  -1.87048    0.0
 -1.12919     0.144518    0.537512   0.0
 -0.623411    0.0        -0.508933   0.0
 -0.515344    1.36147     0.0897645  0.0
  0.0         0.0         0.0        0.0
sig2h_iter
5×4 Matrix{Float64}:
   0.249336  1.00932   0.961239  1.0
  11.2798    2.70317   0.881726  1.0
 108.51      8.20847   1.81974   1.0
  45.3408    0.442749  0.503613  1.0
   1.0       1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.13431692568374917
 0.823689207121332
 0.9368098160413708
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  3  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  3  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = [2, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  3  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = [3, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  3  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = [4, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.0, 0.5]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  3  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 1, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  3  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  3  0
rho_tmp = [1, 3, 3, 3, 2]
Si_comp1 = [1, 3, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  3  0
rho_tmp = [1, 4, 3, 3, 2]
Si_comp1 = [1, 4, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.5, 0.0, 0.5]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  3  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = [1, 2, 1, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  3  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [1, 2, 2, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  3  0
rho_tmp = [1, 2, 4, 3, 4]
Si_comp1 = [1, 2, 4, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  3  0
rho_tmp = [1, 2, 5, 3, 4]
Si_comp1 = [1, 2, 5, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  3  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [1, 2, 3, 1]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  3  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [1, 2, 3, 2]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  3  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  3  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = [1, 2, 3, 5]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1757100899524644, 0.1757100899524644, 0.1757100899524644, 0.4728697301426069]
probh = 0.9637525254790303
sampled gamma:
probh = 0.9637525254790303
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1755738340553516, 0.1755738340553516, 0.1755738340553516, 0.47327849783394516]
probh = 0.963779615796609
sampled gamma:
probh = 0.963779615796609
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17282428456152657, 0.17282428456152657, 0.17282428456152657, 0.48152714631542043]
probh = 0.9643266052469146
sampled gamma:
probh = 0.9643266052469146
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17553301775860286, 0.17553301775860286, 0.17553301775860286, 0.4734009467241914]
probh = 0.9637877311652404
sampled gamma:
probh = 0.9637877311652404
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.7202825890277875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18207272735753605, 0.18207272735753605, 0.15076681739057302, 0.4850877278943548]
probh = 0.9059340602125615
sampled gamma:
probh = 0.9059340602125615
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1757100899524644, 0.1757100899524644, 0.1757100899524644, 0.4728697301426069]
probh = 0.9882867380538154
sampled gamma:
probh = 0.9882867380538154
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1755738340553516, 0.1755738340553516, 0.1755738340553516, 0.47327849783394516]
probh = 0.9882957148915378
sampled gamma:
probh = 0.9882957148915378
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17282428456152657, 0.17282428456152657, 0.17282428456152657, 0.48152714631542043]
probh = 0.9884768961049555
sampled gamma:
probh = 0.9884768961049555
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17553301775860286, 0.17553301775860286, 0.17553301775860286, 0.4734009467241914]
probh = 0.9882984039905431
sampled gamma:
probh = 0.9882984039905431
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.7202825890277875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18207272735753605, 0.18207272735753605, 0.15076681739057302, 0.4850877278943548]
probh = 0.9899327777001112
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update rho]
movable_units = [5]
Si_iter[:, t] = [1, 2, 3, 3, 3]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 3, 2]

▶ iteration 11.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
muh_iter
5×4 Matrix{Float64}:
 -1.7963    -0.0377796  -1.87048    0.0
 -1.31516    0.144518    0.537512   0.0
  0.792212   0.0        -0.508933   0.0
  1.06569    1.36147     0.0897645  0.0
  0.0        0.0         0.0        0.0
sig2h_iter
5×4 Matrix{Float64}:
 0.499857   1.05334   0.493974  1.0
 0.308613   0.771593  3.70765   1.0
 0.879473  19.9317    0.601605  1.0
 1.12187    0.522803  0.503613  1.0
 1.0        1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.003749112141169951
 0.8378785695303885
 0.8817092539853139
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  2  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  2  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = [2, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  2  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = [3, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  2  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = [4, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  2  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 1, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  2  0
rho_tmp = [1, 3, 3, 3, 2]
Si_comp1 = [1, 3, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  2  0
rho_tmp = [1, 4, 3, 3, 2]
Si_comp1 = [1, 4, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = [1, 2, 1, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [1, 2, 2, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 4, 3, 4]
Si_comp1 = [1, 2, 4, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 5, 3, 4]
Si_comp1 = [1, 2, 5, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [1, 2, 3, 1, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [1, 2, 3, 2, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = [1, 2, 3, 5, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.710221619849552, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18118400418727781, 0.18118400418727781, 0.1500309028696795, 0.48760108875576486]
probh = 0.9661300324651848
sampled gamma:
probh = 0.9661300324651848
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.708581793473421, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1810391299640017, 0.1810391299640017, 0.14991093857913337, 0.48801080149286324]
probh = 0.9661561982274931
sampled gamma:
probh = 0.9661561982274931
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.675518911604456, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17811716364546443, 0.17811716364546443, 0.14749138036873066, 0.4962742923403405]
probh = 0.9722536682235119
sampled gamma:
probh = 0.9722536682235119
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.708090601410822, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1809957333567639, 0.1809957333567639, 0.1498750036620607, 0.4881335296244116]
probh = 0.9718178940908997
sampled gamma:
probh = 0.9718178940908997
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.7202825890277875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18207272735753605, 0.18207272735753605, 0.15076681739057302, 0.4850877278943548]
probh = 0.9141939382765527
sampled gamma:
probh = 0.9141939382765527
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1757100899524644, 0.1757100899524644, 0.1757100899524644, 0.4728697301426069]
probh = 0.9769695149310841
sampled gamma:
probh = 0.9769695149310841
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1755738340553516, 0.1755738340553516, 0.1755738340553516, 0.47327849783394516]
probh = 0.9769869631242316
sampled gamma:
probh = 0.9769869631242316
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20893297679794065, 0.20893297679794065, 0.5821340464041186]
probh = 0.9727336928492823
sampled gamma:
probh = 0.9727336928492823
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21290484827105935, 0.21290484827105935, 0.5741903034578812]
probh = 0.9722297475222681
sampled gamma:
probh = 0.9722297475222681
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.7237675570867275, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22245943551218425, 0.18485244646254548, 0.5926881180252703]
probh = 0.9263415246911296
sampled gamma:
probh = 0.9263415246911296
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update rho]
movable_units = [2]
Si_iter[:, t] = [1, 2, 3, 3, 2]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 3, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 4, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 3]

▶ iteration 12.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -1.27421    -0.0377796  -1.87048    0.0
  0.44929     0.144518   -0.508933   0.0
  1.00003     0.0         0.537512   0.0
  0.0163849   1.36147     0.0897645  0.0
  0.0         0.0         0.0        0.0
sig2h_iter
5×4 Matrix{Float64}:
  6.98557   1.38883   0.240284  1.0
  7.36514   1.98395   0.857263  1.0
 19.8324   40.3029    1.65727   1.0
  2.87947   0.261643  0.503613  1.0
  1.0       1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.004561654022974133
 0.8840920834764532
 0.8400827762398253
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 1  4  3  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 1  4  3  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = [2, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 1  4  3  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = [3, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 1  4  3  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = [4, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  1  0
 3  3  2  0
 3  3  2  0
 2  4  3  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 1, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  1  0
 3  3  2  0
 3  3  2  0
 2  4  3  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  1  0
 3  3  2  0
 3  3  2  0
 2  4  3  0
rho_tmp = [1, 3, 3, 3, 2]
Si_comp1 = [1, 3, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  1  0
 3  3  2  0
 3  3  2  0
 2  4  3  0
rho_tmp = [1, 4, 3, 3, 2]
Si_comp1 = [1, 4, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = [1, 2, 1, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [1, 2, 2, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 4, 3, 4]
Si_comp1 = [1, 2, 4, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 5, 3, 4]
Si_comp1 = [1, 2, 5, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [1, 2, 3, 1, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [1, 2, 3, 2, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = [1, 2, 3, 5, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.710221619849552, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18118400418727781, 0.18118400418727781, 0.1500309028696795, 0.48760108875576486]
probh = 0.9767972281580374
sampled gamma:
probh = 0.9767972281580374
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.708581793473421, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1810391299640017, 0.1810391299640017, 0.14991093857913337, 0.48801080149286324]
probh = 0.9768153508877265
sampled gamma:
probh = 0.9768153508877265
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.675518911604456, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17811716364546443, 0.17811716364546443, 0.14749138036873066, 0.4962742923403405]
probh = 0.981030120186686
sampled gamma:
probh = 0.981030120186686
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.708090601410822, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1809957333567639, 0.1809957333567639, 0.1498750036620607, 0.4881335296244116]
probh = 0.9807294538691962
sampled gamma:
probh = 0.9807294538691962
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.7202825890277875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18207272735753605, 0.18207272735753605, 0.15076681739057302, 0.4850877278943548]
probh = 0.9402058321691255
sampled gamma:
probh = 0.9402058321691255
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.713706587908492, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22113415318903495, 0.18375120443554996, 0.5951146423754151]
probh = 0.9596055468436663
sampled gamma:
probh = 0.9596055468436663
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2, 2]
Si_red1 = [1, 1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.708581793473421, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.33730732621107673, 0.1557320819729404, 0.5069605918159829]
probh = 0.9396646516107331
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 4.679003879663396, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21658275052886963, 0.17996922092637388, 0.6034480285447565]
probh = 0.9668760441141347
sampled gamma:
probh = 0.9668760441141347
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.8967624220024675, 4.711575569469762, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22085376773264667, 0.18351821841971058, 0.5956280138476426]
probh = 0.9662448878995747
sampled gamma:
probh = 0.9662448878995747
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.7237675570867275, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22245943551218425, 0.18485244646254548, 0.5926881180252703]
probh = 0.8986151384758118
sampled gamma:
probh = 0.8986151384758118
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update rho]
movable_units = [2]
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 3, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 4, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 3]

▶ iteration 13.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -1.80669   -0.0377796  -1.87048    0.0
 -0.720852   0.144518   -0.508933   0.0
 -0.797702   0.0         0.537512   0.0
  1.06666    1.36147     0.0897645  0.0
  0.0        0.0         0.0        0.0
sig2h_iter
5×4 Matrix{Float64}:
 1.90566    0.636489  0.422418  1.0
 0.263089   0.888893  0.674548  1.0
 0.425013  19.6007    0.512019  1.0
 3.75327    0.672282  0.503613  1.0
 1.0        1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.036627713948496524
 0.92216725723933
 0.6701455984034611
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 1  4  3  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 1  4  3  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = [2, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 1  4  3  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = [3, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 1  4  3  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = [4, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  2  0
 3  3  2  0
 2  4  3  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 1, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  2  0
 3  3  2  0
 2  4  3  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  2  0
 3  3  2  0
 2  4  3  0
rho_tmp = [1, 3, 3, 3, 2]
Si_comp1 = [1, 3, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  2  0
 3  3  2  0
 2  4  3  0
rho_tmp = [1, 4, 3, 3, 2]
Si_comp1 = [1, 4, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = [1, 2, 1, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [1, 2, 2, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 4, 3, 4]
Si_comp1 = [1, 2, 4, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 5, 3, 4]
Si_comp1 = [1, 2, 5, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [1, 2, 3, 1, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [1, 2, 3, 2, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = [1, 2, 3, 5, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.710221619849552, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18118400418727781, 0.18118400418727781, 0.1500309028696795, 0.48760108875576486]
probh = 0.9849380430272693
sampled gamma:
probh = 0.9849380430272693
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.708581793473421, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1810391299640017, 0.1810391299640017, 0.14991093857913337, 0.48801080149286324]
probh = 0.9849499052701651
sampled gamma:
probh = 0.9849499052701651
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.675518911604456, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17811716364546443, 0.17811716364546443, 0.14749138036873066, 0.4962742923403405]
probh = 0.9877044967727402
sampled gamma:
probh = 0.9877044967727402
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.708090601410822, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1809957333567639, 0.1809957333567639, 0.1498750036620607, 0.4881335296244116]
probh = 0.987508270104418
sampled gamma:
probh = 0.987508270104418
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.7202825890277875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18207272735753605, 0.18207272735753605, 0.15076681739057302, 0.4850877278943548]
probh = 0.9606679809783365
sampled gamma:
probh = 0.9606679809783365
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.862189152254271, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.49332819449865906, 0.5066718055013409]
probh = 0.8003902900353231
sampled gamma:
probh = 0.8003902900353231
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.718274301421629, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22066614769055493, 0.18450408474359833, 0.5948297675658467]
probh = 0.9167454701869017
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 4.679003879663396, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21658275052886963, 0.17996922092637388, 0.6034480285447565]
probh = 0.9186252393035177
sampled gamma:
probh = 0.9186252393035177
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.8967624220024675, 4.711575569469762, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22085376773264667, 0.18351821841971058, 0.5956280138476426]
probh = 0.917153471849867
sampled gamma:
probh = 0.917153471849867
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.7237675570867275, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22245943551218425, 0.18485244646254548, 0.5926881180252703]
probh = 0.7741562971154156
sampled gamma:
probh = 0.7741562971154156
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update rho]
movable_units = [2]
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 3, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 4, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 3]

▶ iteration 14.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.250725  -0.0377796  -1.87048    0.0
  0.279654   0.144518   -0.508933   0.0
 -0.689054   0.0         0.537512   0.0
  0.714473   1.36147     0.0897645  0.0
  0.0        0.0         0.0        0.0
sig2h_iter
5×4 Matrix{Float64}:
  1.28675   1.34557   0.666833  1.0
 15.6912    0.54367   1.03189   1.0
 53.3809   32.5835    0.466593  1.0
 15.898     0.328385  0.503613  1.0
  1.0       1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.01904421920811461
 0.7615286002773075
 0.5932565370470534
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 1  4  3  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 1  4  3  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = [2, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 1  4  3  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = [3, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 1  4  3  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = [4, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  2  0
 3  3  2  0
 2  4  3  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 1, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  2  0
 3  3  2  0
 2  4  3  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  2  0
 3  3  2  0
 2  4  3  0
rho_tmp = [1, 3, 3, 3, 2]
Si_comp1 = [1, 3, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  2  0
 3  3  2  0
 2  4  3  0
rho_tmp = [1, 4, 3, 3, 2]
Si_comp1 = [1, 4, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = [1, 2, 1, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [1, 2, 2, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 4, 3, 4]
Si_comp1 = [1, 2, 4, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 5, 3, 4]
Si_comp1 = [1, 2, 5, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [1, 2, 3, 1, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [1, 2, 3, 2, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = [1, 2, 3, 5, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.710221619849552, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18118400418727781, 0.18118400418727781, 0.1500309028696795, 0.48760108875576486]
probh = 0.9463088346444539
sampled gamma:
probh = 0.9463088346444539
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.708581793473421, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1810391299640017, 0.1810391299640017, 0.14991093857913337, 0.48801080149286324]
probh = 0.9463494626625656
sampled gamma:
probh = 0.9463494626625656
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.675518911604456, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17811716364546443, 0.17811716364546443, 0.14749138036873066, 0.4962742923403405]
probh = 0.9558523554514501
sampled gamma:
probh = 0.9558523554514501
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.708090601410822, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1809957333567639, 0.1809957333567639, 0.1498750036620607, 0.4881335296244116]
probh = 0.9551708652985891
sampled gamma:
probh = 0.9551708652985891
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.7202825890277875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18207272735753605, 0.18207272735753605, 0.15076681739057302, 0.4850877278943548]
probh = 0.8681275937826092
sampled gamma:
probh = 0.8681275937826092
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.862189152254271, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.49332819449865906, 0.5066718055013409]
probh = 0.7421811321771667
sampled gamma:
probh = 0.7421811321771667
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.718274301421629, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22066614769055493, 0.18450408474359833, 0.5948297675658467]
probh = 0.8877067716383862
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 4.679003879663396, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21658275052886963, 0.17996922092637388, 0.6034480285447565]
probh = 0.8901636388377437
sampled gamma:
probh = 0.8901636388377437
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.8967624220024675, 4.711575569469762, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22085376773264667, 0.18351821841971058, 0.5956280138476426]
probh = 0.888239733104946
sampled gamma:
probh = 0.888239733104946
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.7237675570867275, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22245943551218425, 0.18485244646254548, 0.5926881180252703]
probh = 0.7110586516059167
sampled gamma:
probh = 0.7110586516059167
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update rho]
movable_units = [2]
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 3, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  3  2  0
 4  4  3  0
rho_tmp = [1, 4, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 2]

▶ iteration 15.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.868232  -0.0377796  -1.87048    0.0
 -1.40114    0.144518    0.537512   0.0
 -0.307952   0.0        -0.508933   0.0
  0.759761   1.36147     0.0897645  0.0
  0.0        0.0         0.0        0.0
sig2h_iter
5×4 Matrix{Float64}:
  2.11189   0.647954  0.841663  1.0
  1.06577   1.26347   1.15757   1.0
 15.6445   12.3278    0.628473  1.0
  3.25222   0.697035  0.503613  1.0
  1.0       1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.052429180586319124
 0.9394859826577682
 0.5465789469960146
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  2  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  2  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = [2, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  2  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = [3, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  2  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = [4, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  2  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 1, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  2  0
rho_tmp = [1, 3, 3, 3, 2]
Si_comp1 = [1, 3, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  2  0
rho_tmp = [1, 4, 3, 3, 2]
Si_comp1 = [1, 4, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = [1, 2, 1, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [1, 2, 2, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 4, 3, 4]
Si_comp1 = [1, 2, 4, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 5, 3, 4]
Si_comp1 = [1, 2, 5, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [1, 2, 3, 1, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [1, 2, 3, 2, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = [1, 2, 3, 5, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.710221619849552, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18118400418727781, 0.18118400418727781, 0.1500309028696795, 0.48760108875576486]
probh = 0.9884642325343191
sampled gamma:
probh = 0.9884642325343191
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.708581793473421, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1810391299640017, 0.1810391299640017, 0.14991093857913337, 0.48801080149286324]
probh = 0.9884733501802958
sampled gamma:
probh = 0.9884733501802958
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.675518911604456, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17811716364546443, 0.17811716364546443, 0.14749138036873066, 0.4962742923403405]
probh = 0.99058921361356
sampled gamma:
probh = 0.99058921361356
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.708090601410822, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1809957333567639, 0.1809957333567639, 0.1498750036620607, 0.4881335296244116]
probh = 0.9904385791155099
sampled gamma:
probh = 0.9904385791155099
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.7202825890277875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18207272735753605, 0.18207272735753605, 0.15076681739057302, 0.4850877278943548]
probh = 0.9697013033039112
sampled gamma:
probh = 0.9697013033039112
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.898893440441198, 4.713706587908492, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22113415318903495, 0.18375120443554996, 0.5951146423754151]
probh = 0.6694854614731336
sampled gamma:
probh = 0.6694854614731336
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 4.712066761532361, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22091838545704606, 0.1835719124534681, 0.5955097020894858]
probh = 0.8451188903596408
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.44837626606234, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.39162143252303233, 0.6083785674769677]
probh = 0.7547886389814575
sampled gamma:
probh = 0.7547886389814575
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4809479558687055, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.39940857143489605, 0.600591428565104]
probh = 0.7511262455592943
sampled gamma:
probh = 0.7511262455592943
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.40233675694331344, 0.5976632430566866]
probh = 0.6685391837994034
sampled gamma:
probh = 0.6685391837994034
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update rho]
movable_units = [1, 2]
Si_iter[:, t] = [1, 2, 3, 3, 2]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  3  0
 2  2  2  0
 3  3  1  0
 3  3  1  0
 4  4  2  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  3  0
 2  2  2  0
 3  3  1  0
 3  3  1  0
 4  4  2  0
rho_tmp = [2, 2, 1, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  3  0
 2  2  2  0
 3  3  1  0
 3  3  1  0
 4  4  2  0
rho_tmp = [3, 2, 1, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 2]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 3, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 4, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 3, 2]

▶ iteration 16.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
  0.68039   -0.0377796  -0.026172   0.0
 -1.33532    0.144518    0.537512   0.0
  0.589196   0.0        -0.508933   0.0
 -0.550233   1.36147     0.0897645  0.0
  0.0        0.0         0.0        0.0
sig2h_iter
5×4 Matrix{Float64}:
  0.319056  0.710325  0.972277  1.0
  0.915374  0.57818   1.5188    1.0
 15.0077    7.63531   0.684212  1.0
  0.396538  0.286181  0.503613  1.0
  1.0       1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.14858928144496117
 0.979245401332515
 0.6851868197196399
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  2  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  2  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = [2, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  2  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = [3, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  2  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = [4, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  2  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 1, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  2  0
rho_tmp = [1, 3, 3, 3, 2]
Si_comp1 = [1, 3, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  2  0
rho_tmp = [1, 4, 3, 3, 2]
Si_comp1 = [1, 4, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = [1, 2, 1, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [1, 2, 2, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 4, 3, 4]
Si_comp1 = [1, 2, 4, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 5, 3, 4]
Si_comp1 = [1, 2, 5, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [1, 2, 3, 1, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [1, 2, 3, 2, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = [1, 2, 3, 5, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.710221619849552, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18118400418727781, 0.18118400418727781, 0.1500309028696795, 0.48760108875576486]
probh = 0.9961745889171402
sampled gamma:
probh = 0.9961745889171402
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.708581793473421, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1810391299640017, 0.1810391299640017, 0.14991093857913337, 0.48801080149286324]
probh = 0.9961776360133475
sampled gamma:
probh = 0.9961776360133475
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.675518911604456, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17811716364546443, 0.17811716364546443, 0.14749138036873066, 0.4962742923403405]
probh = 0.996883738093704
sampled gamma:
probh = 0.996883738093704
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.708090601410822, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1809957333567639, 0.1809957333567639, 0.1498750036620607, 0.4881335296244116]
probh = 0.9968335353363127
sampled gamma:
probh = 0.9968335353363127
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.7202825890277875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18207272735753605, 0.18207272735753605, 0.15076681739057302, 0.4850877278943548]
probh = 0.9898234440962648
sampled gamma:
probh = 0.9898234440962648
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.898893440441198, 4.713706587908492, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22113415318903495, 0.18375120443554996, 0.5951146423754151]
probh = 0.7852813276102986
sampled gamma:
probh = 0.7852813276102986
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.708581793473421, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1810391299640017, 0.1810391299640017, 0.14991093857913337, 0.48801080149286324]
probh = 0.9232080096739602
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 4.679003879663396, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21658275052886963, 0.17996922092637388, 0.6034480285447565]
probh = 0.9236271766207318
sampled gamma:
probh = 0.9236271766207318
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.8967624220024675, 4.711575569469762, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22085376773264667, 0.18351821841971058, 0.5956280138476426]
probh = 0.9222382176485618
sampled gamma:
probh = 0.9222382176485618
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.7237675570867275, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22245943551218425, 0.18485244646254548, 0.5926881180252703]
probh = 0.7859694401804335
sampled gamma:
probh = 0.7859694401804335
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update rho]
movable_units = [2]
Si_iter[:, t] = [1, 2, 3, 3, 2]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 3, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 4, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 3, 2]

▶ iteration 17.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
  0.12283   -0.0377796  -0.026172   0.0
 -0.174202   0.144518    0.537512   0.0
  1.45004    0.0        -0.508933   0.0
 -0.451346   1.36147     0.0897645  0.0
  0.0        0.0         0.0        0.0
sig2h_iter
5×4 Matrix{Float64}:
   0.400616  0.854605  0.390787  1.0
   0.733186  0.528836  0.896543  1.0
 105.868     8.82489   1.01101   1.0
   3.23822   0.396514  0.503613  1.0
   1.0       1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.041665111035262915
 0.8340801113625466
 0.7754777304798619
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  2  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  2  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = [2, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  2  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = [3, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  2  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = [4, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  2  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 1, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  2  0
rho_tmp = [1, 3, 3, 3, 2]
Si_comp1 = [1, 3, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  2  0
rho_tmp = [1, 4, 3, 3, 2]
Si_comp1 = [1, 4, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = [1, 2, 1, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [1, 2, 2, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 4, 3, 4]
Si_comp1 = [1, 2, 4, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 5, 3, 4]
Si_comp1 = [1, 2, 5, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [1, 2, 3, 1, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [1, 2, 3, 2, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = [1, 2, 3, 5, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.710221619849552, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18118400418727781, 0.18118400418727781, 0.1500309028696795, 0.48760108875576486]
probh = 0.9652117072345527
sampled gamma:
probh = 0.9652117072345527
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.708581793473421, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1810391299640017, 0.1810391299640017, 0.14991093857913337, 0.48801080149286324]
probh = 0.9652385569102923
sampled gamma:
probh = 0.9652385569102923
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.675518911604456, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17811716364546443, 0.17811716364546443, 0.14749138036873066, 0.4962742923403405]
probh = 0.9714964763225247
sampled gamma:
probh = 0.9714964763225247
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.708090601410822, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1809957333567639, 0.1809957333567639, 0.1498750036620607, 0.4881335296244116]
probh = 0.9710491641143133
sampled gamma:
probh = 0.9710491641143133
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.7202825890277875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18207272735753605, 0.18207272735753605, 0.15076681739057302, 0.4850877278943548]
probh = 0.9119957244913345
sampled gamma:
probh = 0.9119957244913345
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.898893440441198, 4.713706587908492, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22113415318903495, 0.18375120443554996, 0.5951146423754151]
probh = 0.8530223962472879
sampled gamma:
probh = 0.8530223962472879
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.708581793473421, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1810391299640017, 0.1810391299640017, 0.14991093857913337, 0.48801080149286324]
probh = 0.9501947446775695
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 4.679003879663396, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21658275052886963, 0.17996922092637388, 0.6034480285447565]
probh = 0.9504745075293248
sampled gamma:
probh = 0.9504745075293248
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21290484827105935, 0.21290484827105935, 0.5741903034578812]
probh = 0.941937248131621
sampled gamma:
probh = 0.941937248131621
gt = true
gamma_iter[:, t] = Bool[1, 0, 0, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21439662402037066, 0.21439662402037066, 0.5712067519592587]
probh = 0.8580890842324912
sampled gamma:
probh = 0.8580890842324912
gt = true
gamma_iter[:, t] = Bool[1, 0, 0, 1, 1]
												[update rho]
movable_units = [2, 3]
Si_iter[:, t] = [1, 2, 3, 3, 2]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 3, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  2  0
rho_tmp = [1, 4, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 4, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 5, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]

▶ iteration 18.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.0687479  -0.0377796  -0.026172  0.0
 -1.71019     0.144518    0.167358  0.0
  0.528697    0.0        -0.508933  0.0
 -0.324155    1.36147     0.537512  0.0
  0.0         0.0         0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
   0.646904  0.242729  0.798011  1.0
   6.32402   1.13102   0.54247   1.0
 103.029     7.28812   0.39409   1.0
   0.247075  0.321488  1.63177   1.0
   1.0       1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.06050743824389943
 0.8865661435241661
 0.683673687758589
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  4  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  4  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = [2, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  4  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = [3, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  4  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = [4, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  4  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 1, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  4  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  4  0
rho_tmp = [1, 3, 3, 3, 2]
Si_comp1 = [1, 3, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  4  0
rho_tmp = [1, 4, 3, 3, 2]
Si_comp1 = [1, 4, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = [1, 2, 1, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [1, 2, 2, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 4, 3, 4]
Si_comp1 = [1, 2, 4, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 5, 3, 4]
Si_comp1 = [1, 2, 5, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [1, 2, 3, 1, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [1, 2, 3, 2, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = [1, 2, 3, 5, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.710221619849552, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18118400418727781, 0.18118400418727781, 0.1500309028696795, 0.48760108875576486]
probh = 0.9773432034147947
sampled gamma:
probh = 0.9773432034147947
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.708581793473421, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1810391299640017, 0.1810391299640017, 0.14991093857913337, 0.48801080149286324]
probh = 0.9773609095892032
sampled gamma:
probh = 0.9773609095892032
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.675518911604456, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17811716364546443, 0.17811716364546443, 0.14749138036873066, 0.4962742923403405]
probh = 0.9814783815544654
sampled gamma:
probh = 0.9814783815544654
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.708090601410822, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1809957333567639, 0.1809957333567639, 0.1498750036620607, 0.4881335296244116]
probh = 0.9811846837674539
sampled gamma:
probh = 0.9811846837674539
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.7202825890277875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18207272735753605, 0.18207272735753605, 0.15076681739057302, 0.4850877278943548]
probh = 0.9415613131445713
sampled gamma:
probh = 0.9415613131445713
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.4830789743074355, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.39991987245586275, 0.6000801275441373]
probh = 0.7826877399711504
sampled gamma:
probh = 0.7826877399711504
gt = true
gamma_iter[:, t] = Bool[1, 0, 0, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.897253614065066, 4.712066761532361, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22091838545704606, 0.1835719124534681, 0.5955097020894858]
probh = 0.7839853361355408
sampled gamma:
probh = 0.7839853361355408
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.675518911604456, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17811716364546443, 0.17811716364546443, 0.14749138036873066, 0.4962742923403405]
probh = 0.9361172861140995
sampled gamma:
probh = 0.9361172861140995
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.708090601410822, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1809957333567639, 0.1809957333567639, 0.1498750036620607, 0.4881335296244116]
probh = 0.9351518212742825
sampled gamma:
probh = 0.9351518212742825
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.7202825890277875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18207272735753605, 0.18207272735753605, 0.15076681739057302, 0.4850877278943548]
probh = 0.81669764538062
sampled gamma:
probh = 0.81669764538062
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 3, 4]

▶ iteration 19.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.476001   -0.0377796  -0.026172  0.0
 -0.578817    0.144518    0.167358  0.0
 -0.0565272   0.0        -0.508933  0.0
 -0.654341    1.36147     0.537512  0.0
  0.0         0.0         0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
    0.42735    0.643674  0.600753  1.0
    0.585832   0.773228  0.231863  1.0
 2394.15      11.5853    0.828966  1.0
    0.149324   0.190117  1.38307   1.0
    1.0        1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.21778787999188748
 0.8270837045596624
 0.7592279002474975
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  4  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  4  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = [2, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  4  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = [3, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  4  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = [4, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  4  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 1, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  4  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  4  0
rho_tmp = [1, 3, 3, 3, 2]
Si_comp1 = [1, 3, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  4  0
rho_tmp = [1, 4, 3, 3, 2]
Si_comp1 = [1, 4, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = [1, 2, 1, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [1, 2, 2, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 4, 3, 4]
Si_comp1 = [1, 2, 4, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 5, 3, 4]
Si_comp1 = [1, 2, 5, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [1, 2, 3, 1, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [1, 2, 3, 2, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = [1, 2, 3, 5, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.710221619849552, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18118400418727781, 0.18118400418727781, 0.1500309028696795, 0.48760108875576486]
probh = 0.9635028206194035
sampled gamma:
probh = 0.9635028206194035
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.708581793473421, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1810391299640017, 0.1810391299640017, 0.14991093857913337, 0.48801080149286324]
probh = 0.963530939383864
sampled gamma:
probh = 0.963530939383864
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.675518911604456, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17811716364546443, 0.17811716364546443, 0.14749138036873066, 0.4962742923403405]
probh = 0.9700867452767126
sampled gamma:
probh = 0.9700867452767126
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.708090601410822, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1809957333567639, 0.1809957333567639, 0.1498750036620607, 0.4881335296244116]
probh = 0.969618001710633
sampled gamma:
probh = 0.969618001710633
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.7202825890277875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18207272735753605, 0.18207272735753605, 0.15076681739057302, 0.4850877278943548]
probh = 0.9079221139323685
sampled gamma:
probh = 0.9079221139323685
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.710221619849552, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18118400418727781, 0.18118400418727781, 0.1500309028696795, 0.48760108875576486]
probh = 0.9456636395462072
sampled gamma:
probh = 0.9456636395462072
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.708581793473421, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1810391299640017, 0.1810391299640017, 0.14991093857913337, 0.48801080149286324]
probh = 0.9457047277704806
sampled gamma:
probh = 0.9457047277704806
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.675518911604456, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17811716364546443, 0.17811716364546443, 0.14749138036873066, 0.4962742923403405]
probh = 0.9553164276075953
sampled gamma:
probh = 0.9553164276075953
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.708090601410822, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1809957333567639, 0.1809957333567639, 0.1498750036620607, 0.4881335296244116]
probh = 0.9546270572466722
sampled gamma:
probh = 0.9546270572466722
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.7202825890277875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18207272735753605, 0.18207272735753605, 0.15076681739057302, 0.4850877278943548]
probh = 0.8666752752618564
sampled gamma:
probh = 0.8666752752618564
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 3, 4]

▶ iteration 20.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.612256  -0.0377796  -0.026172  0.0
 -1.19353    0.144518    0.167358  0.0
  0.74778    0.0        -0.508933  0.0
 -0.797474   1.36147     0.537512  0.0
  0.0        0.0         0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 0.318178   0.387518  0.740172  1.0
 1.71926    0.241992  0.545354  1.0
 8.82811e5  5.69628   0.80408   1.0
 0.169159   0.235878  3.07851   1.0
 1.0        1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.20625885831778676
 0.9292081063643479
 0.9904660396741067
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  4  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  4  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = [2, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  4  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = [3, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  4  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = [4, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  4  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 1, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  4  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  4  0
rho_tmp = [1, 3, 3, 3, 2]
Si_comp1 = [1, 3, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  4  0
rho_tmp = [1, 4, 3, 3, 2]
Si_comp1 = [1, 4, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = [1, 2, 1, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [1, 2, 2, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 4, 3, 4]
Si_comp1 = [1, 2, 4, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 5, 3, 4]
Si_comp1 = [1, 2, 5, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [1, 2, 3, 1, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [1, 2, 3, 2, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = [1, 2, 3, 5, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.710221619849552, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18118400418727781, 0.18118400418727781, 0.1500309028696795, 0.48760108875576486]
probh = 0.9863844060617137
sampled gamma:
probh = 0.9863844060617137
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.708581793473421, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1810391299640017, 0.1810391299640017, 0.14991093857913337, 0.48801080149286324]
probh = 0.9863951449366338
sampled gamma:
probh = 0.9863951449366338
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.675518911604456, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17811716364546443, 0.17811716364546443, 0.14749138036873066, 0.4962742923403405]
probh = 0.9888882010490999
sampled gamma:
probh = 0.9888882010490999
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.708090601410822, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1809957333567639, 0.1809957333567639, 0.1498750036620607, 0.4881335296244116]
probh = 0.9887106494583822
sampled gamma:
probh = 0.9887106494583822
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.7202825890277875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18207272735753605, 0.18207272735753605, 0.15076681739057302, 0.4850877278943548]
probh = 0.9643606077655568
sampled gamma:
probh = 0.9643606077655568
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.710221619849552, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18118400418727781, 0.18118400418727781, 0.1500309028696795, 0.48760108875576486]
probh = 0.9982590077331625
sampled gamma:
probh = 0.9982590077331625
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.708581793473421, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1810391299640017, 0.1810391299640017, 0.14991093857913337, 0.48801080149286324]
probh = 0.9982603974040245
sampled gamma:
probh = 0.9982603974040245
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.675518911604456, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17811716364546443, 0.17811716364546443, 0.14749138036873066, 0.4962742923403405]
probh = 0.9985823002749226
sampled gamma:
probh = 0.9985823002749226
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.708090601410822, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1809957333567639, 0.1809957333567639, 0.1498750036620607, 0.4881335296244116]
probh = 0.9985594216905094
sampled gamma:
probh = 0.9985594216905094
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.7202825890277875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18207272735753605, 0.18207272735753605, 0.15076681739057302, 0.4850877278943548]
probh = 0.9953523769542529
sampled gamma:
probh = 0.9953523769542529
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 3, 4]

▶ iteration 21.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.474036  -0.0377796  -0.026172  0.0
 -1.14306    0.144518    0.167358  0.0
  0.284642   0.0        -0.508933  0.0
 -0.261774   1.36147     0.537512  0.0
  0.0        0.0         0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 2.06168    0.855977  0.392509  1.0
 0.1422     1.23059   0.566981  1.0
 1.40887e8  7.34099   0.927852  1.0
 0.140058   0.208627  0.731361  1.0
 1.0        1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.07858260028742993
 0.9349866412829317
 0.8647599591815818
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  4  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  4  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = [2, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  4  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = [3, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  4  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = [4, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  4  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 1, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  4  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  4  0
rho_tmp = [1, 3, 3, 3, 2]
Si_comp1 = [1, 3, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  4  0
rho_tmp = [1, 4, 3, 3, 2]
Si_comp1 = [1, 4, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = [1, 2, 1, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [1, 2, 2, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 4, 3, 4]
Si_comp1 = [1, 2, 4, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 5, 3, 4]
Si_comp1 = [1, 2, 5, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [1, 2, 3, 1, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [1, 2, 3, 2, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = [1, 2, 3, 5, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.710221619849552, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18118400418727781, 0.18118400418727781, 0.1500309028696795, 0.48760108875576486]
probh = 0.9875582980535428
sampled gamma:
probh = 0.9875582980535428
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.708581793473421, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1810391299640017, 0.1810391299640017, 0.14991093857913337, 0.48801080149286324]
probh = 0.9875681227269728
sampled gamma:
probh = 0.9875681227269728
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.675518911604456, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17811716364546443, 0.17811716364546443, 0.14749138036873066, 0.4962742923403405]
probh = 0.9898484456787334
sampled gamma:
probh = 0.9898484456787334
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.708090601410822, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1809957333567639, 0.1809957333567639, 0.1498750036620607, 0.4881335296244116]
probh = 0.9896860774756835
sampled gamma:
probh = 0.9896860774756835
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.7202825890277875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18207272735753605, 0.18207272735753605, 0.15076681739057302, 0.4850877278943548]
probh = 0.9673705068741911
sampled gamma:
probh = 0.9673705068741911
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.710221619849552, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18118400418727781, 0.18118400418727781, 0.1500309028696795, 0.48760108875576486]
probh = 0.9724453574531182
sampled gamma:
probh = 0.9724453574531182
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.708581793473421, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1810391299640017, 0.1810391299640017, 0.14991093857913337, 0.48801080149286324]
probh = 0.9724667834395094
sampled gamma:
probh = 0.9724667834395094
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.675518911604456, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17811716364546443, 0.17811716364546443, 0.14749138036873066, 0.4962742923403405]
probh = 0.9774538383024701
sampled gamma:
probh = 0.9774538383024701
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.708090601410822, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1809957333567639, 0.1809957333567639, 0.1498750036620607, 0.4881335296244116]
probh = 0.9770978123648032
sampled gamma:
probh = 0.9770978123648032
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.7202825890277875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18207272735753605, 0.18207272735753605, 0.15076681739057302, 0.4850877278943548]
probh = 0.929486375785792
sampled gamma:
probh = 0.929486375785792
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update rho]
movable_units = [5]
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]

▶ iteration 22.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
muh_iter
5×4 Matrix{Float64}:
 -0.670049   -0.0377796  -0.026172  0.0
 -0.627046    0.144518    0.167358  0.0
 -0.0463063   0.0        -0.508933  0.0
 -0.499018    1.36147     0.278299  0.0
  0.0         0.0         0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 0.294936     0.649723  0.665723  1.0
 0.570159     1.35602   0.400953  1.0
 2.94398e10  14.7064    0.484757  1.0
 1.20295      0.348153  0.537405  1.0
 1.0          1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.03698597081094278
 0.7331678988914863
 0.47542105338623447
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  4  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  4  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = [2, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  4  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = [3, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 1  4  4  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = [4, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  4  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 1, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  4  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  4  0
rho_tmp = [1, 3, 3, 3, 2]
Si_comp1 = [1, 3, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  3  3  0
 2  4  4  0
rho_tmp = [1, 4, 3, 3, 2]
Si_comp1 = [1, 4, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = [1, 2, 1, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [1, 2, 2, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 4, 3, 4]
Si_comp1 = [1, 2, 4, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 5, 3, 4]
Si_comp1 = [1, 2, 5, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [1, 2, 3, 1, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [1, 2, 3, 2, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = [1, 2, 3, 5, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3, 1]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3, 2]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3, 4]
Si_comp2 = [1, 2, 3, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.710221619849552, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18118400418727781, 0.18118400418727781, 0.1500309028696795, 0.48760108875576486]
probh = 0.9381383662859133
sampled gamma:
probh = 0.9381383662859133
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.708581793473421, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1810391299640017, 0.1810391299640017, 0.14991093857913337, 0.48801080149286324]
probh = 0.9381847730228488
sampled gamma:
probh = 0.9381847730228488
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.675518911604456, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17811716364546443, 0.17811716364546443, 0.14749138036873066, 0.4962742923403405]
probh = 0.9490559919723686
sampled gamma:
probh = 0.9490559919723686
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.708090601410822, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1809957333567639, 0.1809957333567639, 0.1498750036620607, 0.4881335296244116]
probh = 0.94827526620396
sampled gamma:
probh = 0.94827526620396
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.7202825890277875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18207272735753605, 0.18207272735753605, 0.15076681739057302, 0.4850877278943548]
probh = 0.8499463877667062
sampled gamma:
probh = 0.8499463877667062
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update rho]
movable_units = [5]
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  4  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 3, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1757100899524644, 0.1757100899524644, 0.1757100899524644, 0.4728697301426069]
probh = 0.8376063294266345
sampled gamma:
probh = 0.8376063294266345
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21296489765602558, 0.21296489765602558, 0.5740702046879489]
probh = 0.8097263160821141
sampled gamma:
probh = 0.8097263160821141
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20893297679794065, 0.20893297679794065, 0.5821340464041186]
probh = 0.8126537577324706
sampled gamma:
probh = 0.8126537577324706
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21290484827105935, 0.21290484827105935, 0.5741903034578812]
probh = 0.8097697611839486
sampled gamma:
probh = 0.8097697611839486
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.7237675570867275, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22245943551218425, 0.18485244646254548, 0.5926881180252703]
probh = 0.6046054245161044
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update rho]
movable_units = [1, 5]
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  2  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  2  1  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  2  1  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 2  2  2  0
 3  3  3  0
 3  3  3  0
 4  2  1  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 4  2  3  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 4  2  3  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 4  2  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 2, 3]

▶ iteration 23.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 4  2  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
muh_iter
5×4 Matrix{Float64}:
 -1.19654    -0.0377796   0.167358  0.0
 -0.376782    0.144518   -0.508933  0.0
 -1.15302     0.0        -1.20695   0.0
 -2.99091e6   1.36147    -0.026172  0.0
  0.0         0.0         0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 0.315328   2.44557   0.62714   1.0
 0.354422   0.784973  0.668255  1.0
 9.01201e9  6.91354   0.37934   1.0
 0.236985   0.348153  0.665723  1.0
 1.0        1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.24298603526460813
 0.646936569144726
 0.4233094003671742
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 1  2  3  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 1  2  3  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = [2, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 1  2  3  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = [3, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 1  2  3  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = [4, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.0, 0.5]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  1  0
 2  3  2  0
 2  3  2  0
 1  2  3  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 2]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  1  0
 2  3  2  0
 2  3  2  0
 1  2  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  1  0
 2  3  2  0
 2  3  2  0
 1  2  3  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 2]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 1.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 1  2  3  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [1, 2, 1, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 1  2  3  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 1  2  3  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 1  2  3  0
rho_tmp = [1, 2, 4, 3, 1]
Si_comp1 = [1, 2, 4, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 1  2  3  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = [1, 2, 3, 1]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 1  2  3  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 3, 2]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 1  2  3  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 1  2  3  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [1, 2, 3, 4]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 1  2  3  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 1  2  3  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 1  2  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  2  0
 1  2  3  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 3, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1757100899524644, 0.1757100899524644, 0.1757100899524644, 0.4728697301426069]
probh = 0.912497691359256
sampled gamma:
probh = 0.912497691359256
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21296489765602558, 0.21296489765602558, 0.5740702046879489]
probh = 0.895876833224292
sampled gamma:
probh = 0.895876833224292
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2641153918314374, 0.7358846081685626]
probh = 0.8740188555492666
sampled gamma:
probh = 0.8740188555492666
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27049442218439607, 0.7295055778156039]
probh = 0.871367500648693
sampled gamma:
probh = 0.871367500648693
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.40233675694331344, 0.5976632430566866]
probh = 0.7540496154456757
sampled gamma:
probh = 0.7540496154456757
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update rho]
movable_units = [1, 2]
Si_iter[:, t] = [1, 2, 3, 3, 2]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  3  1  0
 2  2  1  0
 3  1  2  0
 3  1  2  0
 1  2  3  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = [2, 1, 1]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  3  1  0
 2  2  1  0
 3  1  2  0
 3  1  2  0
 1  2  3  0
rho_tmp = [2, 2, 1, 1, 2]
Si_comp1 = [2, 1, 1]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  3  1  0
 2  2  1  0
 3  1  2  0
 3  1  2  0
 1  2  3  0
rho_tmp = [3, 2, 1, 1, 2]
Si_comp1 = [2, 1, 1]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 1, 2]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  1  2  0
 1  2  3  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 1, 1]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  1  2  0
 1  2  3  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = [2, 1, 1]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  1  2  0
 1  2  3  0
rho_tmp = [1, 3, 1, 1, 2]
Si_comp1 = [3, 1, 1]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.5, 0.5]
new_label = 3
Si_iter[:, t] = [1, 2, 1, 1, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3270046287595133, 0.18232463230342916, 0.49067073893705765]
probh = 0.691806488824855
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21296489765602558, 0.21296489765602558, 0.5740702046879489]
probh = 0.7751155466385183
sampled gamma:
probh = 0.7751155466385183
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20893297679794065, 0.20893297679794065, 0.5821340464041186]
probh = 0.778429778186522
sampled gamma:
probh = 0.778429778186522
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27049442218439607, 0.7295055778156039]
probh = 0.5015464249123015
sampled gamma:
probh = 0.5015464249123015
gt = true
gamma_iter[:, t] = Bool[0, 1, 0, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21439662402037066, 0.21439662402037066, 0.5712067519592587]
probh = 0.5623737679485578
sampled gamma:
probh = 0.5623737679485578
gt = true
gamma_iter[:, t] = Bool[0, 1, 0, 1, 1]
												[update rho]
movable_units = [1, 3]
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  1  2  0
 1  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  1  2  0
 1  3  3  0
rho_tmp = [2, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  1  2  0
 1  3  3  0
rho_tmp = [3, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  1  2  0
 1  3  3  0
rho_tmp = [4, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  1  2  0
 1  3  3  0
rho_tmp = [1, 1, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  1  2  0
 1  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  1  2  0
 1  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  1  2  0
 1  3  3  0
rho_tmp = [1, 1, 4, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 3]

▶ iteration 24.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  1  0
 3  1  2  0
 1  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.969938   0.0        0.167358  0.0
  0.0916972  0.596814  -0.508933  0.0
 -1.51018    0.144518  -1.20695   0.0
 -1.19654    1.36147   -0.026172  0.0
  0.0        0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 5.46251e13  5.95533   1.96033   1.0
 6.82257     0.847568  1.27804   1.0
 9.9546e11   0.476497  0.477461  1.0
 0.315328    0.348153  0.665723  1.0
 1.0         1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.021313899926914546
 0.9135549794659577
 0.5789371165397827
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  1  0
 3  1  2  0
 1  3  3  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [3, 3, 1]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  1  0
 3  1  2  0
 1  3  3  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = [3, 3, 1]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  1  0
 3  1  2  0
 1  3  3  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = [3, 3, 1]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  1  0
 3  1  2  0
 1  3  3  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = [3, 3, 1]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  1  0
 2  1  1  0
 2  1  2  0
 1  3  3  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [2, 2, 1]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  1  0
 2  1  1  0
 2  1  2  0
 1  3  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 2, 1]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  1  0
 2  1  1  0
 2  1  2  0
 1  3  3  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [2, 2, 1]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  1  1  0
 2  1  2  0
 1  3  3  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  1  1  0
 2  1  2  0
 1  3  3  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [2, 2, 1]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  1  1  0
 2  1  2  0
 1  3  3  0
rho_tmp = [1, 1, 3, 2, 1]
Si_comp1 = [3, 2, 1]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  1  1  0
 2  1  2  0
 1  3  3  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = [2, 1, 1]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  1  1  0
 2  1  2  0
 1  3  3  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [2, 2, 1]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  1  1  0
 2  1  2  0
 1  3  3  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [2, 3, 1]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  1  1  0
 2  1  2  0
 1  3  3  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [2, 2, 1]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  1  1  0
 2  1  2  0
 1  3  3  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [2, 2, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  1  1  0
 2  1  2  0
 1  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [2, 2, 3]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.5]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 2, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.898893440441198, 4.713706587908492, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22113415318903495, 0.18375120443554996, 0.5951146423754151]
probh = 0.9829097223651833
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 4.712066761532361, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22091838545704606, 0.1835719124534681, 0.5955097020894858]
probh = 0.9795236714657937
sampled gamma:
probh = 0.9795236714657937
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 4.679003879663396, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21658275052886963, 0.17996922092637388, 0.6034480285447565]
probh = 0.9832555860600696
sampled gamma:
probh = 0.9832555860600696
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.8967624220024675, 4.711575569469762, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22085376773264667, 0.18351821841971058, 0.5956280138476426]
probh = 0.9829310219834609
sampled gamma:
probh = 0.9829310219834609
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.7237675570867275, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22245943551218425, 0.18485244646254548, 0.5926881180252703]
probh = 0.9468952404214038
sampled gamma:
probh = 0.9468952404214038
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update rho]
movable_units = [1]
Si_iter[:, t] = [1, 2, 1, 1, 3]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  1  1  0
 2  1  2  0
 3  3  3  0
rho_tmp = [1, 2, 1, 1, 3]
Si_comp1 = [2, 1, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  1  1  0
 2  1  2  0
 3  3  3  0
rho_tmp = [2, 2, 1, 1, 3]
Si_comp1 = [2, 1, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  1  1  0
 2  1  2  0
 3  3  3  0
rho_tmp = [3, 2, 1, 1, 3]
Si_comp1 = [2, 1, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  1  1  0
 2  1  2  0
 3  3  3  0
rho_tmp = [4, 2, 1, 1, 3]
Si_comp1 = [2, 1, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 1, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3270046287595133, 0.18232463230342916, 0.49067073893705765]
probh = 0.8078643655874859
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21296489765602558, 0.21296489765602558, 0.5740702046879489]
probh = 0.8658832740245955
sampled gamma:
probh = 0.8658832740245955
gt = true
gamma_iter[:, t] = Bool[0, 1, 0, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3214352794279148, 0.17921938705688611, 0.4993453335151991]
probh = 0.810516651996021
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21290484827105935, 0.21290484827105935, 0.5741903034578812]
probh = 0.8659160200998254
sampled gamma:
probh = 0.8659160200998254
gt = true
gamma_iter[:, t] = Bool[0, 1, 0, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21439662402037066, 0.21439662402037066, 0.5712067519592587]
probh = 0.706493812356526
sampled gamma:
probh = 0.706493812356526
gt = true
gamma_iter[:, t] = Bool[0, 1, 0, 1, 1]
												[update rho]
movable_units = [1, 3]
Si_iter[:, t] = [1, 1, 1, 2, 3]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  1  1  0
 2  1  2  0
 3  3  3  0
rho_tmp = [1, 1, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  1  1  0
 2  1  2  0
 3  3  3  0
rho_tmp = [2, 1, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  1  1  0
 2  1  2  0
 3  3  3  0
rho_tmp = [3, 1, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  1  1  0
 2  1  2  0
 3  3  3  0
rho_tmp = [4, 1, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 3]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  1  1  0
 2  1  2  0
 3  3  3  0
rho_tmp = [1, 1, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  1  1  0
 2  1  2  0
 3  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  1  1  0
 2  1  2  0
 3  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  1  1  0
 2  1  2  0
 3  3  3  0
rho_tmp = [1, 1, 4, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 3]

▶ iteration 25.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  1  1  0
 2  1  2  0
 3  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -1.15599   0.0        0.167358  0.0
  0.500472  0.596814  -0.508933  0.0
 -0.11862   0.144518  -1.20695   0.0
 -1.19654   1.36147   -0.026172  0.0
  0.0       0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 2.36644e12  9.51957   0.76731   1.0
 1.0823e12   3.473     0.601409  1.0
 0.679004    0.73626   0.191518  1.0
 0.315328    0.348153  0.665723  1.0
 1.0         1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.001387003758809683
 0.7847671164110305
 0.9161831056299329
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  1  1  0
 2  1  2  0
 3  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 2, 2, 3]
Si_comp2 = [2, 1, 1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  1  1  0
 2  1  2  0
 3  3  3  0
rho_tmp = [2, 1, 2, 2, 3]
Si_comp1 = [1, 2, 2, 3]
Si_comp2 = [2, 1, 1, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  1  1  0
 2  1  2  0
 3  3  3  0
rho_tmp = [3, 1, 2, 2, 3]
Si_comp1 = [1, 2, 2, 3]
Si_comp2 = [2, 1, 1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  1  1  0
 2  1  2  0
 3  3  3  0
rho_tmp = [4, 1, 2, 2, 3]
Si_comp1 = [1, 2, 2, 3]
Si_comp2 = [2, 1, 1, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  1  0
 2  1  1  0
 2  1  2  0
 1  3  3  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [2, 1, 1, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  1  0
 2  1  1  0
 2  1  2  0
 1  3  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 1]
Si_comp2 = [2, 1, 1, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  1  0
 2  1  1  0
 2  1  2  0
 1  3  3  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [3, 2, 2, 1]
Si_comp2 = [2, 1, 1, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 1.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  1  0
 3  1  2  0
 1  3  3  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [2, 1, 3, 1]
Si_comp2 = [2, 1, 1, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  1  0
 3  1  2  0
 1  3  3  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [2, 2, 3, 1]
Si_comp2 = [2, 1, 1, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  1  0
 3  1  2  0
 1  3  3  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [2, 3, 3, 1]
Si_comp2 = [2, 1, 1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  1  0
 3  1  2  0
 1  3  3  0
rho_tmp = [1, 2, 4, 3, 1]
Si_comp1 = [2, 4, 3, 1]
Si_comp2 = [2, 1, 1, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  1  0
 3  1  2  0
 1  3  3  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = [2, 3, 1, 1]
Si_comp2 = [2, 1, 1, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  1  0
 3  1  2  0
 1  3  3  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [2, 3, 2, 1]
Si_comp2 = [2, 1, 1, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  1  0
 3  1  2  0
 1  3  3  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [2, 3, 3, 1]
Si_comp2 = [2, 1, 1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  1  0
 3  1  2  0
 1  3  3  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [2, 3, 4, 1]
Si_comp2 = [2, 1, 1, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  1  0
 3  1  2  0
 1  3  3  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [2, 3, 3, 1]
Si_comp2 = [2, 1, 1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  1  0
 3  1  2  0
 1  3  3  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [2, 3, 3, 2]
Si_comp2 = [2, 1, 1, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  1  0
 3  1  2  0
 1  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [2, 3, 3, 3]
Si_comp2 = [2, 1, 1, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  1  0
 3  1  2  0
 1  3  3  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [2, 3, 3, 4]
Si_comp2 = [2, 1, 1, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.0, 0.5]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 1, 1]
Si_red1 = [1, 2, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.865181009637455, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.4158915616648342, 0.158243816816288, 0.4258646215188778]
probh = 0.8976146396318878
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 4.712066761532361, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22091838545704606, 0.1835719124534681, 0.5955097020894858]
probh = 0.9428715774572497
sampled gamma:
probh = 0.9428715774572497
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 4.679003879663396, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21658275052886963, 0.17996922092637388, 0.6034480285447565]
probh = 0.9529627431932282
sampled gamma:
probh = 0.9529627431932282
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.8967624220024675, 4.711575569469762, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22085376773264667, 0.18351821841971058, 0.5956280138476426]
probh = 0.9520796171149905
sampled gamma:
probh = 0.9520796171149905
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.7237675570867275, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22245943551218425, 0.18485244646254548, 0.5926881180252703]
probh = 0.8601760977077024
sampled gamma:
probh = 0.8601760977077024
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update rho]
movable_units = [1]
Si_iter[:, t] = [1, 2, 1, 1, 3]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  1  0
 3  1  2  0
 4  3  3  0
rho_tmp = [1, 2, 1, 1, 3]
Si_comp1 = [2, 1, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  1  0
 3  1  2  0
 4  3  3  0
rho_tmp = [2, 2, 1, 1, 3]
Si_comp1 = [2, 1, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  1  0
 3  1  2  0
 4  3  3  0
rho_tmp = [3, 2, 1, 1, 3]
Si_comp1 = [2, 1, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  1  0
 3  1  2  0
 4  3  3  0
rho_tmp = [4, 2, 1, 1, 3]
Si_comp1 = [2, 1, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3270046287595133, 0.18232463230342916, 0.49067073893705765]
probh = 0.970952992902065
sampled gamma:
probh = 0.970952992902065
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3267415120228054, 0.1821779289908333, 0.49108055898636144]
probh = 0.9709756865503701
sampled gamma:
probh = 0.9709756865503701
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 1, 2]
Si_red1 = [1, 1, 1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.827486444009176, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.4090066212111542, 0.15609044780860107, 0.43490293098024463]
probh = 0.9639316828624727
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3266626967668691, 0.18213398477324527, 0.49120331845988574]
probh = 0.983610584380543
sampled gamma:
probh = 0.983610584380543
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3286187622697228, 0.18322460824521933, 0.48815662948505795]
probh = 0.9572502135587633
sampled gamma:
probh = 0.9572502135587633
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update rho]
movable_units = [3]
Si_iter[:, t] = [1, 1, 1, 2, 3]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 4  3  3  0
rho_tmp = [1, 1, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 4  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 4  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 4  3  3  0
rho_tmp = [1, 1, 4, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 1, 2, 3, 4]

▶ iteration 26.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -1.32747    0.596814   0.167358   0.0
 -0.0696392  0.0       -0.0690291  0.0
 -0.43733    0.144518  -0.508933   0.0
 -1.40686    1.36147   -1.20695    0.0
  0.0        0.0        0.0        0.0
sig2h_iter
5×4 Matrix{Float64}:
 0.222144    2.47896   0.811557  1.0
 0.21346     7.34264   0.19307   1.0
 1.16259e12  0.503358  0.502235  1.0
 0.316541    0.348153  0.306234  1.0
 1.0         1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.19414481739018832
 0.4599721694207655
 0.39710603619013873
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 1  3  4  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [2, 3, 3, 1]
Si_comp2 = [1, 2, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 1  3  4  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = [2, 3, 3, 1]
Si_comp2 = [1, 2, 2, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 1  3  4  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = [2, 3, 3, 1]
Si_comp2 = [1, 2, 2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 1  3  4  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = [2, 3, 3, 1]
Si_comp2 = [1, 2, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  1  1  0
 3  2  2  0
 3  2  3  0
 2  3  4  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 3, 3, 2]
Si_comp2 = [1, 2, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  1  1  0
 3  2  2  0
 3  2  3  0
 2  3  4  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [2, 3, 3, 2]
Si_comp2 = [1, 2, 2, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  1  1  0
 3  2  2  0
 3  2  3  0
 2  3  4  0
rho_tmp = [1, 3, 3, 3, 2]
Si_comp1 = [3, 3, 3, 2]
Si_comp2 = [1, 2, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  1  1  0
 3  2  2  0
 3  2  3  0
 2  3  4  0
rho_tmp = [1, 4, 3, 3, 2]
Si_comp1 = [4, 3, 3, 2]
Si_comp2 = [1, 2, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.0, 0.5]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = [2, 1, 3, 4]
Si_comp2 = [1, 2, 2, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [2, 2, 3, 4]
Si_comp2 = [1, 2, 2, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [2, 3, 3, 4]
Si_comp2 = [1, 2, 2, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 4, 3, 4]
Si_comp1 = [2, 4, 3, 4]
Si_comp2 = [1, 2, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 5, 3, 4]
Si_comp1 = [2, 5, 3, 4]
Si_comp2 = [1, 2, 2, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [2, 3, 1, 4]
Si_comp2 = [1, 2, 2, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [2, 3, 2, 4]
Si_comp2 = [1, 2, 2, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [2, 3, 3, 4]
Si_comp2 = [1, 2, 2, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [2, 3, 4, 4]
Si_comp2 = [1, 2, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = [2, 3, 5, 4]
Si_comp2 = [1, 2, 2, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [2, 3, 3, 1]
Si_comp2 = [1, 2, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [2, 3, 3, 2]
Si_comp2 = [1, 2, 2, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [2, 3, 3, 3]
Si_comp2 = [1, 2, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [2, 3, 3, 4]
Si_comp2 = [1, 2, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.0, 0.5]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 3, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2, 2]
Si_red1 = [1, 1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.710221619849552, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3375877421546272, 0.15586154776070746, 0.5065507100846652]
probh = 0.7161563876282435
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 4.712066761532361, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22091838545704606, 0.1835719124534681, 0.5955097020894858]
probh = 0.794049058304824
sampled gamma:
probh = 0.794049058304824
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 4.679003879663396, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21658275052886963, 0.17996922092637388, 0.6034480285447565]
probh = 0.8255648454246275
sampled gamma:
probh = 0.8255648454246275
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.8967624220024675, 4.711575569469762, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22085376773264667, 0.18351821841971058, 0.5956280138476426]
probh = 0.822734748491815
sampled gamma:
probh = 0.822734748491815
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.7237675570867275, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22245943551218425, 0.18485244646254548, 0.5926881180252703]
probh = 0.5896774821496437
sampled gamma:
probh = 0.5896774821496437
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update rho]
movable_units = [1, 5]
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 1  3  4  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 1, 2, 3]
Si_comp2 = [1, 1, 3, 4]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 1  3  4  0
rho_tmp = [2, 1, 2, 2, 3]
Si_comp1 = [2, 1, 2, 3]
Si_comp2 = [1, 1, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 1  3  4  0
rho_tmp = [3, 1, 2, 2, 3]
Si_comp1 = [3, 1, 2, 3]
Si_comp2 = [1, 1, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 1  3  4  0
rho_tmp = [4, 1, 2, 2, 3]
Si_comp1 = [4, 1, 2, 3]
Si_comp2 = [1, 1, 3, 4]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 1  3  4  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 1]
Si_comp2 = [1, 1, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 1  3  4  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 1, 2, 2]
Si_comp2 = [1, 1, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 1  3  4  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 1, 2, 3]
Si_comp2 = [1, 1, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 1.0]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 2, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1757100899524644, 0.1757100899524644, 0.1757100899524644, 0.4728697301426069]
probh = 0.7894115207186166
sampled gamma:
probh = 0.7894115207186166
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1755738340553516, 0.1755738340553516, 0.1755738340553516, 0.47327849783394516]
probh = 0.7895404547619722
sampled gamma:
probh = 0.7895404547619722
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27258310281868575, 0.15198137770121353, 0.15198137770121353, 0.4234541417788872]
probh = 0.8125186183084843
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3266626967668691, 0.18213398477324527, 0.49120331845988574]
probh = 0.7833802482829287
sampled gamma:
probh = 0.7833802482829287
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3286187622697228, 0.18322460824521933, 0.48815662948505795]
probh = 0.5743400777011621
sampled gamma:
probh = 0.5743400777011621
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update rho]
movable_units = [3]
Si_iter[:, t] = [1, 1, 2, 3, 4]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  4  0
 3  2  3  0
 1  3  2  0
rho_tmp = [1, 1, 1, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  4  0
 3  2  3  0
 1  3  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  4  0
 3  2  3  0
 1  3  2  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  4  0
 3  2  3  0
 1  3  2  0
rho_tmp = [1, 1, 4, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 1, 2, 3, 4]

▶ iteration 27.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 1  3  4  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.030727  0.596814   0.167358  0.0
  0.310717  0.0        0.599108  0.0
  0.213972  0.598048  -0.508933  0.0
 -0.574051  1.36147   -1.20695   0.0
  0.0       0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 4.51077e13  0.592035  1.125     1.0
 0.302843    4.89531   0.233929  1.0
 4.02455e12  0.249748  0.335473  1.0
 0.316541    0.348153  0.343417  1.0
 1.0         1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.08689373210249828
 0.5871378852677428
 0.5955296655724486
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 1  3  4  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [2, 3, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 1  3  4  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = [2, 3, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 1  3  4  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = [2, 3, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 1  3  4  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = [2, 3, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  3  4  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  3  4  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  3  4  0
rho_tmp = [1, 3, 2, 2, 3]
Si_comp1 = [3, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  3  4  0
rho_tmp = [1, 4, 2, 2, 3]
Si_comp1 = [4, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.0, 0.3333333333333333, 0.3333333333333333]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = [2, 1, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [2, 2, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [2, 3, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 4, 3, 4]
Si_comp1 = [2, 4, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 5, 3, 4]
Si_comp1 = [2, 5, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [2, 3, 1]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [2, 3, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [2, 3, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [2, 3, 4]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = [2, 3, 5]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [2, 3, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [2, 3, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [2, 3, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [2, 3, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 3, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3270046287595133, 0.18232463230342916, 0.49067073893705765]
probh = 0.8130462854046693
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21296489765602558, 0.21296489765602558, 0.5740702046879489]
probh = 0.8697526971880528
sampled gamma:
probh = 0.8697526971880528
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2641153918314374, 0.7358846081685626]
probh = 0.8433694402624438
sampled gamma:
probh = 0.8433694402624438
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27049442218439607, 0.7295055778156039]
probh = 0.8401909895813523
sampled gamma:
probh = 0.8401909895813523
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.40233675694331344, 0.5976632430566866]
probh = 0.7040947926725979
sampled gamma:
probh = 0.7040947926725979
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update rho]
movable_units = [1, 2]
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 2  3  4  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 1, 2, 3]
Si_comp2 = [1, 1, 3, 4]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 2  3  4  0
rho_tmp = [2, 1, 2, 2, 3]
Si_comp1 = [2, 1, 2, 3]
Si_comp2 = [1, 1, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 2  3  4  0
rho_tmp = [3, 1, 2, 2, 3]
Si_comp1 = [3, 1, 2, 3]
Si_comp2 = [1, 1, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 2  3  4  0
rho_tmp = [4, 1, 2, 2, 3]
Si_comp1 = [4, 1, 2, 3]
Si_comp2 = [1, 1, 3, 4]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 2  3  4  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 1, 2, 3]
Si_comp2 = [1, 1, 3, 4]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 2  3  4  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 3]
Si_comp2 = [1, 1, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 2  3  4  0
rho_tmp = [1, 3, 2, 2, 3]
Si_comp1 = [1, 3, 2, 3]
Si_comp2 = [1, 1, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 2  3  4  0
rho_tmp = [1, 4, 2, 2, 3]
Si_comp1 = [1, 4, 2, 3]
Si_comp2 = [1, 1, 3, 4]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1757100899524644, 0.1757100899524644, 0.1757100899524644, 0.4728697301426069]
probh = 0.8933849297948994
sampled gamma:
probh = 0.8933849297948994
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1755738340553516, 0.1755738340553516, 0.1755738340553516, 0.47327849783394516]
probh = 0.893458797011205
sampled gamma:
probh = 0.893458797011205
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27258310281868575, 0.15198137770121353, 0.15198137770121353, 0.4234541417788872]
probh = 0.9064356062485169
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3266626967668691, 0.18213398477324527, 0.49120331845988574]
probh = 0.8899162082766398
sampled gamma:
probh = 0.8899162082766398
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3286187622697228, 0.18322460824521933, 0.48815662948505795]
probh = 0.7510072959047558
sampled gamma:
probh = 0.7510072959047558
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update rho]
movable_units = [3]
Si_iter[:, t] = [1, 1, 2, 3, 4]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  4  0
 3  2  3  0
 2  3  2  0
rho_tmp = [1, 1, 1, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  4  0
 3  2  3  0
 2  3  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  4  0
 3  2  3  0
 2  3  2  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  4  0
 3  2  3  0
 2  3  2  0
rho_tmp = [1, 1, 4, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 3]

▶ iteration 28.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 2  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -1.13422   0.596814   0.167358  0.0
  1.07033   0.0       -0.508933  0.0
 -1.52399   0.598048  -1.20695   0.0
 -0.030727  1.36147    0.599108  0.0
  0.0       0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 0.565842    0.562186  0.889699  1.0
 1.04356e13  3.57405   0.407882  1.0
 7.44146e13  1.10202   0.310531  1.0
 4.51077e13  0.348153  0.233929  1.0
 1.0         1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.4574338809224211
 0.7321969174348212
 0.9291987766252461
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  1  1  0
 1  2  1  0
 1  2  2  0
 2  3  3  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [2, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  1  1  0
 1  2  1  0
 1  2  2  0
 2  3  3  0
rho_tmp = [2, 2, 1, 1, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [2, 2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  1  1  0
 1  2  1  0
 1  2  2  0
 2  3  3  0
rho_tmp = [3, 2, 1, 1, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [2, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [2, 2, 1]
Si_comp2 = [2, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 2, 1]
Si_comp2 = [2, 2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [2, 2, 1]
Si_comp2 = [2, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [2, 2, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 2, 1]
Si_comp2 = [2, 2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [3, 2, 1]
Si_comp2 = [2, 2, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [2, 1, 1]
Si_comp2 = [2, 2, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 2, 1]
Si_comp2 = [2, 2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [2, 3, 1]
Si_comp2 = [2, 2, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 2, 1]
Si_comp2 = [2, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [2, 2, 2]
Si_comp2 = [2, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2, 2, 3]
Si_comp2 = [2, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.5]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.713706587908492, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22113415318903495, 0.18375120443554996, 0.5951146423754151]
probh = 0.9251717065196008
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 4.712066761532361, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22091838545704606, 0.1835719124534681, 0.5955097020894858]
probh = 0.9252392604415364
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.44837626606234, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.39162143252303233, 0.6083785674769677]
probh = 0.8747095433672762
sampled gamma:
probh = 0.8747095433672762
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4809479558687055, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.39940857143489605, 0.600591428565104]
probh = 0.872535777794338
sampled gamma:
probh = 0.872535777794338
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.40233675694331344, 0.5976632430566866]
probh = 0.8206158308407718
sampled gamma:
probh = 0.8206158308407718
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 1, 0]
												[update rho]
movable_units = [1, 2, 5]
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [2, 1, 2, 2, 3]
Si_comp1 = [2, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [3, 1, 2, 2, 3]
Si_comp1 = [3, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [4, 1, 2, 2, 3]
Si_comp1 = [4, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 3, 2, 2, 3]
Si_comp1 = [1, 3, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 4, 2, 2, 3]
Si_comp1 = [1, 4, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 1]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 1, 2, 2]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 1.0]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 2, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3270046287595133, 0.18232463230342916, 0.49067073893705765]
probh = 0.9756892939393449
sampled gamma:
probh = 0.9756892939393449
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3267415120228054, 0.1821779289908333, 0.49108055898636144]
probh = 0.975708379819009
sampled gamma:
probh = 0.975708379819009
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 1, 2]
Si_red1 = [1, 1, 1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.827486444009176, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.4090066212111542, 0.15609044780860107, 0.43490293098024463]
probh = 0.9697772173151754
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3266626967668691, 0.18213398477324527, 0.49120331845988574]
probh = 0.9863120795070839
sampled gamma:
probh = 0.9863120795070839
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3286187622697228, 0.18322460824521933, 0.48815662948505795]
probh = 0.9641383169974409
sampled gamma:
probh = 0.9641383169974409
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update rho]
movable_units = [3]
Si_iter[:, t] = [1, 1, 1, 2, 3]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 1, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 1, 4, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 3]

▶ iteration 29.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.532918  0.596814   0.167358  0.0
  0.531236  0.0       -0.508933  0.0
 -0.955641  1.16614   -1.20695   0.0
 -0.030727  1.36147    0.599108  0.0
  0.0       0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 1.13389e12  1.25229   1.45326   1.0
 3.04339e12  5.23119   0.618707  1.0
 0.565842    0.147891  0.274196  1.0
 4.51077e13  0.348153  0.233929  1.0
 1.0         1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.07498330522164141
 0.3643965885050386
 0.797392235240782
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  3  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  3  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  3  0
rho_tmp = [1, 3, 2, 2, 3]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  3  0
rho_tmp = [1, 4, 2, 2, 3]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 4  3  3  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = [1, 3]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 4  3  3  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [2, 3]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 4  3  3  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [3, 3]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 4  3  3  0
rho_tmp = [1, 2, 4, 3, 4]
Si_comp1 = [4, 3]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 4  3  3  0
rho_tmp = [1, 2, 5, 3, 4]
Si_comp1 = [5, 3]
Si_comp2 = [2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 4  3  3  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [3, 1]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 4  3  3  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [3, 2]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 4  3  3  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [3, 3]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 4  3  3  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [3, 4]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 4  3  3  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = [3, 5]
Si_comp2 = [2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 4  3  3  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [3, 3]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 4  3  3  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [3, 3]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 4  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [3, 3]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 4  3  3  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [3, 3]
Si_comp2 = [2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21316540189401498, 0.21316540189401498, 0.5736691962119701]
probh = 0.7289604804944005
sampled gamma:
probh = 0.7289604804944005
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21296489765602558, 0.21296489765602558, 0.5740702046879489]
probh = 0.7291463697018921
sampled gamma:
probh = 0.7291463697018921
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20893297679794065, 0.20893297679794065, 0.5821340464041186]
probh = 0.7329046234146263
sampled gamma:
probh = 0.7329046234146263
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21290484827105935, 0.21290484827105935, 0.5741903034578812]
probh = 0.72920206045434
sampled gamma:
probh = 0.72920206045434
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.7237675570867275, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22245943551218425, 0.18485244646254548, 0.5926881180252703]
probh = 0.4916895051475056
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update rho]
movable_units = [1, 5]
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 3  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 3  3  3  0
rho_tmp = [2, 1, 2, 2, 3]
Si_comp1 = [2, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 3  3  3  0
rho_tmp = [3, 1, 2, 2, 3]
Si_comp1 = [3, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 3  3  3  0
rho_tmp = [4, 1, 2, 2, 3]
Si_comp1 = [4, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 3  3  3  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 1]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 3  3  3  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 1, 2, 2]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 3  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 1.0]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 2, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3270046287595133, 0.18232463230342916, 0.49067073893705765]
probh = 0.9232860643840242
sampled gamma:
probh = 0.9232860643840242
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3267415120228054, 0.1821779289908333, 0.49108055898636144]
probh = 0.9233430587499578
sampled gamma:
probh = 0.9233430587499578
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 1, 2]
Si_red1 = [1, 1, 1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.827486444009176, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.4090066212111542, 0.15609044780860107, 0.43490293098024463]
probh = 0.9058597426493025
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3266626967668691, 0.18213398477324527, 0.49120331845988574]
probh = 0.955768877910691
sampled gamma:
probh = 0.955768877910691
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.40233675694331344, 0.5976632430566866]
probh = 0.8681617900824169
sampled gamma:
probh = 0.8681617900824169
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 0, 1]
												[update rho]
movable_units = [3, 4]
Si_iter[:, t] = [1, 1, 1, 2, 3]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 3  3  3  0
rho_tmp = [1, 1, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 3  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 3  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 3  2  2  0
 3  3  3  0
rho_tmp = [1, 1, 4, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 1, 2, 3, 4]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  4  0
 3  3  3  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  4  0
 3  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  4  0
 3  3  3  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  4  0
 3  3  3  0
rho_tmp = [1, 1, 2, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 1, 3]

▶ iteration 30.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 3  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
  0.362498  0.596814   0.167358  0.0
 -1.13536   0.0        0.646502  0.0
 -0.649133  0.915497  -1.20695   0.0
 -0.532918  1.36147   -0.508933  0.0
  0.0       0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 0.462276     0.546076  0.36121   1.0
 0.773574    23.7724    0.296187  1.0
 2.69864e11   0.256205  0.251542  1.0
 1.13389e12   0.348153  0.618707  1.0
 1.0          1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.005048911259858668
 0.7522012298472837
 0.5863275151777798
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  1  1  0
 1  2  2  0
 1  2  1  0
 1  3  3  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [2, 1, 1]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  1  1  0
 1  2  2  0
 1  2  1  0
 1  3  3  0
rho_tmp = [2, 2, 1, 1, 1]
Si_comp1 = [2, 1, 1]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  1  1  0
 1  2  2  0
 1  2  1  0
 1  3  3  0
rho_tmp = [3, 2, 1, 1, 1]
Si_comp1 = [2, 1, 1]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  1  1  0
 2  2  2  0
 2  2  1  0
 2  3  3  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  1  1  0
 2  2  2  0
 2  2  1  0
 2  3  3  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [2, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  1  1  0
 2  2  2  0
 2  2  1  0
 2  3  3  0
rho_tmp = [1, 3, 2, 2, 2]
Si_comp1 = [3, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.5]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 3  3  3  0
rho_tmp = [1, 2, 1, 3, 3]
Si_comp1 = [2, 1, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 3  3  3  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = [2, 2, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 3  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [2, 3, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 3  3  3  0
rho_tmp = [1, 2, 4, 3, 3]
Si_comp1 = [2, 4, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [2, 3, 1]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [2, 3, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 3  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [2, 3, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [2, 3, 4]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 3  3  3  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [2, 3, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 3  3  3  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [2, 3, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 3  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [2, 3, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 3  3  3  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [2, 3, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 3, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3270046287595133, 0.18232463230342916, 0.49067073893705765]
probh = 0.9027506277329814
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21296489765602558, 0.21296489765602558, 0.5740702046879489]
probh = 0.9344420299450149
sampled gamma:
probh = 0.9344420299450149
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2641153918314374, 0.7358846081685626]
probh = 0.9199564931191723
sampled gamma:
probh = 0.9199564931191723
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27049442218439607, 0.7295055778156039]
probh = 0.9181814227817402
sampled gamma:
probh = 0.9181814227817402
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.40233675694331344, 0.5976632430566866]
probh = 0.8354993017281166
sampled gamma:
probh = 0.8354993017281166
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update rho]
movable_units = [1, 2]
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 1  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 1, 3]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 1  3  3  0
rho_tmp = [2, 1, 2, 2, 3]
Si_comp1 = [2, 1, 3]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 1  3  3  0
rho_tmp = [3, 1, 2, 2, 3]
Si_comp1 = [3, 1, 3]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 1  3  3  0
rho_tmp = [4, 1, 2, 2, 3]
Si_comp1 = [4, 1, 3]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 1  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 1, 3]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 1  3  3  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 1  3  3  0
rho_tmp = [1, 3, 2, 2, 3]
Si_comp1 = [1, 3, 3]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 1  3  3  0
rho_tmp = [1, 4, 2, 2, 3]
Si_comp1 = [1, 4, 3]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.39991987245586275, 0.6000801275441373]
probh = 0.7799362730204943
sampled gamma:
probh = 0.7799362730204943
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3995264050768606, 0.6004735949231395]
probh = 0.7801051760232209
sampled gamma:
probh = 0.7801051760232209
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.827486444009176, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.4846569400110208, 0.5153430599889791]
probh = 0.7333578795891428
sampled gamma:
probh = 0.7333578795891428
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2, 1]
Si_red1 = [1, 1, 2, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.7152158084996865, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.38011729116211085, 0.16767481514920304, 0.452207893688686]
probh = 0.7885286787629834
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3286187622697228, 0.18322460824521933, 0.48815662948505795]
probh = 0.7438207977796631
sampled gamma:
probh = 0.7438207977796631
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update rho]
movable_units = [4]
Si_iter[:, t] = [1, 1, 2, 1, 3]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 1  3  3  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 1  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 1  3  3  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 1  3  3  0
rho_tmp = [1, 1, 2, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 3]

▶ iteration 31.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 1  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -1.25097   0.596814   0.167358  0.0
  0.40671   0.0        0.646502  0.0
 -0.754209  0.915497  -1.20695   0.0
 -0.532918  1.36147   -0.508933  0.0
  0.0       0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 3.90634      0.899542  0.503476  1.0
 0.776667    15.8351    0.235684  1.0
 1.70218e9    0.408886  1.26149   1.0
 1.13389e12   0.348153  0.618707  1.0
 1.0          1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.1822715386617091
 0.35172087786041634
 0.9177319116470918
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 1  3  3  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [3, 3, 1]
Si_comp2 = [2, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 1  3  3  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = [3, 3, 1]
Si_comp2 = [2, 2, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 1  3  3  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = [3, 3, 1]
Si_comp2 = [2, 2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  3  0
 1  3  3  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = [3, 3, 1]
Si_comp2 = [2, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 1, 1, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  1  1  0
 1  2  2  0
 1  2  3  0
 2  3  3  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [2, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  1  1  0
 1  2  2  0
 1  2  3  0
 2  3  3  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [2, 2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  1  1  0
 1  2  2  0
 1  2  3  0
 2  3  3  0
rho_tmp = [1, 3, 1, 1, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [2, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  2  3  0
 2  3  3  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [2, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  2  3  0
 2  3  3  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [2, 1, 2]
Si_comp2 = [2, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  2  3  0
 2  3  3  0
rho_tmp = [1, 1, 3, 1, 2]
Si_comp1 = [3, 1, 2]
Si_comp2 = [2, 2, 3]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  2  3  0
 2  3  3  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [2, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  2  3  0
 2  3  3  0
rho_tmp = [1, 1, 1, 2, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [2, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  2  3  0
 2  3  3  0
rho_tmp = [1, 1, 1, 3, 2]
Si_comp1 = [1, 3, 2]
Si_comp2 = [2, 2, 3]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  2  3  0
 2  3  3  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [2, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  2  3  0
 2  3  3  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [2, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5]
After exp and normalization:
ph = [0.0, 1.0]
new_label = 2
Si_iter[:, t] = [1, 1, 1, 1, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.713706587908492, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22113415318903495, 0.18375120443554996, 0.5951146423754151]
probh = 0.7104359513917556
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 4.712066761532361, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22091838545704606, 0.1835719124534681, 0.5955097020894858]
probh = 0.7106367325551729
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.44837626606234, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.39162143252303233, 0.6083785674769677]
probh = 0.5807800014783975
sampled gamma:
probh = 0.5807800014783975
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27049442218439607, 0.7295055778156039]
probh = 0.6673048436292593
sampled gamma:
probh = 0.6673048436292593
gt = true
gamma_iter[:, t] = Bool[0, 0, 0, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.272906953528583, 0.727093046471417]
probh = 0.427322771410419
sampled gamma:
probh = 0.427322771410419
gt = true
gamma_iter[:, t] = Bool[0, 0, 0, 1, 1]
												[update rho]
movable_units = [1, 2, 3]
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  2  3  0
 2  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  2  3  0
 2  3  3  0
rho_tmp = [2, 1, 2, 2, 3]
Si_comp1 = [2, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  2  3  0
 2  3  3  0
rho_tmp = [3, 1, 2, 2, 3]
Si_comp1 = [3, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  2  3  0
 2  3  3  0
rho_tmp = [4, 1, 2, 2, 3]
Si_comp1 = [4, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  2  3  0
 2  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  2  3  0
 2  3  3  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  2  3  0
 2  3  3  0
rho_tmp = [1, 3, 2, 2, 3]
Si_comp1 = [1, 3, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  2  3  0
 2  3  3  0
rho_tmp = [1, 4, 2, 2, 3]
Si_comp1 = [1, 4, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  2  3  0
 2  3  3  0
rho_tmp = [1, 1, 1, 2, 3]
Si_comp1 = [1, 1, 1, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  2  3  0
 2  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  2  3  0
 2  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [1, 1, 3, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  2  3  0
 2  3  3  0
rho_tmp = [1, 1, 4, 2, 3]
Si_comp1 = [1, 1, 4, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.5, 0.0, 0.5]
new_label = 4
Si_iter[:, t] = [1, 1, 2, 3, 4]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3270046287595133, 0.18232463230342916, 0.49067073893705765]
probh = 0.9715211956106077
sampled gamma:
probh = 0.9715211956106077
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3267415120228054, 0.1821779289908333, 0.49108055898636144]
probh = 0.9715434583477469
sampled gamma:
probh = 0.9715434583477469
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3214352794279148, 0.17921938705688611, 0.4993453335151991]
probh = 0.9571551233903336
sampled gamma:
probh = 0.9571551233903336
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2763330561294445, 0.15407220088354184, 0.15407220088354184, 0.4155225421034718]
probh = 0.98637668937626
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3286187622697228, 0.18322460824521933, 0.48815662948505795]
probh = 0.9580748889511594
sampled gamma:
probh = 0.9580748889511594
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update rho]
movable_units = [4, 5]
Si_iter[:, t] = [1, 1, 2, 3, 3]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  3  3  0
 2  4  3  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  3  3  0
 2  4  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  3  3  0
 2  4  3  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  3  3  0
 2  4  3  0
rho_tmp = [1, 1, 2, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 1, 3]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  3  1  0
 2  4  3  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  3  1  0
 2  4  3  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  3  1  0
 2  4  3  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 1, 2]

▶ iteration 32.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  3  1  0
 2  4  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
muh_iter
5×4 Matrix{Float64}:
 -0.244427   0.596814   0.167358  0.0
 -0.758193   0.187257   0.646502  0.0
  0.0712729  0.0       -1.20695   0.0
  0.503557   0.915497  -0.508933  0.0
  0.0        0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 6.82631e7    0.644061  2.44419   1.0
 0.461465     0.445531  0.876384  1.0
 0.776667    12.0578    1.26149   1.0
 1.13389e12   1.05513   0.618707  1.0
 1.0          1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.239064387022805
 0.735556046447374
 0.6987038619564526
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 1, 1, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  3  1  0
 2  4  2  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 2]
Si_comp2 = [3, 4]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  3  1  0
 2  4  2  0
rho_tmp = [2, 1, 1, 1, 2]
Si_comp1 = [1, 2]
Si_comp2 = [3, 4]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  2  2  0
 1  3  1  0
 2  4  2  0
rho_tmp = [3, 1, 1, 1, 2]
Si_comp1 = [1, 2]
Si_comp2 = [3, 4]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  3  1  0
 3  4  2  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [2, 3]
Si_comp2 = [3, 4]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  3  1  0
 3  4  2  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2, 3]
Si_comp2 = [3, 4]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  3  1  0
 3  4  2  0
rho_tmp = [1, 3, 2, 2, 3]
Si_comp1 = [2, 3]
Si_comp2 = [3, 4]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  3  1  0
 3  4  2  0
rho_tmp = [1, 4, 2, 2, 3]
Si_comp1 = [2, 3]
Si_comp2 = [3, 4]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  3  1  0
 2  4  2  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = [3, 2]
Si_comp2 = [3, 4]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  3  1  0
 2  4  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [3, 2]
Si_comp2 = [3, 4]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  3  1  0
 2  4  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [3, 2]
Si_comp2 = [3, 4]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  3  1  0
 2  4  2  0
rho_tmp = [1, 2, 4, 3, 2]
Si_comp1 = [3, 2]
Si_comp2 = [3, 4]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 4  3  1  0
 2  4  2  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = [1, 2]
Si_comp2 = [3, 4]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 4  3  1  0
 2  4  2  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = [2, 2]
Si_comp2 = [3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 4  3  1  0
 2  4  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [3, 2]
Si_comp2 = [3, 4]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 4  3  1  0
 2  4  2  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [4, 2]
Si_comp2 = [3, 4]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.0, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 1, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 2  4  2  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = [1, 1]
Si_comp2 = [3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 2  4  2  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = [1, 2]
Si_comp2 = [3, 4]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 2  4  2  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 3]
Si_comp2 = [3, 4]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 2  4  2  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [1, 4]
Si_comp2 = [3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 1, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21316540189401498, 0.21316540189401498, 0.5736691962119701]
probh = 0.8290202945862227
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21296489765602558, 0.21296489765602558, 0.5740702046879489]
probh = 0.8289212228337774
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20893297679794065, 0.20893297679794065, 0.5821340464041186]
probh = 0.9301333260753554
sampled gamma:
probh = 0.9301333260753554
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21290484827105935, 0.21290484827105935, 0.5741903034578812]
probh = 0.9288995764659237
sampled gamma:
probh = 0.9288995764659237
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21439662402037066, 0.21439662402037066, 0.5712067519592587]
probh = 0.8296291770390168
sampled gamma:
probh = 0.8296291770390168
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 1, 0]
												[update rho]
movable_units = [1, 2, 5]
Si_iter[:, t] = [1, 1, 2, 3, 4]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 2  4  2  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 2  4  2  0
rho_tmp = [2, 1, 2, 3, 4]
Si_comp1 = [2, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 2  4  2  0
rho_tmp = [3, 1, 2, 3, 4]
Si_comp1 = [3, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 0
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 2  4  2  0
rho_tmp = [4, 1, 2, 3, 4]
Si_comp1 = [4, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 2  4  2  0
rho_tmp = [5, 1, 2, 3, 4]
Si_comp1 = [5, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 4]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 2  4  2  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 2  4  2  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 2  4  2  0
rho_tmp = [1, 3, 2, 3, 4]
Si_comp1 = [1, 3, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 0
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 2  4  2  0
rho_tmp = [1, 4, 2, 3, 4]
Si_comp1 = [1, 4, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 2  4  2  0
rho_tmp = [1, 5, 2, 3, 4]
Si_comp1 = [1, 5, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 4]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 2  4  2  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 2  4  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 2  4  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 2  4  2  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.39991987245586275, 0.6000801275441373]
probh = 0.8529118877860822
sampled gamma:
probh = 0.8529118877860822
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3995264050768606, 0.6004735949231395]
probh = 0.8530353347298164
sampled gamma:
probh = 0.8530353347298164
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.39162143252303233, 0.6083785674769677]
probh = 0.792175883060599
sampled gamma:
probh = 0.792175883060599
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3266626967668691, 0.18213398477324527, 0.49120331845988574]
probh = 0.8765286790039652
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3286187622697228, 0.18322460824521933, 0.48815662948505795]
probh = 0.9267751323882699
sampled gamma:
probh = 0.9267751323882699
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update rho]
movable_units = [4]
Si_iter[:, t] = [1, 1, 2, 1, 2]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 2  2  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 2  2  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 1, 2]

▶ iteration 33.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 2  2  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
  0.0659182  0.596814   0.167358  0.0
 -0.417716   0.187257   0.646502  0.0
 -0.18005    0.0       -1.20695   0.0
 -0.244427   0.915497  -0.508933  0.0
  0.0        0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 117.517      0.699135  0.552759  1.0
 114.517      0.335718  0.933909  1.0
   0.235724   6.96983   1.26149   1.0
   6.82631e7  1.05513   0.618707  1.0
   1.0        1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.01243360752370315
 0.5948092937057019
 0.5089498776024921
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 1, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 2  2  2  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = [3, 1]
Si_comp2 = [2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 2  2  2  0
rho_tmp = [2, 2, 3, 1, 2]
Si_comp1 = [3, 1]
Si_comp2 = [2, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 2  2  2  0
rho_tmp = [3, 2, 3, 1, 2]
Si_comp1 = [3, 1]
Si_comp2 = [2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 2  2  2  0
rho_tmp = [4, 2, 3, 1, 2]
Si_comp1 = [3, 1]
Si_comp2 = [2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  1  0
 1  2  2  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [2, 3]
Si_comp2 = [2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  1  0
 1  2  2  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [2, 3]
Si_comp2 = [2, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  1  0
 1  2  2  0
rho_tmp = [1, 3, 2, 3, 1]
Si_comp1 = [2, 3]
Si_comp2 = [2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  1  0
 1  2  2  0
rho_tmp = [1, 4, 2, 3, 1]
Si_comp1 = [2, 3]
Si_comp2 = [2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  1  0
 1  2  2  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2]
Si_comp2 = [2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  1  0
 1  2  2  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 2]
Si_comp2 = [2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  1  0
 1  2  2  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [3, 2]
Si_comp2 = [2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.5]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  1  0
 1  2  2  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = [3, 1]
Si_comp2 = [2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  1  0
 1  2  2  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [3, 2]
Si_comp2 = [2, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  1  0
 1  2  2  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [3, 3]
Si_comp2 = [2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  1  0
 1  2  2  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [3, 4]
Si_comp2 = [2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.0, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 1, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 1  2  2  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = [3, 1]
Si_comp2 = [2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 1  2  2  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = [3, 1]
Si_comp2 = [2, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 1  2  2  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [3, 1]
Si_comp2 = [2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 1  2  2  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [3, 1]
Si_comp2 = [2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 1, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21316540189401498, 0.21316540189401498, 0.5736691962119701]
probh = 0.8732018048208539
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21296489765602558, 0.21296489765602558, 0.5740702046879489]
probh = 0.8733059613108245
sampled gamma:
probh = 0.8733059613108245
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20893297679794065, 0.20893297679794065, 0.5821340464041186]
probh = 0.8754057207094346
sampled gamma:
probh = 0.8754057207094346
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21290484827105935, 0.21290484827105935, 0.5741903034578812]
probh = 0.718832421353778
sampled gamma:
probh = 0.718832421353778
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1765458004244042, 0.1765458004244042, 0.1765458004244042, 0.4703625987267872]
probh = 0.8926459661120099
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update rho]
movable_units = [1, 5]
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 1  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 2]
Si_comp2 = [1, 1, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 1  2  2  0
rho_tmp = [2, 1, 2, 3, 2]
Si_comp1 = [2, 1, 2, 2]
Si_comp2 = [1, 1, 2, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 1  2  2  0
rho_tmp = [3, 1, 2, 3, 2]
Si_comp1 = [3, 1, 2, 2]
Si_comp2 = [1, 1, 2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 1  2  2  0
rho_tmp = [4, 1, 2, 3, 2]
Si_comp1 = [4, 1, 2, 2]
Si_comp2 = [1, 1, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 1  2  2  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 1, 2, 1]
Si_comp2 = [1, 1, 2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 1  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 2]
Si_comp2 = [1, 1, 2, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 1  2  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 1, 2, 3]
Si_comp2 = [1, 1, 2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 1  2  2  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 1, 2, 4]
Si_comp2 = [1, 1, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.862189152254271, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.49332819449865906, 0.5066718055013409]
probh = 0.6775169407961404
sampled gamma:
probh = 0.6775169407961404
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3995264050768606, 0.6004735949231395]
probh = 0.7217740838932536
sampled gamma:
probh = 0.7217740838932536
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.39162143252303233, 0.6083785674769677]
probh = 0.6301269064356525
sampled gamma:
probh = 0.6301269064356525
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 1]
Si_red1 = [1, 2, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.964180124185894, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22442099928930231, 0.2097897936555915, 0.5657892070551062]
probh = 0.8220114152545897
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21439662402037066, 0.21439662402037066, 0.5712067519592587]
probh = 0.8285990636681215
sampled gamma:
probh = 0.8285990636681215
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update rho]
movable_units = [1, 4]
Si_iter[:, t] = [1, 1, 2, 1, 2]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 1  2  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 1  2  2  0
rho_tmp = [2, 1, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 1  2  2  0
rho_tmp = [3, 1, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 1, 2]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 1  2  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 1  2  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  1  0
 1  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 2]

▶ iteration 34.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  2  0
 1  2  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.556619  0.596814   0.167358  0.0
 -0.921018  0.187257   0.646502  0.0
 -2.03197   0.0       -1.20695   0.0
 -0.244427  0.915497  -0.508933  0.0
  0.0       0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 460.513       1.5192    0.526416  1.0
 205.597       0.190189  0.787328  1.0
   0.461887   14.1571    1.26149   1.0
   6.82631e7   1.05513   0.618707  1.0
   1.0         1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.0889782185811489
 0.6345672626671178
 0.5063121785808123
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 1, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  2  0
 1  2  2  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = [2, 3, 1]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  2  0
 1  2  2  0
rho_tmp = [2, 2, 3, 1, 1]
Si_comp1 = [2, 3, 1]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  2  0
 1  2  2  0
rho_tmp = [3, 2, 3, 1, 1]
Si_comp1 = [2, 3, 1]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 1  3  2  0
 1  2  2  0
rho_tmp = [4, 2, 3, 1, 1]
Si_comp1 = [2, 3, 1]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  2  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  2  2  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = [2, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  2  2  0
rho_tmp = [1, 3, 2, 3, 3]
Si_comp1 = [3, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  2  2  0
rho_tmp = [1, 4, 2, 3, 3]
Si_comp1 = [4, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.0, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 3  2  2  0
 2  3  2  0
 2  2  2  0
rho_tmp = [1, 1, 1, 2, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 2, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 3  2  2  0
 2  3  2  0
 2  2  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 3  2  2  0
 2  3  2  0
 2  2  2  0
rho_tmp = [1, 1, 3, 2, 2]
Si_comp1 = [1, 3, 2]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 1.0]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  2  2  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  2  2  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  2  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  2  2  0
rho_tmp = [1, 1, 2, 4, 3]
Si_comp1 = [1, 2, 4]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.5, 0.5]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  2  2  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  2  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 3  2  2  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3270046287595133, 0.18232463230342916, 0.49067073893705765]
probh = 0.8415280860059979
sampled gamma:
probh = 0.8415280860059979
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3267415120228054, 0.1821779289908333, 0.49108055898636144]
probh = 0.8416354035865904
sampled gamma:
probh = 0.8416354035865904
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3214352794279148, 0.17921938705688611, 0.4993453335151991]
probh = 0.9064471029271838
sampled gamma:
probh = 0.9064471029271838
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3266626967668691, 0.18213398477324527, 0.49120331845988574]
probh = 0.7795005517570478
sampled gamma:
probh = 0.7795005517570478
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2777315143547265, 0.15485192495865216, 0.15485192495865216, 0.41256463572796914]
probh = 0.918125537169869
sampled gamma:
probh = 0.918125537169869
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3270046287595133, 0.18232463230342916, 0.49067073893705765]
probh = 0.7582357011304182
sampled gamma:
probh = 0.7582357011304182
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3267415120228054, 0.1821779289908333, 0.49108055898636144]
probh = 0.758383229473246
sampled gamma:
probh = 0.758383229473246
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3214352794279148, 0.17921938705688611, 0.4993453335151991]
probh = 0.8512444082650764
sampled gamma:
probh = 0.8512444082650764
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2, 2]
Si_red1 = [1, 1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.4809479558687055, 4.708090601410822, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3372233319097799, 0.15569330247899413, 0.507083365611226]
probh = 0.8681978019915003
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3286187622697228, 0.18322460824521933, 0.48815662948505795]
probh = 0.8484238978345571
sampled gamma:
probh = 0.8484238978345571
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update rho]
movable_units = [4]
Si_iter[:, t] = [1, 1, 2, 2, 2]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 2  2  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 2  2  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 2]

▶ iteration 35.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 2  2  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.757379  0.596814   0.167358  0.0
  0.476296  0.187257   0.646502  0.0
 -1.50458   0.0       -1.20695   0.0
 -0.244427  0.915497  -0.508933  0.0
  0.0       0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 2542.34        0.441193  0.328905  1.0
   24.116       0.281964  0.560991  1.0
  109.941      23.5291    1.26149   1.0
    6.82631e7   1.05513   0.618707  1.0
    1.0         1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.056633958952000185
 0.8563333842657658
 0.7922740030841737
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 2  2  2  0
rho_tmp = [2, 1, 2, 3, 2]
Si_comp1 = [2, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 2  2  2  0
rho_tmp = [3, 1, 2, 3, 2]
Si_comp1 = [3, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 2  2  2  0
rho_tmp = [4, 1, 2, 3, 2]
Si_comp1 = [4, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 2  2  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 2  2  2  0
rho_tmp = [1, 3, 2, 3, 2]
Si_comp1 = [1, 3, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 2  2  2  0
rho_tmp = [1, 4, 2, 3, 2]
Si_comp1 = [1, 4, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 2  2  2  0
rho_tmp = [1, 1, 1, 3, 2]
Si_comp1 = [1, 1, 1, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 2  2  2  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 1, 3, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 2  2  2  0
rho_tmp = [1, 1, 4, 3, 2]
Si_comp1 = [1, 1, 4, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 2  2  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 1, 2, 1, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 2  2  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 1, 2, 2, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 1.0]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 1, 2, 3, 1]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 1, 2, 3, 3]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 1, 2, 3, 4]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27657770110264573, 0.15420860508354678, 0.15420860508354678, 0.4150050887302608]
probh = 0.9556563050461898
sampled gamma:
probh = 0.9556563050461898
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27638945374469, 0.15410364592608283, 0.15410364592608283, 0.4154032544031443]
probh = 0.9556851492424933
sampled gamma:
probh = 0.9556851492424933
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27258310281868575, 0.15198137770121353, 0.15198137770121353, 0.4234541417788872]
probh = 0.9751361364428194
sampled gamma:
probh = 0.9751361364428194
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2763330561294445, 0.15407220088354184, 0.15407220088354184, 0.4155225421034718]
probh = 0.97480270061179
sampled gamma:
probh = 0.97480270061179
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2777315143547265, 0.15485192495865216, 0.15485192495865216, 0.41256463572796914]
probh = 0.9746784118101586
sampled gamma:
probh = 0.9746784118101586
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3270046287595133, 0.18232463230342916, 0.49067073893705765]
probh = 0.9210331845281113
sampled gamma:
probh = 0.9210331845281113
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3267415120228054, 0.1821779289908333, 0.49108055898636144]
probh = 0.9210917096156327
sampled gamma:
probh = 0.9210917096156327
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3214352794279148, 0.17921938705688611, 0.4993453335151991]
probh = 0.955119454679442
sampled gamma:
probh = 0.955119454679442
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2, 2]
Si_red1 = [1, 1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.4809479558687055, 4.708090601410822, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3372233319097799, 0.15569330247899413, 0.507083365611226]
probh = 0.9607798488786327
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3286187622697228, 0.18322460824521933, 0.48815662948505795]
probh = 0.9541624326033838
sampled gamma:
probh = 0.9541624326033838
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update rho]
movable_units = [4]
Si_iter[:, t] = [1, 1, 2, 2, 2]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 2  2  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 2  2  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  2  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 2]

▶ iteration 36.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.913619  0.596814   0.167358  0.0
 -0.728777  0.187257   0.646502  0.0
  0.878998  0.0       -0.353133  0.0
 -0.244427  0.915497  -0.508933  0.0
  0.0       0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 155.746       1.18032   0.794465  1.0
   8.49203     0.416666  0.673949  1.0
   0.434915   12.4417    0.365608  1.0
   6.82631e7   1.05513   0.618707  1.0
   1.0         1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.30638119459896423
 0.9850421939260723
 0.7618937732318085
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [2, 1, 2, 3, 2]
Si_comp1 = [2, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [3, 1, 2, 3, 2]
Si_comp1 = [3, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [4, 1, 2, 3, 2]
Si_comp1 = [4, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 3, 2, 3, 2]
Si_comp1 = [1, 3, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 4, 2, 3, 2]
Si_comp1 = [1, 4, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 1, 3, 2]
Si_comp1 = [1, 1, 1, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 1, 3, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 4, 3, 2]
Si_comp1 = [1, 1, 4, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 1, 2, 1, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 1, 2, 2, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 1.0]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 1, 2, 3, 1]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 1, 2, 3, 3]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 1, 2, 3, 4]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27657770110264573, 0.15420860508354678, 0.15420860508354678, 0.4150050887302608]
probh = 0.9958177490375882
sampled gamma:
probh = 0.9958177490375882
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27638945374469, 0.15410364592608283, 0.15410364592608283, 0.4154032544031443]
probh = 0.9958205837102537
sampled gamma:
probh = 0.9958205837102537
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27258310281868575, 0.15198137770121353, 0.15198137770121353, 0.4234541417788872]
probh = 0.9976974857883554
sampled gamma:
probh = 0.9976974857883554
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2763330561294445, 0.15407220088354184, 0.15407220088354184, 0.4155225421034718]
probh = 0.9976658838027812
sampled gamma:
probh = 0.9976658838027812
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2777315143547265, 0.15485192495865216, 0.15485192495865216, 0.41256463572796914]
probh = 0.9976540990867756
sampled gamma:
probh = 0.9976540990867756
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3270046287595133, 0.18232463230342916, 0.49067073893705765]
probh = 0.9072803596410736
sampled gamma:
probh = 0.9072803596410736
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3267415120228054, 0.1821779289908333, 0.49108055898636144]
probh = 0.9073480520896429
sampled gamma:
probh = 0.9073480520896429
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3214352794279148, 0.17921938705688611, 0.4993453335151991]
probh = 0.8650108455388317
sampled gamma:
probh = 0.8650108455388317
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2763330561294445, 0.15407220088354184, 0.15407220088354184, 0.4155225421034718]
probh = 0.9540614822891886
sampled gamma:
probh = 0.9540614822891886
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2777315143547265, 0.15485192495865216, 0.15485192495865216, 0.41256463572796914]
probh = 0.953839729524497
sampled gamma:
probh = 0.953839729524497
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 1, 2, 3, 2]

▶ iteration 37.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
  0.48902   0.596814   0.167358  0.0
 -0.743034  0.187257   0.646502  0.0
  1.62815   0.0       -0.353133  0.0
 -0.244427  0.915497  -0.508933  0.0
  0.0       0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 248.761       0.433177  0.342018  1.0
 293.809       0.375139  0.934487  1.0
   0.298153   49.8788    0.341431  1.0
   6.82631e7   1.05513   0.618707  1.0
   1.0         1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.029845514961088896
 0.8336143723356066
 0.8706404721986811
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [2, 1, 2, 3, 2]
Si_comp1 = [2, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [3, 1, 2, 3, 2]
Si_comp1 = [3, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [4, 1, 2, 3, 2]
Si_comp1 = [4, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 3, 2, 3, 2]
Si_comp1 = [1, 3, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 4, 2, 3, 2]
Si_comp1 = [1, 4, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 1, 3, 2]
Si_comp1 = [1, 1, 1, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 1, 3, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 4, 3, 2]
Si_comp1 = [1, 1, 4, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 1, 2, 1, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 1, 2, 2, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 1.0]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 1, 2, 3, 1]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 1, 2, 3, 3]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 1, 2, 3, 4]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27657770110264573, 0.15420860508354678, 0.15420860508354678, 0.4150050887302608]
probh = 0.9476843658332232
sampled gamma:
probh = 0.9476843658332232
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27638945374469, 0.15410364592608283, 0.15410364592608283, 0.4154032544031443]
probh = 0.9477181118409655
sampled gamma:
probh = 0.9477181118409655
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27258310281868575, 0.15198137770121353, 0.15198137770121353, 0.4234541417788872]
probh = 0.9705583172672149
sampled gamma:
probh = 0.9705583172672149
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2763330561294445, 0.15407220088354184, 0.15407220088354184, 0.4155225421034718]
probh = 0.9701653690469461
sampled gamma:
probh = 0.9701653690469461
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2777315143547265, 0.15485192495865216, 0.15485192495865216, 0.41256463572796914]
probh = 0.9700189095533792
sampled gamma:
probh = 0.9700189095533792
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27657770110264573, 0.15420860508354678, 0.15420860508354678, 0.4150050887302608]
probh = 0.9605282069385365
sampled gamma:
probh = 0.9605282069385365
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27638945374469, 0.15410364592608283, 0.15410364592608283, 0.4154032544031443]
probh = 0.9605540129195324
sampled gamma:
probh = 0.9605540129195324
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27258310281868575, 0.15198137770121353, 0.15198137770121353, 0.4234541417788872]
probh = 0.9779173047925086
sampled gamma:
probh = 0.9779173047925086
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2763330561294445, 0.15407220088354184, 0.15407220088354184, 0.4155225421034718]
probh = 0.977620309734141
sampled gamma:
probh = 0.977620309734141
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2777315143547265, 0.15485192495865216, 0.15485192495865216, 0.41256463572796914]
probh = 0.9775095984827586
sampled gamma:
probh = 0.9775095984827586
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 1, 2, 3, 2]

▶ iteration 38.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.582828   0.596814   0.167358  0.0
  0.0741736  0.187257   0.646502  0.0
  0.11584    0.0       -0.353133  0.0
 -0.244427   0.915497  -0.508933  0.0
  0.0        0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 66245.8        0.82769   0.547686  1.0
     1.20848e5  0.321217  0.542693  1.0
     0.166059   8.42038   0.872662  1.0
     6.82631e7  1.05513   0.618707  1.0
     1.0        1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.3032038117960977
 0.919100234890685
 0.899347470094006
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [2, 1, 2, 3, 2]
Si_comp1 = [2, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [3, 1, 2, 3, 2]
Si_comp1 = [3, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [4, 1, 2, 3, 2]
Si_comp1 = [4, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 3, 2, 3, 2]
Si_comp1 = [1, 3, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 4, 2, 3, 2]
Si_comp1 = [1, 4, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 1, 3, 2]
Si_comp1 = [1, 1, 1, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 1, 3, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 4, 3, 2]
Si_comp1 = [1, 1, 4, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 1, 2, 1, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 1, 2, 2, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 1.0]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 1, 2, 3, 1]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 1, 2, 3, 3]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 1, 2, 3, 4]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27657770110264573, 0.15420860508354678, 0.15420860508354678, 0.4150050887302608]
probh = 0.9762340329986302
sampled gamma:
probh = 0.9762340329986302
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27638945374469, 0.15410364592608283, 0.15410364592608283, 0.4154032544031443]
probh = 0.9762498246732071
sampled gamma:
probh = 0.9762498246732071
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27258310281868575, 0.15198137770121353, 0.15198137770121353, 0.4234541417788872]
probh = 0.9867991010756707
sampled gamma:
probh = 0.9867991010756707
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2763330561294445, 0.15407220088354184, 0.15407220088354184, 0.4155225421034718]
probh = 0.9866199248774927
sampled gamma:
probh = 0.9866199248774927
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2777315143547265, 0.15485192495865216, 0.15485192495865216, 0.41256463572796914]
probh = 0.9865531219208338
sampled gamma:
probh = 0.9865531219208338
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27657770110264573, 0.15420860508354678, 0.15420860508354678, 0.4150050887302608]
probh = 0.9699755454938307
sampled gamma:
probh = 0.9699755454938307
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27638945374469, 0.15410364592608283, 0.15410364592608283, 0.4154032544031443]
probh = 0.9699953679065025
sampled gamma:
probh = 0.9699953679065025
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27258310281868575, 0.15198137770121353, 0.15198137770121353, 0.4234541417788872]
probh = 0.9832751353373419
sampled gamma:
probh = 0.9832751353373419
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2763330561294445, 0.15407220088354184, 0.15407220088354184, 0.4155225421034718]
probh = 0.9830489498763183
sampled gamma:
probh = 0.9830489498763183
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2777315143547265, 0.15485192495865216, 0.15485192495865216, 0.41256463572796914]
probh = 0.9829646258850423
sampled gamma:
probh = 0.9829646258850423
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 1, 2, 3, 2]

▶ iteration 39.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.242217  0.596814   0.167358  0.0
 -0.431699  0.187257   0.646502  0.0
  0.563214  0.0       -0.353133  0.0
 -0.244427  0.915497  -0.508933  0.0
  0.0       0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 8.89724e7  1.27925   0.325319  1.0
 3.71211e7  0.337311  0.524781  1.0
 0.113844   7.80664   0.47061   1.0
 6.82631e7  1.05513   0.618707  1.0
 1.0        1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.21800150846061833
 0.7935213045628708
 0.9739341623318499
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [2, 1, 2, 3, 2]
Si_comp1 = [2, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [3, 1, 2, 3, 2]
Si_comp1 = [3, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [4, 1, 2, 3, 2]
Si_comp1 = [4, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 3, 2, 3, 2]
Si_comp1 = [1, 3, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 4, 2, 3, 2]
Si_comp1 = [1, 4, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 1, 3, 2]
Si_comp1 = [1, 1, 1, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 1, 3, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 4, 3, 2]
Si_comp1 = [1, 1, 4, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 1, 2, 1, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 1, 2, 2, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 1.0]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 1, 2, 3, 1]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 1, 2, 3, 3]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 1, 2, 3, 4]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27657770110264573, 0.15420860508354678, 0.15420860508354678, 0.4150050887302608]
probh = 0.9328644772872886
sampled gamma:
probh = 0.9328644772872886
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27638945374469, 0.15410364592608283, 0.15410364592608283, 0.4154032544031443]
probh = 0.9329071060279528
sampled gamma:
probh = 0.9329071060279528
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27258310281868575, 0.15198137770121353, 0.15198137770121353, 0.4234541417788872]
probh = 0.9619580166067392
sampled gamma:
probh = 0.9619580166067392
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2763330561294445, 0.15407220088354184, 0.15407220088354184, 0.4155225421034718]
probh = 0.9614548417030208
sampled gamma:
probh = 0.9614548417030208
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2777315143547265, 0.15485192495865216, 0.15485192495865216, 0.41256463572796914]
probh = 0.9612673290091512
sampled gamma:
probh = 0.9612673290091512
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27657770110264573, 0.15420860508354678, 0.15420860508354678, 0.4150050887302608]
probh = 0.9926522162612657
sampled gamma:
probh = 0.9926522162612657
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27638945374469, 0.15410364592608283, 0.15410364592608283, 0.4154032544031443]
probh = 0.9926571806682878
sampled gamma:
probh = 0.9926571806682878
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27258310281868575, 0.15198137770121353, 0.15198137770121353, 0.4234541417788872]
probh = 0.995948931993934
sampled gamma:
probh = 0.995948931993934
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2763330561294445, 0.15407220088354184, 0.15407220088354184, 0.4155225421034718]
probh = 0.9958934299047674
sampled gamma:
probh = 0.9958934299047674
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2777315143547265, 0.15485192495865216, 0.15485192495865216, 0.41256463572796914]
probh = 0.9958727332698273
sampled gamma:
probh = 0.9958727332698273
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 1, 2, 3, 2]

▶ iteration 40.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.498922  0.596814   0.167358  0.0
 -0.314287  0.187257   0.646502  0.0
  0.920302  0.0       -0.353133  0.0
 -0.244427  0.915497  -0.508933  0.0
  0.0       0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 3.94802e10   1.0108    0.691197  1.0
 1.65147e11   0.438075  1.76006   1.0
 0.417643    16.5331    1.20577   1.0
 6.82631e7    1.05513   0.618707  1.0
 1.0          1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.06689519144779431
 0.9100045478342922
 0.8068372800757065
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [2, 1, 2, 3, 2]
Si_comp1 = [2, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [3, 1, 2, 3, 2]
Si_comp1 = [3, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [4, 1, 2, 3, 2]
Si_comp1 = [4, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 3, 2, 3, 2]
Si_comp1 = [1, 3, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 4, 2, 3, 2]
Si_comp1 = [1, 4, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 1, 3, 2]
Si_comp1 = [1, 1, 1, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 1, 3, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 4, 3, 2]
Si_comp1 = [1, 1, 4, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 1, 2, 1, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 1, 2, 2, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 1.0]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 1, 2, 3, 1]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 1, 2, 3, 3]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 1, 2, 3, 4]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27657770110264573, 0.15420860508354678, 0.15420860508354678, 0.4150050887302608]
probh = 0.9733759109501077
sampled gamma:
probh = 0.9733759109501077
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27638945374469, 0.15410364592608283, 0.15410364592608283, 0.4154032544031443]
probh = 0.973393549990246
sampled gamma:
probh = 0.973393549990246
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27258310281868575, 0.15198137770121353, 0.15198137770121353, 0.4234541417788872]
probh = 0.9851922738214003
sampled gamma:
probh = 0.9851922738214003
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2763330561294445, 0.15407220088354184, 0.15407220088354184, 0.4155225421034718]
probh = 0.9849916198128498
sampled gamma:
probh = 0.9849916198128498
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2777315143547265, 0.15485192495865216, 0.15485192495865216, 0.41256463572796914]
probh = 0.9849168114706649
sampled gamma:
probh = 0.9849168114706649
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27657770110264573, 0.15420860508354678, 0.15420860508354678, 0.4150050887302608]
probh = 0.9378973910155174
sampled gamma:
probh = 0.9378973910155174
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27638945374469, 0.15410364592608283, 0.15410364592608283, 0.4154032544031443]
probh = 0.9379370366395466
sampled gamma:
probh = 0.9379370366395466
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27258310281868575, 0.15198137770121353, 0.15198137770121353, 0.4234541417788872]
probh = 0.9648919728236899
sampled gamma:
probh = 0.9648919728236899
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2763330561294445, 0.15407220088354184, 0.15407220088354184, 0.4155225421034718]
probh = 0.9644261697585084
sampled gamma:
probh = 0.9644261697585084
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2777315143547265, 0.15485192495865216, 0.15485192495865216, 0.41256463572796914]
probh = 0.9642525744065027
sampled gamma:
probh = 0.9642525744065027
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 1, 2, 3, 2]

▶ iteration 41.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -1.17434    0.596814   0.167358  0.0
  0.280923   0.187257   0.646502  0.0
  0.0153904  0.0       -0.353133  0.0
 -0.244427   0.915497  -0.508933  0.0
  0.0        0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 6.80869e12  0.387437  0.62384   1.0
 4.21407e12  0.288015  1.33096   1.0
 0.133486    9.09402   0.295898  1.0
 6.82631e7   1.05513   0.618707  1.0
 1.0         1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.0058859133744708966
 0.9458976551631063
 0.7275100129124001
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [2, 1, 2, 3, 2]
Si_comp1 = [2, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [3, 1, 2, 3, 2]
Si_comp1 = [3, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [4, 1, 2, 3, 2]
Si_comp1 = [4, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 3, 2, 3, 2]
Si_comp1 = [1, 3, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 4, 2, 3, 2]
Si_comp1 = [1, 4, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 1, 3, 2]
Si_comp1 = [1, 1, 1, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 1, 3, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 4, 3, 2]
Si_comp1 = [1, 1, 4, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 1, 2, 1, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 1, 2, 2, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 1.0]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 1, 2, 3, 1]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 1, 2, 3, 3]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 1, 2, 3, 4]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27657770110264573, 0.15420860508354678, 0.15420860508354678, 0.4150050887302608]
probh = 0.9844269881811545
sampled gamma:
probh = 0.9844269881811545
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27638945374469, 0.15410364592608283, 0.15410364592608283, 0.4154032544031443]
probh = 0.9844374227006564
sampled gamma:
probh = 0.9844374227006564
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27258310281868575, 0.15198137770121353, 0.15198137770121353, 0.4234541417788872]
probh = 0.9913820618512038
sampled gamma:
probh = 0.9913820618512038
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2763330561294445, 0.15407220088354184, 0.15407220088354184, 0.4155225421034718]
probh = 0.9912645396619587
sampled gamma:
probh = 0.9912645396619587
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2777315143547265, 0.15485192495865216, 0.15485192495865216, 0.41256463572796914]
probh = 0.9912207196163461
sampled gamma:
probh = 0.9912207196163461
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27657770110264573, 0.15420860508354678, 0.15420860508354678, 0.4150050887302608]
probh = 0.9061314831703082
sampled gamma:
probh = 0.9061314831703082
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27638945374469, 0.15410364592608283, 0.15410364592608283, 0.4154032544031443]
probh = 0.9061893794491009
sampled gamma:
probh = 0.9061893794491009
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27258310281868575, 0.15198137770121353, 0.15198137770121353, 0.4234541417788872]
probh = 0.9461410554608324
sampled gamma:
probh = 0.9461410554608324
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2763330561294445, 0.15407220088354184, 0.15407220088354184, 0.4155225421034718]
probh = 0.9454405379628243
sampled gamma:
probh = 0.9454405379628243
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2777315143547265, 0.15485192495865216, 0.15485192495865216, 0.41256463572796914]
probh = 0.9451795616692279
sampled gamma:
probh = 0.9451795616692279
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 1, 2, 3, 2]

▶ iteration 42.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -1.4052    0.596814   0.167358  0.0
 -0.546387  0.187257   0.646502  0.0
  0.483931  0.0       -0.353133  0.0
 -0.244427  0.915497  -0.508933  0.0
  0.0       0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 3.94382e15  1.27368   0.666404  1.0
 4.73761e15  0.493946  0.65441   1.0
 0.509125    7.48126   0.326766  1.0
 6.82631e7   1.05513   0.618707  1.0
 1.0         1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.13928196738273108
 0.9719043566266387
 0.9985465766730696
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [2, 1, 2, 3, 2]
Si_comp1 = [2, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [3, 1, 2, 3, 2]
Si_comp1 = [3, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [4, 1, 2, 3, 2]
Si_comp1 = [4, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 3, 2, 3, 2]
Si_comp1 = [1, 3, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 4, 2, 3, 2]
Si_comp1 = [1, 4, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 1, 3, 2]
Si_comp1 = [1, 1, 1, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 1, 3, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 4, 3, 2]
Si_comp1 = [1, 1, 4, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 1, 2, 1, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 1, 2, 2, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 1.0]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 1, 2, 3, 1]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 1, 2, 3, 3]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 1, 2, 3, 4]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27657770110264573, 0.15420860508354678, 0.15420860508354678, 0.4150050887302608]
probh = 0.9920681567116314
sampled gamma:
probh = 0.9920681567116314
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27638945374469, 0.15410364592608283, 0.15410364592608283, 0.4154032544031443]
probh = 0.9920735125776817
sampled gamma:
probh = 0.9920735125776817
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27258310281868575, 0.15198137770121353, 0.15198137770121353, 0.4234541417788872]
probh = 0.9956257665503189
sampled gamma:
probh = 0.9956257665503189
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2763330561294445, 0.15407220088354184, 0.15407220088354184, 0.4155225421034718]
probh = 0.9955658566108375
sampled gamma:
probh = 0.9955658566108375
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2777315143547265, 0.15485192495865216, 0.15485192495865216, 0.41256463572796914]
probh = 0.9955435164323383
sampled gamma:
probh = 0.9955435164323383
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27657770110264573, 0.15420860508354678, 0.15420860508354678, 0.4150050887302608]
probh = 0.9995975924105377
sampled gamma:
probh = 0.9995975924105377
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27638945374469, 0.15410364592608283, 0.15410364592608283, 0.4154032544031443]
probh = 0.9995978661914778
sampled gamma:
probh = 0.9995978661914778
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27258310281868575, 0.15198137770121353, 0.15198137770121353, 0.4234541417788872]
probh = 0.9997788341268059
sampled gamma:
probh = 0.9997788341268059
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2763330561294445, 0.15407220088354184, 0.15407220088354184, 0.4155225421034718]
probh = 0.9997757922076976
sampled gamma:
probh = 0.9997757922076976
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2777315143547265, 0.15485192495865216, 0.15485192495865216, 0.41256463572796914]
probh = 0.9997746577991663
sampled gamma:
probh = 0.9997746577991663
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 1, 2, 3, 2]

▶ iteration 43.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -1.39126   0.596814   0.167358  0.0
  0.153742  0.187257   0.646502  0.0
  0.477378  0.0       -0.353133  0.0
 -0.244427  0.915497  -0.508933  0.0
  0.0       0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 1.96789e17  1.0021    0.708491  1.0
 4.33642e17  0.212993  0.588709  1.0
 0.193291    5.64883   0.433107  1.0
 6.82631e7   1.05513   0.618707  1.0
 1.0         1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.08183799190700725
 0.9662665872018483
 0.787939796430021
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [2, 1, 2, 3, 2]
Si_comp1 = [2, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [3, 1, 2, 3, 2]
Si_comp1 = [3, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [4, 1, 2, 3, 2]
Si_comp1 = [4, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 3, 2, 3, 2]
Si_comp1 = [1, 3, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 4, 2, 3, 2]
Si_comp1 = [1, 4, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 1, 3, 2]
Si_comp1 = [1, 1, 1, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 1, 3, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 4, 3, 2]
Si_comp1 = [1, 1, 4, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 1, 2, 1, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 1, 2, 2, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 1.0]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 1, 2, 3, 1]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 1, 2, 3, 3]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 1, 2, 3, 4]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27657770110264573, 0.15420860508354678, 0.15420860508354678, 0.4150050887302608]
probh = 0.9904367125229596
sampled gamma:
probh = 0.9904367125229596
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27638945374469, 0.15410364592608283, 0.15410364592608283, 0.4154032544031443]
probh = 0.9904431593867579
sampled gamma:
probh = 0.9904431593867579
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27258310281868575, 0.15198137770121353, 0.15198137770121353, 0.4234541417788872]
probh = 0.9947221688428495
sampled gamma:
probh = 0.9947221688428495
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2763330561294445, 0.15407220088354184, 0.15407220088354184, 0.4155225421034718]
probh = 0.994649949640515
sampled gamma:
probh = 0.994649949640515
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2777315143547265, 0.15485192495865216, 0.15485192495865216, 0.41256463572796914]
probh = 0.9946230198463488
sampled gamma:
probh = 0.9946230198463488
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update rho]
movable_units = [5]
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 1, 2, 3, 1]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 1, 2, 3, 3]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 1, 2, 3, 4]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27657770110264573, 0.15420860508354678, 0.15420860508354678, 0.4150050887302608]
probh = 0.9307208213422002
sampled gamma:
probh = 0.9307208213422002
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27638945374469, 0.15410364592608283, 0.15410364592608283, 0.4154032544031443]
probh = 0.9307647102088477
sampled gamma:
probh = 0.9307647102088477
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27258310281868575, 0.15198137770121353, 0.15198137770121353, 0.4234541417788872]
probh = 0.9607041939404956
sampled gamma:
probh = 0.9607041939404956
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2763330561294445, 0.15407220088354184, 0.15407220088354184, 0.4155225421034718]
probh = 0.9601851213418859
sampled gamma:
probh = 0.9601851213418859
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2777315143547265, 0.15485192495865216, 0.15485192495865216, 0.41256463572796914]
probh = 0.9599916888052503
sampled gamma:
probh = 0.9599916888052503
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 1, 2, 3, 2]

▶ iteration 44.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.797735  0.596814   0.167358  0.0
 -0.643942  0.187257   0.646502  0.0
 -0.384476  0.0       -0.353133  0.0
 -0.244427  0.915497  -0.508933  0.0
  0.0       0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 5.76352e19   1.23651   0.330073  1.0
 1.12577e20   0.868414  0.971004  1.0
 0.303179    14.41      0.376299  1.0
 6.82631e7    1.05513   0.618707  1.0
 1.0          1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.04244118909180107
 0.8072936730096726
 0.9045714762817775
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [2, 1, 2, 3, 2]
Si_comp1 = [2, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [3, 1, 2, 3, 2]
Si_comp1 = [3, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [4, 1, 2, 3, 2]
Si_comp1 = [4, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 3, 2, 3, 2]
Si_comp1 = [1, 3, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 4, 2, 3, 2]
Si_comp1 = [1, 4, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 1, 3, 2]
Si_comp1 = [1, 1, 1, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 1, 3, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 4, 3, 2]
Si_comp1 = [1, 1, 4, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.5, 0.0, 0.5]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 1, 2, 1]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 1, 2, 2]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 1.0]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 1, 2, 3]
Si_comp2 = [1, 1, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3270046287595133, 0.18232463230342916, 0.49067073893705765]
probh = 0.9275937371009142
sampled gamma:
probh = 0.9275937371009142
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3267415120228054, 0.1821779289908333, 0.49108055898636144]
probh = 0.927647781888884
sampled gamma:
probh = 0.927647781888884
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3214352794279148, 0.17921938705688611, 0.4993453335151991]
probh = 0.9589742654693592
sampled gamma:
probh = 0.9589742654693592
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3266626967668691, 0.18213398477324527, 0.49120331845988574]
probh = 0.8950520394044735
sampled gamma:
probh = 0.8950520394044735
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3286187622697228, 0.18322460824521933, 0.48815662948505795]
probh = 0.958095836124289
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update rho]
movable_units = [4, 5]
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 1, 2, 1, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 1, 2, 2, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 1.0]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 1, 2, 3, 1]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 1, 2, 3, 3]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 1, 2, 3, 4]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27657770110264573, 0.15420860508354678, 0.15420860508354678, 0.4150050887302608]
probh = 0.9716494119879681
sampled gamma:
probh = 0.9716494119879681
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27638945374469, 0.15410364592608283, 0.15410364592608283, 0.4154032544031443]
probh = 0.9716681615777606
sampled gamma:
probh = 0.9716681615777606
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27258310281868575, 0.15198137770121353, 0.15198137770121353, 0.4234541417788872]
probh = 0.9842196108981415
sampled gamma:
probh = 0.9842196108981415
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2763330561294445, 0.15407220088354184, 0.15407220088354184, 0.4155225421034718]
probh = 0.9840059906674675
sampled gamma:
probh = 0.9840059906674675
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2777315143547265, 0.15485192495865216, 0.15485192495865216, 0.41256463572796914]
probh = 0.9839263496877783
sampled gamma:
probh = 0.9839263496877783
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 1, 2, 3, 2]

▶ iteration 45.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 -1.06231    0.596814   0.167358  0.0
  0.957535   0.187257   0.646502  0.0
  0.51372   -2.12544   -0.353133  0.0
 -0.244427   0.915497  -0.508933  0.0
  0.0        0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 2.00256e22  0.464956  0.55902   1.0
 4.79833e19  0.199407  0.771221  1.0
 1.31947e22  6.28402   0.379812  1.0
 6.82631e7   1.05513   0.618707  1.0
 1.0         1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.007819125577324951
 0.6503293553454699
 0.8895129691896533
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 3, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
rho_tmp = [2, 1, 2, 3, 3]
Si_comp1 = [2, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
rho_tmp = [3, 1, 2, 3, 3]
Si_comp1 = [3, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
rho_tmp = [4, 1, 2, 3, 3]
Si_comp1 = [4, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
rho_tmp = [1, 3, 2, 3, 3]
Si_comp1 = [1, 3, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
rho_tmp = [1, 4, 2, 3, 3]
Si_comp1 = [1, 4, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 3  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 1, 2, 2]
Si_comp1 = [1, 1, 1]
Si_comp2 = [1, 1, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 3  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 3  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 3, 2, 2]
Si_comp1 = [1, 1, 3]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.5, 0.5]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 4, 3]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.39991987245586275, 0.6000801275441373]
probh = 0.8230250309500186
sampled gamma:
probh = 0.8230250309500186
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3995264050768606, 0.6004735949231395]
probh = 0.8231683606730639
sampled gamma:
probh = 0.8231683606730639
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2641153918314374, 0.7358846081685626]
probh = 0.7165006235485791
sampled gamma:
probh = 0.7165006235485791
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21290484827105935, 0.21290484827105935, 0.5741903034578812]
probh = 0.7640983692921306
sampled gamma:
probh = 0.7640983692921306
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21439662402037066, 0.21439662402037066, 0.5712067519592587]
probh = 0.8966380010688448
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 0, 0]
												[update rho]
movable_units = [2, 4, 5]
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 1  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 1  2  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 1  2  2  0
rho_tmp = [1, 3, 2, 3, 2]
Si_comp1 = [1, 3, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 1  2  2  0
rho_tmp = [1, 4, 2, 3, 2]
Si_comp1 = [1, 4, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 1  2  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 1, 2, 1, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 1  2  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 1, 2, 2, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 1  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 1.0]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 1  2  2  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 1, 2, 3, 1]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 1  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 1  2  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 1, 2, 3, 3]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 1  2  2  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 1, 2, 3, 4]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27657770110264573, 0.15420860508354678, 0.15420860508354678, 0.4150050887302608]
probh = 0.9667870830218248
sampled gamma:
probh = 0.9667870830218248
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27638945374469, 0.15410364592608283, 0.15410364592608283, 0.4154032544031443]
probh = 0.9668089384542617
sampled gamma:
probh = 0.9668089384542617
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27258310281868575, 0.15198137770121353, 0.15198137770121353, 0.4234541417788872]
probh = 0.9814720516097131
sampled gamma:
probh = 0.9814720516097131
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2763330561294445, 0.15407220088354184, 0.15407220088354184, 0.4155225421034718]
probh = 0.981221947104093
sampled gamma:
probh = 0.981221947104093
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2777315143547265, 0.15485192495865216, 0.15485192495865216, 0.41256463572796914]
probh = 0.9811287090503434
sampled gamma:
probh = 0.9811287090503434
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 1, 2, 3, 2]

▶ iteration 46.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 1  2  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.065504   0.596814   0.167358  0.0
 -0.33605    0.187257   0.646502  0.0
  1.43821   -1.18146   -0.353133  0.0
 -0.244427   0.915497  -0.508933  0.0
  0.0        0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 2.94268e21  1.22736   0.429488  1.0
 0.42357     0.403516  0.860371  1.0
 2.33052e20  6.01925   0.832748  1.0
 6.82631e7   1.05513   0.618707  1.0
 1.0         1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.16204966710661955
 0.59745120283395
 0.9696422427619389
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 3, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 1  2  2  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 1  2  2  0
rho_tmp = [2, 1, 2, 3, 1]
Si_comp1 = [2, 2]
Si_comp2 = [1, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 1  2  2  0
rho_tmp = [3, 1, 2, 3, 1]
Si_comp1 = [3, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 1  2  2  0
rho_tmp = [4, 1, 2, 3, 1]
Si_comp1 = [4, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.0, 0.3333333333333333, 0.3333333333333333]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 4  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 3, 4, 2]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 4  3  3  0
 2  2  2  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 4  3  3  0
 2  2  2  0
rho_tmp = [1, 3, 3, 4, 2]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 4  3  3  0
 2  2  2  0
rho_tmp = [1, 4, 3, 4, 2]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 4  3  3  0
 2  2  2  0
rho_tmp = [1, 5, 3, 4, 2]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 4]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 3  3  3  0
 4  2  2  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = [1, 1]
Si_comp2 = [1, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 3  3  3  0
 4  2  2  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 3  3  3  0
 4  2  2  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 3  3  3  0
 4  2  2  0
rho_tmp = [1, 2, 4, 3, 4]
Si_comp1 = [1, 4]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 3  3  3  0
 4  2  2  0
rho_tmp = [1, 2, 5, 3, 4]
Si_comp1 = [1, 5]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  3  3  0
 4  2  2  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  3  3  0
 4  2  2  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  3  3  0
 4  2  2  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  3  3  0
 4  2  2  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  3  3  0
 4  2  2  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 2, 4]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  3  0
 4  2  2  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  3  0
 4  2  2  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  3  0
 4  2  2  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  3  0
 4  2  2  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 2, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2709151356678167, 0.7290848643321833]
probh = 0.845639966854112
sampled gamma:
probh = 0.845639966854112
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2705913586595647, 0.7294086413404354]
probh = 0.8457959986927153
sampled gamma:
probh = 0.8457959986927153
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2641153918314374, 0.7358846081685626]
probh = 0.6685287318977242
sampled gamma:
probh = 0.6685287318977242
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21290484827105935, 0.21290484827105935, 0.5741903034578812]
probh = 0.7210449225997095
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21439662402037066, 0.21439662402037066, 0.5712067519592587]
probh = 0.8737779785504504
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update rho]
movable_units = [1, 4, 5]
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [2, 1, 2, 3, 2]
Si_comp1 = [2, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [3, 1, 2, 3, 2]
Si_comp1 = [3, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [4, 1, 2, 3, 2]
Si_comp1 = [4, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 1, 2, 1, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 1, 2, 2, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 1.0]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 1, 2, 3, 1]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 1, 2, 3, 3]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 1, 2, 3, 4]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27657770110264573, 0.15420860508354678, 0.15420860508354678, 0.4150050887302608]
probh = 0.9914151860860041
sampled gamma:
probh = 0.9914151860860041
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27638945374469, 0.15410364592608283, 0.15410364592608283, 0.4154032544031443]
probh = 0.9914209790485083
sampled gamma:
probh = 0.9914209790485083
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27258310281868575, 0.15198137770121353, 0.15198137770121353, 0.4234541417788872]
probh = 0.995264269862085
sampled gamma:
probh = 0.995264269862085
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2763330561294445, 0.15407220088354184, 0.15407220088354184, 0.4155225421034718]
probh = 0.9951994327002396
sampled gamma:
probh = 0.9951994327002396
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2777315143547265, 0.15485192495865216, 0.15485192495865216, 0.41256463572796914]
probh = 0.9951752553451528
sampled gamma:
probh = 0.9951752553451528
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 1, 2, 3, 2]

▶ iteration 47.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  3  0
 2  2  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.730014   0.596814   0.167358  0.0
 -0.628629   0.187257   0.646502  0.0
  0.775864  -0.207283  -0.353133  0.0
 -0.065504   0.915497  -0.508933  0.0
  0.0        0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 0.237323    0.448761  0.809521  1.0
 0.587669    0.18552   0.412758  1.0
 3.15086e19  9.78326   0.634286  1.0
 2.94268e21  1.05513   0.618707  1.0
 1.0         1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.2980881084563135
 0.20246996419850005
 0.8663440227335236
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 2, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  1  1  0
 1  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = [2, 1]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  1  1  0
 1  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [2, 2, 1, 2, 2]
Si_comp1 = [2, 1]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  1  1  0
 1  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [3, 2, 1, 2, 2]
Si_comp1 = [2, 1]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 2, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 3, 2, 2]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = [2, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [1, 3, 3, 2, 2]
Si_comp1 = [3, 3]
Si_comp2 = [1, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [1, 4, 3, 2, 2]
Si_comp1 = [4, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.0, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 3  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 1, 2, 2]
Si_comp1 = [1, 1]
Si_comp2 = [1, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 3  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 3  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 3, 2, 2]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.5, 0.5]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 4, 3]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.39991987245586275, 0.6000801275441373]
probh = 0.38830637858699923
sampled gamma:
probh = 0.38830637858699923
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3995264050768606, 0.6004735949231395]
probh = 0.3885402115168124
sampled gamma:
probh = 0.3885402115168124
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.39162143252303233, 0.6083785674769677]
probh = 0.29442889981527043
sampled gamma:
probh = 0.29442889981527043
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.4809479558687055, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3266626967668691, 0.18213398477324527, 0.49120331845988574]
probh = 0.3407326929139351
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.493139943485671, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3286187622697228, 0.18322460824521933, 0.48815662948505795]
probh = 0.580813691544678
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update rho]
movable_units = [4, 5]
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  2  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 1, 2, 1, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  2  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 1, 2, 2, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 1.0]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  2  2  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 1, 2, 3, 1]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2, 3, 2]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  2  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 1, 2, 3, 3]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  2  2  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 1, 2, 3, 4]
Si_comp2 = [1, 1, 2, 3, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1, 2, 3]
Si_red1 = [1, 1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27657770110264573, 0.15420860508354678, 0.15420860508354678, 0.4150050887302608]
probh = 0.9590768936016315
sampled gamma:
probh = 0.9590768936016315
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1755738340553516, 0.1755738340553516, 0.1755738340553516, 0.47327849783394516]
probh = 0.9736275398248373
sampled gamma:
probh = 0.9736275398248373
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17282428456152657, 0.17282428456152657, 0.17282428456152657, 0.48152714631542043]
probh = 0.9740298163084575
sampled gamma:
probh = 0.9740298163084575
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17553301775860286, 0.17553301775860286, 0.17553301775860286, 0.4734009467241914]
probh = 0.9736335090775198
sampled gamma:
probh = 0.9736335090775198
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1765458004244042, 0.1765458004244042, 0.1765458004244042, 0.4703625987267872]
probh = 0.973485414477428
sampled gamma:
probh = 0.973485414477428
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update rho]
movable_units = [1]
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  2  2  0
rho_tmp = [2, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  2  2  0
rho_tmp = [3, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  2  2  0
rho_tmp = [4, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 3, 1]

▶ iteration 48.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  3  0
 1  2  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.971786  0.596814   0.646502  0.0
  1.44765   0.187257   0.167358  0.0
  1.3962    1.58148   -0.353133  0.0
 -0.065504  0.915497  -0.508933  0.0
  0.0       0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 53.3264       0.662933  0.54301   1.0
  3.38873      0.659546  0.839658  1.0
  0.587669    10.257     1.28607   1.0
  2.94268e21   1.05513   0.618707  1.0
  1.0          1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.07569941599016462
 0.7506703317817573
 0.8808187527004893
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  3  0
 1  2  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  3  0
 1  2  1  0
rho_tmp = [2, 1, 2, 2, 1]
Si_comp1 = [2, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  3  0
 1  2  1  0
rho_tmp = [3, 1, 2, 2, 1]
Si_comp1 = [3, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  3  0
 1  2  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  3  0
 1  2  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  3  0
 1  2  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  3  0
 1  2  1  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [1, 1, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  3  0
 1  2  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  3  0
 1  2  1  0
rho_tmp = [1, 1, 3, 2, 1]
Si_comp1 = [1, 1, 3]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.5, 0.5]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  3  0
 1  2  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  3  0
 1  2  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  3  0
 1  2  1  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  3  0
 1  2  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  3  0
 1  2  1  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  3  0
 1  2  1  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 2, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4830789743074355, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.39991987245586275, 0.6000801275441373]
probh = 0.8827446215792804
sampled gamma:
probh = 0.8827446215792804
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4814391479313045, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3995264050768606, 0.6004735949231395]
probh = 0.8828464698605564
sampled gamma:
probh = 0.8828464698605564
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2641153918314374, 0.7358846081685626]
probh = 0.8035880540217409
sampled gamma:
probh = 0.8035880540217409
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21290484827105935, 0.21290484827105935, 0.5741903034578812]
probh = 0.8398328588094779
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21439662402037066, 0.21439662402037066, 0.5712067519592587]
probh = 0.9335235344177234
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 0, 0]
												[update rho]
movable_units = [2, 4, 5]
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  3  0
 3  2  1  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 2, 3, 2]
Si_comp2 = [2, 1, 3, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  3  0
 3  2  1  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [2, 2, 3, 2]
Si_comp2 = [2, 1, 3, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  3  0
 3  2  1  0
rho_tmp = [1, 3, 2, 3, 2]
Si_comp1 = [3, 2, 3, 2]
Si_comp2 = [2, 1, 3, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  3  0
 3  2  1  0
rho_tmp = [1, 4, 2, 3, 2]
Si_comp1 = [4, 2, 3, 2]
Si_comp2 = [2, 1, 3, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.0, 0.5]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  4  3  0
 3  3  1  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [2, 3, 1, 3]
Si_comp2 = [2, 1, 3, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  4  3  0
 3  3  1  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [2, 3, 2, 3]
Si_comp2 = [2, 1, 3, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  4  3  0
 3  3  1  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [2, 3, 3, 3]
Si_comp2 = [2, 1, 3, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  4  3  0
 3  3  1  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [2, 3, 4, 3]
Si_comp2 = [2, 1, 3, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.0, 0.5]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  4  3  0
 3  3  1  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [2, 3, 4, 1]
Si_comp2 = [2, 1, 3, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  4  3  0
 3  3  1  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [2, 3, 4, 2]
Si_comp2 = [2, 1, 3, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  4  3  0
 3  3  1  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [2, 3, 4, 3]
Si_comp2 = [2, 1, 3, 1]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  4  3  0
 3  3  1  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [2, 3, 4, 4]
Si_comp2 = [2, 1, 3, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  4  3  0
 3  3  1  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [2, 3, 4, 5]
Si_comp2 = [2, 1, 3, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 1, 3]
Si_red1 = [1, 2, 1, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.966311142624624, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18568899212440815, 0.17358293326052093, 0.17358293326052093, 0.46714514135455]
probh = 0.9754907132884798
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1755738340553516, 0.1755738340553516, 0.1755738340553516, 0.47327849783394516]
probh = 0.9767948422657581
sampled gamma:
probh = 0.9767948422657581
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17282428456152657, 0.17282428456152657, 0.17282428456152657, 0.48152714631542043]
probh = 0.9771499396580547
sampled gamma:
probh = 0.9771499396580547
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17553301775860286, 0.17553301775860286, 0.17553301775860286, 0.4734009467241914]
probh = 0.9768001117005081
sampled gamma:
probh = 0.9768001117005081
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1765458004244042, 0.1765458004244042, 0.1765458004244042, 0.4703625987267872]
probh = 0.976669376991349
sampled gamma:
probh = 0.976669376991349
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update rho]
movable_units = [1]
Si_iter[:, t] = [1, 2, 1, 3, 1]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  4  3  0
 3  3  1  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  4  3  0
 3  3  1  0
rho_tmp = [2, 2, 1, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  4  3  0
 3  3  1  0
rho_tmp = [3, 2, 1, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  4  3  0
 3  3  1  0
rho_tmp = [4, 2, 1, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]

▶ iteration 49.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  4  0
 3  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.0908286  0.596814   0.414943  0.0
 -1.43787    1.31945    0.167358  0.0
 -0.132128   0.187257   0.646502  0.0
 -0.0175138  0.634592  -0.353133  0.0
  0.0        0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 8.1928       0.386098  0.727701  1.0
 8.89588      0.393999  2.30479   1.0
 1.02121      0.443545  0.537449  1.0
 2.94268e21  11.2994    0.449837  1.0
 1.0          1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.13007006362262494
 0.4126815194516889
 0.9204847148344386
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 2]
Si_comp2 = [1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [2, 1, 2, 2, 3]
Si_comp1 = [2, 2]
Si_comp2 = [1, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [3, 1, 2, 2, 3]
Si_comp1 = [3, 2]
Si_comp2 = [1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [4, 1, 2, 2, 3]
Si_comp1 = [4, 2]
Si_comp2 = [1, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.0, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 2]
Si_comp2 = [1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2]
Si_comp2 = [1, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 3, 2, 2, 3]
Si_comp1 = [1, 2]
Si_comp2 = [1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 4, 2, 2, 3]
Si_comp1 = [1, 2]
Si_comp2 = [1, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = [1, 1]
Si_comp2 = [1, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 3]
Si_comp2 = [1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 4, 3, 2]
Si_comp1 = [1, 4]
Si_comp2 = [1, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 1, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2]
Si_comp2 = [1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = [1, 2]
Si_comp2 = [1, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 1, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2709151356678167, 0.7290848643321833]
probh = 0.4907695660306119
sampled gamma:
probh = 0.4907695660306119
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2705913586595647, 0.7294086413404354]
probh = 0.7219699718276188
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.4126815194516889
sampled gamma:
probh = 0.4126815194516889
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27049442218439607, 0.7295055778156039]
probh = 0.4906253967521326
sampled gamma:
probh = 0.4906253967521326
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.272906953528583, 0.727093046471417]
probh = 0.720256300914825
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update rho]
movable_units = [1, 2, 4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [2, 3, 1, 3]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 3  3  3  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = [2, 3, 1, 3]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 3  3  3  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = [2, 3, 1, 3]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 3  3  3  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = [2, 3, 1, 3]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 1, 3]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  3  2  0
 2  2  3  0
 1  1  4  0
 3  2  3  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 2, 1, 2]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  3  2  0
 2  2  3  0
 1  1  4  0
 3  2  3  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [2, 2, 1, 2]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  3  2  0
 2  2  3  0
 1  1  4  0
 3  2  3  0
rho_tmp = [1, 3, 2, 1, 2]
Si_comp1 = [3, 2, 1, 2]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 1.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 1, 3]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [2, 3, 1, 3]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [2, 3, 2, 3]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [2, 3, 3, 3]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [2, 3, 4, 3]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.0, 0.5]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 1, 3]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = [2, 3, 1, 1]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = [2, 3, 1, 2]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [2, 3, 1, 3]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [2, 3, 1, 4]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 1, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9872544206120802
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1755738340553516, 0.1755738340553516, 0.1755738340553516, 0.47327849783394516]
probh = 0.9850597994116691
sampled gamma:
probh = 0.9850597994116691
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17282428456152657, 0.17282428456152657, 0.17282428456152657, 0.48152714631542043]
probh = 0.9852903267288419
sampled gamma:
probh = 0.9852903267288419
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17553301775860286, 0.17553301775860286, 0.17553301775860286, 0.4734009467241914]
probh = 0.9850632207367274
sampled gamma:
probh = 0.9850632207367274
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1765458004244042, 0.1765458004244042, 0.1765458004244042, 0.4703625987267872]
probh = 0.984978333757152
sampled gamma:
probh = 0.984978333757152
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update rho]
movable_units = [1]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 2  2  2  0
 2  3  3  0
 1  1  1  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 2  2  2  0
 2  3  3  0
 1  1  1  0
 3  3  3  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 2  2  2  0
 2  3  3  0
 1  1  1  0
 3  3  3  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 2  2  2  0
 2  3  3  0
 1  1  1  0
 3  3  3  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]

▶ iteration 50.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 3  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.186017   0.634592  -0.645192  0.0
  0.31958    0.678737   0.167358  0.0
 -0.0314681  0.187257   0.646502  0.0
  0.65624    0.596814  -0.353133  0.0
  0.0        0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 231.305       5.10821   0.788252  1.0
   8.823       0.440571  0.670556  1.0
   0.29322     0.190125  1.00672   1.0
   2.94268e21  0.386098  1.09399   1.0
   1.0         1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.07774410252209445
 0.4756774886201254
 0.8872060463047523
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 1, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 3  3  3  0
rho_tmp = [2, 2, 2, 1, 3]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 3  3  3  0
rho_tmp = [3, 2, 2, 1, 3]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 3  3  3  0
rho_tmp = [4, 2, 2, 1, 3]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  4  0
 1  3  3  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  4  0
 1  3  3  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  4  0
 1  3  3  0
rho_tmp = [1, 3, 2, 3, 1]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  4  0
 1  3  3  0
rho_tmp = [1, 4, 2, 3, 1]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 3, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  4  0
 1  3  3  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  4  0
 1  3  3  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  4  0
 1  3  3  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  4  0
 1  3  3  0
rho_tmp = [1, 2, 4, 3, 1]
Si_comp1 = [4]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 3, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  4  0
 1  3  3  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  4  0
 1  3  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  4  0
 1  3  3  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  4  0
 1  3  3  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  4  0
 1  3  3  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  4  0
 1  3  3  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  4  0
 1  3  3  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2709151356678167, 0.7290848643321833]
probh = 0.5544329765886954
sampled gamma:
probh = 0.5544329765886954
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21296489765602558, 0.21296489765602558, 0.5740702046879489]
probh = 0.8098846799685556
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2641153918314374, 0.7358846081685626]
probh = 0.5521385425593222
sampled gamma:
probh = 0.5521385425593222
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27049442218439607, 0.7295055778156039]
probh = 0.7703231721342946
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.272906953528583, 0.727093046471417]
probh = 0.5551086901064923
sampled gamma:
probh = 0.5551086901064923
gt = true
gamma_iter[:, t] = Bool[1, 0, 0, 0, 1]
												[update rho]
movable_units = [2, 3, 4]
Si_iter[:, t] = [1, 2, 3, 1, 3]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  3  2  0
 2  2  3  0
 3  1  4  0
 3  2  3  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 2, 1, 2]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  3  2  0
 2  2  3  0
 3  1  4  0
 3  2  3  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [2, 2, 1, 2]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  3  2  0
 2  2  3  0
 3  1  4  0
 3  2  3  0
rho_tmp = [1, 3, 2, 1, 2]
Si_comp1 = [3, 2, 1, 2]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 1.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 1, 3]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  4  0
 3  3  3  0
rho_tmp = [1, 2, 1, 1, 3]
Si_comp1 = [2, 1, 1, 3]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = [2, 2, 1, 3]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [2, 3, 1, 3]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  4  0
 3  3  3  0
rho_tmp = [1, 2, 4, 1, 3]
Si_comp1 = [2, 4, 1, 3]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 1, 3]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [2, 3, 1, 3]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [2, 3, 2, 3]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [2, 3, 3, 3]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [2, 3, 4, 3]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.0, 0.5]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9813540926947694
sampled gamma:
probh = 0.9813540926947694
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9813661631401731
sampled gamma:
probh = 0.9813661631401731
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.9816103994549698
sampled gamma:
probh = 0.9816103994549698
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.9813697795192079
sampled gamma:
probh = 0.9813697795192079
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.9812801275980009
sampled gamma:
probh = 0.9812801275980009
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]

▶ iteration 51.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 3  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.381892   0.634592  -0.645192  0.0
 -0.12839    1.60161    0.167358  0.0
 -0.605163   0.187257   0.646502  0.0
  0.523671  -0.305207  -0.353133  0.0
  0.0        0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
    0.553831    0.506892  0.537573  1.0
 1898.09        0.351846  1.60747   1.0
    3.76892     0.937246  0.574216  1.0
    2.94268e21  9.6781    0.3105    1.0
    1.0         1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.021922963830169742
 0.5851660481705324
 0.9951221042718166
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 3, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 1  3  3  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 1]
Si_comp2 = [1, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 1  3  3  0
rho_tmp = [2, 2, 2, 1, 1]
Si_comp1 = [2, 1]
Si_comp2 = [1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 1  3  3  0
rho_tmp = [3, 2, 2, 1, 1]
Si_comp1 = [3, 1]
Si_comp2 = [1, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.5, 0.5]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 3  3  3  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 3]
Si_comp2 = [1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = [1, 3]
Si_comp2 = [1, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 3  3  3  0
rho_tmp = [1, 3, 2, 3, 3]
Si_comp1 = [1, 3]
Si_comp2 = [1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 3  3  3  0
rho_tmp = [1, 4, 2, 3, 3]
Si_comp1 = [1, 3]
Si_comp2 = [1, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 2, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 2  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 2  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 2  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 1, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 1]
Si_comp2 = [1, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = [1, 3]
Si_comp2 = [1, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.5, 0.5]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 1, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2709151356678167, 0.7290848643321833]
probh = 0.6592564500442557
sampled gamma:
probh = 0.6592564500442557
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2705913586595647, 0.7294086413404354]
probh = 0.6591567066272402
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2641153918314374, 0.7358846081685626]
probh = 0.6571680267016007
sampled gamma:
probh = 0.6571680267016007
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27049442218439607, 0.7295055778156039]
probh = 0.8390965291444892
sampled gamma:
probh = 0.8390965291444892
gt = true
gamma_iter[:, t] = Bool[0, 0, 0, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.272906953528583, 0.727093046471417]
probh = 0.6598707182551011
sampled gamma:
probh = 0.6598707182551011
gt = true
gamma_iter[:, t] = Bool[0, 0, 0, 1, 1]
												[update rho]
movable_units = [1, 2, 3]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 2  3  3  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = [2, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 2  3  3  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = [3, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 2  3  3  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = [4, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  2  0
 2  3  3  0
 1  2  4  0
 2  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [1, 1, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  2  0
 2  3  3  0
 1  2  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  2  0
 2  3  3  0
 1  2  4  0
 2  3  3  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = [1, 3, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  2  0
 2  3  3  0
 1  2  4  0
 2  3  3  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = [1, 4, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = [1, 2, 1, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [1, 2, 2, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 4, 4, 3]
Si_comp1 = [1, 2, 4, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 5, 4, 3]
Si_comp1 = [1, 2, 5, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9992679604289958
sampled gamma:
probh = 0.9992679604289958
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9992684429602249
sampled gamma:
probh = 0.9992684429602249
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.9992782041646354
sampled gamma:
probh = 0.9992782041646354
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.9992685875273029
sampled gamma:
probh = 0.9992685875273029
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.9992650033322008
sampled gamma:
probh = 0.9992650033322008
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]

▶ iteration 52.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.13056    0.0984946  -0.645192  0.0
  0.319392  -0.0691328   0.167358  0.0
 -0.809201   0.187257    0.646502  0.0
  0.616758  -0.305207   -0.353133  0.0
  0.0        0.0         0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 20044.4         0.347183  0.28519   1.0
 74313.9         2.35042   0.55578   1.0
  1898.09        0.223542  1.91452   1.0
     2.94268e21  7.38261   0.639994  1.0
     1.0         1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.009629120011354693
 0.2846533627052559
 0.7403161974618329
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 1, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [1, 2]
Si_comp2 = [4, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [2, 2, 2, 1, 2]
Si_comp1 = [1, 2]
Si_comp2 = [4, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [3, 2, 2, 1, 2]
Si_comp1 = [1, 2]
Si_comp2 = [4, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [3, 2]
Si_comp2 = [4, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [3, 2]
Si_comp2 = [4, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 3, 2, 3, 2]
Si_comp1 = [3, 2]
Si_comp2 = [4, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 4, 2, 3, 2]
Si_comp1 = [3, 2]
Si_comp2 = [4, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 2, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 1, 2, 3]
Si_comp1 = [2, 3]
Si_comp2 = [4, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2, 3]
Si_comp2 = [4, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [2, 3]
Si_comp2 = [4, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 4, 2, 3]
Si_comp1 = [2, 3]
Si_comp2 = [4, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = [1, 3]
Si_comp2 = [4, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2, 3]
Si_comp2 = [4, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = [3, 3]
Si_comp2 = [4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [4, 3]
Si_comp2 = [4, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.0, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 1, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 1]
Si_comp2 = [4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [1, 2]
Si_comp2 = [4, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = [1, 3]
Si_comp2 = [4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.5, 0.5]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 1, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21316540189401498, 0.21316540189401498, 0.5736691962119701]
probh = 0.4095580429858122
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21296489765602558, 0.21296489765602558, 0.5740702046879489]
probh = 0.40938907458992024
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20893297679794065, 0.20893297679794065, 0.5821340464041186]
probh = 0.6557128009886185
sampled gamma:
probh = 0.6557128009886185
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21290484827105935, 0.21290484827105935, 0.5741903034578812]
probh = 0.6514490725112873
sampled gamma:
probh = 0.6514490725112873
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.272906953528583, 0.727093046471417]
probh = 0.5931805406866346
sampled gamma:
probh = 0.5931805406866346
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update rho]
movable_units = [1, 2, 4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 2  3  3  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = [2, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 2  3  3  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = [3, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 2  3  3  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = [4, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  2  0
 2  3  3  0
 1  2  4  0
 2  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [1, 1, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  2  0
 2  3  3  0
 1  2  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  2  0
 2  3  3  0
 1  2  4  0
 2  3  3  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = [1, 3, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  2  0
 2  3  3  0
 1  2  4  0
 2  3  3  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = [1, 4, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [1, 2, 3, 4, 1]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [1, 2, 3, 4, 2]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [1, 2, 3, 4, 5]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9501880405288605
sampled gamma:
probh = 0.9501880405288605
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9502192629194006
sampled gamma:
probh = 0.9502192629194006
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.9508513002441531
sampled gamma:
probh = 0.9508513002441531
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.9502286175879048
sampled gamma:
probh = 0.9502286175879048
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.949996744458764
sampled gamma:
probh = 0.949996744458764
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]

▶ iteration 53.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.117269  -0.120916  -0.645192  0.0
  0.257283   0.333916   0.167358  0.0
 -0.80148    0.187257   0.646502  0.0
  0.75075   -0.173954  -0.353133  0.0
  0.0        0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
     3.44333     0.470938  0.160737  1.0
  3636.29        0.28676   0.348512  1.0
 74313.9         0.1512    0.429944  1.0
     2.94268e21  5.88207   0.903301  1.0
     1.0         1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.1385268741300193
 0.1012444157901472
 0.7150114448350038
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 1, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [2, 2, 2, 1, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [3, 2, 2, 1, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 3, 2, 3, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 4, 2, 3, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 4, 3, 2]
Si_comp1 = [4]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 3, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 2, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 1, 2, 3]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 2, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2709151356678167, 0.7290848643321833]
probh = 0.13383028140208753
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2705913586595647, 0.7294086413404354]
probh = 0.29393926988719316
sampled gamma:
probh = 0.29393926988719316
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.1012444157901472
sampled gamma:
probh = 0.1012444157901472
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.1012444157901472
sampled gamma:
probh = 0.1012444157901472
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.1012444157901472
sampled gamma:
probh = 0.1012444157901472
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 1  3  3  0
 2  1  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 1  3  3  0
 2  1  4  0
 2  3  3  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = [2, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 1  3  3  0
 2  1  4  0
 2  3  3  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = [3, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 1  3  3  0
 2  1  4  0
 2  3  3  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = [4, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  2  0
 1  3  3  0
 2  2  4  0
 2  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [1, 1, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  2  0
 1  3  3  0
 2  2  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  2  0
 1  3  3  0
 2  2  4  0
 2  3  3  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = [1, 3, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  2  0
 1  3  3  0
 2  2  4  0
 2  3  3  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = [1, 4, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = [1, 2, 1, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [1, 2, 2, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 4, 4, 3]
Si_comp1 = [1, 2, 4, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 5, 4, 3]
Si_comp1 = [1, 2, 5, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [1, 2, 3, 4, 1]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [1, 2, 3, 4, 2]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [1, 2, 3, 4, 5]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9437811227103511
sampled gamma:
probh = 0.9437811227103511
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9438161235333267
sampled gamma:
probh = 0.9438161235333267
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.9445247115836493
sampled gamma:
probh = 0.9445247115836493
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.9438266103310731
sampled gamma:
probh = 0.9438266103310731
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.9435666830695101
sampled gamma:
probh = 0.9435666830695101
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]

▶ iteration 54.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  4  0
 2  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 -1.16994    -2.95728   -0.645192  0.0
 -0.538363    0.36894    0.167358  0.0
 -0.748687    0.187257   0.646502  0.0
  0.0103257  -0.50507   -0.353133  0.0
  0.0         0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
  0.975531    6.92908   0.297689  1.0
 76.5652      0.560265  1.04135   1.0
  3.44333     0.480922  0.755434  1.0
  2.94268e21  5.15465   1.01681   1.0
  1.0         1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.11205440161112959
 0.16831523163699041
 0.9947775291424255
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 1, 2, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  4  0
 2  3  3  0
rho_tmp = [2, 2, 1, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  4  0
 2  3  3  0
rho_tmp = [3, 2, 1, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 1, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 1  4  4  0
 1  3  3  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 1  4  4  0
 1  3  3  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 1  4  4  0
 1  3  3  0
rho_tmp = [1, 3, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 1, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 1  3  3  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 1  3  3  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 1  3  3  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 1, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 1  3  3  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 1  3  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 1  3  3  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 1, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 1  3  3  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 1  3  3  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 1  3  3  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 1, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.16831523163699041
sampled gamma:
probh = 0.16831523163699041
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.16831523163699041
sampled gamma:
probh = 0.16831523163699041
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.16831523163699041
sampled gamma:
probh = 0.16831523163699041
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.16831523163699041
sampled gamma:
probh = 0.16831523163699041
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.16831523163699041
sampled gamma:
probh = 0.16831523163699041
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 3  3  3  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = [2, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 3  3  3  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = [3, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 2  3  3  0
 1  1  4  0
 3  3  3  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = [4, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  2  0
 2  3  3  0
 1  2  4  0
 3  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [1, 1, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  2  0
 2  3  3  0
 1  2  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  2  0
 2  3  3  0
 1  2  4  0
 3  3  3  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = [1, 3, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  2  0
 2  3  3  0
 1  2  4  0
 3  3  3  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = [1, 4, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = [1, 2, 1, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [1, 2, 2, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 4, 4, 3]
Si_comp1 = [1, 2, 4, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 5, 4, 3]
Si_comp1 = [1, 2, 5, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [1, 2, 3, 4, 1]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [1, 2, 3, 4, 2]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [1, 2, 3, 4, 5]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9992160183421093
sampled gamma:
probh = 0.9992160183421093
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9992165350846421
sampled gamma:
probh = 0.9992165350846421
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.9992269883628045
sampled gamma:
probh = 0.9992269883628045
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.9992166899014848
sampled gamma:
probh = 0.9992166899014848
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.9992128515889079
sampled gamma:
probh = 0.9992128515889079
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]

▶ iteration 55.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 3  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.131676  -1.03799   -0.645192  0.0
 -0.803191  -3.91705    0.167358  0.0
  0.478026   0.187257   0.646502  0.0
 -0.271735   1.58438   -0.353133  0.0
  0.0        0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 0.191724    2.04192  0.226512  1.0
 1.06841     9.89761  1.2328    1.0
 0.617923    0.95393  1.68664   1.0
 2.94268e21  6.41259  1.00771   1.0
 1.0         1.0      1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.14278873784499305
 0.020022679112739753
 0.6917729856610206
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 1, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [2, 2, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [3, 2, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [4, 2, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 1  3  3  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 1  3  3  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 1  3  3  0
rho_tmp = [1, 3, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 1  3  3  0
rho_tmp = [1, 4, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 3  3  3  0
 2  4  4  0
 1  3  3  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 3  3  3  0
 2  4  4  0
 1  3  3  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 3  3  3  0
 2  4  4  0
 1  3  3  0
rho_tmp = [1, 1, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  4  0
 1  3  3  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  4  0
 1  3  3  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  4  0
 1  3  3  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 1  3  3  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 1  3  3  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 1  3  3  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 1  3  3  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.020022679112739753
sampled gamma:
probh = 0.020022679112739753
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.020022679112739753
sampled gamma:
probh = 0.020022679112739753
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.020022679112739753
sampled gamma:
probh = 0.020022679112739753
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.020022679112739753
sampled gamma:
probh = 0.020022679112739753
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.020022679112739753
sampled gamma:
probh = 0.020022679112739753
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 1  2  2  0
 2  3  3  0
 3  1  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 1  2  2  0
 2  3  3  0
 3  1  4  0
 2  3  3  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = [2, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 1  2  2  0
 2  3  3  0
 3  1  4  0
 2  3  3  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = [3, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 1  2  2  0
 2  3  3  0
 3  1  4  0
 2  3  3  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = [4, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  4  2  0
 2  3  3  0
 3  2  4  0
 2  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [1, 1, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  4  2  0
 2  3  3  0
 3  2  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  4  2  0
 2  3  3  0
 3  2  4  0
 2  3  3  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = [1, 3, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  4  2  0
 2  3  3  0
 3  2  4  0
 2  3  3  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = [1, 4, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = [1, 2, 1, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [1, 2, 2, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 4, 4, 3]
Si_comp1 = [1, 2, 4, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 5, 4, 3]
Si_comp1 = [1, 2, 5, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [1, 2, 3, 4, 1]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [1, 2, 3, 4, 2]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [1, 2, 3, 4, 5]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9375681233008718
sampled gamma:
probh = 0.9375681233008718
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.937606736501755
sampled gamma:
probh = 0.937606736501755
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.9383885248423719
sampled gamma:
probh = 0.9383885248423719
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.9376183056864321
sampled gamma:
probh = 0.9376183056864321
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.9373315586039318
sampled gamma:
probh = 0.9373315586039318
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update rho]
movable_units = [5]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 4, 2]

▶ iteration 56.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
muh_iter
5×4 Matrix{Float64}:
 -0.998662  1.94971   -0.645192  0.0
 -0.634902  3.40203    0.167358  0.0
 -0.833337  0.187257   0.646502  0.0
  0.518922  0.419952  -0.353133  0.0
  0.0       0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 47.6218       0.203047  0.508597  1.0
 42.3174       0.844836  0.99883   1.0
  5.81702      0.388324  1.10426   1.0
  2.94268e21  16.4232    0.320713  1.0
  1.0          1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.06595602682008135
 0.2107115363863215
 0.7182793018964796
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  2  0
rho_tmp = [2, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  2  0
rho_tmp = [3, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  2  0
rho_tmp = [4, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 3, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  2  0
 1  3  3  0
 2  4  4  0
 1  3  2  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  2  0
 1  3  3  0
 2  4  4  0
 1  3  2  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  2  0
 1  3  3  0
 2  4  4  0
 1  3  2  0
rho_tmp = [1, 3, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  4  0
 1  3  2  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  4  0
 1  3  2  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  4  0
 1  3  2  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 2  4  4  0
 1  3  2  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 2  4  4  0
 1  3  2  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 2  4  4  0
 1  3  2  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 1  3  2  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 1  3  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 1  3  2  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 1  3  2  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 3, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.2107115363863215
sampled gamma:
probh = 0.2107115363863215
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.2107115363863215
sampled gamma:
probh = 0.2107115363863215
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.2107115363863215
sampled gamma:
probh = 0.2107115363863215
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27049442218439607, 0.7295055778156039]
probh = 0.26790977058495086
sampled gamma:
probh = 0.26790977058495086
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.272906953528583, 0.727093046471417]
probh = 0.4944958680492755
sampled gamma:
probh = 0.4944958680492755
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 0, 1]
												[update rho]
movable_units = [1, 2, 4]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 2  3  3  0
 3  1  4  0
 2  3  2  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1]
Si_comp2 = [1, 2, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 2  3  3  0
 3  1  4  0
 2  3  2  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = [2, 2, 3, 1]
Si_comp2 = [1, 2, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 2  3  3  0
 3  1  4  0
 2  3  2  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = [3, 2, 3, 1]
Si_comp2 = [1, 2, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 2  3  3  0
 3  1  4  0
 2  3  2  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = [4, 2, 3, 1]
Si_comp2 = [1, 2, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  2  0
 2  3  3  0
 3  2  4  0
 2  3  2  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [1, 1, 3, 2]
Si_comp2 = [1, 2, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  2  0
 2  3  3  0
 3  2  4  0
 2  3  2  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2]
Si_comp2 = [1, 2, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  2  0
 2  3  3  0
 3  2  4  0
 2  3  2  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = [1, 3, 3, 2]
Si_comp2 = [1, 2, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  2  0
 2  3  3  0
 3  2  4  0
 2  3  2  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = [1, 4, 3, 2]
Si_comp2 = [1, 2, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  2  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1]
Si_comp2 = [1, 2, 3, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  2  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2]
Si_comp2 = [1, 2, 3, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  2  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  2  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4]
Si_comp2 = [1, 2, 3, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1757100899524644, 0.1757100899524644, 0.1757100899524644, 0.4728697301426069]
probh = 0.9355269232959138
sampled gamma:
probh = 0.9355269232959138
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1755738340553516, 0.1755738340553516, 0.1755738340553516, 0.47327849783394516]
probh = 0.935573698426223
sampled gamma:
probh = 0.935573698426223
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17282428456152657, 0.17282428456152657, 0.17282428456152657, 0.48152714631542043]
probh = 0.9365185886415972
sampled gamma:
probh = 0.9365185886415972
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17553301775860286, 0.17553301775860286, 0.17553301775860286, 0.4734009467241914]
probh = 0.8434011054360625
sampled gamma:
probh = 0.8434011054360625
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1765458004244042, 0.1765458004244042, 0.1765458004244042, 0.4703625987267872]
probh = 0.93524013549435
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update rho]
movable_units = [4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 2]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  2  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  2  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  2  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 2, 2]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  2  0
 2  3  2  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  2  0
 2  3  2  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  2  0
 2  3  2  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  2  0
 2  3  2  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 2, 3]

▶ iteration 57.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  2  0
 2  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
muh_iter
5×4 Matrix{Float64}:
 -0.959054   0.0636211  -0.645192  0.0
  0.143094  -2.04987     0.167358  0.0
 -0.639981   0.187257    0.646502  0.0
 -7.49585   -1.42293    -0.353133  0.0
  0.0        0.0         0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 64.2188      0.766105  1.71384   1.0
 91.7191      1.18944   0.928463  1.0
  0.11388     0.850654  0.89748   1.0
  2.94268e21  2.74249   0.320713  1.0
  1.0         1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.13932353016112117
 0.42307238198601566
 0.8281209937838165
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  2  0
 2  3  3  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [2, 2]
Si_comp2 = [3, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  2  0
 2  3  3  0
rho_tmp = [2, 2, 2, 1, 2]
Si_comp1 = [2, 2]
Si_comp2 = [3, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  2  0
 2  3  3  0
rho_tmp = [3, 2, 2, 1, 2]
Si_comp1 = [2, 2]
Si_comp2 = [3, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  2  0
 2  3  3  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [2, 2]
Si_comp2 = [3, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  2  0
 2  3  3  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [2, 2]
Si_comp2 = [3, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  2  0
 2  3  3  0
rho_tmp = [1, 3, 2, 3, 2]
Si_comp1 = [2, 2]
Si_comp2 = [3, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  2  0
 2  3  3  0
rho_tmp = [1, 4, 2, 3, 2]
Si_comp1 = [2, 2]
Si_comp2 = [3, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  2  0
 2  3  3  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = [1, 2]
Si_comp2 = [3, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  2  0
 2  3  3  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [2, 2]
Si_comp2 = [3, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  2  0
 2  3  3  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [3, 2]
Si_comp2 = [3, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  2  0
 2  3  3  0
rho_tmp = [1, 2, 4, 3, 2]
Si_comp1 = [4, 2]
Si_comp2 = [3, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  2  0
 2  3  3  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [2, 2]
Si_comp2 = [3, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  2  0
 2  3  3  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [2, 2]
Si_comp2 = [3, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  2  0
 2  3  3  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [2, 2]
Si_comp2 = [3, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  2  0
 2  3  3  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [2, 1]
Si_comp2 = [3, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  2  0
 2  3  3  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [2, 2]
Si_comp2 = [3, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  2  0
 2  3  3  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = [2, 3]
Si_comp2 = [3, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  2  0
 2  3  3  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [2, 4]
Si_comp2 = [3, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 3, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21316540189401498, 0.21316540189401498, 0.5736691962119701]
probh = 0.5610756891123627
sampled gamma:
probh = 0.5610756891123627
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21296489765602558, 0.21296489765602558, 0.5740702046879489]
probh = 0.7749462472100097
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2641153918314374, 0.7358846081685626]
probh = 0.49912710635736274
sampled gamma:
probh = 0.49912710635736274
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27049442218439607, 0.7295055778156039]
probh = 0.7305333538301079
sampled gamma:
probh = 0.7305333538301079
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 1]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.42307238198601566
sampled gamma:
probh = 0.42307238198601566
gt = true
gamma_iter[:, t] = Bool[0, 0, 0, 0, 1]
												[update rho]
movable_units = [1, 2, 3, 4]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 2  3  3  0
 3  1  2  0
 2  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 2  3  3  0
 3  1  2  0
 2  3  3  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = [2, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 2  3  3  0
 3  1  2  0
 2  3  3  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = [3, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 2  3  3  0
 3  1  2  0
 2  3  3  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = [4, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.0, 0.5]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 1, 3]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  3  2  0
 2  2  3  0
 3  1  2  0
 2  2  3  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 2, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  3  2  0
 2  2  3  0
 3  1  2  0
 2  2  3  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  3  2  0
 2  2  3  0
 3  1  2  0
 2  2  3  0
rho_tmp = [1, 3, 2, 1, 2]
Si_comp1 = [1, 3, 2]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 1.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 1, 3]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  2  0
 2  3  3  0
rho_tmp = [1, 2, 1, 1, 3]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  2  0
 2  3  3  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  2  0
 2  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  2  0
 2  3  3  0
rho_tmp = [1, 2, 4, 1, 3]
Si_comp1 = [1, 2, 4]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.5, 0.5]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 1, 3]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  2  0
 2  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  2  0
 2  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  2  0
 2  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  1  2  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21316540189401498, 0.21316540189401498, 0.5736691962119701]
probh = 0.9576313980590062
sampled gamma:
probh = 0.9576313980590062
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21296489765602558, 0.21296489765602558, 0.5740702046879489]
probh = 0.9576695631812426
sampled gamma:
probh = 0.9576695631812426
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20893297679794065, 0.20893297679794065, 0.5821340464041186]
probh = 0.892200997152008
sampled gamma:
probh = 0.892200997152008
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17553301775860286, 0.17553301775860286, 0.17553301775860286, 0.4734009467241914]
probh = 0.9648482561516393
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1765458004244042, 0.1765458004244042, 0.1765458004244042, 0.4703625987267872]
probh = 0.9646526082212957
sampled gamma:
probh = 0.9646526082212957
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update rho]
movable_units = [4]
Si_iter[:, t] = [1, 2, 3, 2, 3]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  3  2  0
 2  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  3  2  0
 2  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  3  2  0
 2  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  3  2  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 1, 3]

▶ iteration 58.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  3  1  0
 2  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.676888  -1.42293    -0.645192  0.0
  0.571645  -1.29867     0.167358  0.0
 -1.48037    0.187257    0.646502  0.0
 -7.49585    0.0636211  -0.353133  0.0
  0.0        0.0         0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
     0.72561      0.379597  0.297616  1.0
 54556.1          1.06706   0.32383   1.0
    20.7396      15.4278    1.59614   1.0
     2.94268e21   0.766105  0.320713  1.0
     1.0          1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.004841049300664538
 0.3682273852239887
 0.7941973783268234
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  2  2  0
 2  3  3  0
 1  3  1  0
 2  3  3  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  2  2  0
 2  3  3  0
 1  3  1  0
 2  3  3  0
rho_tmp = [2, 2, 2, 1, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  2  2  0
 2  3  3  0
 1  3  1  0
 2  3  3  0
rho_tmp = [3, 2, 2, 1, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  3  1  0
 2  3  3  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  3  1  0
 2  3  3  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  3  1  0
 2  3  3  0
rho_tmp = [1, 3, 2, 3, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  3  1  0
 2  3  3  0
rho_tmp = [1, 4, 2, 3, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  3  1  0
 3  3  3  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  3  1  0
 3  3  3  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  3  1  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  3  1  0
 3  3  3  0
rho_tmp = [1, 2, 4, 4, 3]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  3  1  0
 3  3  3  0
rho_tmp = [1, 2, 5, 4, 3]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 3, 4]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 4  3  1  0
 3  3  3  0
rho_tmp = [1, 2, 1, 1, 3]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 4  3  1  0
 3  3  3  0
rho_tmp = [1, 2, 1, 2, 3]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 4  3  1  0
 3  3  3  0
rho_tmp = [1, 2, 1, 3, 3]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 4  3  1  0
 3  3  3  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 2, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  3  1  0
 3  3  3  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  3  1  0
 3  3  3  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  3  1  0
 3  3  3  0
rho_tmp = [1, 2, 1, 2, 3]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2709151356678167, 0.7290848643321833]
probh = 0.44426662253113747
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2705913586595647, 0.7294086413404354]
probh = 0.44415700729521107
sampled gamma:
probh = 0.44415700729521107
gt = true
gamma_iter[:, t] = Bool[0, 1, 0, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20893297679794065, 0.20893297679794065, 0.5821340464041186]
probh = 0.7361227521615032
sampled gamma:
probh = 0.7361227521615032
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.8967624220024675, 4.711575569469762, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22085376773264667, 0.18351821841971058, 0.5956280138476426]
probh = 0.760534557113891
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21439662402037066, 0.21439662402037066, 0.5712067519592587]
probh = 0.7310779828814515
sampled gamma:
probh = 0.7310779828814515
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update rho]
movable_units = [1, 4]
Si_iter[:, t] = [1, 2, 3, 3, 3]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  3  1  0
 2  2  2  0
 1  1  3  0
 2  1  1  0
 1  1  3  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  3  1  0
 2  2  2  0
 1  1  3  0
 2  1  1  0
 1  1  3  0
rho_tmp = [2, 2, 1, 1, 1]
Si_comp1 = [2, 2, 1, 1]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  3  1  0
 2  2  2  0
 1  1  3  0
 2  1  1  0
 1  1  3  0
rho_tmp = [3, 2, 1, 1, 1]
Si_comp1 = [3, 2, 1, 1]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 1.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 3]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  3  1  0
 1  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  3  1  0
 1  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  3  1  0
 1  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  3  1  0
 1  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 1]
Si_red1 = [1, 2, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.966311142624624, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22469162314982177, 0.2100427740987608, 0.5652656027514175]
probh = 0.9449786392440942
sampled gamma:
probh = 0.9449786392440942
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 1]
Si_red1 = [1, 2, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.964671316248493, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22448337040552804, 0.20984809846505453, 0.5656685311294175]
probh = 0.9484259856768917
sampled gamma:
probh = 0.9484259856768917
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 1]
Si_red1 = [1, 2, 1, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.931608434379529, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2202944171864736, 0.20593224551795378, 0.5737733372955727]
probh = 0.8705618107735358
sampled gamma:
probh = 0.8705618107735358
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 1]
Si_red1 = [1, 2, 3, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.453263393671671, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2708313073404751, 0.15524354987468286, 0.15524354987468286, 0.4186815929101591]
probh = 0.9344211241553108
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1765458004244042, 0.1765458004244042, 0.1765458004244042, 0.4703625987267872]
probh = 0.9562525781448363
sampled gamma:
probh = 0.9562525781448363
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update rho]
movable_units = [4]
Si_iter[:, t] = [1, 2, 3, 1, 3]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  1  0
 1  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  1  0
 1  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  1  0
 1  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  1  0
 1  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 2, 3]

▶ iteration 59.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  2  0
 1  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -1.07907   -3.17297   -0.645192  0.0
 -0.242514  -1.29867    0.167358  0.0
  0.530488   0.187257   0.646502  0.0
 -6.95469   -3.4001    -0.353133  0.0
  0.0        0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
  1154.4     1.48032  0.258571  1.0
  8108.11    2.208    0.57565   1.0
 54556.1     0.98878  0.707462  1.0
    20.7396  4.31491  0.320713  1.0
     1.0     1.0      1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.12770874306092736
 0.7258592244787
 0.4946067309658173
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 1, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  2  0
 1  3  3  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [2, 1, 1]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  2  0
 1  3  3  0
rho_tmp = [2, 2, 1, 2, 1]
Si_comp1 = [2, 1, 1]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  2  0
 1  3  3  0
rho_tmp = [3, 2, 1, 2, 1]
Si_comp1 = [2, 1, 1]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 1, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 1  4  2  0
 2  3  3  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 1  4  2  0
 2  3  3  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [2, 2, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 1  4  2  0
 2  3  3  0
rho_tmp = [1, 3, 2, 1, 2]
Si_comp1 = [3, 2, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 1, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 1  4  2  0
 2  3  3  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 1  4  2  0
 2  3  3  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 1  4  2  0
 2  3  3  0
rho_tmp = [1, 1, 3, 1, 2]
Si_comp1 = [1, 3, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 1, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 1  4  2  0
 2  3  3  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 1  4  2  0
 2  3  3  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 1  4  2  0
 2  3  3  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  2  0
 2  3  3  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [2, 3, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  2  0
 2  3  3  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  2  0
 2  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 2, 3]
Si_comp2 = [2, 3, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1757100899524644, 0.1757100899524644, 0.1757100899524644, 0.4728697301426069]
probh = 0.9377680553328321
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21296489765602558, 0.21296489765602558, 0.5740702046879489]
probh = 0.9255556410246967
sampled gamma:
probh = 0.9255556410246967
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20893297679794065, 0.20893297679794065, 0.5821340464041186]
probh = 0.8197668786735915
sampled gamma:
probh = 0.8197668786735915
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17553301775860286, 0.17553301775860286, 0.17553301775860286, 0.4734009467241914]
probh = 0.9378268705508597
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21439662402037066, 0.21439662402037066, 0.5712067519592587]
probh = 0.9250926537833406
sampled gamma:
probh = 0.9250926537833406
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update rho]
movable_units = [1, 4]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 1  2  2  0
 2  3  3  0
 2  1  2  0
 2  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 1  2  2  0
 2  3  3  0
 2  1  2  0
 2  3  3  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = [2, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 1  2  2  0
 2  3  3  0
 2  1  2  0
 2  3  3  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = [3, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 1  2  2  0
 2  3  3  0
 2  1  2  0
 2  3  3  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = [4, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.0, 0.5]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  2  0
 2  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  2  0
 2  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  2  0
 2  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  2  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 1, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.713706587908492, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22113415318903495, 0.18375120443554996, 0.5951146423754151]
probh = 0.8156894832064836
sampled gamma:
probh = 0.8156894832064836
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.712066761532361, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22091838545704606, 0.1835719124534681, 0.5955097020894858]
probh = 0.8420518639125285
sampled gamma:
probh = 0.8420518639125285
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.679003879663396, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21658275052886963, 0.17996922092637388, 0.6034480285447565]
probh = 0.6185790674630282
sampled gamma:
probh = 0.6185790674630282
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 2]
Si_red1 = [1, 2, 3, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.8967624220024675, 2.713373161418252, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2079178028832243, 0.023423822558919893, 0.2079178028832243, 0.5607405716746314]
probh = 0.9766248203017776
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1765458004244042, 0.1765458004244042, 0.1765458004244042, 0.4703625987267872]
probh = 0.8471733456244949
sampled gamma:
probh = 0.8471733456244949
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update rho]
movable_units = [4]
Si_iter[:, t] = [1, 2, 3, 2, 3]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  1  2  0
 2  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  1  2  0
 2  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  1  2  0
 2  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  1  2  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 1, 3]

▶ iteration 60.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  1  1  0
 2  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
  0.260547  -2.20078   -0.645192  0.0
  0.431434  -1.29867    0.167358  0.0
 -0.16976    0.187257   0.646502  0.0
 -6.95469   -3.4001    -0.353133  0.0
  0.0        0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
     2.51668  8.3741   5.03683   1.0
   123.863    1.76907  0.161857  1.0
 54556.1      0.30296  1.16936   1.0
    20.7396   4.31491  0.320713  1.0
     1.0      1.0      1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.034365318092739856
 0.7999749333054634
 0.8842149849620773
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 2, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  1  1  0
 2  3  3  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  1  1  0
 2  3  3  0
rho_tmp = [2, 1, 2, 2, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  1  1  0
 2  3  3  0
rho_tmp = [3, 1, 2, 2, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  1  1  0
 2  3  3  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  1  1  0
 2  3  3  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [2, 2, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  1  1  0
 2  3  3  0
rho_tmp = [1, 3, 2, 2, 2]
Si_comp1 = [3, 2, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  1  1  0
 2  3  3  0
rho_tmp = [1, 1, 1, 2, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  1  1  0
 2  3  3  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  1  1  0
 2  3  3  0
rho_tmp = [1, 1, 3, 2, 2]
Si_comp1 = [1, 3, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  1  1  0
 2  3  3  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  1  1  0
 2  3  3  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  1  1  0
 2  3  3  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  1  1  0
 2  3  3  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [2, 3, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  1  1  0
 2  3  3  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [2, 3, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  1  1  0
 2  3  3  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 2, 3]
Si_comp2 = [2, 3, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  1  1  0
 2  3  3  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 2, 4]
Si_comp2 = [2, 3, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 1]
Si_red1 = [1, 2, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.966311142624624, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22469162314982177, 0.2100427740987608, 0.5652656027514175]
probh = 0.9468067794117075
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21296489765602558, 0.21296489765602558, 0.5740702046879489]
probh = 0.9494425941026987
sampled gamma:
probh = 0.9494425941026987
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20893297679794065, 0.20893297679794065, 0.5821340464041186]
probh = 0.87293831739991
sampled gamma:
probh = 0.87293831739991
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17553301775860286, 0.17553301775860286, 0.17553301775860286, 0.4734009467241914]
probh = 0.9579552210937371
sampled gamma:
probh = 0.9579552210937371
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1765458004244042, 0.1765458004244042, 0.1765458004244042, 0.4703625987267872]
probh = 0.9577228889068873
sampled gamma:
probh = 0.9577228889068873
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update rho]
movable_units = [1]
Si_iter[:, t] = [1, 2, 3, 1, 3]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  1  1  0
 2  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  1  1  0
 2  3  3  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = [2, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  1  1  0
 2  3  3  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = [3, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  1  1  0
 2  3  3  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = [4, 2, 3, 3]
Si_comp2 = [1, 2, 3, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.0, 0.5]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 1]
Si_red1 = [1, 2, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.966311142624624, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22469162314982177, 0.2100427740987608, 0.5652656027514175]
probh = 0.9714183261206362
sampled gamma:
probh = 0.9714183261206362
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21296489765602558, 0.21296489765602558, 0.5740702046879489]
probh = 0.9728695424089264
sampled gamma:
probh = 0.9728695424089264
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20893297679794065, 0.20893297679794065, 0.5821340464041186]
probh = 0.9291706935681393
sampled gamma:
probh = 0.9291706935681393
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17553301775860286, 0.17553301775860286, 0.17553301775860286, 0.4734009467241914]
probh = 0.9775309949633615
sampled gamma:
probh = 0.9775309949633615
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1765458004244042, 0.1765458004244042, 0.1765458004244042, 0.4703625987267872]
probh = 0.9774042836127766
sampled gamma:
probh = 0.9774042836127766
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update rho]
movable_units = [1, 5]
Si_iter[:, t] = [1, 2, 3, 1, 3]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  1  0
 2  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  1  0
 2  3  3  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  1  0
 2  3  3  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  1  0
 2  3  3  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]

▶ iteration 61.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
muh_iter
5×4 Matrix{Float64}:
 -0.496671   -0.727964  -0.717681  0.0
 -0.0202478  -1.29867    0.167358  0.0
  0.0366783   0.187257   0.646502  0.0
 -0.79483    -2.20078   -0.645192  0.0
  0.0         0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
  1.61201  2.62231   0.309653  1.0
  2.29643  2.02054   0.402639  1.0
  0.11907  0.982542  0.719858  1.0
 20.7396   6.29255   0.424019  1.0
  1.0      1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.06304540345682859
 0.7452271731529356
 0.7259988403660365
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 2, 3, 2]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [2, 1, 2, 3, 2]
Si_comp1 = [1, 2, 3, 2]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [3, 1, 2, 3, 2]
Si_comp1 = [1, 2, 3, 2]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  4  0
 2  3  3  0
rho_tmp = [4, 1, 2, 3, 2]
Si_comp1 = [1, 2, 3, 2]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 1, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 2, 1, 2]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [2, 2, 1, 2]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  2  0
 2  3  3  0
 1  4  4  0
 2  3  3  0
rho_tmp = [1, 3, 2, 1, 2]
Si_comp1 = [3, 2, 1, 2]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 1.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 1, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 1, 1, 3]
Si_comp1 = [2, 1, 1, 3]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = [2, 2, 1, 3]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [2, 3, 1, 3]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 4, 1, 3]
Si_comp1 = [2, 4, 1, 3]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 1, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [2, 3, 1, 3]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [2, 3, 2, 3]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [2, 3, 3, 3]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [2, 3, 4, 3]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.0, 0.5]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [2, 3, 4, 1]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [2, 3, 4, 2]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [2, 3, 4, 3]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [2, 3, 4, 4]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [2, 3, 4, 5]
Si_comp2 = [2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9513906558935514
sampled gamma:
probh = 0.9513906558935514
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9514211630173196
sampled gamma:
probh = 0.9514211630173196
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.9520387107328615
sampled gamma:
probh = 0.9520387107328615
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.9514303033723884
sampled gamma:
probh = 0.9514303033723884
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.9512037411256024
sampled gamma:
probh = 0.9512037411256024
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1757100899524644, 0.1757100899524644, 0.1757100899524644, 0.4728697301426069]
probh = 0.9378089958235153
sampled gamma:
probh = 0.9378089958235153
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1755738340553516, 0.1755738340553516, 0.1755738340553516, 0.47327849783394516]
probh = 0.9378542252952177
sampled gamma:
probh = 0.9378542252952177
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17282428456152657, 0.17282428456152657, 0.17282428456152657, 0.48152714631542043]
probh = 0.9387678578507815
sampled gamma:
probh = 0.9387678578507815
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17553301775860286, 0.17553301775860286, 0.17553301775860286, 0.4734009467241914]
probh = 0.8484156792782632
sampled gamma:
probh = 0.8484156792782632
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.9464029236244451
sampled gamma:
probh = 0.9464029236244451
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]

▶ iteration 62.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -1.3346    -0.727964  -0.717681  0.0
 -1.65347   -1.29867    0.167358  0.0
 -0.638186   0.187257   0.646502  0.0
  0.335018  -2.20078   -0.645192  0.0
  0.0        0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
  0.327941  0.777927  0.524216  1.0
  7.39812   1.1584    2.82701   1.0
 53.7852    0.2337    0.891455  1.0
 49.4603    3.12891   0.543334  1.0
  1.0       1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.4577099887313576
 0.8694259146182284
 0.8278341310359753
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = [2, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = [3, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = [4, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [1, 1, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = [1, 3, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = [1, 4, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = [1, 2, 1, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [1, 2, 2, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 4, 4, 3]
Si_comp1 = [1, 2, 4, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 5, 4, 3]
Si_comp1 = [1, 2, 5, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [1, 2, 3, 4, 1]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [1, 2, 3, 4, 2]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [1, 2, 3, 4, 5]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9780476567761953
sampled gamma:
probh = 0.9780476567761953
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9780618197967533
sampled gamma:
probh = 0.9780618197967533
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.9783484110570188
sampled gamma:
probh = 0.9783484110570188
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.9780660631360903
sampled gamma:
probh = 0.9780660631360903
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.9779608701775747
sampled gamma:
probh = 0.9779608701775747
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9698555582407549
sampled gamma:
probh = 0.9698555582407549
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9698748437733062
sampled gamma:
probh = 0.9698748437733062
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.9702651347694363
sampled gamma:
probh = 0.9702651347694363
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.9698806218933976
sampled gamma:
probh = 0.9698806218933976
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.9697373870286099
sampled gamma:
probh = 0.9697373870286099
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]

▶ iteration 63.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.480489   -0.727964  -0.717681  0.0
 -0.16303    -1.29867    0.167358  0.0
 -0.0631711   0.187257   0.646502  0.0
 -0.439984   -2.20078   -0.645192  0.0
  0.0         0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 0.250537  1.07797  0.486889  1.0
 0.315587  1.51058  0.265265  1.0
 9.24438   0.32234  0.410936  1.0
 0.549552  7.03063  1.21857   1.0
 1.0       1.0      1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.02101757553726716
 0.872831561489156
 0.7960265362089817
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = [2, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = [3, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = [4, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [1, 1, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = [1, 3, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = [1, 4, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = [1, 2, 1, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [1, 2, 2, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 4, 4, 3]
Si_comp1 = [1, 2, 4, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 5, 4, 3]
Si_comp1 = [1, 2, 5, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [1, 2, 3, 4, 1]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [1, 2, 3, 4, 2]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [1, 2, 3, 4, 5]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9786896612651167
sampled gamma:
probh = 0.9786896612651167
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9787034191019353
sampled gamma:
probh = 0.9787034191019353
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.9789818088930018
sampled gamma:
probh = 0.9789818088930018
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.9787075410431408
sampled gamma:
probh = 0.9787075410431408
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.9786053572523438
sampled gamma:
probh = 0.9786053572523438
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.96311737696642
sampled gamma:
probh = 0.96311737696642
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9631408095556855
sampled gamma:
probh = 0.9631408095556855
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.9636150713881996
sampled gamma:
probh = 0.9636150713881996
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.9631478302120561
sampled gamma:
probh = 0.9631478302120561
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.9629737994039842
sampled gamma:
probh = 0.9629737994039842
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]

▶ iteration 64.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.307054  -0.727964  -0.717681  0.0
 -0.377894  -1.29867    0.167358  0.0
 -1.19773    0.187257   0.646502  0.0
  0.130575  -2.20078   -0.645192  0.0
  0.0        0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
  0.856     1.72664   0.74193   1.0
  1.60558   1.95848   0.433315  1.0
 12.1128    0.269964  1.05252   1.0
  0.293857  3.50922   0.897694  1.0
  1.0       1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.27871525709681627
 0.9898752636916676
 0.898366293033554
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = [2, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = [3, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = [4, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [1, 1, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = [1, 3, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = [1, 4, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = [1, 2, 1, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [1, 2, 2, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 4, 4, 3]
Si_comp1 = [1, 2, 4, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 5, 4, 3]
Si_comp1 = [1, 2, 5, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [1, 2, 3, 4, 1]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [1, 2, 3, 4, 2]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [1, 2, 3, 4, 5]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9984737125239949
sampled gamma:
probh = 0.9984737125239949
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9984747177925748
sampled gamma:
probh = 0.9984747177925748
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.9984950537638976
sampled gamma:
probh = 0.9984950537638976
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.9984750189727499
sampled gamma:
probh = 0.9984750189727499
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.9984675519581814
sampled gamma:
probh = 0.9984675519581814
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9833735588304905
sampled gamma:
probh = 0.9833735588304905
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9833843441070345
sampled gamma:
probh = 0.9833843441070345
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.9836025698309947
sampled gamma:
probh = 0.9836025698309947
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.9833875754360489
sampled gamma:
probh = 0.9833875754360489
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.9833074683449058
sampled gamma:
probh = 0.9833074683449058
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]

▶ iteration 65.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.749122  -0.727964  -0.717681  0.0
 -0.626907  -1.29867    0.167358  0.0
 -0.960532   0.187257   0.646502  0.0
  1.32306   -2.20078   -0.645192  0.0
  0.0        0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
   0.397819  0.919486  0.459208  1.0
   0.77034   2.40127   0.481576  1.0
 206.199     0.693334  1.14587   1.0
  10.3678    4.13644   1.03547   1.0
   1.0       1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.042801779451883674
 0.9169153859245103
 0.7657507228714061
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = [2, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = [3, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = [4, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [1, 1, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = [1, 3, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = [1, 4, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = [1, 2, 1, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [1, 2, 2, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 4, 4, 3]
Si_comp1 = [1, 2, 4, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 5, 4, 3]
Si_comp1 = [1, 2, 5, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [1, 2, 3, 4, 1]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [1, 2, 3, 4, 2]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [1, 2, 3, 4, 5]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9866387839793388
sampled gamma:
probh = 0.9866387839793388
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9866474799224912
sampled gamma:
probh = 0.9866474799224912
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.9868234227177738
sampled gamma:
probh = 0.9868234227177738
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.9866500852682741
sampled gamma:
probh = 0.9866500852682741
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.9865854957834511
sampled gamma:
probh = 0.9865854957834511
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9562807490286213
sampled gamma:
probh = 0.9562807490286213
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9563083280814039
sampled gamma:
probh = 0.9563083280814039
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.9568665653696337
sampled gamma:
probh = 0.9568665653696337
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.9563165911113769
sampled gamma:
probh = 0.9563165911113769
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.9561117704383982
sampled gamma:
probh = 0.9561117704383982
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]

▶ iteration 66.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
  0.160533  -0.727964  -0.717681  0.0
 -0.984528  -1.29867    0.167358  0.0
 -0.724031   0.187257   0.646502  0.0
 -0.252465  -2.20078   -0.645192  0.0
  0.0        0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
  0.850286  0.869949  0.380023  1.0
  0.489823  7.94811   0.513183  1.0
 20.5818    0.22411   0.976444  1.0
  0.173004  4.68315   0.858946  1.0
  1.0       1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.41425881154992517
 0.9944462169238535
 0.9497041244529726
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = [2, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = [3, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = [4, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [1, 1, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = [1, 3, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = [1, 4, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = [1, 2, 1, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [1, 2, 2, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 4, 4, 3]
Si_comp1 = [1, 2, 4, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 5, 4, 3]
Si_comp1 = [1, 2, 5, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [1, 2, 3, 4, 1]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [1, 2, 3, 4, 2]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [1, 2, 3, 4, 5]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9991660466912398
sampled gamma:
probh = 0.9991660466912398
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9991665963439048
sampled gamma:
probh = 0.9991665963439048
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.9991777153748651
sampled gamma:
probh = 0.9991777153748651
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.9991667610206798
sampled gamma:
probh = 0.9991667610206798
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.9991626782556706
sampled gamma:
probh = 0.9991626782556706
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9921473421043691
sampled gamma:
probh = 0.9921473421043691
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.992152481402312
sampled gamma:
probh = 0.992152481402312
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.9922564554821005
sampled gamma:
probh = 0.9922564554821005
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.9921540211530622
sampled gamma:
probh = 0.9921540211530622
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.9921158479922093
sampled gamma:
probh = 0.9921158479922093
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]

▶ iteration 67.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -1.03219   -0.727964  -0.717681  0.0
 -0.672225  -1.29867    0.167358  0.0
  0.533459   0.187257   0.646502  0.0
  0.423968  -2.20078   -0.645192  0.0
  0.0        0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
    3.27494   0.901191  0.1127    1.0
    2.7436    4.55322   1.73022   1.0
 9132.81      0.3718    1.39732   1.0
   26.3979   12.1442    0.532136  1.0
    1.0       1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.016604754564736004
 0.8863581264105431
 0.829989979255786
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = [2, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = [3, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = [4, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [1, 1, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = [1, 3, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = [1, 4, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = [1, 2, 1, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [1, 2, 2, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 4, 4, 3]
Si_comp1 = [1, 2, 4, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 5, 4, 3]
Si_comp1 = [1, 2, 5, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [1, 2, 3, 4, 1]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [1, 2, 3, 4, 2]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [1, 2, 3, 4, 5]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9811989253391373
sampled gamma:
probh = 0.9811989253391373
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.981211094309111
sampled gamma:
probh = 0.981211094309111
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.9814573247290761
sampled gamma:
probh = 0.9814573247290761
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.9812147402071925
sampled gamma:
probh = 0.9812147402071925
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.9811243565593721
sampled gamma:
probh = 0.9811243565593721
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9702968340637546
sampled gamma:
probh = 0.9702968340637546
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9703158459216992
sampled gamma:
probh = 0.9703158459216992
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.970700596048999
sampled gamma:
probh = 0.970700596048999
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.9703215420442467
sampled gamma:
probh = 0.9703215420442467
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.9701803395384578
sampled gamma:
probh = 0.9701803395384578
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]

▶ iteration 68.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -1.05309   -0.727964  -0.717681  0.0
 -0.504253  -1.29867    0.167358  0.0
 -0.586168   0.187257   0.646502  0.0
  0.396047  -2.20078   -0.645192  0.0
  0.0        0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
    0.141828  0.710239  0.564088  1.0
    1.80722   2.60812   0.551505  1.0
 2217.18      0.25025   1.58666   1.0
    0.728035  8.11458   0.729846  1.0
    1.0       1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.14218496032294897
 0.5565566297931497
 0.9038024380860763
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = [2, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = [3, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = [4, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [1, 1, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = [1, 3, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = [1, 4, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = [1, 2, 1, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [1, 2, 2, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 4, 4, 3]
Si_comp1 = [1, 2, 4, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 5, 4, 3]
Si_comp1 = [1, 2, 5, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [1, 2, 3, 4, 1]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [1, 2, 3, 4, 2]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [1, 2, 3, 4, 5]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.8935941339858545
sampled gamma:
probh = 0.8935941339858545
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.8936568596198257
sampled gamma:
probh = 0.8936568596198257
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.8949276274011684
sampled gamma:
probh = 0.8949276274011684
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.893675654016196
sampled gamma:
probh = 0.893675654016196
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.8932099233215866
sampled gamma:
probh = 0.8932099233215866
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9843421157067852
sampled gamma:
probh = 0.9843421157067852
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9843522826951753
sampled gamma:
probh = 0.9843522826951753
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.9845579953900339
sampled gamma:
probh = 0.9845579953900339
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.9843553287790807
sampled gamma:
probh = 0.9843553287790807
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.9842798137104519
sampled gamma:
probh = 0.9842798137104519
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]

▶ iteration 69.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.612896  -0.727964  -0.717681  0.0
 -0.361408  -1.29867    0.167358  0.0
 -0.594472   0.187257   0.646502  0.0
 -0.290943  -2.20078   -0.645192  0.0
  0.0        0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
     0.530956  4.91804  0.478952  1.0
     0.444916  1.6574   0.59955   1.0
 41961.1       0.18428  0.901053  1.0
     0.295455  6.68073  0.974111  1.0
     1.0       1.0      1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.04828007597911076
 0.8900565381998764
 0.8804080156916781
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = [2, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = [3, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = [4, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [1, 1, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = [1, 3, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = [1, 4, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = [1, 2, 1, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [1, 2, 2, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 4, 4, 3]
Si_comp1 = [1, 2, 4, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 5, 4, 3]
Si_comp1 = [1, 2, 5, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [1, 2, 3, 4, 1]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [1, 2, 3, 4, 2]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [1, 2, 3, 4, 5]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9818739158721118
sampled gamma:
probh = 0.9818739158721118
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9818856560209391
sampled gamma:
probh = 0.9818856560209391
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.9821232073051626
sampled gamma:
probh = 0.9821232073051626
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.9818891734395383
sampled gamma:
probh = 0.9818891734395383
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.9818019745859848
sampled gamma:
probh = 0.9818019745859848
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9801030602466639
sampled gamma:
probh = 0.9801030602466639
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9801159241398613
sampled gamma:
probh = 0.9801159241398613
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.9803762198306962
sampled gamma:
probh = 0.9803762198306962
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.980119778244826
sampled gamma:
probh = 0.980119778244826
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.9800242335359177
sampled gamma:
probh = 0.9800242335359177
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]

▶ iteration 70.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
  0.50228   -0.727964  -0.717681  0.0
 -0.613497  -1.29867    0.167358  0.0
  0.285158   0.187257   0.646502  0.0
  0.910412  -2.20078   -0.645192  0.0
  0.0        0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 1.23694    2.70658   0.507761  1.0
 0.389192   1.14664   0.693286  1.0
 1.08124e7  0.313836  0.873413  1.0
 0.215961   9.73277   0.486894  1.0
 1.0        1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.2237367217655051
 0.712256581688328
 0.7439384339208915
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = [2, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = [3, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = [4, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [1, 1, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = [1, 3, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = [1, 4, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = [1, 2, 1, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [1, 2, 2, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 4, 4, 3]
Si_comp1 = [1, 2, 4, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 5, 4, 3]
Si_comp1 = [1, 2, 5, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [1, 2, 3, 4, 1]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [1, 2, 3, 4, 2]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [1, 2, 3, 4, 5]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9430615770506912
sampled gamma:
probh = 0.9430615770506912
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9430969988397441
sampled gamma:
probh = 0.9430969988397441
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.9438141165363703
sampled gamma:
probh = 0.9438141165363703
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.9431076117721032
sampled gamma:
probh = 0.9431076117721032
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.9428445590099184
sampled gamma:
probh = 0.9428445590099184
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9510763083491612
sampled gamma:
probh = 0.9510763083491612
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9511070026181658
sampled gamma:
probh = 0.9511070026181658
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17282428456152657, 0.17282428456152657, 0.17282428456152657, 0.48152714631542043]
probh = 0.9438542235157509
sampled gamma:
probh = 0.9438542235157509
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17553301775860286, 0.17553301775860286, 0.17553301775860286, 0.4734009467241914]
probh = 0.9430243699373271
sampled gamma:
probh = 0.9430243699373271
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1765458004244042, 0.1765458004244042, 0.1765458004244042, 0.4703625987267872]
probh = 0.9427144662466322
sampled gamma:
probh = 0.9427144662466322
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update rho]
movable_units = [2]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  4  0
 3  3  3  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  4  0
 3  3  3  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  4  0
 3  3  3  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  4  0
 3  3  3  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]

▶ iteration 71.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.576012  -0.727964  -0.717681  0.0
 -1.85169   -1.29867    0.517246  0.0
  0.059522   0.187257   0.646502  0.0
  0.919459  -2.20078   -0.645192  0.0
  0.0        0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 1.8176     1.2027    0.408256  1.0
 0.23115    1.42193   0.546395  1.0
 6.60185e9  0.456415  3.24523   1.0
 0.836429   9.31735   0.420819  1.0
 1.0        1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.07976262270262942
 0.6997318505831448
 0.6517902030708307
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = [2, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = [3, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  4  0
 3  3  3  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = [4, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [1, 1, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = [1, 3, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  4  0
 3  3  3  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = [1, 4, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = [1, 2, 1, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [1, 2, 2, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 4, 4, 3]
Si_comp1 = [1, 2, 4, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 5, 4, 3]
Si_comp1 = [1, 2, 5, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [1, 2, 3, 4, 1]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [1, 2, 3, 4, 2]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [1, 2, 3, 4, 5]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9397331323746996
sampled gamma:
probh = 0.9397331323746996
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9397704925684384
sampled gamma:
probh = 0.9397704925684384
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.9405268887474186
sampled gamma:
probh = 0.9405268887474186
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.9397816863096666
sampled gamma:
probh = 0.9397816863096666
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.939504241926288
sampled gamma:
probh = 0.939504241926288
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1757100899524644, 0.1757100899524644, 0.1757100899524644, 0.4728697301426069]
probh = 0.7983241340240075
sampled gamma:
probh = 0.7983241340240075
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9261068570071705
sampled gamma:
probh = 0.9261068570071705
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17282428456152657, 0.17282428456152657, 0.17282428456152657, 0.48152714631542043]
probh = 0.9154751363455671
sampled gamma:
probh = 0.9154751363455671
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17553301775860286, 0.17553301775860286, 0.17553301775860286, 0.4734009467241914]
probh = 0.9142639316986343
sampled gamma:
probh = 0.9142639316986343
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1765458004244042, 0.1765458004244042, 0.1765458004244042, 0.4703625987267872]
probh = 0.9138118907174604
sampled gamma:
probh = 0.9138118907174604
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update rho]
movable_units = [2]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  4  0
 3  3  3  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  4  0
 3  3  3  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  4  0
 3  3  3  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  4  0
 3  3  3  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 2, 3]

▶ iteration 72.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  2  0
 3  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.810419  -0.727964  -0.717681  0.0
  0.435747  -1.29867   -0.645192  0.0
 -0.069032   0.187257   0.646502  0.0
 -1.12768   -2.20078    0.517246  0.0
  0.0        0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 0.233728    0.686625  0.259557  1.0
 2.06083     1.89999   0.940586  1.0
 1.21838e11  0.905289  1.33083   1.0
 0.119579    7.9511    0.546395  1.0
 1.0         1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.10417026247700993
 0.8399474967173942
 0.2333404181052762
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  2  0
 3  3  3  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = [2, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  2  0
 3  3  3  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = [3, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  3  0
 1  4  2  0
 3  3  3  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = [4, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  2  0
 3  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [1, 1, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  2  0
 3  3  3  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = [1, 3, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 2  4  2  0
 3  3  3  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = [1, 4, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = [1, 2, 1, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [1, 2, 2, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 4, 4, 3]
Si_comp1 = [1, 2, 4, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 5, 4, 3]
Si_comp1 = [1, 2, 5, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [1, 2, 3, 4, 1]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [1, 2, 3, 4, 2]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [1, 2, 3, 4, 5]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9723107077444151
sampled gamma:
probh = 0.9723107077444151
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9723284673596163
sampled gamma:
probh = 0.9723284673596163
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.972687865239326
sampled gamma:
probh = 0.972687865239326
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.9723337882898604
sampled gamma:
probh = 0.9723337882898604
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.9722018852643595
sampled gamma:
probh = 0.9722018852643595
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 1]
Si_red1 = [1, 2, 1, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.966311142624624, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22469162314982177, 0.2100427740987608, 0.5652656027514175]
probh = 0.34998960567790294
sampled gamma:
probh = 0.34998960567790294
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 2]
Si_red1 = [1, 2, 3, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 2.713864353480851, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20797507166518384, 0.02343027440560249, 0.20797507166518384, 0.5606195822640299]
probh = 0.9285205058383642
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17282428456152657, 0.17282428456152657, 0.17282428456152657, 0.48152714631542043]
probh = 0.6378247697422954
sampled gamma:
probh = 0.6378247697422954
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17553301775860286, 0.17553301775860286, 0.17553301775860286, 0.4734009467241914]
probh = 0.634224597418596
sampled gamma:
probh = 0.634224597418596
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21439662402037066, 0.21439662402037066, 0.5712067519592587]
probh = 0.586710484613225
sampled gamma:
probh = 0.586710484613225
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 0, 1]
												[update rho]
movable_units = [2, 4]
Si_iter[:, t] = [1, 2, 3, 2, 3]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  3  0
 3  3  2  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  3  0
 3  3  2  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  3  0
 3  3  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 1, 2]

▶ iteration 73.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  1  0
 3  3  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.0794739  -0.727964  -0.717681  0.0
 -0.331908   -1.29867    0.646502  0.0
 -0.179687    0.187257  -0.645192  0.0
 -1.24442    -2.20078    0.517246  0.0
  0.0         0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 0.27956     2.35442   0.400877  1.0
 1.68125     1.63963   1.60012   1.0
 8.75432e13  0.326162  0.940586  1.0
 0.649013    6.77793   0.546395  1.0
 1.0         1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.1481482895825168
 0.7836912990335699
 0.34192612870994504
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  2  0
 1  4  1  0
 3  3  2  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  2  0
 1  4  1  0
 3  3  2  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = [2, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  2  0
 1  4  1  0
 3  3  2  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = [3, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  2  0
 1  4  1  0
 3  3  2  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = [4, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  2  0
 2  4  1  0
 3  3  2  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [1, 1, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  2  0
 2  4  1  0
 3  3  2  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  2  0
 2  4  1  0
 3  3  2  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = [1, 3, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  2  0
 2  4  1  0
 3  3  2  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = [1, 4, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  1  0
 3  3  2  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = [1, 2, 1, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  1  0
 3  3  2  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [1, 2, 2, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  1  0
 3  3  2  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  1  0
 3  3  2  0
rho_tmp = [1, 2, 4, 4, 3]
Si_comp1 = [1, 2, 4, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  1  0
 3  3  2  0
rho_tmp = [1, 2, 5, 4, 3]
Si_comp1 = [1, 2, 5, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  1  0
 3  3  2  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  1  0
 3  3  2  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  1  0
 3  3  2  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  1  0
 3  3  2  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  1  0
 3  3  2  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [1, 2, 3, 4, 1]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  1  0
 3  3  2  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [1, 2, 3, 4, 2]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  1  0
 3  3  2  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  1  0
 3  3  2  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  1  0
 3  3  2  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [1, 2, 3, 4, 5]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9603840251425095
sampled gamma:
probh = 0.9603840251425095
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.960409122923174
sampled gamma:
probh = 0.960409122923174
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.9609171067046816
sampled gamma:
probh = 0.9609171067046816
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.9604166425064606
sampled gamma:
probh = 0.9604166425064606
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.9602302464959563
sampled gamma:
probh = 0.9602302464959563
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.21316540189401498, 0.21316540189401498, 0.5736691962119701]
probh = 0.7090891516565772
sampled gamma:
probh = 0.7090891516565772
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 1]
Si_red1 = [1, 2, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.964671316248493, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.22448337040552804, 0.20984809846505453, 0.5656685311294175]
probh = 0.7123139297466609
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.44837626606234, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.39162143252303233, 0.6083785674769677]
probh = 0.46064047104010386
sampled gamma:
probh = 0.46064047104010386
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.4809479558687055, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.39940857143489605, 0.600591428565104]
probh = 0.5653853903444362
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.272906953528583, 0.727093046471417]
probh = 0.41677618766123625
sampled gamma:
probh = 0.41677618766123625
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 0, 0]
												[update rho]
movable_units = [2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 1, 2]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  1  0
 3  3  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  1  0
 3  3  2  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  1  0
 3  3  2  0
rho_tmp = [1, 3, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 1, 2]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  1  0
 3  3  2  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  1  0
 3  3  2  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  1  0
 3  3  2  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 1, 2]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  1  0
 4  4  1  0
 3  3  2  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  1  0
 4  4  1  0
 3  3  2  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  1  0
 4  4  1  0
 3  3  2  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 1, 2]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  1  0
 4  4  1  0
 3  3  2  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  1  0
 4  4  1  0
 3  3  2  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  1  0
 4  4  1  0
 3  3  2  0
rho_tmp = [1, 2, 1, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 1, 1]

▶ iteration 74.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
muh_iter
5×4 Matrix{Float64}:
 -0.0273068  -0.727964  -0.717681  0.0
 -0.711125   -1.29867    0.646502  0.0
  1.0485      0.187257  -0.645192  0.0
 -3.20982    -2.20078    0.517246  0.0
  0.0         0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 0.408315     1.64837   1.0246    1.0
 0.267909     1.25271   0.708759  1.0
 3.04488e15   0.324713  0.940586  1.0
 0.370496    13.0563    0.546395  1.0
 1.0          1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.03844884521698962
 0.7951214277721049
 0.1630051263673662
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  1  0
 1  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  1  0
 1  4  1  0
 3  3  1  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = [2, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  1  0
 1  4  1  0
 3  3  1  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = [3, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  1  0
 1  4  1  0
 3  3  1  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = [4, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  1  0
 2  4  1  0
 3  3  1  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [1, 1, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  1  0
 2  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  1  0
 2  4  1  0
 3  3  1  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = [1, 3, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  1  0
 2  4  1  0
 3  3  1  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = [1, 4, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = [1, 2, 1, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [1, 2, 2, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 4, 4, 3]
Si_comp1 = [1, 2, 4, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 5, 4, 3]
Si_comp1 = [1, 2, 5, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [1, 2, 3, 4, 1]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [1, 2, 3, 4, 2]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [1, 2, 3, 4, 5]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9629191762955217
sampled gamma:
probh = 0.9629191762955217
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9629427299623187
sampled gamma:
probh = 0.9629427299623187
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.9634194436567032
sampled gamma:
probh = 0.9634194436567032
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.962949786896022
sampled gamma:
probh = 0.962949786896022
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.962774856994078
sampled gamma:
probh = 0.962774856994078
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.1630051263673662
sampled gamma:
probh = 0.1630051263673662
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.1630051263673662
sampled gamma:
probh = 0.1630051263673662
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.1630051263673662
sampled gamma:
probh = 0.1630051263673662
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.1630051263673662
sampled gamma:
probh = 0.1630051263673662
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.1630051263673662
sampled gamma:
probh = 0.1630051263673662
gt = true
gamma_iter[:, t] = Bool[0, 0, 0, 0, 1]
												[update rho]
movable_units = [1, 2, 3, 4]
Si_iter[:, t] = [1, 2, 1, 1, 1]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
rho_tmp = [2, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
rho_tmp = [3, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 1, 1]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 1, 1]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 1, 1]

▶ iteration 75.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.903386  -0.727964  -0.717681  0.0
  0.863663  -1.29867   -1.19081   0.0
  0.678383   0.187257  -0.645192  0.0
 -3.19367   -2.20078    0.517246  0.0
  0.0        0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 0.230231    0.88287  0.82852   1.0
 0.310176    5.8366   0.894025  1.0
 6.29016e17  1.30281  0.940586  1.0
 0.190653    6.45803  0.546395  1.0
 1.0         1.0      1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.014554724469704542
 0.844109871255528
 0.35002903362733007
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  1  0
 3  3  2  0
 1  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  1  0
 3  3  2  0
 1  4  1  0
 3  3  1  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = [2, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  1  0
 3  3  2  0
 1  4  1  0
 3  3  1  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = [3, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  1  0
 3  3  2  0
 1  4  1  0
 3  3  1  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = [4, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  1  0
 3  3  2  0
 2  4  1  0
 3  3  1  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [1, 1, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  1  0
 3  3  2  0
 2  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  1  0
 3  3  2  0
 2  4  1  0
 3  3  1  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = [1, 3, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  1  0
 3  3  2  0
 2  4  1  0
 3  3  1  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = [1, 4, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = [1, 2, 1, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [1, 2, 2, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 4, 4, 3]
Si_comp1 = [1, 2, 4, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 5, 4, 3]
Si_comp1 = [1, 2, 5, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [1, 2, 3, 4, 1]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [1, 2, 3, 4, 2]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [1, 2, 3, 4, 5]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9731408782076134
sampled gamma:
probh = 0.9731408782076134
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9731581200596859
sampled gamma:
probh = 0.9731581200596859
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.9735070360097982
sampled gamma:
probh = 0.9735070360097982
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.9731632858600605
sampled gamma:
probh = 0.9731632858600605
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.9730352279215211
sampled gamma:
probh = 0.9730352279215211
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2709151356678167, 0.7290848643321833]
probh = 0.6653077069077703
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2705913586595647, 0.7294086413404354]
probh = 0.6655739355363166
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2641153918314374, 0.7358846081685626]
probh = 0.4225706036177767
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27049442218439607, 0.7295055778156039]
probh = 0.665653683895893
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 1]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.35002903362733007
sampled gamma:
probh = 0.35002903362733007
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 1, 1]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [2, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [3, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 1, 1]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 3, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 1, 1]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 1, 1]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  2  0
 3  3  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  2  0
 3  3  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  2  0
 3  3  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 2]

▶ iteration 76.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  2  0
 3  3  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
muh_iter
5×4 Matrix{Float64}:
  0.00942772  -0.727964  -0.717681  0.0
 -0.712574    -1.29867   -1.19081   0.0
  0.642259     0.187257  -0.645192  0.0
 -1.13622     -2.20078    0.517246  0.0
  0.0          0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 0.787763     0.381518  0.342331  1.0
 0.346355     0.970762  0.970156  1.0
 6.19637e20   0.358739  0.940586  1.0
 0.607393    10.1277    0.546395  1.0
 1.0          1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.07198703195339452
 0.798372714058861
 0.041236297972554715
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  2  0
 1  4  2  0
 3  3  2  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  2  0
 1  4  2  0
 3  3  2  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = [2, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  2  0
 1  4  2  0
 3  3  2  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = [3, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  3  2  0
 1  4  2  0
 3  3  2  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = [4, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  2  0
 2  4  2  0
 3  3  2  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [1, 1, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  2  0
 2  4  2  0
 3  3  2  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  2  0
 2  4  2  0
 3  3  2  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = [1, 3, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  2  0
 2  4  2  0
 3  3  2  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = [1, 4, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  2  0
 3  3  2  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = [1, 2, 1, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  2  0
 3  3  2  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [1, 2, 2, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  2  0
 3  3  2  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  2  0
 3  3  2  0
rho_tmp = [1, 2, 4, 4, 3]
Si_comp1 = [1, 2, 4, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  2  0
 3  3  2  0
rho_tmp = [1, 2, 5, 4, 3]
Si_comp1 = [1, 2, 5, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  2  0
 3  3  2  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  2  0
 3  3  2  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  2  0
 3  3  2  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  2  0
 3  3  2  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  2  0
 3  3  2  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [1, 2, 3, 4, 1]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  2  0
 3  3  2  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [1, 2, 3, 4, 2]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  2  0
 3  3  2  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  2  0
 3  3  2  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  2  0
 4  4  2  0
 3  3  2  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [1, 2, 3, 4, 5]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.9636294282131923
sampled gamma:
probh = 0.9636294282131923
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9636525477590079
sampled gamma:
probh = 0.9636525477590079
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.1473573550927442, 0.4105705796290231]
probh = 0.9641204704191225
sampled gamma:
probh = 0.9641204704191225
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.14932206506057388, 0.4027117397577044]
probh = 0.9636594746211451
sampled gamma:
probh = 0.9636594746211451
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.1500543373328268, 0.3997826506686929]
probh = 0.9634877684082698
sampled gamma:
probh = 0.9634877684082698
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.041236297972554715
sampled gamma:
probh = 0.041236297972554715
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.041236297972554715
sampled gamma:
probh = 0.041236297972554715
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.041236297972554715
sampled gamma:
probh = 0.041236297972554715
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.041236297972554715
sampled gamma:
probh = 0.041236297972554715
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.041236297972554715
sampled gamma:
probh = 0.041236297972554715
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 2]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  2  0
 2  2  1  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  2  0
 2  2  1  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
rho_tmp = [2, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 1, 1]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  1  0
 3  3  1  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 1]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  1  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  1  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 2, 3]

▶ iteration 77.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
muh_iter
5×4 Matrix{Float64}:
 -1.18466   -0.727964  -1.19081    0.0
  0.938174  -1.29867    0.0233878  0.0
 -0.395575   0.187257   0.379722   0.0
 -0.407427  -2.20078    0.517246   0.0
  0.0        0.0        0.0        0.0
sig2h_iter
5×4 Matrix{Float64}:
 3.37539      1.14872   0.217686  1.0
 0.734073    13.4511    0.540941  1.0
 5.52997e22   0.297111  1.03809   1.0
 0.169533     5.69734   0.546395  1.0
 1.0          1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.01795776790677823
 0.5639872417818724
 0.24860565787890138
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  1  0
 3  3  2  0
 1  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  1  0
 3  3  2  0
 1  4  2  0
 3  3  3  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = [2, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  1  0
 3  3  2  0
 1  4  2  0
 3  3  3  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = [3, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  1  0
 3  3  2  0
 1  4  2  0
 3  3  3  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = [4, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  1  0
 3  3  2  0
 2  4  2  0
 3  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [1, 1, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  1  0
 3  3  2  0
 2  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  1  0
 3  3  2  0
 2  4  2  0
 3  3  3  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = [1, 3, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  1  0
 3  3  2  0
 2  4  2  0
 3  3  3  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = [1, 4, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = [1, 2, 1, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [1, 2, 2, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 4, 4, 3]
Si_comp1 = [1, 2, 4, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 5, 4, 3]
Si_comp1 = [1, 2, 5, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 2, 3, 1, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3, 2, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3, 3, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [1, 2, 3, 4, 1]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [1, 2, 3, 4, 2]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 2, 3, 4, 3]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 2, 3, 4, 4]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [1, 2, 3, 4, 5]
Si_comp2 = [1, 2, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.14945018457702325, 0.4021992616919071]
probh = 0.8964281231253047
sampled gamma:
probh = 0.8964281231253047
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.8964893716577174
sampled gamma:
probh = 0.8964893716577174
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17282428456152657, 0.17282428456152657, 0.17282428456152657, 0.48152714631542043]
probh = 0.88213862012333
sampled gamma:
probh = 0.88213862012333
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17553301775860286, 0.17553301775860286, 0.17553301775860286, 0.4734009467241914]
probh = 0.8805120668349811
sampled gamma:
probh = 0.8805120668349811
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1765458004244042, 0.1765458004244042, 0.1765458004244042, 0.4703625987267872]
probh = 0.8799054457591671
sampled gamma:
probh = 0.8799054457591671
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update rho]
movable_units = [2]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  1  0
 3  3  2  0
 4  2  2  0
 3  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  1  0
 3  3  2  0
 4  2  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  1  0
 3  3  2  0
 4  2  2  0
 3  3  3  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  1  0
 3  3  2  0
 4  2  2  0
 3  3  3  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.24860565787890138
sampled gamma:
probh = 0.24860565787890138
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.24860565787890138
sampled gamma:
probh = 0.24860565787890138
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.24860565787890138
sampled gamma:
probh = 0.24860565787890138
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.24860565787890138
sampled gamma:
probh = 0.24860565787890138
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.24860565787890138
sampled gamma:
probh = 0.24860565787890138
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  3  0
rho_tmp = [2, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  3  0
rho_tmp = [3, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  3  0
rho_tmp = [4, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  4  0
 3  3  3  0
 4  4  3  0
 3  3  2  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  4  0
 3  3  3  0
 4  4  3  0
 3  3  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  4  0
 3  3  3  0
 4  4  3  0
 3  3  2  0
rho_tmp = [1, 3, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  4  0
 3  3  3  0
 4  4  3  0
 3  3  2  0
rho_tmp = [1, 4, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 1, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  3  0
rho_tmp = [1, 1, 4, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  3  0
 3  3  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  3  0
 3  3  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  3  0
 3  3  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 2]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  2  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  2  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 2, 3]

▶ iteration 78.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  4  2  0
 3  3  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
muh_iter
5×4 Matrix{Float64}:
  0.0662065  -0.727964   0.052893  0.0
  0.0747156  -1.29678    0.379722  0.0
 -0.657313    0.187257   0.79373   0.0
 -0.147785   -2.20078   -1.19081   0.0
  0.0         0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 0.319114    1.59674   0.654853  1.0
 1.34414     2.96604   0.306402  1.0
 3.21307e25  0.409538  1.20119   1.0
 0.290831    7.21332   0.217686  1.0
 1.0         1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.0695526722051669
 0.5998252888383154
 0.09701718395810591
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  1  0
 3  3  2  0
 1  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 3, 1, 3]
Si_comp2 = [1, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  1  0
 3  3  2  0
 1  4  2  0
 3  3  3  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = [2, 3, 1, 3]
Si_comp2 = [1, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  1  0
 3  3  2  0
 1  4  2  0
 3  3  3  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = [3, 3, 1, 3]
Si_comp2 = [1, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  1  0
 3  3  2  0
 1  4  2  0
 3  3  3  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = [4, 3, 1, 3]
Si_comp2 = [1, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.5, 0.0, 0.5]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  2  0
 3  4  2  0
 2  3  3  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 2, 3, 2]
Si_comp2 = [1, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  2  0
 3  4  2  0
 2  3  3  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2, 3, 2]
Si_comp2 = [1, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  2  0
 3  4  2  0
 2  3  3  0
rho_tmp = [1, 3, 2, 3, 2]
Si_comp1 = [1, 2, 3, 2]
Si_comp2 = [1, 3, 4, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  2  0
 3  4  2  0
 2  3  3  0
rho_tmp = [1, 4, 2, 3, 2]
Si_comp1 = [1, 2, 3, 2]
Si_comp2 = [1, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 2, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 2  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 1, 2, 3]
Si_comp1 = [1, 1, 2, 3]
Si_comp2 = [1, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 2  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 3]
Si_comp2 = [1, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 2  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 3, 2, 3]
Si_comp2 = [1, 3, 4, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 2  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 4, 2, 3]
Si_comp1 = [1, 4, 2, 3]
Si_comp2 = [1, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 2, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 2  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 3, 1, 3]
Si_comp2 = [1, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 2  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 3, 2, 3]
Si_comp2 = [1, 3, 4, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 2  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 3, 3, 3]
Si_comp2 = [1, 3, 4, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 2  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1, 3, 4, 3]
Si_comp2 = [1, 3, 4, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.5, 0.0, 0.5]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 2, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 2  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 3, 2, 1]
Si_comp2 = [1, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 2  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = [1, 3, 2, 2]
Si_comp2 = [1, 3, 4, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 2  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 3, 2, 3]
Si_comp2 = [1, 3, 4, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 2  4  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [1, 3, 2, 4]
Si_comp2 = [1, 3, 4, 3]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 2, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.898893440441198, 4.898893440441198, 4.898893440441198, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1757100899524644, 0.1757100899524644, 0.1757100899524644, 0.4728697301426069]
probh = 0.760181081600777
sampled gamma:
probh = 0.760181081600777
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 4]
Si_red1 = [1, 2, 3, 4, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.897253614065066, 4.897253614065066, 4.897253614065066, 4.897253614065066, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.14935160086855484, 0.40259359652578064]
probh = 0.9093883314331723
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.864190732196103, 4.864190732196103, 4.864190732196103, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17282428456152657, 0.17282428456152657, 0.17282428456152657, 0.48152714631542043]
probh = 0.8966196733995782
sampled gamma:
probh = 0.8966196733995782
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.8967624220024675, 4.8967624220024675, 4.8967624220024675, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17553301775860286, 0.17553301775860286, 0.17553301775860286, 0.4734009467241914]
probh = 0.8951692175894695
sampled gamma:
probh = 0.8951692175894695
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.908954409619434, 4.908954409619434, 4.908954409619434, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1765458004244042, 0.1765458004244042, 0.1765458004244042, 0.4703625987267872]
probh = 0.8946281035471436
sampled gamma:
probh = 0.8946281035471436
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 1, 0]
												[update rho]
movable_units = [2, 5]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  1  0
 3  3  2  0
 2  2  2  0
 3  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  1  0
 3  3  2  0
 2  2  2  0
 3  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  1  0
 3  3  2  0
 2  2  2  0
 3  3  3  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  4  1  0
 3  3  2  0
 2  2  2  0
 3  3  3  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  3  2  0
 3  2  3  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  3  2  0
 3  2  3  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  3  2  0
 3  2  3  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  3  2  0
 3  2  3  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 3, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.09701718395810591
sampled gamma:
probh = 0.09701718395810591
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.09701718395810591
sampled gamma:
probh = 0.09701718395810591
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.09701718395810591
sampled gamma:
probh = 0.09701718395810591
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.09701718395810591
sampled gamma:
probh = 0.09701718395810591
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.09701718395810591
sampled gamma:
probh = 0.09701718395810591
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  3  2  0
 3  1  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  3  2  0
 3  1  3  0
rho_tmp = [2, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  3  2  0
 3  1  3  0
rho_tmp = [3, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  3  2  0
 3  1  3  0
rho_tmp = [4, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 1, 3]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  3  0
 3  2  1  0
 2  3  1  0
 3  1  2  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
