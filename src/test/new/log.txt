LOG FILE
current seed = 512.0

▶ iteration 1.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
muh_iter
5×4 Matrix{Float64}:
 0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0
sig2h_iter
5×4 Matrix{Float64}:
 1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0
alpha_iter
4-element Vector{Float64}:
 0.5
 0.5
 0.5
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
rho_tmp = [2, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 1, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 1  1  1  0
 1  1  1  0
 1  1  1  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 1, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 1  1  1  0
 1  1  1  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 1  1  1  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 1  1  1  0
 1  1  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 1  1  1  0
 1  1  1  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 2  1  1  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 2  1  1  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 2  1  1  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 2  1  1  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 2, 4]
► time 2
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.5
sampled gamma:
probh = 0.5
gt = true
gamma_iter[:, t] = Bool[1, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.7943622151526066
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.8082976700245764
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25395099810962674, 0.7460490018903733]
probh = 0.7974793285443639
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.810715301700127
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 0, 0]
												[update rho]
movable_units = [2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 2  1  1  0
 4  1  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 2  1  1  0
 4  1  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 1, 1]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  1  0
 2  1  1  0
 4  1  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  1  0
 2  1  1  0
 4  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  1  0
 2  1  1  0
 4  1  1  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 1, 1]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 2  1  1  0
 4  1  1  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 2  1  1  0
 4  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 2  1  1  0
 4  1  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 2  1  1  0
 4  1  1  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 2, 1]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 2  2  1  0
 4  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 2  2  1  0
 4  1  1  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 2  2  1  0
 4  1  1  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 2  2  1  0
 4  1  1  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 2, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.5
sampled gamma:
probh = 0.5
gt = true
gamma_iter[:, t] = Bool[1, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.7943622151526066
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.8082976700245764
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25395099810962674, 0.7460490018903733]
probh = 0.7974793285443639
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.810715301700127
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 0, 0]
												[update rho]
movable_units = [2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 2  2  1  0
 4  2  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 2  2  1  0
 4  2  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 2  2  1  0
 4  2  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 2  2  1  0
 4  2  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 2  2  1  0
 4  2  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 2  2  1  0
 4  2  1  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 2  2  1  0
 4  2  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 2  2  1  0
 4  2  1  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]

▶ iteration 2.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 2  2  1  0
 4  2  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
muh_iter
5×4 Matrix{Float64}:
  0.495169  0.0       0.0  0.0
 -1.20224   1.6737    0.0  0.0
  1.87863   0.156821  0.0  0.0
  1.93474   0.0       0.0  0.0
  0.0       0.0       0.0  0.0
sig2h_iter
5×4 Matrix{Float64}:
 4.41738   0.98865  0.935303  1.0
 1.86138   3.07607  1.0       1.0
 0.857748  2.84037  1.0       1.0
 2.52866   1.0      1.0       1.0
 1.0       1.0      1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.2216319762384468
 0.20635361794948465
 0.3321608124039784
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 2, 4]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  1  0
 3  3  1  0
 2  2  1  0
 1  2  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  1  0
 3  3  1  0
 2  2  1  0
 1  2  1  0
rho_tmp = [2, 2, 3, 2, 1]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  1  0
 3  3  1  0
 2  2  1  0
 1  2  1  0
rho_tmp = [3, 2, 3, 2, 1]
Si_comp1 = [3]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  1  0
 3  3  1  0
 2  2  1  0
 1  2  1  0
rho_tmp = [4, 2, 3, 2, 1]
Si_comp1 = [4]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 2, 4]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 2  2  1  0
 4  2  1  0
rho_tmp = [1, 1, 3, 2, 4]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 2  2  1  0
 4  2  1  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 2  2  1  0
 4  2  1  0
rho_tmp = [1, 3, 3, 2, 4]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 2  2  1  0
 4  2  1  0
rho_tmp = [1, 4, 3, 2, 4]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 2  2  1  0
 4  2  1  0
rho_tmp = [1, 5, 3, 2, 4]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 4  3  1  0
 3  2  1  0
 2  2  1  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 4  3  1  0
 3  2  1  0
 2  2  1  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 4  3  1  0
 3  2  1  0
 2  2  1  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 4  3  1  0
 3  2  1  0
 2  2  1  0
rho_tmp = [1, 2, 4, 3, 2]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 3  2  1  0
 2  2  1  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 3  2  1  0
 2  2  1  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 3  2  1  0
 2  2  1  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 3  2  1  0
 2  2  1  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 4  2  1  0
 2  2  1  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 4  2  1  0
 2  2  1  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 4  2  1  0
 2  2  1  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 4  2  1  0
 2  2  1  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  1  0
 4  2  1  0
 2  2  1  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 5
Si_iter[:, t] = [1, 2, 3, 4, 5]
► time 2
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.20635361794948465
sampled gamma:
probh = 0.20635361794948465
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.20635361794948465
sampled gamma:
probh = 0.20635361794948465
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.20635361794948465
sampled gamma:
probh = 0.20635361794948465
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.20635361794948465
sampled gamma:
probh = 0.20635361794948465
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.20635361794948465
sampled gamma:
probh = 0.20635361794948465
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 2, 2]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  3  1  0
 2  2  1  0
 3  1  1  0
 4  2  1  0
 5  2  1  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  3  1  0
 2  2  1  0
 3  1  1  0
 4  2  1  0
 5  2  1  0
rho_tmp = [2, 2, 1, 2, 2]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  3  1  0
 2  2  1  0
 3  1  1  0
 4  2  1  0
 5  2  1  0
rho_tmp = [3, 2, 1, 2, 2]
Si_comp1 = [3]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 2, 2]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  1  0
 4  2  1  0
 5  2  1  0
rho_tmp = [1, 1, 1, 2, 2]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  1  0
 4  2  1  0
 5  2  1  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  1  0
 4  2  1  0
 5  2  1  0
rho_tmp = [1, 3, 1, 2, 2]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 2]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 4  2  1  0
 5  2  1  0
rho_tmp = [1, 1, 1, 2, 2]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 4  2  1  0
 5  2  1  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 4  2  1  0
 5  2  1  0
rho_tmp = [1, 1, 3, 2, 2]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 3]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 4  3  1  0
 5  3  1  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 4  3  1  0
 5  3  1  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 4  3  1  0
 5  3  1  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 4  3  1  0
 5  3  1  0
rho_tmp = [1, 1, 2, 4, 3]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 4  2  1  0
 5  3  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 4  2  1  0
 5  3  1  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 4  2  1  0
 5  3  1  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.3321608124039784
sampled gamma:
probh = 0.3321608124039784
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.3321608124039784
sampled gamma:
probh = 0.3321608124039784
gt = true
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.677117952808143
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25395099810962674, 0.7460490018903733]
probh = 0.6619924168411393
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.6805360895692073
sampled gamma:
probh = 0.6805360895692073
gt = true
gamma_iter[:, t] = Bool[0, 1, 0, 0, 1]
												[update rho]
movable_units = [1, 3, 4]
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 4  2  1  0
 5  1  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 4  2  1  0
 5  1  1  0
rho_tmp = [2, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 2]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  2  2  0
 4  2  2  0
 5  1  2  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  2  2  0
 4  2  2  0
 5  1  2  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  2  2  0
 4  2  2  0
 5  1  2  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 2, 2]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  2  1  0
 4  2  2  0
 5  1  2  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  2  1  0
 4  2  2  0
 5  1  2  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  2  1  0
 4  2  2  0
 5  1  2  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 1, 3, 2]

▶ iteration 3.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  2  1  0
 4  2  3  0
 5  1  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 -1.91802   0.156821  0.192261  0.0
  1.24826   3.19264   0.0       0.0
  0.644131  1.6737    4.6451    0.0
 -0.862474  0.0       0.0       0.0
  0.980914  0.0       0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 2.55263    0.601797  0.155894  1.0
 2.99354   17.0192    0.746726  1.0
 0.162529   3.07607   2.092     1.0
 0.329002   1.0       1.0       1.0
 5.18541    1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.09036363748966532
 0.17161279119262454
 0.27966608801744036
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 5]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 5  1  1  0
 2  1  2  0
 3  2  1  0
 4  2  3  0
 1  1  2  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 5  1  1  0
 2  1  2  0
 3  2  1  0
 4  2  3  0
 1  1  2  0
rho_tmp = [2, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 5  1  1  0
 2  1  2  0
 3  2  1  0
 4  2  3  0
 1  1  2  0
rho_tmp = [3, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 5  1  1  0
 2  1  2  0
 3  2  1  0
 4  2  3  0
 1  1  2  0
rho_tmp = [4, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 5  1  1  0
 2  1  2  0
 3  2  1  0
 4  2  3  0
 1  1  2  0
rho_tmp = [5, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 1, 4]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  1  2  0
 3  2  1  0
 1  2  3  0
 2  1  2  0
rho_tmp = [1, 1, 3, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  1  2  0
 3  2  1  0
 1  2  3  0
 2  1  2  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  1  2  0
 3  2  1  0
 1  2  3  0
 2  1  2  0
rho_tmp = [1, 3, 3, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  1  2  0
 3  2  1  0
 1  2  3  0
 2  1  2  0
rho_tmp = [1, 4, 3, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 1, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 3  2  1  0
 1  2  3  0
 2  1  2  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 3  2  1  0
 1  2  3  0
 2  1  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 3  2  1  0
 1  2  3  0
 2  1  2  0
rho_tmp = [1, 1, 3, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 1, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 1  2  3  0
 2  1  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 1  2  3  0
 2  1  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 1  2  3  0
 2  1  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  2  3  0
 2  1  2  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  2  3  0
 2  1  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  2  3  0
 2  1  2  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 2, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.17161279119262454
sampled gamma:
probh = 0.17161279119262454
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.17161279119262454
sampled gamma:
probh = 0.17161279119262454
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.17161279119262454
sampled gamma:
probh = 0.17161279119262454
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.17161279119262454
sampled gamma:
probh = 0.17161279119262454
gt = true
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.21276353842810275
sampled gamma:
probh = 0.21276353842810275
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update rho]
movable_units = [1, 2, 3, 5]
Si_iter[:, t] = [1, 1, 2, 2, 1]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  2  3  0
 3  1  2  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  2  3  0
 3  1  2  0
rho_tmp = [2, 1, 2, 2, 1]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  2  3  0
 3  1  2  0
rho_tmp = [3, 1, 2, 2, 1]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 2]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 2]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  3  3  0
 3  2  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  3  3  0
 3  2  2  0
rho_tmp = [1, 3, 3, 3, 2]
Si_comp1 = [3, 2]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  3  3  0
 3  2  2  0
rho_tmp = [1, 4, 3, 3, 2]
Si_comp1 = [4, 2]
Si_comp2 = [2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 3, 2]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  3  3  0
 3  2  2  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  3  3  0
 3  2  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  3  3  0
 3  2  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  3  3  0
 3  2  2  0
rho_tmp = [1, 2, 4, 3, 2]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 2]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  4  3  0
 3  2  2  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [2, 1]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  4  3  0
 3  2  2  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  4  3  0
 3  2  2  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [2, 3]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  4  3  0
 3  2  2  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [2, 4]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  4  3  0
 3  2  2  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [2, 5]
Si_comp2 = [2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 4, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18763781382561492, 0.18763781382561492, 0.6247243723487702]
probh = 0.6741736557395985
sampled gamma:
probh = 0.6741736557395985
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.837036039561302, 4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2056377848473934, 0.2056377848473934, 0.5887244303052133]
probh = 0.39739732729873506
sampled gamma:
probh = 0.39739732729873506
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.720608804660927, 4.720608804660927, 4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16086427386558605, 0.16086427386558605, 0.16086427386558605, 0.5174071784032418]
probh = 0.707045096751775
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.811228001684916, 4.811228001684916, 4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1684134637041103, 0.1684134637041103, 0.1684134637041103, 0.49475960888766907]
probh = 0.6974564218926492
sampled gamma:
probh = 0.6974564218926492
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.700105935349557, 4.700105935349557, 4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15915844084302325, 0.15915844084302325, 0.15915844084302325, 0.5225246774709303]
probh = 0.7092484090376879
sampled gamma:
probh = 0.7092484090376879
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 1, 0]
												[update rho]
movable_units = [3, 5]
Si_iter[:, t] = [1, 2, 1, 3, 2]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  4  3  0
 3  2  2  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  4  3  0
 3  2  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  4  3  0
 3  2  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  1  0
 2  4  3  0
 3  2  2  0
rho_tmp = [1, 2, 4, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 2]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  3  0
 3  2  2  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  3  0
 3  2  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  3  0
 3  2  2  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  3  0
 3  2  2  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]

▶ iteration 4.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  3  0
 3  2  4  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
muh_iter
5×4 Matrix{Float64}:
 -0.0197177  2.33189   0.192261  0.0
  1.24582    0.156821  0.0       0.0
  1.34782    4.94891   4.6451    0.0
  1.13831    3.19264   1.33411   0.0
 -1.91802    0.0       0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 5.96931   0.764524   0.204192  1.0
 0.83646   0.727782   0.393927  1.0
 4.71546   1.03042   11.2279    1.0
 2.99354  15.6629     0.877101  1.0
 2.55263   1.0        1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.0018245701342094476
 0.15034979882763277
 0.40969078380512525
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  3  0
 3  2  4  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [2]
Si_comp2 = [4]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  3  0
 3  2  4  0
rho_tmp = [2, 1, 2, 2, 3]
Si_comp1 = [2]
Si_comp2 = [4]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  3  0
 3  2  4  0
rho_tmp = [3, 1, 2, 2, 3]
Si_comp1 = [2]
Si_comp2 = [4]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  3  0
 3  2  4  0
rho_tmp = [4, 1, 2, 2, 3]
Si_comp1 = [2]
Si_comp2 = [4]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  4  3  0
 2  2  4  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [3]
Si_comp2 = [4]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  4  3  0
 2  2  4  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [3]
Si_comp2 = [4]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  4  3  0
 2  2  4  0
rho_tmp = [1, 3, 3, 3, 2]
Si_comp1 = [3]
Si_comp2 = [4]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  3  3  0
 3  4  3  0
 2  2  4  0
rho_tmp = [1, 4, 3, 3, 2]
Si_comp1 = [3]
Si_comp2 = [4]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  3  0
 3  2  4  0
rho_tmp = [1, 1, 1, 2, 3]
Si_comp1 = [2]
Si_comp2 = [4]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  3  0
 3  2  4  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [2]
Si_comp2 = [4]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  3  0
 3  2  4  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [2]
Si_comp2 = [4]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 2  4  3  0
 3  2  4  0
rho_tmp = [1, 1, 4, 2, 3]
Si_comp1 = [2]
Si_comp2 = [4]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 1, 2, 3, 4]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 4  4  3  0
 3  2  4  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = [1]
Si_comp2 = [4]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 4  4  3  0
 3  2  4  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [2]
Si_comp2 = [4]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 4  4  3  0
 3  2  4  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [3]
Si_comp2 = [4]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 4  4  3  0
 3  2  4  0
rho_tmp = [1, 1, 2, 4, 3]
Si_comp1 = [4]
Si_comp2 = [4]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 1, 2, 3, 4]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  3  0
 4  2  4  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [3]
Si_comp2 = [4]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  3  0
 4  2  4  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [3]
Si_comp2 = [4]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  3  0
 4  2  4  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [3]
Si_comp2 = [4]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  3  3  0
 3  4  3  0
 4  2  4  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [3]
Si_comp2 = [4]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 1, 2, 3, 4]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23097802558886682, 0.7690219744111332]
probh = 0.187060525293008
sampled gamma:
probh = 0.187060525293008
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.1927438641726441
sampled gamma:
probh = 0.1927438641726441
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.42730051422422793
sampled gamma:
probh = 0.42730051422422793
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.15034979882763277
sampled gamma:
probh = 0.15034979882763277
gt = true
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.18755631352747626
sampled gamma:
probh = 0.18755631352747626
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update rho]
movable_units = [1, 2, 3, 5]
Si_iter[:, t] = [1, 2, 3, 4, 2]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 1  2  2  0
 2  3  3  0
 3  1  3  0
 4  2  4  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 1  2  2  0
 2  3  3  0
 3  1  3  0
 4  2  4  0
rho_tmp = [2, 2, 3, 1, 2]
Si_comp1 = [2, 2, 1]
Si_comp2 = [1, 2, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 1  2  2  0
 2  3  3  0
 3  1  3  0
 4  2  4  0
rho_tmp = [3, 2, 3, 1, 2]
Si_comp1 = [3, 2, 1]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 1  2  2  0
 2  3  3  0
 3  1  3  0
 4  2  4  0
rho_tmp = [4, 2, 3, 1, 2]
Si_comp1 = [4, 2, 1]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.5, 0.5]
new_label = 3
Si_iter[:, t] = [1, 2, 1, 3, 2]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  1  3  0
 3  3  3  0
 4  2  4  0
rho_tmp = [1, 1, 1, 3, 2]
Si_comp1 = [1, 1, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  1  3  0
 3  3  3  0
 4  2  4  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  1  3  0
 3  3  3  0
 4  2  4  0
rho_tmp = [1, 3, 1, 3, 2]
Si_comp1 = [1, 3, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  1  3  0
 3  3  3  0
 4  2  4  0
rho_tmp = [1, 4, 1, 3, 2]
Si_comp1 = [1, 4, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.5, 0.0, 0.5]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 3, 2]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  1  3  0
 3  3  3  0
 4  2  4  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  1  3  0
 3  3  3  0
 4  2  4  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  1  3  0
 3  3  3  0
 4  2  4  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  1  3  0
 3  3  3  0
 4  2  4  0
rho_tmp = [1, 2, 4, 3, 2]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  2  3  0
 3  3  3  0
 4  2  4  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  2  3  0
 3  3  3  0
 4  2  4  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  2  3  0
 3  3  3  0
 4  2  4  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  2  3  0
 3  3  3  0
 4  2  4  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18763781382561492, 0.18763781382561492, 0.6247243723487702]
probh = 0.7871779377357615
sampled gamma:
probh = 0.7871779377357615
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.483590277571483
sampled gamma:
probh = 0.483590277571483
gt = true
gamma_iter[:, t] = Bool[0, 1, 0, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19170232997542352, 0.19170232997542352, 0.616595340049153]
probh = 0.7835656649949077
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25395099810962674, 0.7460490018903733]
probh = 0.48193791020765303
sampled gamma:
probh = 0.48193791020765303
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.4751826342759921
sampled gamma:
probh = 0.4751826342759921
gt = true
gamma_iter[:, t] = Bool[0, 1, 0, 0, 1]
												[update rho]
movable_units = [1, 3, 4]
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 1  2  2  0
 2  2  3  0
 3  3  3  0
 4  3  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 1  2  2  0
 2  2  3  0
 3  3  3  0
 4  3  1  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 1  2  2  0
 2  2  3  0
 3  3  3  0
 4  3  1  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 1  2  2  0
 2  2  3  0
 3  3  3  0
 4  3  1  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  2  2  0
 3  3  2  0
 4  3  3  0
rho_tmp = [1, 1, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  2  2  0
 3  3  2  0
 4  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  2  2  0
 3  3  2  0
 4  3  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  2  2  0
 3  3  2  0
 4  3  3  0
rho_tmp = [1, 1, 4, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  2  2  0
 3  3  3  0
 4  3  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  2  2  0
 3  3  3  0
 4  3  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  2  2  0
 3  3  3  0
 4  3  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 1, 2]

▶ iteration 5.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  2  2  0
 3  3  1  0
 4  3  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
  0.101929  4.94891   0.0       0.0
  0.160281  0.156821  1.33411   0.0
  1.68551   3.19264   4.6451    0.0
  1.22993   2.33189   0.192261  0.0
 -1.91802   0.0       0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 3.14448   26.4722     0.39316   1.0
 0.720928   1.14943    0.575597  1.0
 2.57358   15.5037    11.2279    1.0
 6.66183    0.764524   0.204192  1.0
 2.55263    1.0        1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.1893251981781573
 0.4581991303885645
 0.42795585777325135
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 3, 4]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  2  2  0
 3  3  1  0
 4  3  2  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  2  2  0
 3  3  1  0
 4  3  2  0
rho_tmp = [2, 1, 2, 3, 4]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  2  2  0
 3  3  1  0
 4  3  2  0
rho_tmp = [3, 1, 2, 3, 4]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  2  2  0
 3  3  1  0
 4  3  2  0
rho_tmp = [4, 1, 2, 3, 4]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  2  2  0
 3  3  1  0
 4  3  2  0
rho_tmp = [5, 1, 2, 3, 4]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  1  0
 3  2  2  0
 2  3  1  0
 1  3  2  0
rho_tmp = [1, 1, 3, 2, 1]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  1  0
 3  2  2  0
 2  3  1  0
 1  3  2  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  1  0
 3  2  2  0
 2  3  1  0
 1  3  2  0
rho_tmp = [1, 3, 3, 2, 1]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  1  0
 3  2  2  0
 2  3  1  0
 1  3  2  0
rho_tmp = [1, 4, 3, 2, 1]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  1  0
 1  3  2  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  1  0
 1  3  2  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  1  0
 1  3  2  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  1  0
 1  3  2  0
rho_tmp = [1, 2, 4, 3, 1]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 3  3  1  0
 1  3  2  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 3  3  1  0
 1  3  2  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 3  3  1  0
 1  3  2  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 3  3  1  0
 1  3  2  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [4]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 3  3  1  0
 1  3  2  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 3  3  1  0
 1  3  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 3  3  1  0
 1  3  2  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 3  3  1  0
 1  3  2  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23097802558886682, 0.7690219744111332]
probh = 0.5237423989886961
sampled gamma:
probh = 0.5237423989886961
gt = true
gamma_iter[:, t] = Bool[1, 0, 0, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2056377848473934, 0.2056377848473934, 0.5887244303052133]
probh = 0.8044030556926532
sampled gamma:
probh = 0.8044030556926532
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 4.665308262143196, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19370004475101535, 0.18327912406712002, 0.6230208311818646]
probh = 0.8218819673633182
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.811228001684916, 4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20252067145563615, 0.20252067145563615, 0.5949586570887277]
probh = 0.5870221750618473
sampled gamma:
probh = 0.5870221750618473
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.700105935349557, 4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18928469829987307, 0.18928469829987307, 0.6214306034002539]
probh = 0.5764303055130127
sampled gamma:
probh = 0.5764303055130127
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 0, 0]
												[update rho]
movable_units = [3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 3, 3]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 3  3  1  0
 3  3  2  0
rho_tmp = [1, 2, 1, 3, 3]
Si_comp1 = [2, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 3  3  1  0
 3  3  2  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = [2, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 3  3  1  0
 3  3  2  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [2, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 3  3  1  0
 3  3  2  0
rho_tmp = [1, 2, 4, 3, 3]
Si_comp1 = [2, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 4]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  4  1  0
 3  4  2  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [2, 4]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  4  1  0
 3  4  2  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [2, 4]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  4  1  0
 3  4  2  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [2, 4]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  4  1  0
 3  4  2  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [2, 4]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  4  1  0
 3  4  2  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = [2, 4]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 2, 4]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  2  1  0
 3  4  2  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [2, 1]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  2  1  0
 3  4  2  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = [2, 2]
Si_comp2 = [1, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  2  1  0
 3  4  2  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [2, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  2  1  0
 3  4  2  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [2, 4]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.0, 0.3333333333333333, 0.3333333333333333]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 2, 4]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.007117550135875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.29281311194311704, 0.7071868880568829]
probh = 0.7187004653522228
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.7429249847528666
sampled gamma:
probh = 0.7429249847528666
gt = true
gamma_iter[:, t] = Bool[0, 1, 0, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.0416453621923845, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.30001370567070174, 0.6999862943292982]
probh = 0.5166184809242301
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.132264559216373, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.31938198507206067, 0.6806180149279393]
probh = 0.7008128002996239
sampled gamma:
probh = 0.7008128002996239
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.4939244479740903
sampled gamma:
probh = 0.4939244479740903
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update rho]
movable_units = [1, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 1, 2]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  2  1  0
 3  4  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  2  1  0
 3  4  2  0
rho_tmp = [2, 1, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  2  1  0
 3  4  2  0
rho_tmp = [3, 1, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 1, 2]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  2  1  0
 3  4  2  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  2  1  0
 3  4  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  2  1  0
 3  4  2  0
rho_tmp = [1, 1, 3, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 1, 3]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  2  1  0
 3  4  3  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  2  1  0
 3  4  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  2  1  0
 3  4  3  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  2  1  0
 3  4  3  0
rho_tmp = [1, 1, 2, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 1, 3]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  2  1  0
 3  4  3  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  2  1  0
 3  4  3  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  2  1  0
 3  4  3  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 1, 1]

▶ iteration 6.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  2  1  0
 3  4  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
muh_iter
5×4 Matrix{Float64}:
  0.839129  4.94891    0.0       0.0
  2.02994   0.156821  -0.415384  0.0
  0.67418   4.91734    1.33411   0.0
 -0.849259  3.4783     0.192261  0.0
 -1.91802   0.0        0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 1.47052  7.19232   0.57062   1.0
 1.07476  1.15113   0.273325  1.0
 5.19969  0.512737  0.575597  1.0
 3.14448  7.98588   0.204192  1.0
 2.55263  1.0       1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.3195115646482313
 0.3673414885357323
 0.5191410455060633
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  2  1  0
 1  3  2  0
 1  2  1  0
 1  4  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  2  1  0
 1  3  2  0
 1  2  1  0
 1  4  1  0
rho_tmp = [2, 2, 1, 1, 1]
Si_comp1 = [2, 2]
Si_comp2 = [1, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  2  1  0
 1  3  2  0
 1  2  1  0
 1  4  1  0
rho_tmp = [3, 2, 1, 1, 1]
Si_comp1 = [3, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.5]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 1, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 1  2  1  0
 1  4  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1]
Si_comp2 = [1, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 1  2  1  0
 1  4  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5]
After exp and normalization:
ph = [0.0, 1.0]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 1, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 1  2  1  0
 1  4  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 1  2  1  0
 1  4  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 1  2  1  0
 1  4  1  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 1, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 1  2  1  0
 1  4  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 1  2  1  0
 1  4  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 1  2  1  0
 1  4  1  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 2  2  1  0
 1  4  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 2  2  1  0
 1  4  1  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 2  2  1  0
 1  4  1  0
rho_tmp = [1, 2, 1, 2, 3]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23097802558886682, 0.7690219744111332]
probh = 0.7154074641873268
sampled gamma:
probh = 0.7154074641873268
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.4392866712985608
sampled gamma:
probh = 0.4392866712985608
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.4321900214169082
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25395099810962674, 0.7460490018903733]
probh = 0.43765738932098536
sampled gamma:
probh = 0.43765738932098536
gt = true
gamma_iter[:, t] = Bool[1, 0, 0, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.700105935349557, 4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18928469829987307, 0.18928469829987307, 0.6214306034002539]
probh = 0.4830295550182391
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 1, 0]
												[update rho]
movable_units = [2, 3, 5]
Si_iter[:, t] = [1, 2, 3, 2, 4]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 2  2  1  0
 1  4  1  0
rho_tmp = [1, 1, 3, 2, 4]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 2  2  1  0
 1  4  1  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 2  2  1  0
 1  4  1  0
rho_tmp = [1, 3, 3, 2, 4]
Si_comp1 = [3]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 2  2  1  0
 1  4  1  0
rho_tmp = [1, 4, 3, 2, 4]
Si_comp1 = [4]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 2  2  1  0
 1  4  1  0
rho_tmp = [1, 5, 3, 2, 4]
Si_comp1 = [5]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 5
Si_iter[:, t] = [1, 2, 3, 4, 5]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  5  2  0
 2  4  1  0
 1  3  1  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  5  2  0
 2  4  1  0
 1  3  1  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  5  2  0
 2  4  1  0
 1  3  1  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  5  2  0
 2  4  1  0
 1  3  1  0
rho_tmp = [1, 2, 4, 4, 3]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  5  2  0
 2  4  1  0
 1  3  1  0
rho_tmp = [1, 2, 5, 4, 3]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 5
Si_iter[:, t] = [1, 2, 3, 4, 5]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 2  4  1  0
 1  5  1  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 2  4  1  0
 1  5  1  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 2  4  1  0
 1  5  1  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 2  4  1  0
 1  5  1  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 2  4  1  0
 1  5  1  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 4, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23097802558886682, 0.7690219744111332]
probh = 0.8237602605205315
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.5191410455060633
sampled gamma:
probh = 0.5191410455060633
gt = true
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.5859673057028579
sampled gamma:
probh = 0.5859673057028579
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.811228001684916, 4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20252067145563615, 0.20252067145563615, 0.5949586570887277]
probh = 0.8420438905662948
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18928469829987307, 0.18928469829987307, 0.6214306034002539]
probh = 0.850827325260085
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update rho]
movable_units = [1, 4, 5]
Si_iter[:, t] = [1, 1, 2, 1, 1]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 2  4  1  0
 1  3  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 2  4  1  0
 1  3  1  0
rho_tmp = [2, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 2  4  1  0
 1  3  1  0
rho_tmp = [3, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 2, 2]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  2  0
 1  3  2  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  2  0
 1  3  2  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  2  0
 1  3  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  2  0
 1  3  2  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 2, 2]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  2  0
 1  3  2  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  2  0
 1  3  2  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  2  0
 1  3  2  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  2  0
 1  3  2  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 2, 2]

▶ iteration 7.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  2  0
 1  3  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
muh_iter
5×4 Matrix{Float64}:
  0.398154  4.94891   -0.354221  0.0
  0.563484  3.40033    0.0       0.0
  0.187818  5.17835   -0.415384  0.0
  1.23683   0.156821   0.192261  0.0
 -1.91802   3.4783     0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 2.56772  6.55697   0.218354  1.0
 2.43357  4.6757    0.231201  1.0
 1.47052  2.26458   0.492169  1.0
 3.14448  0.702037  0.204192  1.0
 2.55263  7.98588   1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.10826274814438296
 0.5446371825097964
 0.35035209151524915
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 1, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  2  0
 1  3  2  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2]
Si_comp2 = [1, 4]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  2  0
 1  3  2  0
rho_tmp = [2, 2, 1, 2, 1]
Si_comp1 = [2, 2]
Si_comp2 = [1, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  2  0
 1  3  2  0
rho_tmp = [3, 2, 1, 2, 1]
Si_comp1 = [3, 2]
Si_comp2 = [1, 4]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.5]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 2, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  4  2  0
 3  3  2  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [1, 2]
Si_comp2 = [1, 4]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  4  2  0
 3  3  2  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2]
Si_comp2 = [1, 4]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  4  2  0
 3  3  2  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = [1, 2]
Si_comp2 = [1, 4]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  4  2  0
 3  3  2  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = [1, 2]
Si_comp2 = [1, 4]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  2  0
 2  3  2  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = [1, 3]
Si_comp2 = [1, 4]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  2  0
 2  3  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 3]
Si_comp2 = [1, 4]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  2  0
 2  3  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 3]
Si_comp2 = [1, 4]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  2  0
 2  3  2  0
rho_tmp = [1, 2, 4, 3, 2]
Si_comp1 = [1, 3]
Si_comp2 = [1, 4]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  2  0
 2  3  2  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = [1, 1]
Si_comp2 = [1, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  2  0
 2  3  2  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 4]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  2  0
 2  3  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 3]
Si_comp2 = [1, 4]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  4  2  0
 2  3  2  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [1, 4]
Si_comp2 = [1, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  4  2  0
 2  3  2  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 3]
Si_comp2 = [1, 4]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  4  2  0
 2  3  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 3]
Si_comp2 = [1, 4]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  4  2  0
 2  3  2  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 3]
Si_comp2 = [1, 4]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  4  2  0
 2  3  2  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 3]
Si_comp2 = [1, 4]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 3, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23097802558886682, 0.7690219744111332]
probh = 0.6086547628231381
sampled gamma:
probh = 0.6086547628231381
gt = true
gamma_iter[:, t] = Bool[1, 0, 0, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.837036039561302, 4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2056377848473934, 0.2056377848473934, 0.5887244303052133]
probh = 0.6701409045121117
sampled gamma:
probh = 0.6701409045121117
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.720608804660927, 4.720608804660927, 4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16086427386558605, 0.16086427386558605, 0.16086427386558605, 0.5174071784032418]
probh = 0.8814485551611659
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.811228001684916, 4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20252067145563615, 0.20252067145563615, 0.5949586570887277]
probh = 0.667808248063794
sampled gamma:
probh = 0.667808248063794
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.700105935349557, 4.700105935349557, 4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15915844084302325, 0.15915844084302325, 0.15915844084302325, 0.5225246774709303]
probh = 0.6959548160925678
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 1, 0]
												[update rho]
movable_units = [3, 5]
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  4  2  0
 1  3  2  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = [2, 1]
Si_comp2 = [2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  4  2  0
 1  3  2  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [2, 2]
Si_comp2 = [2, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  4  2  0
 1  3  2  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [2, 3]
Si_comp2 = [2, 3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  4  2  0
 1  3  2  0
rho_tmp = [1, 2, 4, 4, 3]
Si_comp1 = [2, 4]
Si_comp2 = [2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 3  4  2  0
 1  3  2  0
rho_tmp = [1, 2, 5, 4, 3]
Si_comp1 = [2, 5]
Si_comp2 = [2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.0, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 3, 4]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  3  0
 3  3  2  0
 1  4  2  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [2, 1]
Si_comp2 = [2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  3  0
 3  3  2  0
 1  4  2  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = [2, 1]
Si_comp2 = [2, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  3  0
 3  3  2  0
 1  4  2  0
rho_tmp = [1, 2, 1, 3, 3]
Si_comp1 = [2, 1]
Si_comp2 = [2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  3  0
 3  3  2  0
 1  4  2  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = [2, 1]
Si_comp2 = [2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 3, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18763781382561492, 0.18763781382561492, 0.6247243723487702]
probh = 0.7418774861050766
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.6756673845515458
sampled gamma:
probh = 0.6756673845515458
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.41416482015345063
sampled gamma:
probh = 0.41416482015345063
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.811228001684916, 4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20252067145563615, 0.20252067145563615, 0.5949586570887277]
probh = 0.7269933951819686
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18928469829987307, 0.18928469829987307, 0.6214306034002539]
probh = 0.7402005440469347
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update rho]
movable_units = [1, 4, 5]
Si_iter[:, t] = [1, 2, 3, 2, 2]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  3  0
 2  2  2  0
 3  1  1  0
 3  3  2  0
 1  1  2  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  3  0
 2  2  2  0
 3  1  1  0
 3  3  2  0
 1  1  2  0
rho_tmp = [2, 2, 1, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  3  0
 2  2  2  0
 3  1  1  0
 3  3  2  0
 1  1  2  0
rho_tmp = [3, 2, 1, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 1, 1]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  3  1  0
 1  1  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  3  1  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  3  1  0
 1  1  1  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 1]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  3  3  0
 1  1  1  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  3  3  0
 1  1  1  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  3  3  0
 1  1  1  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  3  3  0
 1  1  1  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]

▶ iteration 8.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  3  3  0
 1  1  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
muh_iter
5×4 Matrix{Float64}:
 -0.168331  4.94891    0.0       0.0
  0.292534  3.40033   -0.415384  0.0
  1.52492   0.156821   2.76384   0.0
  0.563484  5.17835    0.192261  0.0
 -1.91802   3.4783     0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 2.47045  10.4316   0.210643  1.0
 3.433     2.47644  0.326918  1.0
 1.12364   3.23823  0.320588  1.0
 2.43357   2.26458  0.204192  1.0
 2.55263   7.98588  1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.13058337040965196
 0.24574132338357174
 0.3370856690850549
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  3  3  0
 1  1  2  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  3  3  0
 1  1  2  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = [2, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  3  3  0
 1  1  2  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = [3, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  3  3  0
 1  1  2  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = [4, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.0, 0.5]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  1  0
 2  1  2  0
 2  3  3  0
 1  1  2  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 2, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  1  0
 2  1  2  0
 2  3  3  0
 1  1  2  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  1  0
 2  1  2  0
 2  3  3  0
 1  1  2  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 1.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  3  3  0
 1  1  2  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  3  3  0
 1  1  2  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  3  3  0
 1  1  2  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  3  3  0
 1  1  2  0
rho_tmp = [1, 2, 4, 3, 1]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 3, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  3  3  0
 1  1  2  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  3  3  0
 1  1  2  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  3  3  0
 1  1  2  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 1.0]
new_label = 3
Si_iter[:, t] = [1, 2, 1, 3, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  3  3  0
 1  1  2  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  3  3  0
 1  1  2  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  3  3  0
 1  1  2  0
rho_tmp = [1, 2, 1, 3, 3]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  3  3  0
 1  1  2  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 1, 3, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.007117550135875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.29281311194311704, 0.7071868880568829]
probh = 0.526665871774701
sampled gamma:
probh = 0.526665871774701
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.158072597092759, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.32501802132358387, 0.6749819786764162]
probh = 0.3255488672698903
sampled gamma:
probh = 0.3255488672698903
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 1]
Si_red1 = [1, 2, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.156043824502127, 4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.11883053396548796, 0.20898518702507168, 0.6721842790094403]
probh = 0.7327462646920073
sampled gamma:
probh = 0.7327462646920073
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 1]
Si_red1 = [1, 2, 1, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.246663021526116, 4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.12617845796241461, 0.221907852770138, 0.6519136892674475]
probh = 0.33322986468058347
sampled gamma:
probh = 0.33322986468058347
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 1]
Si_red1 = [1, 2, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.135540955190757, 4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.11719866453956033, 0.20611524673449763, 0.6766860887259419]
probh = 0.7354454431700749
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update rho]
movable_units = [4, 5]
Si_iter[:, t] = [1, 2, 1, 3, 1]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  3  3  0
 3  1  2  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [2, 1]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  3  3  0
 3  1  2  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [2, 1]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  3  3  0
 3  1  2  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [2, 1]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 1, 1]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  3  0
 3  1  2  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [2, 1]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  3  0
 3  1  2  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = [2, 1]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  3  0
 3  1  2  0
rho_tmp = [1, 2, 1, 1, 3]
Si_comp1 = [2, 1]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 1, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.007117550135875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.29281311194311704, 0.7071868880568829]
probh = 0.6345790892279448
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.6626474546346408
sampled gamma:
probh = 0.6626474546346408
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.3370856690850549
sampled gamma:
probh = 0.3370856690850549
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.3370856690850549
sampled gamma:
probh = 0.3370856690850549
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.3370856690850549
sampled gamma:
probh = 0.3370856690850549
gt = true
gamma_iter[:, t] = Bool[0, 0, 0, 0, 1]
												[update rho]
movable_units = [1, 2, 3, 4]
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  3  0
 3  2  2  0
rho_tmp = [2, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  3  0
 3  2  2  0
rho_tmp = [3, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  3  0
 3  2  2  0
rho_tmp = [4, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 3, 1]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  3  0
 1  1  1  0
 3  1  2  0
 3  2  1  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  3  0
 1  1  1  0
 3  1  2  0
 3  2  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  3  0
 1  1  1  0
 3  1  2  0
 3  2  1  0
rho_tmp = [1, 3, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 1]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  1  0
 3  1  2  0
 3  2  1  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  1  0
 3  1  2  0
 3  2  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  1  0
 3  1  2  0
 3  2  1  0
rho_tmp = [1, 1, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 1]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  2  0
 3  2  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  2  0
 3  2  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  2  0
 3  2  1  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 1, 1]

▶ iteration 9.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  1  0
 3  2  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
  0.308075  4.94891   -0.415384  0.0
  0.992567  3.40033    2.76384   0.0
  1.10055   0.156821   0.0       0.0
  0.563484  5.17835    0.192261  0.0
 -1.91802   3.4783     0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
  4.71274  9.41093  0.560953  1.0
  1.04514  3.02085  1.24665   1.0
 16.5799   3.23823  0.210643  1.0
  2.43357  2.26458  0.204192  1.0
  2.55263  7.98588  1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.008740087480522036
 0.5272760146126991
 0.38397356237191926
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 1, 3, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  1  0
 3  2  1  0
rho_tmp = [1, 2, 1, 3, 3]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  1  0
 3  2  1  0
rho_tmp = [2, 2, 1, 3, 3]
Si_comp1 = [2, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  1  0
 3  2  1  0
rho_tmp = [3, 2, 1, 3, 3]
Si_comp1 = [3, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  1  0
 3  2  1  0
rho_tmp = [4, 2, 1, 3, 3]
Si_comp1 = [4, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 3, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  1  0
 1  1  2  0
 2  1  1  0
 2  2  1  0
rho_tmp = [1, 1, 1, 2, 2]
Si_comp1 = [1, 1, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  1  0
 1  1  2  0
 2  1  1  0
 2  2  1  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  1  0
 1  1  2  0
 2  1  1  0
 2  2  1  0
rho_tmp = [1, 3, 1, 2, 2]
Si_comp1 = [1, 3, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.5, 0.5]
new_label = 3
Si_iter[:, t] = [1, 2, 1, 3, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  1  0
 3  2  1  0
rho_tmp = [1, 2, 1, 3, 3]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  1  0
 3  2  1  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  1  0
 3  2  1  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  1  0
 3  2  1  0
rho_tmp = [1, 2, 4, 3, 3]
Si_comp1 = [1, 2, 4]
Si_comp2 = [1, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 3, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  1  0
 3  2  1  0
rho_tmp = [1, 2, 1, 1, 3]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  1  0
 3  2  1  0
rho_tmp = [1, 2, 1, 2, 3]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  1  0
 3  2  1  0
rho_tmp = [1, 2, 1, 3, 3]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  1  0
 3  2  1  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 1, 3, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  1  0
 3  2  1  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  1  0
 3  2  1  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  1  0
 3  2  1  0
rho_tmp = [1, 2, 1, 3, 3]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  1  0
 3  2  1  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 3, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18763781382561492, 0.18763781382561492, 0.6247243723487702]
probh = 0.8559996425944086
sampled gamma:
probh = 0.8559996425944086
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2056377848473934, 0.2056377848473934, 0.5887244303052133]
probh = 0.844336102912883
sampled gamma:
probh = 0.844336102912883
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.720608804660927, 4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19170232997542352, 0.19170232997542352, 0.616595340049153]
probh = 0.8533378569895498
sampled gamma:
probh = 0.8533378569895498
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 1]
Si_red1 = [1, 2, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.246663021526116, 4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.12617845796241461, 0.221907852770138, 0.6519136892674475]
probh = 0.8983724905456394
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 1]
Si_red1 = [1, 2, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.135540955190757, 4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.11719866453956033, 0.20611524673449763, 0.6766860887259419]
probh = 0.8440310451273607
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update rho]
movable_units = [4, 5]
Si_iter[:, t] = [1, 2, 1, 1, 2]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  1  0
 1  2  1  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  1  0
 1  2  1  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  1  0
 1  2  1  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 1, 2]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  1  0
 1  2  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  1  0
 1  2  1  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  1  0
 1  2  1  0
rho_tmp = [1, 2, 1, 1, 3]
Si_comp1 = [3]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 1, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23097802558886682, 0.7690219744111332]
probh = 0.7296241522100064
sampled gamma:
probh = 0.7296241522100064
gt = true
gamma_iter[:, t] = Bool[1, 0, 0, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.158072597092759, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.32501802132358387, 0.6749819786764162]
probh = 0.6572714735892852
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.0416453621923845, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.30001370567070174, 0.6999862943292982]
probh = 0.47102707940543914
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.132264559216373, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.31938198507206067, 0.6806180149279393]
probh = 0.6612010899229653
sampled gamma:
probh = 0.6612010899229653
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.7274946793152335
sampled gamma:
probh = 0.7274946793152335
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 0, 0]
												[update rho]
movable_units = [2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 1, 1]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  1  0
 1  1  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  1  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  1  2  0
 3  1  1  0
 1  1  1  0
rho_tmp = [1, 3, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 1, 1]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  1  1  0
 1  1  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  1  1  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  1  1  0
 1  1  1  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 1, 1]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  1  1  0
 1  1  1  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  1  1  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  1  1  0
 1  1  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  1  1  0
 1  1  1  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 2, 1]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  1  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  1  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  1  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  1  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 2, 4]

▶ iteration 10.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  1  2  0
 1  1  4  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
muh_iter
5×4 Matrix{Float64}:
 -0.0156917  4.94891   -0.415384  0.0
  0.62543    3.40033    2.42513   0.0
  2.11018    0.156821   1.90486   0.0
 -0.333042   5.17835    0.215611  0.0
 -1.91802    3.4783     0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 4.289    16.5554   0.474585  1.0
 1.48151   4.55162  0.822552  1.0
 1.07816   3.23823  1.09741   1.0
 2.43357   2.26458  0.331806  1.0
 2.55263   7.98588  1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.031900197286977794
 0.5839180160518643
 0.43845079750141597
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 1, 3, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  1  2  0
 1  1  4  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  1  2  0
 1  1  4  0
rho_tmp = [2, 2, 1, 3, 1]
Si_comp1 = [2, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  1  2  0
 1  1  4  0
rho_tmp = [3, 2, 1, 3, 1]
Si_comp1 = [3, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  1  2  0
 1  1  4  0
rho_tmp = [4, 2, 1, 3, 1]
Si_comp1 = [4, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 3, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  2  0
 1  1  3  0
 2  1  2  0
 1  1  4  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  2  0
 1  1  3  0
 2  1  2  0
 1  1  4  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  2  0
 1  1  3  0
 2  1  2  0
 1  1  4  0
rho_tmp = [1, 3, 1, 2, 1]
Si_comp1 = [1, 3, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.5, 0.5]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  1  2  0
 1  1  4  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  1  2  0
 1  1  4  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  1  2  0
 1  1  4  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  1  2  0
 1  1  4  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  1  2  0
 1  1  4  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  1  2  0
 1  1  4  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  1  2  0
 1  1  4  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  1  2  0
 1  1  4  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  1  2  0
 1  1  4  0
rho_tmp = [1, 2, 1, 2, 3]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18763781382561492, 0.18763781382561492, 0.6247243723487702]
probh = 0.8820637354650328
sampled gamma:
probh = 0.8820637354650328
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2056377848473934, 0.2056377848473934, 0.5887244303052133]
probh = 0.872196103306914
sampled gamma:
probh = 0.872196103306914
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.720608804660927, 4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19170232997542352, 0.19170232997542352, 0.616595340049153]
probh = 0.8798160902639434
sampled gamma:
probh = 0.8798160902639434
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 1]
Si_red1 = [1, 2, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.246663021526116, 4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.12617845796241461, 0.221907852770138, 0.6519136892674475]
probh = 0.9175062086670767
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 1]
Si_red1 = [1, 2, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.135540955190757, 4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.11719866453956033, 0.20611524673449763, 0.6766860887259419]
probh = 0.9229245780164843
sampled gamma:
probh = 0.9229245780164843
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update rho]
movable_units = [4]
Si_iter[:, t] = [1, 2, 1, 1, 1]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  1  2  0
 1  1  4  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  1  2  0
 1  1  4  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  1  2  0
 1  1  4  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 1, 3, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.43845079750141597
sampled gamma:
probh = 0.43845079750141597
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.43845079750141597
sampled gamma:
probh = 0.43845079750141597
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.43845079750141597
sampled gamma:
probh = 0.43845079750141597
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.43845079750141597
sampled gamma:
probh = 0.43845079750141597
gt = true
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.5046100952395596
sampled gamma:
probh = 0.5046100952395596
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update rho]
movable_units = [1, 2, 3, 5]
Si_iter[:, t] = [1, 2, 3, 2, 4]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 2  2  2  0
 1  1  3  0
 2  3  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 2  2  2  0
 1  1  3  0
 2  3  2  0
 1  1  1  0
rho_tmp = [2, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 2  2  2  0
 1  1  3  0
 2  3  2  0
 1  1  1  0
rho_tmp = [3, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 2  2  2  0
 1  1  3  0
 2  3  2  0
 1  1  1  0
rho_tmp = [4, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 1, 2, 3]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  2  0
 1  1  3  0
rho_tmp = [1, 1, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  2  0
 1  1  3  0
rho_tmp = [1, 2, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  2  0
 1  1  3  0
rho_tmp = [1, 3, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  2  0
 1  1  3  0
rho_tmp = [1, 4, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 1, 3, 2]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  3  0
 1  1  2  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  3  0
 1  1  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  3  0
 1  1  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  3  0
 1  1  2  0
rho_tmp = [1, 2, 4, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 3, 2]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  3  0
 1  1  2  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  3  0
 1  1  2  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  3  0
 1  1  2  0
rho_tmp = [1, 2, 1, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  3  0
 1  1  2  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 3, 1]

▶ iteration 11.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  3  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
muh_iter
5×4 Matrix{Float64}:
  0.504152  4.94891   1.90486   0.0
  0.756658  3.40033   0.215611  0.0
  0.665283  5.65137   2.42513   0.0
 -0.333042  5.17835  -0.415384  0.0
 -1.91802   3.4783    0.0       0.0
sig2h_iter
5×4 Matrix{Float64}:
 4.30702   7.35252  0.867125  1.0
 1.58941   1.29338  0.178687  1.0
 1.48151  17.0207   0.373233  1.0
 2.43357   2.26458  0.474585  1.0
 2.55263   7.98588  1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.11452888247950761
 0.9773942726973388
 0.37945339708251874
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 1, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  3  0
 1  1  1  0
rho_tmp = [2, 2, 1, 2, 1]
Si_comp1 = [2, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  3  0
 1  1  1  0
rho_tmp = [3, 2, 1, 2, 1]
Si_comp1 = [3, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  3  0
 1  1  1  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  3  0
 1  1  1  0
rho_tmp = [1, 3, 1, 2, 1]
Si_comp1 = [1, 3, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.5, 0.5]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  3  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 3, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = [1, 2, 1, 2]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 3]
Si_comp1 = [1, 2, 1, 3]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.686080992604418, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1579924549734541, 0.1579924549734541, 0.1579924549734541, 0.5260226350796378]
probh = 0.9963591652967527
sampled gamma:
probh = 0.9963591652967527
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 4.837036039561302, 4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17056348716992353, 0.17056348716992353, 0.17056348716992353, 0.4883095384902295]
probh = 0.996070612239341
sampled gamma:
probh = 0.996070612239341
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.720608804660927, 4.720608804660927, 4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16086427386558605, 0.16086427386558605, 0.16086427386558605, 0.5174071784032418]
probh = 0.996293231384984
sampled gamma:
probh = 0.996293231384984
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 1, 3]
Si_red1 = [1, 2, 1, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.246663021526116, 4.811228001684916, 4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1032634806923947, 0.18160768200896626, 0.18160768200896626, 0.5335211552896728]
probh = 0.9958172437957737
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 1]
Si_red1 = [1, 2, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.135540955190757, 4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.11719866453956033, 0.20611524673449763, 0.6766860887259419]
probh = 0.9972966907190806
sampled gamma:
probh = 0.9972966907190806
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update rho]
movable_units = [4]
Si_iter[:, t] = [1, 2, 1, 3, 1]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  3  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23097802558886682, 0.7690219744111332]
probh = 0.725829264858532
sampled gamma:
probh = 0.725829264858532
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.4520756776883376
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.7205351491357009
sampled gamma:
probh = 0.7205351491357009
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25395099810962674, 0.7460490018903733]
probh = 0.45043706690205704
sampled gamma:
probh = 0.45043706690205704
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.7236812226960309
sampled gamma:
probh = 0.7236812226960309
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 0, 1]
												[update rho]
movable_units = [1, 2, 4]
Si_iter[:, t] = [1, 2, 1, 3, 1]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  2  3  0
 1  1  1  0
rho_tmp = [2, 2, 1, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  2  3  0
 1  1  1  0
rho_tmp = [3, 2, 1, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  1  0
 2  2  3  0
 1  1  1  0
rho_tmp = [4, 2, 1, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  4  0
 1  1  3  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  4  0
 1  1  3  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  4  0
 1  1  3  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  4  0
 1  1  3  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  2  4  0
 1  1  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  2  4  0
 1  1  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  2  4  0
 1  1  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  2  4  0
 1  1  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 3]

▶ iteration 12.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  2  3  0
 1  1  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
  1.7004    4.94891  5.00979  0.0
  1.7694    3.40033  4.4525   0.0
  1.32759   5.65137  1.90486  0.0
 -0.333042  5.17835  2.42513  0.0
 -1.91802   3.4783   0.0      0.0
sig2h_iter
5×4 Matrix{Float64}:
 6.19939    6.08453  2.57491   1.0
 0.606631  10.6241   2.64725   1.0
 1.48151   17.0207   0.452194  1.0
 2.43357    2.26458  0.373233  1.0
 2.55263    7.98588  1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.059614104570222565
 0.5953152195159017
 0.6610689264177656
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 1, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  2  3  0
 1  1  3  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  2  3  0
 1  1  3  0
rho_tmp = [2, 2, 1, 2, 1]
Si_comp1 = [2, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  2  3  0
 1  1  3  0
rho_tmp = [3, 2, 1, 2, 1]
Si_comp1 = [3, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  2  3  0
 1  1  3  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  2  3  0
 1  1  3  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  2  3  0
 1  1  3  0
rho_tmp = [1, 3, 1, 2, 1]
Si_comp1 = [1, 3, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.5, 0.5]
new_label = 3
Si_iter[:, t] = [1, 2, 1, 3, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  2  3  0
 1  1  3  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  2  3  0
 1  1  3  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  2  3  0
 1  1  3  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  2  3  0
 1  1  3  0
rho_tmp = [1, 2, 4, 3, 1]
Si_comp1 = [1, 2, 4, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 3, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  2  3  0
 1  1  3  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  2  3  0
 1  1  3  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  2  3  0
 1  1  3  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 1, 3, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  2  3  0
 1  1  3  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  2  3  0
 1  1  3  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = [1, 2, 1, 2]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  2  3  0
 1  1  3  0
rho_tmp = [1, 2, 1, 3, 3]
Si_comp1 = [1, 2, 1, 3]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  2  3  0
 1  1  3  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = [1, 2, 1, 4]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 3, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.630780450086686, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18955129186518385, 0.17935357105104527, 0.6310951370837709]
probh = 0.8858544451737226
sampled gamma:
probh = 0.8858544451737226
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 4.78173549704357, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20793823935157388, 0.1967513142157692, 0.5953104464326568]
probh = 0.8820301664430449
sampled gamma:
probh = 0.8820301664430449
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.720608804660927, 4.665308262143196, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19370004475101535, 0.18327912406712002, 0.6230208311818646]
probh = 0.8836468037566666
sampled gamma:
probh = 0.8836468037566666
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 1, 2]
Si_red1 = [1, 2, 1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.246663021526116, 5.486708368422315, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.103924493244973, 0.35913916365309095, 0.536936343101936]
probh = 0.8037703480731533
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 1]
Si_red1 = [1, 2, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.135540955190757, 4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.11719866453956033, 0.20611524673449763, 0.6766860887259419]
probh = 0.9262092911624675
sampled gamma:
probh = 0.9262092911624675
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update rho]
movable_units = [4]
Si_iter[:, t] = [1, 2, 1, 2, 1]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  2  3  0
 1  1  3  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [1, 1]
Si_comp2 = [3, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  2  3  0
 1  1  3  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 1]
Si_comp2 = [3, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  2  3  0
 1  1  3  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [1, 1]
Si_comp2 = [3, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 1, 3, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.686080992604418, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18763781382561492, 0.18763781382561492, 0.6247243723487702]
probh = 0.7574052474034422
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.837036039561302, 4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2056377848473934, 0.2056377848473934, 0.5887244303052133]
probh = 0.9046246830732149
sampled gamma:
probh = 0.9046246830732149
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19170232997542352, 0.19170232997542352, 0.616595340049153]
probh = 0.9105095784366064
sampled gamma:
probh = 0.9105095784366064
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 4.755927459167184, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20475153441693866, 0.19373605167501418, 0.6015124139080472]
probh = 0.9096459775322207
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.700105935349557, 4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18928469829987307, 0.18928469829987307, 0.6214306034002539]
probh = 0.911538338838016
sampled gamma:
probh = 0.911538338838016
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update rho]
movable_units = [1, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 3]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  3  0
 2  2  2  0
 1  1  1  0
 3  3  1  0
 1  1  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  3  0
 2  2  2  0
 1  1  1  0
 3  3  1  0
 1  1  1  0
rho_tmp = [2, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  3  0
 2  2  2  0
 1  1  1  0
 3  3  1  0
 1  1  1  0
rho_tmp = [3, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 3]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  3  3  0
 1  1  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  3  3  0
 1  1  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  3  3  0
 1  1  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  3  3  0
 1  1  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  3  4  0
 1  1  3  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  3  4  0
 1  1  3  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  3  4  0
 1  1  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  3  4  0
 1  1  3  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  3  4  0
 1  1  3  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 4, 2]

▶ iteration 13.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  3  4  0
 1  1  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
muh_iter
5×4 Matrix{Float64}:
 -0.16154   4.94891  4.82688  0.0
  0.491877  3.40033  4.4525   0.0
  1.11313   6.11071  1.90486  0.0
  3.72671   5.17835  5.01442  0.0
 -1.91802   3.4783   0.0      0.0
sig2h_iter
5×4 Matrix{Float64}:
 3.03674    4.60434  4.93251  1.0
 1.13971    1.4237   3.67099  1.0
 0.896984  15.8855   2.69672  1.0
 2.43357    2.26458  2.89676  1.0
 2.55263    7.98588  1.0      1.0
alpha_iter
4-element Vector{Float64}:
 0.12026919168558879
 0.9012869955385887
 0.44071252424252016
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 1, 3, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  3  4  0
 1  1  2  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  3  4  0
 1  1  2  0
rho_tmp = [2, 2, 1, 3, 1]
Si_comp1 = [2, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  3  4  0
 1  1  2  0
rho_tmp = [3, 2, 1, 3, 1]
Si_comp1 = [3, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  3  4  0
 1  1  2  0
rho_tmp = [4, 2, 1, 3, 1]
Si_comp1 = [4, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 3, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  2  0
 1  1  3  0
 2  3  4  0
 1  1  2  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  2  0
 1  1  3  0
 2  3  4  0
 1  1  2  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  2  0
 1  1  3  0
 2  3  4  0
 1  1  2  0
rho_tmp = [1, 3, 1, 2, 1]
Si_comp1 = [1, 3, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.5, 0.5]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  3  4  0
 1  1  2  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  3  4  0
 1  1  2  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  3  4  0
 1  1  2  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 3, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  3  4  0
 1  1  2  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  3  4  0
 1  1  2  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 2  3  4  0
 1  1  2  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 1, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 1  3  4  0
 1  1  2  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 1  3  4  0
 1  1  2  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = [1, 2, 1, 2]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 1  3  4  0
 1  1  2  0
rho_tmp = [1, 2, 1, 1, 3]
Si_comp1 = [1, 2, 1, 3]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 1, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.686080992604418, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1579924549734541, 0.1579924549734541, 0.1579924549734541, 0.5260226350796378]
probh = 0.9829902926317639
sampled gamma:
probh = 0.9829902926317639
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 4.837036039561302, 4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17056348716992353, 0.17056348716992353, 0.17056348716992353, 0.4883095384902295]
probh = 0.9816616955977829
sampled gamma:
probh = 0.9816616955977829
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.720608804660927, 4.720608804660927, 4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16086427386558605, 0.16086427386558605, 0.16086427386558605, 0.5174071784032418]
probh = 0.9826864613291374
sampled gamma:
probh = 0.9826864613291374
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 1, 3]
Si_red1 = [1, 2, 1, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.246663021526116, 4.811228001684916, 4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1032634806923947, 0.18160768200896626, 0.18160768200896626, 0.5335211552896728]
probh = 0.9804974258086164
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 1]
Si_red1 = [1, 2, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.135540955190757, 4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.11719866453956033, 0.20611524673449763, 0.6766860887259419]
probh = 0.9873265532101335
sampled gamma:
probh = 0.9873265532101335
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update rho]
movable_units = [4]
Si_iter[:, t] = [1, 2, 1, 3, 1]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 1  3  4  0
 1  1  2  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [2, 1]
Si_comp2 = [2, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 1  3  4  0
 1  1  2  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [2, 1]
Si_comp2 = [2, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 1  3  4  0
 1  1  2  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [2, 1]
Si_comp2 = [2, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18763781382561492, 0.18763781382561492, 0.6247243723487702]
probh = 0.8076746547655428
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.7527163553444135
sampled gamma:
probh = 0.7527163553444135
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.44071252424252016
sampled gamma:
probh = 0.44071252424252016
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.44071252424252016
sampled gamma:
probh = 0.44071252424252016
gt = true
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.5069050317745264
sampled gamma:
probh = 0.5069050317745264
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update rho]
movable_units = [1, 2, 3, 5]
Si_iter[:, t] = [1, 2, 3, 4, 2]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 2  2  2  0
 1  1  3  0
 1  2  1  0
 1  1  2  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 2  2  2  0
 1  1  3  0
 1  2  1  0
 1  1  2  0
rho_tmp = [2, 2, 3, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 2  2  2  0
 1  1  3  0
 1  2  1  0
 1  1  2  0
rho_tmp = [3, 2, 3, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 2  2  2  0
 1  1  3  0
 1  2  1  0
 1  1  2  0
rho_tmp = [4, 2, 3, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 2]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 1  2  4  0
 1  1  2  0
rho_tmp = [1, 1, 3, 4, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 1  2  4  0
 1  1  2  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 1  2  4  0
 1  1  2  0
rho_tmp = [1, 3, 3, 4, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 1  2  4  0
 1  1  2  0
rho_tmp = [1, 4, 3, 4, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 1  2  4  0
 1  1  2  0
rho_tmp = [1, 5, 3, 4, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 4, 2]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  4  0
 1  2  3  0
 1  1  2  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  4  0
 1  2  3  0
 1  1  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  4  0
 1  2  3  0
 1  1  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  4  0
 1  2  3  0
 1  1  2  0
rho_tmp = [1, 2, 4, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 2]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 1  2  3  0
 1  1  2  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 1  2  3  0
 1  1  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 1  2  3  0
 1  1  2  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 1  2  3  0
 1  1  2  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 3, 1]

▶ iteration 14.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 1  2  3  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
muh_iter
5×4 Matrix{Float64}:
  1.55299  4.94891  4.35776  0.0
  5.62486  3.40033  4.4525   0.0
  4.4992   6.11071  5.01442  0.0
  3.72671  5.17835  1.90486  0.0
 -1.91802  3.4783   0.0      0.0
sig2h_iter
5×4 Matrix{Float64}:
 7.87909   5.50264  6.46161   1.0
 1.18229   5.45571  0.820216  1.0
 1.13971  15.8855   5.64858   1.0
 2.43357   2.26458  2.69672   1.0
 2.55263   7.98588  1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.0883850505985663
 0.4618606687346345
 0.38385804898164005
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 1, 1, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 1  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 1  2  3  0
 1  1  1  0
rho_tmp = [2, 2, 1, 1, 1]
Si_comp1 = [2, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 1  2  3  0
 1  1  1  0
rho_tmp = [3, 2, 1, 1, 1]
Si_comp1 = [3, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 1, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 1  2  3  0
 1  1  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 1  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5]
After exp and normalization:
ph = [0.0, 1.0]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 1, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 1  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 1  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 1  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = [1, 2, 3, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 1, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 1  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 1  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 1  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 1, 3, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = [1, 2, 1, 2]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 3, 3]
Si_comp1 = [1, 2, 1, 3]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = [1, 2, 1, 4]
Si_comp2 = [1, 2, 1, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 3, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.630780450086686, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18955129186518385, 0.17935357105104527, 0.6310951370837709]
probh = 0.8190969762554601
sampled gamma:
probh = 0.8190969762554601
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 4.78173549704357, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20793823935157388, 0.1967513142157692, 0.5953104464326568]
probh = 0.8135069456300353
sampled gamma:
probh = 0.8135069456300353
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.720608804660927, 4.665308262143196, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19370004475101535, 0.18327912406712002, 0.6230208311818646]
probh = 0.8158665800713324
sampled gamma:
probh = 0.8158665800713324
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 4.755927459167184, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20475153441693866, 0.19373605167501418, 0.6015124139080472]
probh = 0.8158386550702206
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18928469829987307, 0.18928469829987307, 0.6214306034002539]
probh = 0.8193054323392688
sampled gamma:
probh = 0.8193054323392688
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 0, 1]
												[update rho]
movable_units = [3, 4]
Si_iter[:, t] = [1, 2, 1, 2, 1]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  1  3  0
 3  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 3  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 3  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 3  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23097802558886682, 0.7690219744111332]
probh = 0.44755144541895914
sampled gamma:
probh = 0.44755144541895914
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.4567029056047158
sampled gamma:
probh = 0.4567029056047158
gt = true
gamma_iter[:, t] = Bool[0, 1, 0, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19170232997542352, 0.19170232997542352, 0.616595340049153]
probh = 0.7646972314520689
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25395099810962674, 0.7460490018903733]
probh = 0.4550614522751841
sampled gamma:
probh = 0.4550614522751841
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.44835686462376334
sampled gamma:
probh = 0.44835686462376334
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update rho]
movable_units = [1, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 3  3  3  0
 1  1  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 3  3  3  0
 1  1  1  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 3  3  3  0
 1  1  1  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 3  3  3  0
 1  1  1  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  2  2  0
 3  3  2  0
 1  1  3  0
rho_tmp = [1, 1, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  2  2  0
 3  3  2  0
 1  1  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  2  2  0
 3  3  2  0
 1  1  3  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  2  2  0
 3  3  2  0
 1  1  3  0
rho_tmp = [1, 1, 4, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 1, 2, 3, 4]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  2  2  0
 3  3  4  0
 1  1  3  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  2  2  0
 3  3  4  0
 1  1  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  2  2  0
 3  3  4  0
 1  1  3  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  2  2  0
 3  3  4  0
 1  1  3  0
rho_tmp = [1, 1, 2, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  2  2  0
 3  3  2  0
 1  1  3  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  2  2  0
 3  3  2  0
 1  1  3  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  2  2  0
 3  3  2  0
 1  1  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 2]

▶ iteration 15.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  2  2  0
 3  3  2  0
 1  1  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
muh_iter
5×4 Matrix{Float64}:
  2.38399  4.94891  4.4525   0.0
  2.31866  3.40033  4.21376  0.0
  1.10948  4.84058  4.35776  0.0
  3.72671  5.17835  5.01442  0.0
 -1.91802  3.4783   0.0      0.0
sig2h_iter
5×4 Matrix{Float64}:
 9.54192    6.0449    4.25518  1.0
 0.501535   2.04665  12.4193   1.0
 0.472288  15.6756    6.46161  1.0
 2.43357    2.26458   5.64858  1.0
 2.55263    7.98588   1.0      1.0
alpha_iter
4-element Vector{Float64}:
 0.22107521161329874
 0.3922359191870702
 0.26169161727863993
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 1, 3, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  2  2  0
 3  3  2  0
 1  1  2  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  2  2  0
 3  3  2  0
 1  1  2  0
rho_tmp = [2, 2, 1, 3, 1]
Si_comp1 = [2, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  2  2  0
 3  3  2  0
 1  1  2  0
rho_tmp = [3, 2, 1, 3, 1]
Si_comp1 = [3, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  2  2  0
 3  3  2  0
 1  1  2  0
rho_tmp = [4, 2, 1, 3, 1]
Si_comp1 = [4, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 3, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  1  0
 1  2  2  0
 2  3  2  0
 1  1  2  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  1  0
 1  2  2  0
 2  3  2  0
 1  1  2  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  1  0
 1  2  2  0
 2  3  2  0
 1  1  2  0
rho_tmp = [1, 3, 1, 2, 1]
Si_comp1 = [1, 3, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.5, 0.5]
new_label = 3
Si_iter[:, t] = [1, 2, 1, 3, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  2  2  0
 3  3  2  0
 1  1  2  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  2  2  0
 3  3  2  0
 1  1  2  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  2  2  0
 3  3  2  0
 1  1  2  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  2  2  0
 3  3  2  0
 1  1  2  0
rho_tmp = [1, 2, 4, 3, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 4  3  2  0
 1  1  2  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 4  3  2  0
 1  1  2  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 4  3  2  0
 1  1  2  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 4  3  2  0
 1  1  2  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  3  2  0
 1  1  2  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  3  2  0
 1  1  2  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  3  2  0
 1  1  2  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  3  2  0
 1  1  2  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [1, 2, 4]
Si_comp2 = [1, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18763781382561492, 0.18763781382561492, 0.6247243723487702]
probh = 0.7747480643096432
sampled gamma:
probh = 0.7747480643096432
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.837036039561302, 4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2056377848473934, 0.2056377848473934, 0.5887244303052133]
probh = 0.5229523018414629
sampled gamma:
probh = 0.5229523018414629
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 4.720608804660927, 4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16086427386558605, 0.16086427386558605, 0.16086427386558605, 0.5174071784032418]
probh = 0.8004758370695652
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.811228001684916, 4.811228001684916, 4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1684134637041103, 0.1684134637041103, 0.1684134637041103, 0.49475960888766907]
probh = 0.7930501457750235
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18928469829987307, 0.18928469829987307, 0.6214306034002539]
probh = 0.7732193932600329
sampled gamma:
probh = 0.7732193932600329
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 0, 0]
												[update rho]
movable_units = [3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 3, 1]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  3  2  0
 1  1  2  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  3  2  0
 1  1  2  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  3  2  0
 1  1  2  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  3  2  0
 1  1  2  0
rho_tmp = [1, 2, 4, 3, 1]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 3, 1]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  3  2  0
 1  1  2  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  3  2  0
 1  1  2  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  3  2  0
 1  1  2  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 1, 1]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  1  2  0
 1  1  2  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  1  2  0
 1  1  2  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  1  2  0
 1  1  2  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 1, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23097802558886682, 0.7690219744111332]
probh = 0.6054528114294608
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.26169161727863993
sampled gamma:
probh = 0.26169161727863993
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.26169161727863993
sampled gamma:
probh = 0.26169161727863993
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.26169161727863993
sampled gamma:
probh = 0.26169161727863993
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.26169161727863993
sampled gamma:
probh = 0.26169161727863993
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 2, 2]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  1  2  0
 1  1  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  1  2  0
 1  1  2  0
rho_tmp = [2, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  1  2  0
 1  1  2  0
rho_tmp = [3, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 2]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  1  2  0
 1  1  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  1  2  0
 1  1  2  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  2  2  0
 2  1  2  0
 1  1  2  0
rho_tmp = [1, 3, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 2]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  2  0
 1  1  2  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  2  0
 1  1  2  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  2  0
 1  1  2  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 2]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  2  0
 1  1  2  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  2  0
 1  1  2  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  2  0
 1  1  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  3  0
 1  1  2  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  3  0
 1  1  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  3  0
 1  1  2  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  3  0
 1  1  2  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 3, 2]

▶ iteration 16.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  3  0
 1  1  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
muh_iter
5×4 Matrix{Float64}:
 -0.14513   4.94891  4.4525   0.0
  2.16693   3.40033  4.21376  0.0
  0.642961  4.84058  4.09189  0.0
  1.10948   5.17835  5.01442  0.0
 -1.91802   3.4783   0.0      0.0
sig2h_iter
5×4 Matrix{Float64}:
 3.40801   16.871    1.30609  1.0
 2.05085    3.45533  1.73212  1.0
 0.400695  15.6756   2.92974  1.0
 0.472288   2.26458  5.64858  1.0
 2.55263    7.98588  1.0      1.0
alpha_iter
4-element Vector{Float64}:
 0.053568539838131736
 0.18234179317282517
 0.014944628554351278
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  3  0
 1  1  2  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  3  0
 1  1  2  0
rho_tmp = [2, 2, 3, 2, 1]
Si_comp1 = [2, 2]
Si_comp2 = [1, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  3  0
 1  1  2  0
rho_tmp = [3, 2, 3, 2, 1]
Si_comp1 = [3, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  3  0
 1  1  2  0
rho_tmp = [4, 2, 3, 2, 1]
Si_comp1 = [4, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.0, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 1, 2, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  1  3  0
 3  1  2  0
rho_tmp = [1, 1, 1, 2, 3]
Si_comp1 = [1, 1]
Si_comp2 = [1, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  1  3  0
 3  1  2  0
rho_tmp = [1, 2, 1, 2, 3]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  1  3  0
 3  1  2  0
rho_tmp = [1, 3, 1, 2, 3]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  1  3  0
 3  1  2  0
rho_tmp = [1, 4, 1, 2, 3]
Si_comp1 = [1, 4]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 1, 3, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 3  1  3  0
 2  1  2  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 3  1  3  0
 2  1  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 3  1  3  0
 2  1  2  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 3  1  3  0
 2  1  2  0
rho_tmp = [1, 2, 4, 3, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  1  3  0
 2  1  2  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  1  3  0
 2  1  2  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  1  3  0
 2  1  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  1  3  0
 2  1  2  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  1  3  0
 2  1  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  1  3  0
 2  1  2  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  1  3  0
 2  1  2  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 2, 3, 4]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23097802558886682, 0.7690219744111332]
probh = 0.4912187033707517
sampled gamma:
probh = 0.4912187033707517
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.23130089645582572
sampled gamma:
probh = 0.23130089645582572
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.22620871958094496
sampled gamma:
probh = 0.22620871958094496
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25395099810962674, 0.7460490018903733]
probh = 0.46755875151748305
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.4885278202205585
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 0, 0]
												[update rho]
movable_units = [2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 1, 1]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  1  3  0
 4  1  2  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  1  3  0
 4  1  2  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  1  3  0
 4  1  2  0
rho_tmp = [1, 3, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 1, 1]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  2  2  0
 3  1  3  0
 4  1  2  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  2  2  0
 3  1  3  0
 4  1  2  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  2  0
 3  1  3  0
 4  1  2  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  2  0
 3  1  3  0
 4  1  2  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  2  0
 3  1  3  0
 4  1  2  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  2  0
 3  1  3  0
 4  1  2  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 2
Si_iter[:, t] = [1, 1, 1, 1, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.014944628554351278
sampled gamma:
probh = 0.014944628554351278
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.014944628554351278
sampled gamma:
probh = 0.014944628554351278
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.014944628554351278
sampled gamma:
probh = 0.014944628554351278
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.014944628554351278
sampled gamma:
probh = 0.014944628554351278
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.014944628554351278
sampled gamma:
probh = 0.014944628554351278
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  3  0
 2  1  2  0
 2  1  2  0
 3  1  1  0
 4  2  2  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  3  0
 2  1  2  0
 2  1  2  0
 3  1  1  0
 4  2  2  0
rho_tmp = [2, 2, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  3  0
 2  1  2  0
 2  1  2  0
 3  1  1  0
 4  2  2  0
rho_tmp = [3, 2, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 1, 2, 1]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  1  1  0
 3  1  2  0
 4  2  1  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  1  1  0
 3  1  2  0
 4  2  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  1  1  0
 3  1  2  0
 4  2  1  0
rho_tmp = [1, 3, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 2, 1]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  1  0
 3  1  2  0
 4  2  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  1  0
 3  1  2  0
 4  2  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  1  0
 3  1  2  0
 4  2  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 2, 1]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  3  0
 3  1  2  0
 4  2  1  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  3  0
 3  1  2  0
 4  2  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  3  0
 3  1  2  0
 4  2  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  3  0
 3  1  2  0
 4  2  1  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 2, 1]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  3  0
 3  1  2  0
 4  2  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  3  0
 3  1  2  0
 4  2  1  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  3  0
 3  1  2  0
 4  2  1  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  3  0
 3  1  2  0
 4  2  1  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 2, 4]

▶ iteration 17.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  3  0
 3  1  2  0
 4  2  4  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
muh_iter
5×4 Matrix{Float64}:
  1.85943   4.94891  4.21376  0.0
  1.93059   1.78417  4.09189  0.0
  1.28015   4.84058  4.40212  0.0
  0.458366  5.17835  4.02737  0.0
 -1.91802   3.4783   0.0      0.0
sig2h_iter
5×4 Matrix{Float64}:
 4.56187   12.2648   1.73521   1.0
 1.89141    2.30657  2.68546   1.0
 0.518051  15.6756   2.82779   1.0
 6.02836    2.26458  0.728827  1.0
 2.55263    7.98588  1.0       1.0
alpha_iter
4-element Vector{Float64}:
 0.2210732294132753
 0.14403198289943922
 0.0927754944331358
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 3, 4]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  1  2  0
 2  1  3  0
 3  1  2  0
 1  2  4  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  1  2  0
 2  1  3  0
 3  1  2  0
 1  2  4  0
rho_tmp = [2, 2, 2, 3, 1]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  1  2  0
 2  1  3  0
 3  1  2  0
 1  2  4  0
rho_tmp = [3, 2, 2, 3, 1]
Si_comp1 = [3]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  1  2  0
 2  1  3  0
 3  1  2  0
 1  2  4  0
rho_tmp = [4, 2, 2, 3, 1]
Si_comp1 = [4]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 1, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  3  0
 1  1  2  0
 3  2  4  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  3  0
 1  1  2  0
 3  2  4  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  3  0
 1  1  2  0
 3  2  4  0
rho_tmp = [1, 3, 2, 1, 3]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  3  0
 1  1  2  0
 3  2  4  0
rho_tmp = [1, 4, 2, 1, 3]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 1, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  3  0
 1  1  2  0
 3  2  4  0
rho_tmp = [1, 2, 1, 1, 3]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  3  0
 1  1  2  0
 3  2  4  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  3  0
 1  1  2  0
 3  2  4  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  1  3  0
 1  1  2  0
 3  2  4  0
rho_tmp = [1, 2, 4, 1, 3]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 1, 4]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  1  3  0
 1  1  2  0
 4  2  4  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  1  3  0
 1  1  2  0
 4  2  4  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  1  3  0
 1  1  2  0
 4  2  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  1  3  0
 1  1  2  0
 4  2  4  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  1  3  0
 1  1  2  0
 4  2  4  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 4]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  1  3  0
 4  1  2  0
 4  2  4  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  1  3  0
 4  1  2  0
 4  2  4  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  1  3  0
 4  1  2  0
 4  2  4  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  1  3  0
 4  1  2  0
 4  2  4  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  1  3  0
 4  1  2  0
 4  2  4  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 5
Si_iter[:, t] = [1, 2, 3, 4, 5]
► time 2
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.14403198289943922
sampled gamma:
probh = 0.14403198289943922
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.14403198289943922
sampled gamma:
probh = 0.14403198289943922
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.14403198289943922
sampled gamma:
probh = 0.14403198289943922
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.14403198289943922
sampled gamma:
probh = 0.14403198289943922
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.14403198289943922
sampled gamma:
probh = 0.14403198289943922
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 1, 1, 2]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  1  3  0
 4  1  2  0
 5  2  4  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  1  3  0
 4  1  2  0
 5  2  4  0
rho_tmp = [2, 1, 1, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  1  3  0
 4  1  2  0
 5  2  4  0
rho_tmp = [3, 1, 1, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  3  0
 4  2  2  0
 5  3  4  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  3  0
 4  2  2  0
 5  3  4  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  3  0
 4  2  2  0
 5  3  4  0
rho_tmp = [1, 3, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  3  0
 4  2  2  0
 5  3  4  0
rho_tmp = [1, 4, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  3  2  0
 5  4  4  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  3  2  0
 5  4  4  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  3  2  0
 5  4  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  3  2  0
 5  4  4  0
rho_tmp = [1, 2, 4, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  3  2  0
 5  4  4  0
rho_tmp = [1, 2, 5, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  3  2  0
 5  4  4  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  3  2  0
 5  4  4  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  3  2  0
 5  4  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  3  2  0
 5  4  4  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  3  2  0
 5  4  4  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  3  2  0
 5  4  4  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  3  2  0
 5  4  4  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  3  2  0
 5  4  4  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  3  2  0
 5  4  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 3
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.0927754944331358
sampled gamma:
probh = 0.0927754944331358
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.0927754944331358
sampled gamma:
probh = 0.0927754944331358
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.0927754944331358
sampled gamma:
probh = 0.0927754944331358
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.0927754944331358
sampled gamma:
probh = 0.0927754944331358
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.0927754944331358
sampled gamma:
probh = 0.0927754944331358
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 2, 4]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 2  2  2  0
 3  3  3  0
 4  3  2  0
 5  4  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 2  2  2  0
 3  3  3  0
 4  3  2  0
 5  4  1  0
rho_tmp = [2, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 2  2  2  0
 3  3  3  0
 4  3  2  0
 5  4  1  0
rho_tmp = [3, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 2  2  2  0
 3  3  3  0
 4  3  2  0
 5  4  1  0
rho_tmp = [4, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 2, 1]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  3  2  0
 5  4  1  0
rho_tmp = [1, 1, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  3  2  0
 5  4  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  3  2  0
 5  4  1  0
rho_tmp = [1, 3, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 4  3  2  0
 5  4  1  0
rho_tmp = [1, 4, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 1]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  3  0
 4  3  2  0
 5  4  1  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  3  0
 4  3  2  0
 5  4  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  3  0
 4  3  2  0
 5  4  1  0
rho_tmp = [1, 1, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 1]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  3  2  0
 5  4  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  3  2  0
 5  4  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  3  2  0
 5  4  1  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 1, 1]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  3  1  0
 5  4  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  3  1  0
 5  4  1  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  3  1  0
 5  4  1  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 1, 3]

▶ iteration 18.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  3  1  0
 5  4  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
muh_iter
5×4 Matrix{Float64}:
 0.692543  4.35143  4.02737  0.0
 3.84705   3.17556  4.09189  0.0
 1.51336   4.94891  4.02359  0.0
 1.22842   2.78428  4.21376  0.0
 2.07492   3.4783   0.0      0.0
sig2h_iter
5×4 Matrix{Float64}:
 7.39044   4.72352   2.0208   1.0
 1.70788   2.19859   2.10124  1.0
 0.496462  5.25668   1.80211  1.0
 0.877851  0.953704  1.73521  1.0
 1.54057   7.98588   1.0      1.0
alpha_iter
4-element Vector{Float64}:
 0.3080875890025432
 0.05763088195072922
 0.08687141257772771
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 5]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 5  1  1  0
 2  2  1  0
 3  3  2  0
 4  3  1  0
 1  4  3  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 5  1  1  0
 2  2  1  0
 3  3  2  0
 4  3  1  0
 1  4  3  0
rho_tmp = [2, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 5  1  1  0
 2  2  1  0
 3  3  2  0
 4  3  1  0
 1  4  3  0
rho_tmp = [3, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 5  1  1  0
 2  2  1  0
 3  3  2  0
 4  3  1  0
 1  4  3  0
rho_tmp = [4, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 5  1  1  0
 2  2  1  0
 3  3  2  0
 4  3  1  0
 1  4  3  0
rho_tmp = [5, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 5
Si_iter[:, t] = [1, 2, 3, 4, 5]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 5  2  1  0
 3  3  2  0
 4  3  1  0
 2  4  3  0
rho_tmp = [1, 1, 3, 4, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 5  2  1  0
 3  3  2  0
 4  3  1  0
 2  4  3  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 5  2  1  0
 3  3  2  0
 4  3  1  0
 2  4  3  0
rho_tmp = [1, 3, 3, 4, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 5  2  1  0
 3  3  2  0
 4  3  1  0
 2  4  3  0
rho_tmp = [1, 4, 3, 4, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 5  2  1  0
 3  3  2  0
 4  3  1  0
 2  4  3  0
rho_tmp = [1, 5, 3, 4, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 4]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  3  2  0
 3  3  1  0
 4  4  3  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  3  2  0
 3  3  1  0
 4  4  3  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  3  2  0
 3  3  1  0
 4  4  3  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  3  2  0
 3  3  1  0
 4  4  3  0
rho_tmp = [1, 2, 4, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  3  2  0
 3  3  1  0
 4  4  3  0
rho_tmp = [1, 2, 5, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  3  1  0
 3  4  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  3  1  0
 3  4  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  3  1  0
 3  4  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  3  1  0
 3  4  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  1  0
 3  4  3  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  1  0
 3  4  3  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  1  0
 3  4  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  1  0
 3  4  3  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 3, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.05763088195072922
sampled gamma:
probh = 0.05763088195072922
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.05763088195072922
sampled gamma:
probh = 0.05763088195072922
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.05763088195072922
sampled gamma:
probh = 0.05763088195072922
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.05763088195072922
sampled gamma:
probh = 0.05763088195072922
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.05763088195072922
sampled gamma:
probh = 0.05763088195072922
gt = true
gamma_iter[:, t] = Bool[0, 0, 0, 0, 1]
												[update rho]
movable_units = [1, 2, 3, 4]
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  1  0
 3  3  2  0
 3  3  1  0
 1  1  3  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  1  0
 3  3  2  0
 3  3  1  0
 1  1  3  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  1  0
 3  3  2  0
 3  3  1  0
 1  1  3  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  1  0
 3  3  2  0
 3  3  1  0
 1  1  3  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 1  3  3  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 1  3  3  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 1  3  3  0
rho_tmp = [1, 3, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 3  2  1  0
 1  3  3  0
rho_tmp = [1, 4, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  1  0
 1  4  3  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  1  0
 1  4  3  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  1  0
 1  4  3  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  1  0
 1  4  3  0
rho_tmp = [1, 2, 4, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 3  3  1  0
 1  4  3  0
rho_tmp = [1, 2, 5, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 3, 4]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  4  1  0
 1  3  3  0
rho_tmp = [1, 2, 1, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  4  1  0
 1  3  3  0
rho_tmp = [1, 2, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  4  1  0
 1  3  3  0
rho_tmp = [1, 2, 1, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  4  1  0
 1  3  3  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 1, 3, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.08687141257772771
sampled gamma:
probh = 0.08687141257772771
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.08687141257772771
sampled gamma:
probh = 0.08687141257772771
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.08687141257772771
sampled gamma:
probh = 0.08687141257772771
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25395099810962674, 0.7460490018903733]
probh = 0.11309760724075486
sampled gamma:
probh = 0.11309760724075486
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.11041048838237466
sampled gamma:
probh = 0.11041048838237466
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update rho]
movable_units = [1, 2, 4, 5]
Si_iter[:, t] = [1, 1, 2, 1, 3]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  3  1  0
 1  3  3  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  3  1  0
 1  3  3  0
rho_tmp = [2, 1, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  3  1  0
 1  3  3  0
rho_tmp = [3, 1, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  1  2  0
 3  3  1  0
 1  3  3  0
rho_tmp = [4, 1, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 2, 4]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  3  0
 3  3  2  0
 1  3  4  0
rho_tmp = [1, 1, 3, 2, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  3  0
 3  3  2  0
 1  3  4  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  3  0
 3  3  2  0
 1  3  4  0
rho_tmp = [1, 3, 3, 2, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  3  0
 3  3  2  0
 1  3  4  0
rho_tmp = [1, 4, 3, 2, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  3  0
 3  3  2  0
 1  3  4  0
rho_tmp = [1, 5, 3, 2, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 5
Si_iter[:, t] = [1, 2, 3, 4, 5]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  3  0
 3  3  5  0
 1  3  4  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  3  0
 3  3  5  0
 1  3  4  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  3  0
 3  3  5  0
 1  3  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  3  0
 3  3  5  0
 1  3  4  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  3  0
 3  3  5  0
 1  3  4  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  3  0
 3  3  3  0
 1  3  4  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  3  0
 3  3  3  0
 1  3  4  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  3  0
 3  3  3  0
 1  3  4  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  3  0
 3  3  3  0
 1  3  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 3, 1]

▶ iteration 19.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  3  0
 3  3  3  0
 1  3  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
muh_iter
5×4 Matrix{Float64}:
 0.312232  3.17556  3.3954   0.0
 1.39975   4.84202  3.68261  0.0
 1.33322   2.78428  4.09189  0.0
 1.22842   4.94891  4.02359  0.0
 3.84705   3.4783   4.02737  0.0
sig2h_iter
5×4 Matrix{Float64}:
 14.2594    2.07636  3.76539  1.0
  0.86423   4.85794  6.02941  1.0
  1.52472   4.75698  1.89993  1.0
  0.877851  5.25668  1.80211  1.0
  1.70788   7.98588  2.0208   1.0
alpha_iter
4-element Vector{Float64}:
 0.10367868905015054
 0.22598444389424582
 0.3269083835836
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  3  0
 3  3  3  0
 1  3  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  3  0
 3  3  3  0
 1  3  1  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  3  0
 3  3  3  0
 1  3  1  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  3  0
 3  3  3  0
 1  3  1  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  1  3  0
 3  3  3  0
 2  3  1  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  1  3  0
 3  3  3  0
 2  3  1  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  1  3  0
 3  3  3  0
 2  3  1  0
rho_tmp = [1, 3, 3, 3, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  1  3  0
 3  3  3  0
 2  3  1  0
rho_tmp = [1, 4, 3, 3, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 3, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  3  0
 3  3  3  0
 2  3  1  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  3  0
 3  3  3  0
 2  3  1  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  3  0
 3  3  3  0
 2  3  1  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  3  0
 3  3  3  0
 2  3  1  0
rho_tmp = [1, 2, 4, 3, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  1  3  0
 3  3  3  0
 2  3  1  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  1  3  0
 3  3  3  0
 2  3  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  1  3  0
 3  3  3  0
 2  3  1  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 1, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  1  3  0
 1  3  3  0
 2  3  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  1  3  0
 1  3  3  0
 2  3  1  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  1  3  0
 1  3  3  0
 2  3  1  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 1, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23097802558886682, 0.7690219744111332]
probh = 0.2751815650552239
sampled gamma:
probh = 0.2751815650552239
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.28261147940634035
sampled gamma:
probh = 0.28261147940634035
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.27679643966928397
sampled gamma:
probh = 0.27679643966928397
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25395099810962674, 0.7460490018903733]
probh = 0.5348156039302591
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 1]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.22598444389424582
sampled gamma:
probh = 0.22598444389424582
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 1, 3, 3]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  1  3  0
 1  3  3  0
 3  3  1  0
rho_tmp = [1, 2, 1, 3, 3]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  1  3  0
 1  3  3  0
 3  3  1  0
rho_tmp = [2, 2, 1, 3, 3]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  1  3  0
 1  3  3  0
 3  3  1  0
rho_tmp = [3, 2, 1, 3, 3]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  1  3  0
 1  3  3  0
 3  3  1  0
rho_tmp = [4, 2, 1, 3, 3]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 3, 3]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  3  2  0
 2  1  3  0
 1  2  3  0
 3  2  1  0
rho_tmp = [1, 1, 1, 2, 2]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  3  2  0
 2  1  3  0
 1  2  3  0
 3  2  1  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  3  2  0
 2  1  3  0
 1  2  3  0
 3  2  1  0
rho_tmp = [1, 3, 1, 2, 2]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 2, 2]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  1  3  0
 1  2  3  0
 3  2  1  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  1  3  0
 1  2  3  0
 3  2  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  1  3  0
 1  2  3  0
 3  2  1  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 2, 2]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  2  3  0
 3  2  1  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  2  3  0
 3  2  1  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  2  3  0
 3  2  1  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  2  3  0
 3  2  1  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 2]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  3  0
 3  2  1  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  3  0
 3  2  1  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  3  0
 3  2  1  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  3  0
 3  2  1  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  3  0
 3  2  1  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 4]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23097802558886682, 0.7690219744111332]
probh = 0.3870888431721405
sampled gamma:
probh = 0.3870888431721405
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.6523129776582924
sampled gamma:
probh = 0.6523129776582924
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.3269083835836
sampled gamma:
probh = 0.3269083835836
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.3269083835836
sampled gamma:
probh = 0.3269083835836
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.3269083835836
sampled gamma:
probh = 0.3269083835836
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  3  0
 3  4  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  3  0
 3  4  1  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  3  0
 3  4  1  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  3  0
 3  4  1  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  3  0
 2  3  2  0
 1  4  2  0
 3  4  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  3  0
 2  3  2  0
 1  4  2  0
 3  4  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  3  0
 2  3  2  0
 1  4  2  0
 3  4  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  3  0
 3  4  1  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  3  0
 3  4  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  3  0
 3  4  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  3  0
 3  4  1  0
rho_tmp = [1, 2, 4, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 1]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 3  4  1  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 3  4  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 3  4  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  4  0
 3  4  1  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 1, 1]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  1  0
 3  4  1  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  1  0
 3  4  1  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  1  0
 3  4  1  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  1  0
 3  4  1  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 1, 3]

▶ iteration 20.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  1  0
 3  4  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
muh_iter
5×4 Matrix{Float64}:
 3.14973  3.17556  3.3954   0.0
 2.08189  2.78428  2.49795  0.0
 2.01684  4.76953  4.45199  0.0
 1.26876  4.32995  4.09189  0.0
 3.84705  3.4783   4.02737  0.0
sig2h_iter
5×4 Matrix{Float64}:
 5.52018   2.64242  3.68679   1.0
 0.885581  1.60834  0.916378  1.0
 6.66391   1.05338  2.91332   1.0
 0.86423   7.26606  1.89993   1.0
 1.70788   7.98588  2.0208    1.0
alpha_iter
4-element Vector{Float64}:
 0.15244101802163207
 0.1633548159536751
 0.04940741171355588
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 1, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  1  0
 3  4  3  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  1  0
 3  4  3  0
rho_tmp = [2, 2, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  1  0
 3  4  3  0
rho_tmp = [3, 2, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 1  4  1  0
 3  4  3  0
rho_tmp = [4, 2, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  1  0
 1  4  3  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  1  0
 1  4  3  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  1  0
 1  4  3  0
rho_tmp = [1, 3, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  3  3  0
 3  4  1  0
 1  4  3  0
rho_tmp = [1, 4, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  4  1  0
 1  4  3  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  4  1  0
 1  4  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  3  3  0
 2  4  1  0
 1  4  3  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  1  0
 1  4  3  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  1  0
 1  4  3  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  1  0
 1  4  3  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  1  0
 1  4  3  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  1  0
 1  4  3  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  4  1  0
 1  4  3  0
rho_tmp = [1, 2, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.1633548159536751
sampled gamma:
probh = 0.1633548159536751
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.1633548159536751
sampled gamma:
probh = 0.1633548159536751
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.1633548159536751
sampled gamma:
probh = 0.1633548159536751
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.1633548159536751
sampled gamma:
probh = 0.1633548159536751
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.1633548159536751
sampled gamma:
probh = 0.1633548159536751
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 4]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 1  3  3  0
 2  1  1  0
 1  1  3  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 1  3  3  0
 2  1  1  0
 1  1  3  0
rho_tmp = [2, 2, 3, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 1  3  3  0
 2  1  1  0
 1  1  3  0
rho_tmp = [3, 2, 3, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  4  1  0
 2  2  2  0
 1  3  3  0
 2  1  1  0
 1  1  3  0
rho_tmp = [4, 2, 3, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 3]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  2  3  0
 2  3  1  0
 1  3  3  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  2  3  0
 2  3  1  0
 1  3  3  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  2  3  0
 2  3  1  0
 1  3  3  0
rho_tmp = [1, 3, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 1  2  3  0
 2  3  1  0
 1  3  3  0
rho_tmp = [1, 4, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 2, 2]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  2  1  0
 1  2  3  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  2  1  0
 1  2  3  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  3  3  0
 2  2  1  0
 1  2  3  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 2]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 2  2  1  0
 1  2  3  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 2  2  1  0
 1  2  3  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 2  2  1  0
 1  2  3  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 2]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 2  2  1  0
 1  2  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 2  2  1  0
 1  2  3  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 2  2  1  0
 1  2  3  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 2, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.04940741171355588
sampled gamma:
probh = 0.04940741171355588
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.04940741171355588
sampled gamma:
probh = 0.04940741171355588
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.04940741171355588
sampled gamma:
probh = 0.04940741171355588
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.04940741171355588
sampled gamma:
probh = 0.04940741171355588
gt = true
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.06350102273242968
sampled gamma:
probh = 0.06350102273242968
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update rho]
movable_units = [1, 2, 3, 5]
Si_iter[:, t] = [1, 2, 3, 1, 3]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 2  2  1  0
 1  3  3  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 2  2  1  0
 1  3  3  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 2  2  1  0
 1  3  3  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 2  2  1  0
 1  3  3  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  2  2  0
 2  2  3  0
 1  3  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  2  2  0
 2  2  3  0
 1  3  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  2  2  0
 2  2  3  0
 1  3  2  0
rho_tmp = [1, 3, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  2  2  0
 2  2  3  0
 1  3  2  0
rho_tmp = [1, 4, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 2, 3]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 2, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 2, 4, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 2, 3]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 2  2  2  0
 1  3  3  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 2, 4]

▶ iteration 21.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 2  2  2  0
 1  3  4  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
muh_iter
5×4 Matrix{Float64}:
 0.26183  2.78428  2.49795  0.0
 1.02439  4.32995  3.3954   0.0
 1.69514  4.22408  4.45199  0.0
 1.33372  3.17556  4.75788  0.0
 3.84705  3.4783   4.02737  0.0
sig2h_iter
5×4 Matrix{Float64}:
 9.43725    5.81823   4.53317  1.0
 1.98218   11.9429    1.82983  1.0
 0.885581   3.00779  11.6718   1.0
 0.86423    2.64242   1.59178  1.0
 1.70788    7.98588   2.0208   1.0
alpha_iter
4-element Vector{Float64}:
 0.0237860488553377
 0.2291060908190333
 0.5348821325495886
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 1, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 2  2  2  0
 1  3  4  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 2  2  2  0
 1  3  4  0
rho_tmp = [2, 2, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 2  2  2  0
 1  3  4  0
rho_tmp = [3, 2, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 2  2  2  0
 1  3  4  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 2  2  2  0
 1  3  4  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  3  0
 2  2  2  0
 1  3  4  0
rho_tmp = [1, 3, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  3  0
 2  2  2  0
 1  3  4  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  3  0
 2  2  2  0
 1  3  4  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  3  0
 2  2  2  0
 1  3  4  0
rho_tmp = [1, 1, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  2  3  0
 3  2  2  0
 1  3  4  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  2  3  0
 3  2  2  0
 1  3  4  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  2  3  0
 3  2  2  0
 1  3  4  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 1, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  2  3  0
 1  2  2  0
 1  3  4  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  2  3  0
 1  2  2  0
 1  3  4  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  2  3  0
 1  2  2  0
 1  3  4  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 1, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.2291060908190333
sampled gamma:
probh = 0.2291060908190333
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.2291060908190333
sampled gamma:
probh = 0.2291060908190333
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.2291060908190333
sampled gamma:
probh = 0.2291060908190333
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.2291060908190333
sampled gamma:
probh = 0.2291060908190333
gt = true
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.27939332890643853
sampled gamma:
probh = 0.27939332890643853
gt = true
gamma_iter[:, t] = Bool[0, 0, 0, 1, 1]
												[update rho]
movable_units = [1, 2, 3]
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  3  1  0
 1  2  2  0
 2  2  3  0
 1  2  2  0
 3  1  4  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  3  1  0
 1  2  2  0
 2  2  3  0
 1  2  2  0
 3  1  4  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  3  1  0
 1  2  2  0
 2  2  3  0
 1  2  2  0
 3  1  4  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 1, 1, 2]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  1  2  0
 3  2  4  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  1  2  0
 3  2  4  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  1  2  0
 3  2  4  0
rho_tmp = [1, 3, 1, 1, 2]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 2]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  1  2  0
 3  2  4  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  1  2  0
 3  2  4  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  1  2  0
 3  2  4  0
rho_tmp = [1, 1, 3, 1, 2]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23097802558886682, 0.7690219744111332]
probh = 0.5992620579704091
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.6081010139178654
sampled gamma:
probh = 0.6081010139178654
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.8290263016434988
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.5348821325495886
sampled gamma:
probh = 0.5348821325495886
gt = true
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.6000439555066266
sampled gamma:
probh = 0.6000439555066266
gt = true
gamma_iter[:, t] = Bool[0, 0, 0, 1, 1]
												[update rho]
movable_units = [1, 2, 3]
Si_iter[:, t] = [1, 2, 3, 2, 4]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 1  1  2  0
 2  1  3  0
 1  1  2  0
 3  2  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 1  1  2  0
 2  1  3  0
 1  1  2  0
 3  2  1  0
rho_tmp = [2, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 1  1  2  0
 2  1  3  0
 1  1  2  0
 3  2  1  0
rho_tmp = [3, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 1  1  2  0
 2  1  3  0
 1  1  2  0
 3  2  1  0
rho_tmp = [4, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 2, 4]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  1  2  0
 3  2  4  0
rho_tmp = [1, 1, 3, 2, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  1  2  0
 3  2  4  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  1  2  0
 3  2  4  0
rho_tmp = [1, 3, 3, 2, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  1  2  0
 3  2  4  0
rho_tmp = [1, 4, 3, 2, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  1  2  0
 3  2  4  0
rho_tmp = [1, 5, 3, 2, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 5
Si_iter[:, t] = [1, 2, 3, 4, 5]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  5  0
 1  1  4  0
 3  2  3  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  5  0
 1  1  4  0
 3  2  3  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  5  0
 1  1  4  0
 3  2  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  5  0
 1  1  4  0
 3  2  3  0
rho_tmp = [1, 2, 4, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  5  0
 1  1  4  0
 3  2  3  0
rho_tmp = [1, 2, 5, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 3, 4]

▶ iteration 22.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  1  3  0
 3  2  4  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
  0.889741  4.32995  2.57313  0.0
 -0.388343  4.22408  2.0725   0.0
  2.558     2.78428  3.3954   0.0
  0.571997  3.17556  4.75788  0.0
  3.84705   3.4783   4.45199  0.0
sig2h_iter
5×4 Matrix{Float64}:
 1.58832   5.78113   0.959173  1.0
 0.221892  5.64195   1.95341   1.0
 5.38202   5.81823   1.25635   1.0
 0.86423   2.64242   4.27186   1.0
 1.70788   7.98588  11.6718    1.0
alpha_iter
4-element Vector{Float64}:
 0.018167780221879353
 0.49475739730639884
 0.650299554380711
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 1, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  1  3  0
 3  2  4  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  1  3  0
 3  2  4  0
rho_tmp = [2, 1, 2, 1, 3]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  1  3  0
 3  2  4  0
rho_tmp = [3, 1, 2, 1, 3]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  1  3  0
 3  2  4  0
rho_tmp = [4, 1, 2, 1, 3]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 2, 4]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  1  2  0
 2  1  3  0
 4  2  4  0
rho_tmp = [1, 1, 3, 2, 4]
Si_comp1 = [2, 4]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  1  2  0
 2  1  3  0
 4  2  4  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [2, 4]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  1  2  0
 2  1  3  0
 4  2  4  0
rho_tmp = [1, 3, 3, 2, 4]
Si_comp1 = [2, 4]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  1  2  0
 2  1  3  0
 4  2  4  0
rho_tmp = [1, 4, 3, 2, 4]
Si_comp1 = [2, 4]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  1  2  0
 2  1  3  0
 4  2  4  0
rho_tmp = [1, 5, 3, 2, 4]
Si_comp1 = [2, 4]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 4]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 4  1  2  0
 3  1  3  0
 2  2  4  0
rho_tmp = [1, 1, 1, 3, 2]
Si_comp1 = [3, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 4  1  2  0
 3  1  3  0
 2  2  4  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [3, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 4  1  2  0
 3  1  3  0
 2  2  4  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [3, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 4  1  2  0
 3  1  3  0
 2  2  4  0
rho_tmp = [1, 1, 4, 3, 2]
Si_comp1 = [3, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 1, 2, 3, 4]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  2  0
 4  1  3  0
 3  2  4  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  2  0
 4  1  3  0
 3  2  4  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [2, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  2  0
 4  1  3  0
 3  2  4  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [3, 3]
Si_comp2 = [1, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  2  0
 4  1  3  0
 3  2  4  0
rho_tmp = [1, 1, 2, 4, 3]
Si_comp1 = [4, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.0, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 1, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  1  3  0
 3  2  4  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = [1, 1]
Si_comp2 = [1, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  1  3  0
 3  2  4  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  1  3  0
 3  2  4  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.5, 0.5]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 1, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.007117550135875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.29281311194311704, 0.7071868880568829]
probh = 0.7698119246018531
sampled gamma:
probh = 0.7698119246018531
gt = true
gamma_iter[:, t] = Bool[1, 0, 0, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.042550025020024, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3002037241891629, 0.6997962758108371]
probh = 0.7653651878114552
sampled gamma:
probh = 0.7653651878114552
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 1, 1]
Si_red1 = [1, 1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.547253015599466, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20724296432476033, 0.7927570356752397]
probh = 0.8253310706880744
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.016741987143638, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.29481004528354227, 0.7051899547164576]
probh = 0.768605335871409
sampled gamma:
probh = 0.768605335871409
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.021142492881014, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2957257229117288, 0.7042742770882712]
probh = 0.5816659946295845
sampled gamma:
probh = 0.5816659946295845
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 0, 0]
												[update rho]
movable_units = [3, 4, 5]
Si_iter[:, t] = [1, 1, 1, 1, 2]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  1  3  0
 3  2  4  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 2]
Si_comp2 = [3, 4]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  1  3  0
 3  2  4  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 2]
Si_comp2 = [3, 4]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  1  3  0
 3  2  4  0
rho_tmp = [1, 1, 3, 1, 2]
Si_comp1 = [1, 2]
Si_comp2 = [3, 4]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 2]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  1  3  0
 3  2  4  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 2]
Si_comp2 = [3, 4]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  1  3  0
 3  2  4  0
rho_tmp = [1, 1, 1, 2, 2]
Si_comp1 = [2, 2]
Si_comp2 = [3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  1  3  0
 3  2  4  0
rho_tmp = [1, 1, 1, 3, 2]
Si_comp1 = [3, 2]
Si_comp2 = [3, 4]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.5]
new_label = 3
Si_iter[:, t] = [1, 1, 1, 2, 3]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  2  3  0
 3  3  4  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [2, 1]
Si_comp2 = [3, 4]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  2  3  0
 3  3  4  0
rho_tmp = [1, 1, 1, 2, 2]
Si_comp1 = [2, 2]
Si_comp2 = [3, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  2  3  0
 3  3  4  0
rho_tmp = [1, 1, 1, 2, 3]
Si_comp1 = [2, 3]
Si_comp2 = [3, 4]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.686080992604418, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18763781382561492, 0.18763781382561492, 0.6247243723487702]
probh = 0.7485325104411479
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.837036039561302, 4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2056377848473934, 0.2056377848473934, 0.5887244303052133]
probh = 0.9004285352391946
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.720608804660927, 4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19170232997542352, 0.19170232997542352, 0.616595340049153]
probh = 0.9065455958054721
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25395099810962674, 0.7460490018903733]
probh = 0.8798457361149351
sampled gamma:
probh = 0.8798457361149351
gt = true
gamma_iter[:, t] = Bool[0, 0, 0, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.7081154696140167
sampled gamma:
probh = 0.7081154696140167
gt = true
gamma_iter[:, t] = Bool[0, 0, 0, 1, 1]
												[update rho]
movable_units = [1, 2, 3]
Si_iter[:, t] = [1, 2, 2, 3, 4]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 1  1  2  0
 2  1  2  0
 1  2  3  0
 3  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 1  1  2  0
 2  1  2  0
 1  2  3  0
 3  1  1  0
rho_tmp = [2, 2, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 1  1  2  0
 2  1  2  0
 1  2  3  0
 3  1  1  0
rho_tmp = [3, 2, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 1  1  2  0
 2  1  2  0
 1  2  3  0
 3  1  1  0
rho_tmp = [4, 2, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 1, 3]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  2  1  0
 3  1  3  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  2  1  0
 3  1  3  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  2  1  0
 3  1  3  0
rho_tmp = [1, 3, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  2  0
 1  2  1  0
 3  1  3  0
rho_tmp = [1, 4, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 1, 2]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  1  2  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  1  2  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  1  2  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 1, 2]

▶ iteration 23.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  1  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 1.09285   4.32995  3.3954   0.0
 1.24761   5.54851  4.75788  0.0
 3.18291   4.22408  1.82168  0.0
 0.889741  3.17556  2.57313  0.0
 3.84705   3.4783   4.45199  0.0
sig2h_iter
5×4 Matrix{Float64}:
 3.1632    4.18569   7.61429   1.0
 0.526391  8.61749  10.5009    1.0
 5.68514   5.64195   0.514972  1.0
 1.58832   2.64242   0.959173  1.0
 1.70788   7.98588  11.6718    1.0
alpha_iter
4-element Vector{Float64}:
 0.21662831504880642
 0.5347058329316651
 0.5015854049320213
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 1, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  1  2  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  1  2  0
rho_tmp = [2, 1, 2, 1, 3]
Si_comp1 = [2, 1]
Si_comp2 = [1, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  1  2  0
rho_tmp = [3, 1, 2, 1, 3]
Si_comp1 = [3, 1]
Si_comp2 = [1, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  1  2  0
rho_tmp = [4, 1, 2, 1, 3]
Si_comp1 = [4, 1]
Si_comp2 = [1, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 1, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  1  2  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  1  2  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = [1, 2]
Si_comp2 = [1, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  1  2  0
rho_tmp = [1, 3, 2, 1, 3]
Si_comp1 = [1, 3]
Si_comp2 = [1, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  1  2  0
rho_tmp = [1, 4, 2, 1, 3]
Si_comp1 = [1, 4]
Si_comp2 = [1, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 1, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 3  1  3  0
 1  2  1  0
 2  1  2  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 3  1  3  0
 1  2  1  0
 2  1  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 3  1  3  0
 1  2  1  0
 2  1  2  0
rho_tmp = [1, 1, 3, 1, 2]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 1, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  1  2  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  1  2  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  1  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  1  2  0
rho_tmp = [1, 1, 2, 4, 3]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 1, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  1  2  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  1  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  1  2  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 1, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23097802558886682, 0.7690219744111332]
probh = 0.8326435440838378
sampled gamma:
probh = 0.8326435440838378
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.8161488335704835
sampled gamma:
probh = 0.8161488335704835
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.0416453621923845, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.30001370567070174, 0.6999862943292982]
probh = 0.7929785970434846
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.132264559216373, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.31938198507206067, 0.6806180149279393]
probh = 0.6280361311884423
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.021142492881014, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2957257229117288, 0.7042742770882712]
probh = 0.7953318877400689
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 0, 0]
												[update rho]
movable_units = [3, 4, 5]
Si_iter[:, t] = [1, 1, 1, 2, 1]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  1  2  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [2, 1]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  1  2  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [2, 1]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  1  2  0
rho_tmp = [1, 1, 3, 2, 1]
Si_comp1 = [2, 1]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 1]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  1  2  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1]
Si_comp2 = [1, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  1  2  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [2, 1]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5]
After exp and normalization:
ph = [0.0, 1.0]
new_label = 2
Si_iter[:, t] = [1, 1, 1, 2, 1]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  1  2  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [2, 1]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  1  2  0
rho_tmp = [1, 1, 1, 2, 2]
Si_comp1 = [2, 2]
Si_comp2 = [1, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  1  2  0
rho_tmp = [1, 1, 1, 2, 3]
Si_comp1 = [2, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.5]
new_label = 3
Si_iter[:, t] = [1, 1, 1, 2, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.686080992604418, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18763781382561492, 0.18763781382561492, 0.6247243723487702]
probh = 0.8428493502444991
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.837036039561302, 4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2056377848473934, 0.2056377848473934, 0.5887244303052133]
probh = 0.6309137260662213
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.720608804660927, 4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19170232997542352, 0.19170232997542352, 0.616595340049153]
probh = 0.8399899249985767
sampled gamma:
probh = 0.8399899249985767
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20252067145563615, 0.20252067145563615, 0.5949586570887277]
probh = 0.8324728188074594
sampled gamma:
probh = 0.8324728188074594
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.700105935349557, 4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18928469829987307, 0.18928469829987307, 0.6214306034002539]
probh = 0.6182371872188177
sampled gamma:
probh = 0.6182371872188177
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update rho]
movable_units = [1, 2]
Si_iter[:, t] = [1, 2, 3, 1, 2]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  3  2  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  3  2  0
rho_tmp = [2, 2, 3, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  3  2  0
rho_tmp = [3, 2, 3, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  1  0
 3  3  2  0
rho_tmp = [4, 2, 3, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 2]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  4  0
 3  3  2  0
rho_tmp = [1, 1, 3, 4, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  4  0
 3  3  2  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  4  0
 3  3  2  0
rho_tmp = [1, 3, 3, 4, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  4  0
 3  3  2  0
rho_tmp = [1, 4, 3, 4, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  4  0
 3  3  2  0
rho_tmp = [1, 5, 3, 4, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 5
Si_iter[:, t] = [1, 2, 3, 4, 5]

▶ iteration 24.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  4  0
 3  3  5  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 1.64292   4.32995  2.98095  0.0
 0.866539  4.96407  3.25554  0.0
 0.270223  5.2892   1.82168  0.0
 3.12634   3.17556  3.3954   0.0
 2.14035   3.4783   4.75788  0.0
sig2h_iter
5×4 Matrix{Float64}:
 9.81615    8.60441  2.70305   1.0
 0.681264  12.1418   2.40394   1.0
 1.92076    7.61007  0.355303  1.0
 1.58832    2.64242  4.26074   1.0
 1.70788    7.98588  1.89876   1.0
alpha_iter
4-element Vector{Float64}:
 0.27218163626743214
 0.5977241984000577
 0.6041868083009375
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 1, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  4  0
 3  3  5  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  4  0
 3  3  5  0
rho_tmp = [2, 1, 2, 1, 3]
Si_comp1 = [2, 1]
Si_comp2 = [1, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  4  0
 3  3  5  0
rho_tmp = [3, 1, 2, 1, 3]
Si_comp1 = [3, 1]
Si_comp2 = [1, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  4  0
 3  3  5  0
rho_tmp = [4, 1, 2, 1, 3]
Si_comp1 = [4, 1]
Si_comp2 = [1, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 1, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  4  0
 3  3  5  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  4  0
 3  3  5  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = [1, 2]
Si_comp2 = [1, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  4  0
 3  3  5  0
rho_tmp = [1, 3, 2, 1, 3]
Si_comp1 = [1, 3]
Si_comp2 = [1, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  4  0
 3  3  5  0
rho_tmp = [1, 4, 2, 1, 3]
Si_comp1 = [1, 4]
Si_comp2 = [1, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 1, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 3  1  3  0
 1  2  4  0
 2  3  5  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 3  1  3  0
 1  2  4  0
 2  3  5  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 3  1  3  0
 1  2  4  0
 2  3  5  0
rho_tmp = [1, 1, 3, 1, 2]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 1, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  4  0
 2  3  5  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  4  0
 2  3  5  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 1  2  4  0
 2  3  5  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 3  2  4  0
 2  3  5  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 3  2  4  0
 2  3  5  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 3  2  4  0
 2  3  5  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 3  2  4  0
 2  3  5  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 1, 2, 3, 4]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23097802558886682, 0.7690219744111332]
probh = 0.8654628654537672
sampled gamma:
probh = 0.8654628654537672
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.8516264316711483
sampled gamma:
probh = 0.8516264316711483
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.0416453621923845, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.30001370567070174, 0.6999862943292982]
probh = 0.8320070127590411
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.132264559216373, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.31938198507206067, 0.6806180149279393]
probh = 0.6858407773578137
sampled gamma:
probh = 0.6858407773578137
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.021142492881014, 4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.24349215718714418, 0.1766284150404322, 0.5798794277724236]
probh = 0.7192867870962731
sampled gamma:
probh = 0.7192867870962731
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 1, 0]
												[update rho]
movable_units = [3, 5]
Si_iter[:, t] = [1, 1, 1, 2, 3]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 3  2  4  0
 4  3  5  0
rho_tmp = [1, 1, 1, 2, 3]
Si_comp1 = [1, 2, 3]
Si_comp2 = [3, 4, 5]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 3  2  4  0
 4  3  5  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [2, 2, 3]
Si_comp2 = [3, 4, 5]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 3  2  4  0
 4  3  5  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [3, 2, 3]
Si_comp2 = [3, 4, 5]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 3  2  4  0
 4  3  5  0
rho_tmp = [1, 1, 4, 2, 3]
Si_comp1 = [4, 2, 3]
Si_comp2 = [3, 4, 5]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.0, 0.5]
new_label = 4
Si_iter[:, t] = [1, 1, 2, 3, 4]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 3  3  4  0
 4  4  5  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [2, 3, 1]
Si_comp2 = [3, 4, 5]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 3  3  4  0
 4  4  5  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [2, 3, 2]
Si_comp2 = [3, 4, 5]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 3  3  4  0
 4  4  5  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [2, 3, 3]
Si_comp2 = [3, 4, 5]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 3  3  4  0
 4  4  5  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [2, 3, 4]
Si_comp2 = [3, 4, 5]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.0, 0.5]
new_label = 4
Si_iter[:, t] = [1, 1, 2, 3, 4]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.686080992604418, 4.686080992604418, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1579924549734541, 0.1579924549734541, 0.1579924549734541, 0.5260226350796378]
probh = 0.7437120109193961
sampled gamma:
probh = 0.7437120109193961
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.837036039561302, 4.837036039561302, 4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17056348716992353, 0.17056348716992353, 0.17056348716992353, 0.4883095384902295]
probh = 0.8994916323324557
sampled gamma:
probh = 0.8994916323324557
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 4.720608804660927, 4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16086427386558605, 0.16086427386558605, 0.16086427386558605, 0.5174071784032418]
probh = 0.904662210558562
sampled gamma:
probh = 0.904662210558562
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.811228001684916, 4.811228001684916, 4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1684134637041103, 0.1684134637041103, 0.1684134637041103, 0.49475960888766907]
probh = 0.900632688594779
sampled gamma:
probh = 0.900632688594779
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 4]
j_label = 4
before exp and normalization:
lg_weights = [4.700105935349557, 4.700105935349557, 4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15915844084302325, 0.15915844084302325, 0.15915844084302325, 0.5225246774709303]
probh = 0.7449816607082672
sampled gamma:
probh = 0.7449816607082672
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update rho]
movable_units = [1]
Si_iter[:, t] = [1, 2, 3, 4, 5]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  5  0
 1  1  2  0
 2  2  3  0
 3  3  4  0
 4  4  1  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  5  0
 1  1  2  0
 2  2  3  0
 3  3  4  0
 4  4  1  0
rho_tmp = [2, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  5  0
 1  1  2  0
 2  2  3  0
 3  3  4  0
 4  4  1  0
rho_tmp = [3, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  5  0
 1  1  2  0
 2  2  3  0
 3  3  4  0
 4  4  1  0
rho_tmp = [4, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  5  0
 1  1  2  0
 2  2  3  0
 3  3  4  0
 4  4  1  0
rho_tmp = [5, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 1, 4]

▶ iteration 25.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 3  3  1  0
 4  4  4  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 2.69695  4.32995  3.3954   0.0
 1.7175   4.91943  3.25554  0.0
 1.80677  4.96407  1.82168  0.0
 2.95629  5.45505  4.75788  0.0
 2.14035  3.4783   2.98095  0.0
sig2h_iter
5×4 Matrix{Float64}:
 2.88556   25.6597    2.12129  1.0
 0.837096   0.757952  2.75669  1.0
 1.27524   14.7803    1.07746  1.0
 2.61228    5.04453   1.85834  1.0
 1.70788    7.98588   2.70305  1.0
alpha_iter
4-element Vector{Float64}:
 0.29505566465747574
 0.41951923547568615
 0.6751773310675475
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 3, 4]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 3  3  1  0
 4  4  4  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 1, 3]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 3  3  1  0
 4  4  4  0
rho_tmp = [2, 1, 2, 3, 4]
Si_comp1 = [2, 1, 3]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 3  3  1  0
 4  4  4  0
rho_tmp = [3, 1, 2, 3, 4]
Si_comp1 = [3, 1, 3]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 3  3  1  0
 4  4  4  0
rho_tmp = [4, 1, 2, 3, 4]
Si_comp1 = [4, 1, 3]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 3  3  1  0
 4  4  4  0
rho_tmp = [5, 1, 2, 3, 4]
Si_comp1 = [5, 1, 3]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 4]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 3  3  1  0
 4  4  4  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 1, 3]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 3  3  1  0
 4  4  4  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 3  3  1  0
 4  4  4  0
rho_tmp = [1, 3, 2, 3, 4]
Si_comp1 = [1, 3, 3]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 3  3  1  0
 4  4  4  0
rho_tmp = [1, 4, 2, 3, 4]
Si_comp1 = [1, 4, 3]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 3  3  1  0
 4  4  4  0
rho_tmp = [1, 5, 2, 3, 4]
Si_comp1 = [1, 5, 3]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 4]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 4  2  3  0
 3  3  1  0
 2  4  4  0
rho_tmp = [1, 1, 1, 3, 2]
Si_comp1 = [1, 1, 3]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 4  2  3  0
 3  3  1  0
 2  4  4  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 3]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 4  2  3  0
 3  3  1  0
 2  4  4  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 1, 3]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 4  2  3  0
 3  3  1  0
 2  4  4  0
rho_tmp = [1, 1, 4, 3, 2]
Si_comp1 = [1, 1, 3]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 3  3  1  0
 2  4  4  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 1, 1]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 3  3  1  0
 2  4  4  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 3  3  1  0
 2  4  4  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 3]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.5, 0.5]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 2  3  1  0
 2  4  4  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 2  3  1  0
 2  4  4  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 2  3  1  0
 2  4  4  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18763781382561492, 0.18763781382561492, 0.6247243723487702]
probh = 0.7938833736782843
sampled gamma:
probh = 0.7938833736782843
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.837036039561302, 4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2056377848473934, 0.2056377848473934, 0.5887244303052133]
probh = 0.7784905667716981
sampled gamma:
probh = 0.7784905667716981
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.0416453621923845, 4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2463917294475933, 0.17873175528175547, 0.5748765152706512]
probh = 0.8017267778724942
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.132264559216373, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.31938198507206067, 0.6806180149279393]
probh = 0.5149971905321212
sampled gamma:
probh = 0.5149971905321212
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.021142492881014, 4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.24349215718714418, 0.1766284150404322, 0.5798794277724236]
probh = 0.5548256195690268
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 1, 0]
												[update rho]
movable_units = [3, 5]
Si_iter[:, t] = [1, 1, 2, 3, 4]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  4  3  0
 2  3  1  0
 1  2  4  0
rho_tmp = [1, 1, 1, 3, 2]
Si_comp1 = [1, 1, 3, 2]
Si_comp2 = [2, 3, 1, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  4  3  0
 2  3  1  0
 1  2  4  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 2, 3, 2]
Si_comp2 = [2, 3, 1, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  4  3  0
 2  3  1  0
 1  2  4  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 3, 3, 2]
Si_comp2 = [2, 3, 1, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  4  3  0
 2  3  1  0
 1  2  4  0
rho_tmp = [1, 1, 4, 3, 2]
Si_comp1 = [1, 4, 3, 2]
Si_comp2 = [2, 3, 1, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 1, 2, 3, 4]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 2  3  1  0
 1  4  4  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 2, 3, 1]
Si_comp2 = [2, 3, 1, 4]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 2  3  1  0
 1  4  4  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 2, 3, 2]
Si_comp2 = [2, 3, 1, 4]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 2  3  1  0
 1  4  4  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 2, 3, 3]
Si_comp2 = [2, 3, 1, 4]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 2  3  1  0
 1  4  4  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 2, 3, 4]
Si_comp2 = [2, 3, 1, 4]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, -Inf, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.0, 1.0]
new_label = 4
Si_iter[:, t] = [1, 1, 2, 3, 4]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3, 1]
Si_red1 = [1, 2, 3, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.605506128082483, 4.686080992604418, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.14756646447730382, 0.15994876503711836, 0.15994876503711836, 0.5325360054484595]
probh = 0.9337128302153268
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.837036039561302, 4.837036039561302, 4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17056348716992353, 0.17056348716992353, 0.17056348716992353, 0.4883095384902295]
probh = 0.9241659084856826
sampled gamma:
probh = 0.9241659084856826
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 4.720608804660927, 4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16086427386558605, 0.16086427386558605, 0.16086427386558605, 0.5174071784032418]
probh = 0.9281685045093012
sampled gamma:
probh = 0.9281685045093012
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.811228001684916, 4.811228001684916, 4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1684134637041103, 0.1684134637041103, 0.1684134637041103, 0.49475960888766907]
probh = 0.9250501826059762
sampled gamma:
probh = 0.9250501826059762
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.700105935349557, 4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18928469829987307, 0.18928469829987307, 0.6214306034002539]
probh = 0.7698433704245123
sampled gamma:
probh = 0.7698433704245123
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update rho]
movable_units = [1, 4]
Si_iter[:, t] = [1, 2, 3, 1, 4]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 2  3  1  0
 1  4  4  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 2  3  1  0
 1  4  4  0
rho_tmp = [2, 2, 3, 1, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 2  3  1  0
 1  4  4  0
rho_tmp = [3, 2, 3, 1, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 2  3  1  0
 1  4  4  0
rho_tmp = [4, 2, 3, 1, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 2  3  1  0
 1  4  4  0
rho_tmp = [5, 2, 3, 1, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 3
Si_iter[:, t] = [1, 2, 1, 3, 4]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  4  0
 1  4  3  0
rho_tmp = [1, 2, 1, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  4  0
 1  4  3  0
rho_tmp = [1, 2, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  4  0
 1  4  3  0
rho_tmp = [1, 2, 1, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  4  0
 1  4  3  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 2, 3]

▶ iteration 26.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  2  0
 1  4  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 0.222022  4.32995  1.82168  0.0
 2.05012   3.99618  3.25554  0.0
 2.92748   4.96407  4.75788  0.0
 1.80036   4.04404  3.3954   0.0
 2.14035   3.4783   2.98095  0.0
sig2h_iter
5×4 Matrix{Float64}:
 4.93568   6.15521   2.91169  1.0
 0.672296  0.427124  3.49352  1.0
 1.27524   4.81256   1.24762  1.0
 0.837096  9.71356   2.12129  1.0
 1.70788   7.98588   2.70305  1.0
alpha_iter
4-element Vector{Float64}:
 0.011760460377184048
 0.3985481671253518
 0.5337761981941055
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  2  0
 1  4  3  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  2  0
 1  4  3  0
rho_tmp = [2, 1, 2, 2, 1]
Si_comp1 = [2, 1, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  2  0
 1  4  3  0
rho_tmp = [3, 1, 2, 2, 1]
Si_comp1 = [3, 1, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  2  0
 1  4  3  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  2  0
 1  4  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  2  0
 1  4  3  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  2  0
 1  4  3  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  2  0
 1  4  3  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  1  0
 2  3  2  0
 1  4  3  0
rho_tmp = [1, 1, 3, 2, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  1  0
 2  3  2  0
 1  4  3  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  1  0
 2  3  2  0
 1  4  3  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5]
After exp and normalization:
ph = [0.0, 1.0]
new_label = 2
Si_iter[:, t] = [1, 1, 1, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  1  0
 2  3  2  0
 1  4  3  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  1  0
 2  3  2  0
 1  4  3  0
rho_tmp = [1, 1, 1, 2, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  1  0
 2  3  2  0
 1  4  3  0
rho_tmp = [1, 1, 1, 2, 3]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18763781382561492, 0.18763781382561492, 0.6247243723487702]
probh = 0.7793226740173831
sampled gamma:
probh = 0.7793226740173831
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.837036039561302, 4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2056377848473934, 0.2056377848473934, 0.5887244303052133]
probh = 0.7631668668271068
sampled gamma:
probh = 0.7631668668271068
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.0416453621923845, 4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2463917294475933, 0.17873175528175547, 0.5748765152706512]
probh = 0.7875718981872464
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.132264559216373, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.31938198507206067, 0.6806180149279393]
probh = 0.4933093884327365
sampled gamma:
probh = 0.4933093884327365
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 2]
Si_red1 = [1, 1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [5.021142492881014, 4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.24349215718714418, 0.1766284150404322, 0.5798794277724236]
probh = 0.5333048592713463
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 1, 0]
												[update rho]
movable_units = [3, 5]
Si_iter[:, t] = [1, 1, 2, 3, 4]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  4  1  0
 2  3  2  0
 1  2  3  0
rho_tmp = [1, 1, 1, 3, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [2, 1, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  4  1  0
 2  3  2  0
 1  2  3  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [2, 1, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  4  1  0
 2  3  2  0
 1  2  3  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 3, 2]
Si_comp2 = [2, 1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  4  1  0
 2  3  2  0
 1  2  3  0
rho_tmp = [1, 1, 4, 3, 2]
Si_comp1 = [1, 4, 2]
Si_comp2 = [2, 1, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.5, 0.5]
new_label = 4
Si_iter[:, t] = [1, 1, 2, 3, 4]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  1  0
 2  3  2  0
 1  4  3  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [2, 1, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  1  0
 2  3  2  0
 1  4  3  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [2, 1, 3]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  1  0
 2  3  2  0
 1  4  3  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 2, 3]
Si_comp2 = [2, 1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  1  0
 2  3  2  0
 1  4  3  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 2, 4]
Si_comp2 = [2, 1, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.0, 0.5, 0.5]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.630780450086686, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18955129186518385, 0.17935357105104527, 0.6310951370837709]
probh = 0.8579548472065044
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.158072597092759, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.32501802132358387, 0.6749819786764162]
probh = 0.7788858667464135
sampled gamma:
probh = 0.7788858667464135
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.0416453621923845, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.30001370567070174, 0.6999862943292982]
probh = 0.62057873707154
sampled gamma:
probh = 0.62057873707154
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.132264559216373, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.31938198507206067, 0.6806180149279393]
probh = 0.7818838214419344
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.5989767958831764
sampled gamma:
probh = 0.5989767958831764
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update rho]
movable_units = [1, 3, 4, 5]
Si_iter[:, t] = [1, 2, 1, 2, 3]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  1  0
 2  3  2  0
 1  3  3  0
rho_tmp = [1, 2, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  1  0
 2  3  2  0
 1  3  3  0
rho_tmp = [2, 2, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  1  0
 2  3  2  0
 1  3  3  0
rho_tmp = [3, 2, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  1  0
 2  3  2  0
 1  3  3  0
rho_tmp = [4, 2, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 2, 1]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  3  0
 2  3  2  0
 1  3  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  3  0
 2  3  2  0
 1  3  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  3  0
 2  3  2  0
 1  3  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 2, 1]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  3  0
 2  3  2  0
 1  3  1  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  3  0
 2  3  2  0
 1  3  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  3  0
 2  3  2  0
 1  3  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  3  0
 2  3  2  0
 1  3  1  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 2, 1]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  3  0
 2  3  2  0
 1  3  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  3  0
 2  3  2  0
 1  3  1  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  3  0
 2  3  2  0
 1  3  1  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  3  0
 2  3  2  0
 1  3  1  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 2, 4]

▶ iteration 27.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  3  0
 2  3  2  0
 1  3  4  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
muh_iter
5×4 Matrix{Float64}:
  0.812979  4.32995  4.75788  0.0
  1.2331    2.91518  3.25554  0.0
  0.522177  4.96407  4.61551  0.0
 -0.499992  4.04404  2.64053  0.0
  2.14035   3.4783   2.98095  0.0
sig2h_iter
5×4 Matrix{Float64}:
 8.05802   4.82238   8.89489   1.0
 4.39608   0.398023  2.92589   1.0
 1.27524   5.46319   2.92917   1.0
 0.837096  9.71356   0.628304  1.0
 1.70788   7.98588   2.70305   1.0
alpha_iter
4-element Vector{Float64}:
 0.10737393122025081
 0.5893975149357089
 0.12403308192466544
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 1, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  3  0
 2  3  2  0
 1  3  4  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  3  0
 2  3  2  0
 1  3  4  0
rho_tmp = [2, 1, 1, 2, 1]
Si_comp1 = [2, 1, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  3  0
 2  3  2  0
 1  3  4  0
rho_tmp = [3, 1, 1, 2, 1]
Si_comp1 = [3, 1, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  3  0
 2  3  2  0
 1  3  4  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  3  0
 2  3  2  0
 1  3  4  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  3  0
 2  3  2  0
 1  3  4  0
rho_tmp = [1, 3, 1, 2, 1]
Si_comp1 = [1, 3, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  3  0
 2  3  2  0
 1  3  4  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  3  0
 2  3  2  0
 1  3  4  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 1  2  3  0
 2  3  2  0
 1  3  4  0
rho_tmp = [1, 1, 3, 2, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 3  3  2  0
 1  3  4  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [1, 1, 3]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 3  3  2  0
 1  3  4  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 3  3  2  0
 1  3  4  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 1, 3]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.5, 0.5]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 2  3  2  0
 1  3  4  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 2  3  2  0
 1  3  4  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 2  3  2  0
 1  3  4  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18763781382561492, 0.18763781382561492, 0.6247243723487702]
probh = 0.8843942235998551
sampled gamma:
probh = 0.8843942235998551
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.6594977059630871
sampled gamma:
probh = 0.6594977059630871
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.8582051510118712
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.5893975149357089
sampled gamma:
probh = 0.5893975149357089
gt = true
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.8601023153254334
sampled gamma:
probh = 0.8601023153254334
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update rho]
movable_units = [1, 2, 3, 5]
Si_iter[:, t] = [1, 1, 2, 3, 3]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 2  3  2  0
 2  3  4  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 2  3  2  0
 2  3  4  0
rho_tmp = [2, 1, 2, 3, 3]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 2  3  2  0
 2  3  4  0
rho_tmp = [3, 1, 2, 3, 3]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 2  3  2  0
 2  3  4  0
rho_tmp = [4, 1, 2, 3, 3]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 3]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 2  3  2  0
 2  3  4  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 2  3  2  0
 2  3  4  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 2  3  2  0
 2  3  4  0
rho_tmp = [1, 3, 2, 3, 3]
Si_comp1 = [3]
Si_comp2 = [2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  2  3  0
 2  3  2  0
 2  3  4  0
rho_tmp = [1, 4, 2, 3, 3]
Si_comp1 = [4]
Si_comp2 = [2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 3]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  3  3  0
 2  2  2  0
 2  2  4  0
rho_tmp = [1, 1, 1, 2, 2]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  3  3  0
 2  2  2  0
 2  2  4  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  3  3  0
 2  2  2  0
 2  2  4  0
rho_tmp = [1, 1, 3, 2, 2]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 2]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 2  2  2  0
 2  2  4  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 2  2  2  0
 2  2  4  0
rho_tmp = [1, 1, 1, 2, 2]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 2  2  2  0
 2  2  4  0
rho_tmp = [1, 1, 1, 2, 3]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23097802558886682, 0.7690219744111332]
probh = 0.38004733786815315
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.12403308192466544
sampled gamma:
probh = 0.12403308192466544
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.12403308192466544
sampled gamma:
probh = 0.12403308192466544
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.12403308192466544
sampled gamma:
probh = 0.12403308192466544
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.12403308192466544
sampled gamma:
probh = 0.12403308192466544
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 2, 4]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 1  1  2  0
 2  1  3  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 1  1  2  0
 2  1  3  0
 2  2  2  0
 2  1  1  0
rho_tmp = [2, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 1  1  2  0
 2  1  3  0
 2  2  2  0
 2  1  1  0
rho_tmp = [3, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  4  0
 1  1  2  0
 2  1  3  0
 2  2  2  0
 2  1  1  0
rho_tmp = [4, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 2, 1]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 3, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  2  0
 2  1  3  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 4, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 1]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  1  3  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  1  3  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  1  3  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 1]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  1  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  1  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  1  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 1]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  1  2  0
 2  2  3  0
 2  1  1  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  1  2  0
 2  2  3  0
 2  1  1  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  1  2  0
 2  2  3  0
 2  1  1  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  1  2  0
 2  2  3  0
 2  1  1  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 1]

▶ iteration 28.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  1  2  0
 2  2  3  0
 2  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
muh_iter
5×4 Matrix{Float64}:
  1.69861   4.32995  2.64053  0.0
  3.58094   4.96407  3.25554  0.0
  3.10979   2.91518  2.88484  0.0
 -0.499992  4.04404  4.75788  0.0
  2.14035   3.4783   2.98095  0.0
sig2h_iter
5×4 Matrix{Float64}:
 3.42224   8.85628   2.37767  1.0
 3.78021   6.87868   3.28043  1.0
 4.39608   0.398023  1.33256  1.0
 0.837096  9.71356   8.89489  1.0
 1.70788   7.98588   2.70305  1.0
alpha_iter
4-element Vector{Float64}:
 0.058520748791793836
 0.4930276256623708
 0.20848254552965417
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 2, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  1  2  0
 2  2  3  0
 2  1  1  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  1  2  0
 2  2  3  0
 2  1  1  0
rho_tmp = [2, 1, 2, 2, 2]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  1  2  0
 2  2  3  0
 2  1  1  0
rho_tmp = [3, 1, 2, 2, 2]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 1, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 1  1  2  0
 1  2  3  0
 1  1  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 1  1  2  0
 1  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  2  3  0
 1  1  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 1  1  2  0
 1  2  3  0
 1  1  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 1, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  1  2  0
 1  2  3  0
 1  1  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  1  2  0
 1  2  3  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  1  2  0
 1  2  3  0
 1  1  1  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [3]
Si_comp2 = [2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 1, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  1  2  0
 1  2  3  0
 1  1  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  1  2  0
 1  2  3  0
 1  1  1  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  1  2  0
 1  2  3  0
 1  1  1  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 1, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23097802558886682, 0.7690219744111332]
probh = 0.8080736336091225
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.7897687303036712
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.8039386412919914
sampled gamma:
probh = 0.8039386412919914
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25395099810962674, 0.7460490018903733]
probh = 0.5658828598272428
sampled gamma:
probh = 0.5658828598272428
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.806398079231702
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update rho]
movable_units = [1, 2, 4, 5]
Si_iter[:, t] = [1, 1, 1, 2, 1]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  1  2  0
 1  2  3  0
 3  1  1  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  1  2  0
 1  2  3  0
 3  1  1  0
rho_tmp = [2, 1, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  1  2  0
 1  2  3  0
 3  1  1  0
rho_tmp = [3, 1, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  2  2  0
 1  3  3  0
 3  2  1  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  2  2  0
 1  3  3  0
 3  2  1  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  2  2  0
 1  3  3  0
 3  2  1  0
rho_tmp = [1, 3, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  2  2  0
 1  3  3  0
 3  2  1  0
rho_tmp = [1, 4, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 2, 3]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  2  0
 1  2  3  0
 3  3  1  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  2  0
 1  2  3  0
 3  3  1  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  2  0
 1  2  3  0
 3  3  1  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  2  0
 1  2  3  0
 3  3  1  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 1, 3]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  2  0
 1  1  3  0
 3  3  1  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  2  0
 1  1  3  0
 3  3  1  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  2  0
 1  1  3  0
 3  3  1  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  2  0
 1  1  3  0
 3  3  1  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 1, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.20848254552965417
sampled gamma:
probh = 0.20848254552965417
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.20848254552965417
sampled gamma:
probh = 0.20848254552965417
gt = true
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.2566642203078039
sampled gamma:
probh = 0.2566642203078039
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25395099810962674, 0.7460490018903733]
probh = 0.2609315145103858
sampled gamma:
probh = 0.2609315145103858
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.5301055683690141
sampled gamma:
probh = 0.5301055683690141
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update rho]
movable_units = [1, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 3, 1]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  2  0
 1  1  3  0
 3  2  1  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  2  0
 1  1  3  0
 3  2  1  0
rho_tmp = [2, 1, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  2  0
 1  1  3  0
 3  2  1  0
rho_tmp = [3, 1, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  2  0
 1  1  3  0
 3  2  1  0
rho_tmp = [4, 1, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 1]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  3  0
 1  1  2  0
 3  2  1  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  3  0
 1  1  2  0
 3  2  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  3  0
 1  1  2  0
 3  2  1  0
rho_tmp = [1, 1, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 1]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  2  0
 1  1  2  0
 3  2  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  2  0
 1  1  2  0
 3  2  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  2  0
 1  1  2  0
 3  2  1  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 1, 1]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  2  0
 1  1  1  0
 3  2  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  2  0
 1  1  1  0
 3  2  1  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  2  0
 1  1  1  0
 3  2  1  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 1, 2]

▶ iteration 29.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  2  0
 1  1  1  0
 3  2  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
muh_iter
5×4 Matrix{Float64}:
  1.58717   4.4141   2.64053  0.0
  2.09014   4.96407  2.88484  0.0
  4.94591   4.32995  3.25554  0.0
 -0.499992  4.04404  4.75788  0.0
  2.14035   3.4783   2.98095  0.0
sig2h_iter
5×4 Matrix{Float64}:
  3.03021   4.26956   1.28082  1.0
  0.970045  4.6977    1.02498  1.0
 10.0107    0.744726  3.28043  1.0
  0.837096  9.71356   8.89489  1.0
  1.70788   7.98588   2.70305  1.0
alpha_iter
4-element Vector{Float64}:
 0.1654006371061409
 0.05104268217592196
 0.47634219692336577
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 1, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  2  0
 1  1  1  0
 3  2  2  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  2  0
 1  1  1  0
 3  2  2  0
rho_tmp = [2, 1, 2, 1, 3]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  2  0
 1  1  1  0
 3  2  2  0
rho_tmp = [3, 1, 2, 1, 3]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 2  3  2  0
 1  1  1  0
 3  2  2  0
rho_tmp = [4, 1, 2, 1, 3]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 2, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 2  1  1  0
 3  2  2  0
rho_tmp = [1, 1, 1, 2, 3]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 2  1  1  0
 3  2  2  0
rho_tmp = [1, 2, 1, 2, 3]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 2  1  1  0
 3  2  2  0
rho_tmp = [1, 3, 1, 2, 3]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 2  1  1  0
 3  2  2  0
rho_tmp = [1, 4, 1, 2, 3]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 2, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 2  1  1  0
 3  2  2  0
rho_tmp = [1, 2, 1, 2, 3]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 2  1  1  0
 3  2  2  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 2  1  1  0
 3  2  2  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 1  3  2  0
 2  1  1  0
 3  2  2  0
rho_tmp = [1, 2, 4, 2, 3]
Si_comp1 = [4]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 2, 4]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 2  1  1  0
 4  2  2  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 2  1  1  0
 4  2  2  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 2  1  1  0
 4  2  2  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 2  1  1  0
 4  2  2  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 2  1  1  0
 4  2  2  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 4]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  1  1  0
 4  2  2  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  1  1  0
 4  2  2  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  1  1  0
 4  2  2  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  1  1  0
 4  2  2  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  1  1  0
 4  2  2  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 4, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23097802558886682, 0.7690219744111332]
probh = 0.06537130702303075
sampled gamma:
probh = 0.06537130702303075
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.17203422476413396
sampled gamma:
probh = 0.17203422476413396
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.06586681982838855
sampled gamma:
probh = 0.06586681982838855
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25395099810962674, 0.7460490018903733]
probh = 0.06724890571871546
sampled gamma:
probh = 0.06724890571871546
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.18724117753091796
sampled gamma:
probh = 0.18724117753091796
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update rho]
movable_units = [1, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 1, 2]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  1  1  0
 2  2  2  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  1  1  0
 2  2  2  0
rho_tmp = [2, 2, 3, 1, 2]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  1  1  0
 2  2  2  0
rho_tmp = [3, 2, 3, 1, 2]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 3  3  2  0
 4  1  1  0
 2  2  2  0
rho_tmp = [4, 2, 3, 1, 2]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 1]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  3  2  0
 4  2  1  0
 2  1  2  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  3  2  0
 4  2  1  0
 2  1  2  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  3  2  0
 4  2  1  0
 2  1  2  0
rho_tmp = [1, 1, 3, 2, 1]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 1]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  2  0
 4  2  1  0
 2  1  2  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  2  0
 4  2  1  0
 2  1  2  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 2
Si_iter[:, t] = [1, 1, 1, 2, 1]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  2  0
 4  2  1  0
 2  1  2  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  2  0
 4  2  1  0
 2  1  2  0
rho_tmp = [1, 1, 1, 2, 2]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  2  0
 4  2  1  0
 2  1  2  0
rho_tmp = [1, 1, 1, 2, 3]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 1, 1, 2, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23097802558886682, 0.7690219744111332]
probh = 0.797498195432177
sampled gamma:
probh = 0.797498195432177
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.7784611860170382
sampled gamma:
probh = 0.7784611860170382
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.0416453621923845, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.30001370567070174, 0.6999862943292982]
probh = 0.5651260531087438
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.132264559216373, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.31938198507206067, 0.6806180149279393]
probh = 0.7401340737550172
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.021142492881014, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2957257229117288, 0.7042742770882712]
probh = 0.563624582585544
sampled gamma:
probh = 0.563624582585544
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 0, 1]
												[update rho]
movable_units = [3, 4]
Si_iter[:, t] = [1, 1, 2, 1, 2]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  2  0
 4  2  1  0
 2  3  2  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  2  0
 4  2  1  0
 2  3  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  2  0
 4  2  1  0
 2  3  2  0
rho_tmp = [1, 1, 3, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 2]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 4  2  1  0
 2  3  2  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 4  2  1  0
 2  3  2  0
rho_tmp = [1, 1, 1, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 4  2  1  0
 2  3  2  0
rho_tmp = [1, 1, 1, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 2]

▶ iteration 30.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 4  2  1  0
 2  3  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 1.82354   4.96407  2.64053  0.0
 1.76101   4.36612  2.88484  0.0
 3.45407   3.76217  3.25554  0.0
 0.888361  4.04404  4.75788  0.0
 2.14035   3.4783   2.98095  0.0
sig2h_iter
5×4 Matrix{Float64}:
 5.34256   11.4141   1.55979   1.0
 2.26138    4.33174  0.728315  1.0
 0.735424   6.38361  3.28043   1.0
 0.848021   9.71356  8.89489   1.0
 1.70788    7.98588  2.70305   1.0
alpha_iter
4-element Vector{Float64}:
 0.2082748755182786
 0.3341969002776232
 0.5499000698330595
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  1  1  0
 3  1  1  0
 1  2  1  0
 2  3  2  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  1  1  0
 3  1  1  0
 1  2  1  0
 2  3  2  0
rho_tmp = [2, 2, 3, 1, 2]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  1  1  0
 3  1  1  0
 1  2  1  0
 2  3  2  0
rho_tmp = [3, 2, 3, 1, 2]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  1  1  0
 3  1  1  0
 1  2  1  0
 2  3  2  0
rho_tmp = [4, 2, 3, 1, 2]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 4  2  1  0
 2  3  2  0
rho_tmp = [1, 1, 3, 4, 2]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 4  2  1  0
 2  3  2  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 4  2  1  0
 2  3  2  0
rho_tmp = [1, 3, 3, 4, 2]
Si_comp1 = [3]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 4  2  1  0
 2  3  2  0
rho_tmp = [1, 4, 3, 4, 2]
Si_comp1 = [4]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 4  2  1  0
 2  3  2  0
rho_tmp = [1, 5, 3, 4, 2]
Si_comp1 = [5]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 4]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  1  1  0
 3  2  1  0
 4  3  2  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  1  1  0
 3  2  1  0
 4  3  2  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  1  1  0
 3  2  1  0
 4  3  2  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  1  1  0
 3  2  1  0
 4  3  2  0
rho_tmp = [1, 2, 4, 3, 4]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  1  1  0
 3  2  1  0
 4  3  2  0
rho_tmp = [1, 2, 5, 3, 4]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 3  2  1  0
 4  3  2  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 3  2  1  0
 4  3  2  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 3  2  1  0
 4  3  2  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 3  2  1  0
 4  3  2  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 3  2  1  0
 4  3  2  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 2, 4]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 2  2  1  0
 4  3  2  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 2  2  1  0
 4  3  2  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 2  2  1  0
 4  3  2  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 2  2  1  0
 4  3  2  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 2, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23097802558886682, 0.7690219744111332]
probh = 0.6848538720689665
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.3341969002776232
sampled gamma:
probh = 0.3341969002776232
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.3341969002776232
sampled gamma:
probh = 0.3341969002776232
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.3341969002776232
sampled gamma:
probh = 0.3341969002776232
gt = true
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.3957103963107413
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update rho]
movable_units = [1, 2, 3, 5]
Si_iter[:, t] = [1, 1, 1, 2, 3]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 2  2  1  0
 2  3  2  0
rho_tmp = [1, 1, 1, 2, 3]
Si_comp1 = [1, 1, 3]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 2  2  1  0
 2  3  2  0
rho_tmp = [2, 1, 1, 2, 3]
Si_comp1 = [2, 1, 3]
Si_comp2 = [1, 1, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 2  2  1  0
 2  3  2  0
rho_tmp = [3, 1, 1, 2, 3]
Si_comp1 = [3, 1, 3]
Si_comp2 = [1, 1, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 2  2  1  0
 2  3  2  0
rho_tmp = [4, 1, 1, 2, 3]
Si_comp1 = [4, 1, 3]
Si_comp2 = [1, 1, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 3]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 2  2  1  0
 2  3  2  0
rho_tmp = [1, 1, 1, 2, 3]
Si_comp1 = [1, 1, 3]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 2  2  1  0
 2  3  2  0
rho_tmp = [1, 2, 1, 2, 3]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 1, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 2  2  1  0
 2  3  2  0
rho_tmp = [1, 3, 1, 2, 3]
Si_comp1 = [1, 3, 3]
Si_comp2 = [1, 1, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 2  2  1  0
 2  3  2  0
rho_tmp = [1, 4, 1, 2, 3]
Si_comp1 = [1, 4, 3]
Si_comp2 = [1, 1, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 3]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 2  2  1  0
 2  3  2  0
rho_tmp = [1, 1, 1, 2, 3]
Si_comp1 = [1, 1, 3]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 2  2  1  0
 2  3  2  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 1, 3]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 2  2  1  0
 2  3  2  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = [1, 1, 3]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  1  1  0
 2  2  1  0
 2  3  2  0
rho_tmp = [1, 1, 4, 2, 3]
Si_comp1 = [1, 1, 3]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 2  3  1  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [1, 1, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 2  3  1  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 2  3  1  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 1, 3]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 2  3  1  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = [1, 1, 4]
Si_comp2 = [1, 1, 2]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.007117550135875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.29281311194311704, 0.7071868880568829]
probh = 0.80666556661901
sampled gamma:
probh = 0.80666556661901
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.158072597092759, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.32501802132358387, 0.6749819786764162]
probh = 0.7898699344676147
sampled gamma:
probh = 0.7898699344676147
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.926122790119647, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27632690354652595, 0.723673096453474]
probh = 0.8155429776304386
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.016741987143638, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.29481004528354227, 0.7051899547164576]
probh = 0.8056033733774661
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.021142492881014, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2957257229117288, 0.7042742770882712]
probh = 0.6343337830692888
sampled gamma:
probh = 0.6343337830692888
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 0, 0]
												[update rho]
movable_units = [3, 4, 5]
Si_iter[:, t] = [1, 1, 1, 1, 2]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 2  3  1  0
 2  2  2  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 2  3  1  0
 2  2  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  1  0
 2  3  1  0
 2  2  2  0
rho_tmp = [1, 1, 3, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 1, 2]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  1  0
 2  2  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  1  0
 2  2  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  1  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [1, 1, 2, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 3, 2]

▶ iteration 31.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 3  2  2  0
 2  3  3  0
 2  2  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
muh_iter
5×4 Matrix{Float64}:
 2.07466  4.96407  2.64053  0.0
 1.86969  3.76217  2.88484  0.0
 1.96613  4.36612  2.64853  0.0
 1.76101  4.04404  4.75788  0.0
 2.14035  3.4783   2.98095  0.0
sig2h_iter
5×4 Matrix{Float64}:
 1.0446    3.18168  4.82134  1.0
 3.36983   5.82099  2.51954  1.0
 0.269608  4.51461  1.34121  1.0
 2.26138   9.71356  8.89489  1.0
 1.70788   7.98588  2.70305  1.0
alpha_iter
4-element Vector{Float64}:
 0.22303102231089425
 0.1520841802508579
 0.5219301145968431
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 2, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  1  1  0
 1  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  1  1  0
 1  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [2, 2, 1, 2, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  1  1  0
 1  2  2  0
 2  3  3  0
 2  2  2  0
rho_tmp = [3, 2, 1, 2, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 1, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 1  3  3  0
 1  2  2  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 1  3  3  0
 1  2  2  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  1  1  0
 2  2  2  0
 1  3  3  0
 1  2  2  0
rho_tmp = [1, 3, 2, 1, 1]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 1, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 1  3  3  0
 1  2  2  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 1  3  3  0
 1  2  2  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 1  3  3  0
 1  2  2  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 1, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 1  3  3  0
 1  2  2  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 1  3  3  0
 1  2  2  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 1  3  3  0
 1  2  2  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [3]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  3  3  0
 1  2  2  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  3  3  0
 1  2  2  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  1  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  3  3  0
 1  2  2  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2]
Si_comp2 = [3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 2, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23097802558886682, 0.7690219744111332]
probh = 0.18912412545219937
sampled gamma:
probh = 0.18912412545219937
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.1948551333804449
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.4306105436915774
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.1520841802508579
sampled gamma:
probh = 0.1520841802508579
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.1520841802508579
sampled gamma:
probh = 0.1520841802508579
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  3  3  0
 3  2  2  0
rho_tmp = [2, 1, 2, 3, 2]
Si_comp1 = [2, 1]
Si_comp2 = [1, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  3  3  0
 3  2  2  0
rho_tmp = [3, 1, 2, 3, 2]
Si_comp1 = [3, 1]
Si_comp2 = [1, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  3  3  0
 3  2  2  0
rho_tmp = [4, 1, 2, 3, 2]
Si_comp1 = [4, 1]
Si_comp2 = [1, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  3  3  0
 3  2  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  3  3  0
 3  2  2  0
rho_tmp = [1, 3, 2, 3, 2]
Si_comp1 = [1, 3]
Si_comp2 = [1, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  3  3  0
 3  2  2  0
rho_tmp = [1, 4, 2, 3, 2]
Si_comp1 = [1, 4]
Si_comp2 = [1, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 1, 3, 2]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  3  3  0
 3  2  2  0
rho_tmp = [1, 1, 4, 3, 2]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 1, 2, 3, 4]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  4  3  0
 3  3  2  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  4  3  0
 3  3  2  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  4  3  0
 3  3  2  0
rho_tmp = [1, 1, 2, 3, 3]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  4  3  0
 3  3  2  0
rho_tmp = [1, 1, 2, 4, 3]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  2  3  0
 3  3  2  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  2  3  0
 3  3  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  2  3  0
 3  3  2  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 1]
Si_comp2 = [1, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 1, 2, 2, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23097802558886682, 0.7690219744111332]
probh = 0.8253767962452238
sampled gamma:
probh = 0.8253767962452238
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.8083307402692416
sampled gamma:
probh = 0.8083307402692416
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.5886758758314394
sampled gamma:
probh = 0.5886758758314394
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25395099810962674, 0.7460490018903733]
probh = 0.5940517547409009
sampled gamma:
probh = 0.5940517547409009
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.5875071332843529
sampled gamma:
probh = 0.5875071332843529
gt = false
gamma_iter[:, t] = Bool[1, 0, 0, 0, 0]
												[update rho]
movable_units = [2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 3, 2]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  2  3  0
 3  3  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  2  3  0
 3  3  2  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  2  3  0
 3  3  2  0
rho_tmp = [1, 3, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  1  0
 2  2  2  0
 2  2  3  0
 3  3  2  0
rho_tmp = [1, 4, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  2  3  0
 2  2  4  0
 3  3  3  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  2  3  0
 2  2  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  2  3  0
 2  2  4  0
 3  3  3  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  2  3  0
 2  2  4  0
 3  3  3  0
rho_tmp = [1, 2, 4, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  2  3  0
 2  2  4  0
 3  3  3  0
rho_tmp = [1, 2, 5, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 3, 4]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  2  2  0
 2  2  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  2  2  0
 2  2  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  2  2  0
 2  2  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  2  2  0
 2  2  4  0
 3  3  3  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 3]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  2  2  0
 2  2  3  0
 3  3  3  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  2  2  0
 2  2  3  0
 3  3  3  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  2  2  0
 2  2  3  0
 3  3  3  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  2  2  0
 2  2  3  0
 3  3  3  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 2, 3, 4]

▶ iteration 32.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  2  2  0
 2  2  3  0
 3  3  4  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
muh_iter
5×4 Matrix{Float64}:
 2.92833  4.96407  2.64053  0.0
 2.21349  3.42669  3.51782  0.0
 3.2695   4.45529  2.88484  0.0
 1.66378  4.36612  4.06847  0.0
 2.14035  3.4783   2.98095  0.0
sig2h_iter
5×4 Matrix{Float64}:
 1.39235  7.00501  0.860685  1.0
 1.71601  6.08444  1.67374   1.0
 2.84907  3.90253  0.897871  1.0
 2.26138  4.51461  1.26928   1.0
 1.70788  7.98588  2.70305   1.0
alpha_iter
4-element Vector{Float64}:
 0.1564935425343246
 0.021202945791121055
 0.41316249633017693
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  1  2  0
 2  2  2  0
 2  2  3  0
 1  3  4  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  1  2  0
 2  2  2  0
 2  2  3  0
 1  3  4  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  1  2  0
 2  2  2  0
 2  2  3  0
 1  3  4  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  2  2  0
 2  2  3  0
 3  3  4  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  2  2  0
 2  2  3  0
 3  3  4  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  2  2  0
 2  2  3  0
 3  3  4  0
rho_tmp = [1, 3, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 2  2  2  0
 2  2  3  0
 3  3  4  0
rho_tmp = [1, 4, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 4, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 5, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  2  2  0
 3  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 4]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  2  2  0
 4  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  2  2  0
 4  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  2  2  0
 4  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  2  2  0
 4  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  2  2  0
 4  2  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 4, 5]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 4]
► time 2
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.021202945791121055
sampled gamma:
probh = 0.021202945791121055
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.021202945791121055
sampled gamma:
probh = 0.021202945791121055
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.021202945791121055
sampled gamma:
probh = 0.021202945791121055
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.021202945791121055
sampled gamma:
probh = 0.021202945791121055
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.021202945791121055
sampled gamma:
probh = 0.021202945791121055
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  2  2  0
 4  2  3  0
 4  3  4  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  2  2  0
 4  2  3  0
 4  3  4  0
rho_tmp = [2, 1, 2, 2, 3]
Si_comp1 = [2]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  2  2  0
 4  2  3  0
 4  3  4  0
rho_tmp = [3, 1, 2, 2, 3]
Si_comp1 = [3]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  1  2  0
 3  2  2  0
 4  2  3  0
 4  3  4  0
rho_tmp = [4, 1, 2, 2, 3]
Si_comp1 = [4]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 1, 3]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  3  2  0
 3  1  2  0
 4  1  3  0
 4  2  4  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  3  2  0
 3  1  2  0
 4  1  3  0
 4  2  4  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  3  2  0
 3  1  2  0
 4  1  3  0
 4  2  4  0
rho_tmp = [1, 3, 1, 1, 2]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 1, 1, 3]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  2  0
 4  1  3  0
 4  3  4  0
rho_tmp = [1, 2, 1, 1, 3]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  2  0
 4  1  3  0
 4  3  4  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  2  0
 4  1  3  0
 4  3  4  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  1  2  0
 4  1  3  0
 4  3  4  0
rho_tmp = [1, 2, 4, 1, 3]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 1, 3]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 4  1  3  0
 4  3  4  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 4  1  3  0
 4  3  4  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 4  1  3  0
 4  3  4  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 4  1  3  0
 4  3  4  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 1, 3]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 4  1  3  0
 4  3  4  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 4  1  3  0
 4  3  4  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 4  1  3  0
 4  3  4  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = [1]
Si_comp2 = [1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 1, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.41316249633017693
sampled gamma:
probh = 0.41316249633017693
gt = true
gamma_iter[:, t] = Bool[1, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.48717140270744097
sampled gamma:
probh = 0.48717140270744097
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19170232997542352, 0.19170232997542352, 0.616595340049153]
probh = 0.7859871674484249
sampled gamma:
probh = 0.7859871674484249
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.811228001684916, 4.755927459167184, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20475153441693866, 0.19373605167501418, 0.6015124139080472]
probh = 0.539269238046793
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.700105935349557, 4.644805392831826, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.191232086979981, 0.18094394061844687, 0.6278239724015722]
probh = 0.5286158109733953
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update rho]
movable_units = [4, 5]
Si_iter[:, t] = [1, 2, 2, 3, 4]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 4  1  4  0
 4  1  3  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 4  1  4  0
 4  1  3  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 4  1  4  0
 4  1  3  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 4  1  4  0
 4  1  3  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 2, 3, 4]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 4  1  3  0
 4  1  4  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 4  1  3  0
 4  1  4  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 4  1  3  0
 4  1  4  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 4  1  3  0
 4  1  4  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 3]

▶ iteration 33.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 4  1  3  0
 4  1  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
muh_iter
5×4 Matrix{Float64}:
  1.61511   3.42669  2.64053  0.0
  1.0273    4.83337  3.51782  0.0
  0.950886  4.45529  1.28635  0.0
 -0.552459  4.36612  4.06847  0.0
  2.14035   3.4783   2.98095  0.0
sig2h_iter
5×4 Matrix{Float64}:
  2.67802   3.13097  1.73804   1.0
  2.99922   5.39111  2.66725   1.0
  0.279572  3.90253  0.345857  1.0
 10.302     4.51461  1.26928   1.0
  1.70788   7.98588  2.70305   1.0
alpha_iter
4-element Vector{Float64}:
 0.029422216808873015
 0.05022190018589778
 0.6796034076380343
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 4, 4]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  2  2  0
 1  1  3  0
 1  1  3  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  2  2  0
 1  1  3  0
 1  1  3  0
rho_tmp = [2, 2, 3, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  2  2  0
 1  1  3  0
 1  1  3  0
rho_tmp = [3, 2, 3, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  2  2  0
 1  1  3  0
 1  1  3  0
rho_tmp = [4, 2, 3, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 1, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  2  0
 2  2  2  0
 1  1  3  0
 1  1  3  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  2  0
 2  2  2  0
 1  1  3  0
 1  1  3  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  2  0
 2  2  2  0
 1  1  3  0
 1  1  3  0
rho_tmp = [1, 3, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 1, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  1  3  0
 1  1  3  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  1  3  0
 1  1  3  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  1  3  0
 1  1  3  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 1, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  1  3  0
 1  1  3  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  1  3  0
 1  1  3  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  1  3  0
 1  1  3  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  1  3  0
 1  1  3  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  3  0
 1  1  3  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  3  0
 1  1  3  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  3  0
 1  1  3  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  3  0
 1  1  3  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.05022190018589778
sampled gamma:
probh = 0.05022190018589778
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.05022190018589778
sampled gamma:
probh = 0.05022190018589778
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.05022190018589778
sampled gamma:
probh = 0.05022190018589778
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.05022190018589778
sampled gamma:
probh = 0.05022190018589778
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.05022190018589778
sampled gamma:
probh = 0.05022190018589778
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 1, 1]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  3  0
 1  1  3  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  3  0
 1  1  3  0
rho_tmp = [2, 2, 2, 1, 1]
Si_comp1 = [2, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  3  0
 1  1  3  0
rho_tmp = [3, 2, 2, 1, 1]
Si_comp1 = [3, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.5]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 1, 1]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  3  0
 1  1  3  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  3  0
 1  1  3  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  3  0
 1  1  3  0
rho_tmp = [1, 3, 2, 1, 1]
Si_comp1 = [1, 3, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 1, 1]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  3  0
 1  1  3  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  3  0
 1  1  3  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  3  0
 1  1  3  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 1, 1]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  3  0
 1  1  3  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  3  0
 1  1  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  1  3  0
 1  1  3  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  2  3  0
 1  1  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  2  3  0
 1  1  3  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  2  3  0
 1  1  3  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 2]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18763781382561492, 0.18763781382561492, 0.6247243723487702]
probh = 0.9187282217616586
sampled gamma:
probh = 0.9187282217616586
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2056377848473934, 0.2056377848473934, 0.5887244303052133]
probh = 0.9116209081188567
sampled gamma:
probh = 0.9116209081188567
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19170232997542352, 0.19170232997542352, 0.616595340049153]
probh = 0.9171136720578437
sampled gamma:
probh = 0.9171136720578437
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.811228001684916, 4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20252067145563615, 0.20252067145563615, 0.5949586570887277]
probh = 0.780950354296032
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2]
Si_red1 = [1, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.700105935349557, 4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18928469829987307, 0.18928469829987307, 0.6214306034002539]
probh = 0.7734124125298432
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 0, 0, 0]
												[update rho]
movable_units = [3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 3, 3]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  2  3  0
 1  2  3  0
rho_tmp = [1, 2, 1, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  2  3  0
 1  2  3  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  2  3  0
 1  2  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  2  3  0
 1  2  3  0
rho_tmp = [1, 2, 4, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 3, 3]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  1  0
 2  2  3  0
 1  2  3  0
rho_tmp = [1, 2, 1, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  1  0
 2  2  3  0
 1  2  3  0
rho_tmp = [1, 2, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  1  0
 2  2  3  0
 1  2  3  0
rho_tmp = [1, 2, 1, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  1  0
 2  2  3  0
 1  2  3  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 1, 3]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  1  0
 2  2  1  0
 1  2  3  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  1  0
 2  2  1  0
 1  2  3  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  1  0
 2  2  1  0
 1  2  3  0
rho_tmp = [1, 2, 1, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 1, 1]

▶ iteration 34.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  1  0
 2  2  1  0
 1  2  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
muh_iter
5×4 Matrix{Float64}:
 1.89875   3.42669  2.64053  0.0
 2.77256   4.83337  3.51782  0.0
 0.702521  4.45529  1.28635  0.0
 1.61511   4.36612  4.06847  0.0
 2.14035   3.4783   2.98095  0.0
sig2h_iter
5×4 Matrix{Float64}:
 2.58991    1.46767  2.61583   1.0
 0.851437  13.9883   1.03349   1.0
 0.319674   3.90253  0.345857  1.0
 2.67802    4.51461  1.26928   1.0
 1.70788    7.98588  2.70305   1.0
alpha_iter
4-element Vector{Float64}:
 0.024983926197385084
 0.20107933078922344
 0.5158438677891497
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  1  0
 2  2  1  0
 1  2  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  1  0
 2  2  1  0
 1  2  1  0
rho_tmp = [2, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  1  0
 2  2  1  0
 1  2  1  0
rho_tmp = [3, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  1  0
 2  2  1  0
 1  2  1  0
rho_tmp = [4, 2, 3, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 1, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  2  1  0
 1  2  1  0
 3  2  1  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  2  1  0
 1  2  1  0
 3  2  1  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  2  1  0
 1  2  1  0
 3  2  1  0
rho_tmp = [1, 3, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  2  1  0
 1  2  1  0
 3  2  1  0
rho_tmp = [1, 4, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 1, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 1  2  1  0
 3  2  1  0
rho_tmp = [1, 2, 1, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 1  2  1  0
 3  2  1  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 1  2  1  0
 3  2  1  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 1  2  1  0
 3  2  1  0
rho_tmp = [1, 2, 4, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 1, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 1  2  1  0
 3  2  1  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 1  2  1  0
 3  2  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 1  2  1  0
 3  2  1  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 1  2  1  0
 3  2  1  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 3  2  1  0
 3  2  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 3  2  1  0
 3  2  1  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 3  2  1  0
 3  2  1  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 3  2  1  0
 3  2  1  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 3, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.20107933078922344
sampled gamma:
probh = 0.20107933078922344
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.20107933078922344
sampled gamma:
probh = 0.20107933078922344
gt = true
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.5148517416570962
sampled gamma:
probh = 0.5148517416570962
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.132264559216373, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.31938198507206067, 0.6806180149279393]
probh = 0.4407312875388401
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.021142492881014, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2957257229117288, 0.7042742770882712]
probh = 0.45977728600076856
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update rho]
movable_units = [1, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 2]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  2  1  0
 2  1  2  0
 2  1  1  0
 3  1  1  0
 1  1  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1]
Si_comp2 = [1, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  2  1  0
 2  1  2  0
 2  1  1  0
 3  1  1  0
 1  1  1  0
rho_tmp = [2, 1, 1, 1, 1]
Si_comp1 = [2, 1]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5]
After exp and normalization:
ph = [0.0, 1.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 2]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 3  2  1  0
 1  2  1  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 3  2  1  0
 1  2  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 3  2  1  0
 1  2  1  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 3  3  1  0
 1  2  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 3  3  1  0
 1  2  1  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 3  3  1  0
 1  2  1  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 3  3  1  0
 1  2  1  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 3, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23097802558886682, 0.7690219744111332]
probh = 0.8218349763562685
sampled gamma:
probh = 0.8218349763562685
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.5158438677891497
sampled gamma:
probh = 0.5158438677891497
gt = true
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.5827600705737653
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25395099810962674, 0.7460490018903733]
probh = 0.5881591753151509
sampled gamma:
probh = 0.5881591753151509
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.5815864662958932
sampled gamma:
probh = 0.5815864662958932
gt = true
gamma_iter[:, t] = Bool[0, 1, 0, 0, 1]
												[update rho]
movable_units = [1, 3, 4]
Si_iter[:, t] = [1, 2, 1, 1, 1]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 3  3  1  0
 1  1  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 3  3  1  0
 1  1  1  0
rho_tmp = [2, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 3  3  1  0
 1  1  1  0
rho_tmp = [3, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 2]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  2  0
 1  1  2  0
rho_tmp = [1, 1, 1, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  2  0
 1  1  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  2  0
 1  1  2  0
rho_tmp = [1, 1, 3, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 2]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  2  0
 1  1  2  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  2  0
 1  1  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  2  0
 1  1  2  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 2]

▶ iteration 35.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  2  0
 1  1  2  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 1.08665  4.17851  3.51782  0.0
 1.86002  4.83337  2.64053  0.0
 2.53898  4.55407  1.28635  0.0
 1.61511  4.36612  4.06847  0.0
 2.14035  3.4783   2.98095  0.0
sig2h_iter
5×4 Matrix{Float64}:
 2.5631   14.2668   2.45671   1.0
 1.83095   8.31325  0.722646  1.0
 2.37247   5.21488  0.345857  1.0
 2.67802   4.51461  1.26928   1.0
 1.70788   7.98588  2.70305   1.0
alpha_iter
4-element Vector{Float64}:
 0.2763475961124369
 0.7299254194006219
 0.4059236222488853
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 3, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  2  0
 1  1  2  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  2  0
 1  1  2  0
rho_tmp = [2, 2, 2, 3, 1]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  2  0
 1  1  2  0
rho_tmp = [3, 2, 2, 3, 1]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 3  3  2  0
 1  1  2  0
rho_tmp = [4, 2, 2, 3, 1]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 1, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  2  0
 3  1  2  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = [1, 2]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  2  0
 3  1  2  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  2  0
 3  1  2  0
rho_tmp = [1, 3, 2, 1, 3]
Si_comp1 = [3, 2]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  2  0
 3  1  2  0
rho_tmp = [1, 4, 2, 1, 3]
Si_comp1 = [4, 2]
Si_comp2 = [2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 1, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  2  0
 3  1  2  0
rho_tmp = [1, 2, 1, 1, 3]
Si_comp1 = [2, 1]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  2  0
 3  1  2  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  2  0
 3  1  2  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [2, 3]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  2  0
 3  1  2  0
rho_tmp = [1, 2, 4, 1, 3]
Si_comp1 = [2, 4]
Si_comp2 = [2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 1, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  2  0
 3  1  2  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  2  0
 3  1  2  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  2  0
 3  1  2  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  2  0
 3  1  2  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 1, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  2  0
 3  1  2  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  2  0
 3  1  2  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  2  0
 3  1  2  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 1, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18763781382561492, 0.18763781382561492, 0.6247243723487702]
probh = 0.9350805809742226
sampled gamma:
probh = 0.9350805809742226
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2056377848473934, 0.2056377848473934, 0.5887244303052133]
probh = 0.9292932429982143
sampled gamma:
probh = 0.9292932429982143
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19170232997542352, 0.19170232997542352, 0.616595340049153]
probh = 0.9337674687227403
sampled gamma:
probh = 0.9337674687227403
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.811228001684916, 4.755927459167184, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20475153441693866, 0.19373605167501418, 0.6015124139080472]
probh = 0.8179548377457019
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 4.644805392831826, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.191232086979981, 0.18094394061844687, 0.6278239724015722]
probh = 0.9339192001702816
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update rho]
movable_units = [4, 5]
Si_iter[:, t] = [1, 2, 2, 3, 1]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  2  0
 2  1  2  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [2, 1]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  2  0
 2  1  2  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 1]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 1  3  2  0
 2  1  2  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [2, 1]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 1  2  2  0
 2  1  2  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 1]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 1  2  2  0
 2  1  2  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [2, 2]
Si_comp2 = [1, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 1  2  2  0
 2  1  2  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.5]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 2, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18763781382561492, 0.18763781382561492, 0.6247243723487702]
probh = 0.7845529380434354
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.47969578687470776
sampled gamma:
probh = 0.47969578687470776
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.7423356472592116
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25395099810962674, 0.7460490018903733]
probh = 0.7290427035175687
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 1]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.4059236222488853
sampled gamma:
probh = 0.4059236222488853
gt = true
gamma_iter[:, t] = Bool[0, 0, 0, 0, 1]
												[update rho]
movable_units = [1, 2, 3, 4]
Si_iter[:, t] = [1, 1, 2, 2, 2]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 1  2  2  0
 2  3  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 1  2  2  0
 2  3  2  0
rho_tmp = [2, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  1  0
 2  2  2  0
 1  2  2  0
 2  3  2  0
rho_tmp = [3, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 3]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  3  0
 2  2  2  0
 1  2  2  0
 2  3  2  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  3  0
 2  2  2  0
 1  2  2  0
 2  3  2  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  3  0
 2  2  2  0
 1  2  2  0
 2  3  2  0
rho_tmp = [1, 3, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 3]
j = 3
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 1  2  3  0
 2  3  3  0
rho_tmp = [1, 2, 1, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 1  2  3  0
 2  3  3  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 1  2  3  0
 2  3  3  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 1  2  3  0
 2  3  3  0
rho_tmp = [1, 2, 4, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 4]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 1  2  4  0
 2  3  4  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 1  2  4  0
 2  3  4  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 1  2  4  0
 2  3  4  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 1  2  4  0
 2  3  4  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 1  2  4  0
 2  3  4  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 5
Si_iter[:, t] = [1, 2, 3, 4, 5]

▶ iteration 36.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 1  2  4  0
 2  3  5  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 0.154622  4.17851  4.26372  0.0
 2.76449   4.83337  4.88948  0.0
 3.27061   4.30113  4.04064  0.0
 2.11878   4.36612  5.90404  0.0
 1.67301   3.4783   2.64053  0.0
sig2h_iter
5×4 Matrix{Float64}:
 3.36139   6.6324   2.02516  1.0
 3.09209  11.4989   7.35894  1.0
 2.5631    1.79353  2.17372  1.0
 2.67802   4.51461  5.07784  1.0
 1.70788   7.98588  1.03295  1.0
alpha_iter
4-element Vector{Float64}:
 0.1863998377938919
 0.27628723831929425
 0.2742798462258501
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 1, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 1  2  4  0
 2  3  5  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 1  2  4  0
 2  3  5  0
rho_tmp = [2, 2, 2, 1, 2]
Si_comp1 = [2, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 1  2  4  0
 2  3  5  0
rho_tmp = [3, 2, 2, 1, 2]
Si_comp1 = [3, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.5]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  2  4  0
 2  3  5  0
rho_tmp = [1, 1, 2, 3, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  2  4  0
 2  3  5  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  2  4  0
 2  3  5  0
rho_tmp = [1, 3, 2, 3, 2]
Si_comp1 = [1, 3, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  2  4  0
 2  3  5  0
rho_tmp = [1, 4, 2, 3, 2]
Si_comp1 = [1, 4, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  2  4  0
 2  3  5  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  2  4  0
 2  3  5  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  2  4  0
 2  3  5  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  2  4  0
 2  3  5  0
rho_tmp = [1, 2, 4, 3, 2]
Si_comp1 = [1, 2, 4]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  2  4  0
 2  3  5  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  2  4  0
 2  3  5  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  2  4  0
 2  3  5  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 2  2  4  0
 2  3  5  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 2  2  4  0
 2  3  5  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 2  2  4  0
 2  3  5  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 2, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18763781382561492, 0.18763781382561492, 0.6247243723487702]
probh = 0.6704648303757308
sampled gamma:
probh = 0.6704648303757308
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.5959142613016456
sampled gamma:
probh = 0.5959142613016456
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.6168107025068666
sampled gamma:
probh = 0.6168107025068666
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.132264559216373, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.31938198507206067, 0.6806180149279393]
probh = 0.544485537673442
sampled gamma:
probh = 0.544485537673442
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.905619920808277, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2722457963545019, 0.7277542036454981]
probh = 0.34408068370300937
sampled gamma:
probh = 0.34408068370300937
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update rho]
movable_units = [1, 5]
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  3  1  0
 2  2  2  0
 2  2  3  0
 2  2  4  0
 3  1  5  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1]
Si_comp2 = [5]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  3  1  0
 2  2  2  0
 2  2  3  0
 2  2  4  0
 3  1  5  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [1]
Si_comp2 = [5]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  3  1  0
 2  2  2  0
 2  2  3  0
 2  2  4  0
 3  1  5  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [1]
Si_comp2 = [5]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 2  2  4  0
 3  3  5  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1]
Si_comp2 = [5]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 2  2  4  0
 3  3  5  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [2]
Si_comp2 = [5]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  0  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 2  2  4  0
 3  3  5  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [3]
Si_comp2 = [5]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23097802558886682, 0.7690219744111332]
probh = 0.3295149190568206
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.3377282880753066
sampled gamma:
probh = 0.3377282880753066
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.33130290226716247
sampled gamma:
probh = 0.33130290226716247
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20252067145563615, 0.20252067145563615, 0.5949586570887277]
probh = 0.6511045135369437
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.3302348956831459
sampled gamma:
probh = 0.3302348956831459
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 0, 1]
												[update rho]
movable_units = [1, 2, 4]
Si_iter[:, t] = [1, 2, 3, 4, 5]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  5  0
 2  2  2  0
 2  2  3  0
 2  2  4  0
 3  1  1  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  5  0
 2  2  2  0
 2  2  3  0
 2  2  4  0
 3  1  1  0
rho_tmp = [2, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  5  0
 2  2  2  0
 2  2  3  0
 2  2  4  0
 3  1  1  0
rho_tmp = [3, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  5  0
 2  2  2  0
 2  2  3  0
 2  2  4  0
 3  1  1  0
rho_tmp = [4, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  5  0
 2  2  2  0
 2  2  3  0
 2  2  4  0
 3  1  1  0
rho_tmp = [5, 2, 3, 4, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.2, 0.2, 0.2, 0.2, 0.2]
new_label = 3
Si_iter[:, t] = [1, 2, 1, 3, 4]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  4  0
 2  2  1  0
 2  2  3  0
 3  1  2  0
rho_tmp = [1, 1, 1, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  4  0
 2  2  1  0
 2  2  3  0
 3  1  2  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  4  0
 2  2  1  0
 2  2  3  0
 3  1  2  0
rho_tmp = [1, 3, 1, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  4  0
 2  2  1  0
 2  2  3  0
 3  1  2  0
rho_tmp = [1, 4, 1, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 1, 2, 3]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 2  2  2  0
 3  1  3  0
rho_tmp = [1, 2, 1, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 2  2  2  0
 3  1  3  0
rho_tmp = [1, 2, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 2  2  2  0
 3  1  3  0
rho_tmp = [1, 2, 1, 3, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 2  2  2  0
 3  1  3  0
rho_tmp = [1, 2, 1, 4, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 1, 3]

▶ iteration 37.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  1  0
 2  2  1  0
 3  1  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 2.3669   5.06171  4.04064  0.0
 3.58393  4.83337  5.90404  0.0
 3.10019  4.30113  2.64053  0.0
 2.11878  4.36612  4.88948  0.0
 1.67301  3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
  3.26598   2.8038    5.22855   1.0
  2.7199   41.306    11.6439    1.0
 10.147     1.79353   0.566003  1.0
  2.67802   4.51461   7.35894   1.0
  1.70788   7.98588   2.02516   1.0
alpha_iter
4-element Vector{Float64}:
 0.14219646631709223
 0.694440856661393
 0.5147958049711937
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  2  2  0
 2  2  1  0
 2  2  1  0
 1  1  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  2  2  0
 2  2  1  0
 2  2  1  0
 1  1  3  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  2  2  0
 2  2  1  0
 2  2  1  0
 1  1  3  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 1, 1, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
 2  1  3  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
 2  1  3  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = [2, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
 2  1  3  0
rho_tmp = [1, 3, 1, 1, 2]
Si_comp1 = [3, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
 2  1  3  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
 2  1  3  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 2, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
 2  1  3  0
rho_tmp = [1, 1, 3, 1, 2]
Si_comp1 = [1, 3, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
 2  1  3  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
 2  1  3  0
rho_tmp = [1, 1, 1, 2, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [2, 2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
 2  1  3  0
rho_tmp = [1, 1, 1, 3, 2]
Si_comp1 = [1, 1, 3]
Si_comp2 = [2, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
 2  1  3  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
 2  1  3  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.630780450086686, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18955129186518385, 0.17935357105104527, 0.6310951370837709]
probh = 0.9230167322025273
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.158072597092759, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.32501802132358387, 0.6749819786764162]
probh = 0.8748827184880369
sampled gamma:
probh = 0.8748827184880369
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.0416453621923845, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.30001370567070174, 0.6999862943292982]
probh = 0.8833857782932284
sampled gamma:
probh = 0.8833857782932284
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.132264559216373, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.31938198507206067, 0.6806180149279393]
probh = 0.8767850086027019
sampled gamma:
probh = 0.8767850086027019
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.905619920808277, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2722457963545019, 0.7277542036454981]
probh = 0.7574510858027069
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update rho]
movable_units = [1, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
 1  1  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 1]
Si_comp2 = [1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
 1  1  3  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 1]
Si_comp2 = [1, 3]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
 1  1  3  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [2, 1]
Si_comp2 = [1, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
 1  3  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 1]
Si_comp2 = [1, 3]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
 1  3  3  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [2, 2]
Si_comp2 = [1, 3]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
 1  3  3  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2, 3]
Si_comp2 = [1, 3]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.5]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 2, 3]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.686080992604418, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18763781382561492, 0.18763781382561492, 0.6247243723487702]
probh = 0.8497245379460072
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.837036039561302, 4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2056377848473934, 0.2056377848473934, 0.5887244303052133]
probh = 0.8376491342810519
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.8173039319701878
sampled gamma:
probh = 0.8173039319701878
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.132264559216373, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.31938198507206067, 0.6806180149279393]
probh = 0.7686258034192871
sampled gamma:
probh = 0.7686258034192871
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.021142492881014, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2957257229117288, 0.7042742770882712]
probh = 0.6010370212089294
sampled gamma:
probh = 0.6010370212089294
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update rho]
movable_units = [1, 2]
Si_iter[:, t] = [1, 2, 1, 1, 3]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
 1  3  3  0
rho_tmp = [1, 2, 1, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
 1  3  3  0
rho_tmp = [2, 2, 1, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
 1  3  3  0
rho_tmp = [3, 2, 1, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  1  0
 1  2  1  0
 1  3  3  0
rho_tmp = [4, 2, 1, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  3  0
 1  2  2  0
 1  2  2  0
 1  3  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  3  0
 1  2  2  0
 1  2  2  0
 1  3  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  3  0
 1  2  2  0
 1  2  2  0
 1  3  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 2, 1]

▶ iteration 38.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 1  3  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 0.857607  1.71714  2.64053  0.0
 1.24131   4.83337  4.04064  0.0
 1.48873   1.60325  5.90404  0.0
 2.11878   4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
  3.59265   0.700215   2.52829  1.0
 10.147    19.4147     2.2849   1.0
  3.26598   1.87592   11.6439   1.0
  2.67802   4.51461    7.35894  1.0
  1.70788   7.98588    2.02516  1.0
alpha_iter
4-element Vector{Float64}:
 0.01733295332395696
 0.4021530324500615
 0.6284657561125431
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 1  3  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 1  3  1  0
rho_tmp = [2, 1, 1, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 1  3  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 1  3  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [2, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf]
After exp and normalization:
ph = [1.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 1  3  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 1  3  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = [1, 2, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf]
After exp and normalization:
ph = [1.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 1  3  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 1  3  1  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1, 2]
Si_comp2 = [2, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf]
After exp and normalization:
ph = [1.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 1  3  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 1  3  1  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 1, 1]
Si_comp2 = [2, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5]
After exp and normalization:
ph = [0.5, 0.5]
new_label = 2
Si_iter[:, t] = [1, 1, 1, 1, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.630780450086686, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18955129186518385, 0.17935357105104527, 0.6310951370837709]
probh = 0.7801590538811625
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.158072597092759, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.32501802132358387, 0.6749819786764162]
probh = 0.6742284272797471
sampled gamma:
probh = 0.6742284272797471
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.0416453621923845, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.30001370567070174, 0.6999862943292982]
probh = 0.6915605160588779
sampled gamma:
probh = 0.6915605160588779
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.132264559216373, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.31938198507206067, 0.6806180149279393]
probh = 0.6780588518120538
sampled gamma:
probh = 0.6780588518120538
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.021142492881014, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2957257229117288, 0.7042742770882712]
probh = 0.48852333624671423
sampled gamma:
probh = 0.48852333624671423
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update rho]
movable_units = [1, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  3  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 2, 1]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  3  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 1]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  3  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [2, 2, 1]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 2  3  1  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = [2, 1, 3]
Si_comp2 = [2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 2  3  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2, 2, 3]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 2  3  1  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = [2, 3, 3]
Si_comp2 = [2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 2  3  1  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [2, 4, 3]
Si_comp2 = [2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 2  3  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 2, 1]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 2  3  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [2, 2, 2]
Si_comp2 = [2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 2  3  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2, 2, 3]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.5]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.630780450086686, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18955129186518385, 0.17935357105104527, 0.6310951370837709]
probh = 0.8992334412046038
sampled gamma:
probh = 0.8992334412046038
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 2, 2]
Si_red1 = [1, 1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.158072597092759, 5.199262169971763, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2427890380172497, 0.2529982275181843, 0.5042127344645659]
probh = 0.8744842322069385
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 4.665308262143196, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19370004475101535, 0.18327912406712002, 0.6230208311818646]
probh = 0.9022418045825695
sampled gamma:
probh = 0.9022418045825695
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 4.755927459167184, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20475153441693866, 0.19373605167501418, 0.6015124139080472]
probh = 0.8972374088005174
sampled gamma:
probh = 0.8972374088005174
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 4.644805392831826, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.191232086979981, 0.18094394061844687, 0.6278239724015722]
probh = 0.8984306750986083
sampled gamma:
probh = 0.8984306750986083
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update rho]
movable_units = [2]
Si_iter[:, t] = [1, 1, 2, 2, 1]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  1  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 39.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 0.932806  3.6779   2.64053  0.0
 0.995446  4.83337  4.04064  0.0
 1.48873   1.60325  5.90404  0.0
 2.11878   4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 1.72263   2.59367   1.58877  1.0
 1.17627  10.467     3.06552  1.0
 3.26598   1.87592  11.6439   1.0
 2.67802   4.51461   7.35894  1.0
 1.70788   7.98588   2.02516  1.0
alpha_iter
4-element Vector{Float64}:
 0.03895788316055906
 0.4645314946531842
 0.8951842470866102
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 1, 1, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [2, 1, 1, 1, 2]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [3, 1, 1, 1, 2]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 2]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [3, 2]
Si_comp2 = [2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [2, 1]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [2, 3]
Si_comp2 = [2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18763781382561492, 0.18763781382561492, 0.6247243723487702]
probh = 0.8221714375858068
sampled gamma:
probh = 0.8221714375858068
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2056377848473934, 0.2056377848473934, 0.5887244303052133]
probh = 0.808381280687161
sampled gamma:
probh = 0.808381280687161
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19170232997542352, 0.19170232997542352, 0.616595340049153]
probh = 0.8190165587176613
sampled gamma:
probh = 0.8190165587176613
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 4.755927459167184, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20475153441693866, 0.19373605167501418, 0.6015124139080472]
probh = 0.8174470540703711
sampled gamma:
probh = 0.8174470540703711
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.8482193759498101
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update rho]
movable_units = [5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 3]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.891594978063139, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.26947595511830563, 0.7305240448816943]
probh = 0.9212039522262362
sampled gamma:
probh = 0.9212039522262362
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.9597145269121479
sampled gamma:
probh = 0.9597145269121479
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.9618631347797852
sampled gamma:
probh = 0.9618631347797852
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9601894246580822
sampled gamma:
probh = 0.9601894246580822
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9821482598809167
sampled gamma:
probh = 0.9821482598809167
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 40.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 0.821069  3.6779   2.64053  0.0
 2.37324   4.83337  4.04064  0.0
 1.48873   1.60325  5.90404  0.0
 2.11878   4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 2.15223  4.30335   1.64038  1.0
 3.38387  9.26213   2.75181  1.0
 3.26598  1.87592  11.6439   1.0
 2.67802  4.51461   7.35894  1.0
 1.70788  7.98588   2.02516  1.0
alpha_iter
4-element Vector{Float64}:
 0.14907629579521875
 0.3445364722059026
 0.9594341164331334
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 2  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1, 1, 1]
Si_comp2 = [1, 2, 2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 2  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 1  1  1  0
rho_tmp = [2, 1, 1, 1, 1]
Si_comp1 = [2, 1, 1, 1]
Si_comp2 = [1, 2, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5]
After exp and normalization:
ph = [0.0, 1.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 1, 2, 2]
Si_comp2 = [1, 2, 2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 3, 2, 2, 2]
Si_comp1 = [1, 3, 2, 2]
Si_comp2 = [1, 2, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = [1, 2, 1, 2]
Si_comp2 = [1, 2, 2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = [1, 2, 3, 2]
Si_comp2 = [1, 2, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2, 2, 3]
Si_comp2 = [1, 2, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.630780450086686, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18955129186518385, 0.17935357105104527, 0.6310951370837709]
probh = 0.7349634277899258
sampled gamma:
probh = 0.7349634277899258
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 4.78173549704357, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20793823935157388, 0.1967513142157692, 0.5953104464326568]
probh = 0.7276380787902434
sampled gamma:
probh = 0.7276380787902434
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 4.665308262143196, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19370004475101535, 0.18327912406712002, 0.6230208311818646]
probh = 0.7414660420434105
sampled gamma:
probh = 0.7414660420434105
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 4.755927459167184, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20475153441693866, 0.19373605167501418, 0.6015124139080472]
probh = 0.7306879804963339
sampled gamma:
probh = 0.7306879804963339
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 4.644805392831826, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.191232086979981, 0.18094394061844687, 0.6278239724015722]
probh = 0.7332402102447569
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update rho]
movable_units = [4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 3, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 2, 3]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9935256028865472
sampled gamma:
probh = 0.9935256028865472
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.9850684645170963
sampled gamma:
probh = 0.9850684645170963
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.98588471982779
sampled gamma:
probh = 0.98588471982779
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9852490759460154
sampled gamma:
probh = 0.9852490759460154
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9934793035466787
sampled gamma:
probh = 0.9934793035466787
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 41.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 2.50826  3.6779   2.64053  0.0
 2.85324  4.83337  4.04064  0.0
 1.48873  1.60325  5.90404  0.0
 2.11878  4.36612  4.88948  0.0
 1.67301  3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 1.33909   6.7788    1.11439  1.0
 4.32434  10.458     5.29174  1.0
 3.26598   1.87592  11.6439   1.0
 2.67802   4.51461   7.35894  1.0
 1.70788   7.98588   2.02516  1.0
alpha_iter
4-element Vector{Float64}:
 0.1023148288733304
 0.6841078889017979
 0.8813595134000453
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 2  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 2  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 1  1  1  0
rho_tmp = [2, 1, 1, 1, 1]
Si_comp1 = [2, 1, 1]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5]
After exp and normalization:
ph = [0.0, 1.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 2, 2, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 3, 2, 2, 2]
Si_comp1 = [1, 3, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = [1, 2, 1]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 2, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18763781382561492, 0.18763781382561492, 0.6247243723487702]
probh = 0.9202652614741934
sampled gamma:
probh = 0.9202652614741934
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2056377848473934, 0.2056377848473934, 0.5887244303052133]
probh = 0.9132796760310189
sampled gamma:
probh = 0.9132796760310189
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.7395117350702621
sampled gamma:
probh = 0.7395117350702621
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20252067145563615, 0.20252067145563615, 0.5949586570887277]
probh = 0.9144817899823718
sampled gamma:
probh = 0.9144817899823718
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 4.644805392831826, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.191232086979981, 0.18094394061844687, 0.6278239724015722]
probh = 0.9188618387497092
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 1, 0]
												[update rho]
movable_units = [2, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 2, 3]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9796747348963453
sampled gamma:
probh = 0.9796747348963453
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.953963342760183
sampled gamma:
probh = 0.953963342760183
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.956404753897614
sampled gamma:
probh = 0.956404753897614
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9545028232220201
sampled gamma:
probh = 0.9545028232220201
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9795314266327132
sampled gamma:
probh = 0.9795314266327132
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 42.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 0.145029  3.6779   2.64053  0.0
 1.90609   4.83337  4.04064  0.0
 1.34018   1.60325  5.90404  0.0
 2.11878   4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 0.838552   4.42971   1.50516  1.0
 6.67314   18.6813    3.5859   1.0
 4.11971    1.87592  11.6439   1.0
 2.67802    4.51461   7.35894  1.0
 1.70788    7.98588   2.02516  1.0
alpha_iter
4-element Vector{Float64}:
 0.06817815622278837
 0.2541930798547672
 0.9729493899162696
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.5]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 3, 2, 2, 3]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 4, 2, 2, 3]
Si_comp1 = [1, 2, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 1, 3, 4]
Si_comp1 = [1, 1, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [1, 2, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 3, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 4, 3, 4]
Si_comp1 = [1, 4, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 5, 3, 4]
Si_comp1 = [1, 5, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [1, 3, 1]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [1, 3, 2]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 3, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [1, 3, 4]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = [1, 3, 5]
Si_comp2 = [1, 2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 3, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 3, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 3, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 3, 3]
Si_comp2 = [1, 2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.007117550135875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.29281311194311704, 0.7071868880568829]
probh = 0.32521397223871523
sampled gamma:
probh = 0.32521397223871523
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 4.78173549704357, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20793823935157388, 0.1967513142157692, 0.5953104464326568]
probh = 0.6340061444288575
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19170232997542352, 0.19170232997542352, 0.616595340049153]
probh = 0.6400172149512237
sampled gamma:
probh = 0.6400172149512237
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20252067145563615, 0.20252067145563615, 0.5949586570887277]
probh = 0.6272741925347797
sampled gamma:
probh = 0.6272741925347797
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18928469829987307, 0.18928469829987307, 0.6214306034002539]
probh = 0.6429360682529934
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 0, 0]
												[update rho]
movable_units = [2, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 4  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 4  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 3, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 2, 3]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9957331803975705
sampled gamma:
probh = 0.9957331803975705
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.9901310315976694
sampled gamma:
probh = 0.9901310315976694
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.9906731542651679
sampled gamma:
probh = 0.9906731542651679
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9902510124037258
sampled gamma:
probh = 0.9902510124037258
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9957025994763787
sampled gamma:
probh = 0.9957025994763787
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 43.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 4  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 0.584043  3.6779   2.64053  0.0
 0.775849  4.83337  4.04064  0.0
 3.49372   1.60325  5.90404  0.0
 1.7339    4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 2.50924  10.2043    0.877376  1.0
 4.10634  15.7308    4.11233   1.0
 2.53101   1.87592  11.6439    1.0
 5.26183   4.51461   7.35894   1.0
 1.70788   7.98588   2.02516   1.0
alpha_iter
4-element Vector{Float64}:
 0.03722187016933893
 0.4975601797328481
 0.7553999858405864
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = [2, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = [3, 3]
Si_comp2 = [1, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = [4, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.0, 0.3333333333333333]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 3, 4]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  2  2  0
 3  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 3, 3, 2]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  2  2  0
 3  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  2  2  0
 3  2  2  0
 2  1  1  0
rho_tmp = [1, 3, 3, 3, 2]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  2  2  0
 3  2  2  0
 2  1  1  0
rho_tmp = [1, 4, 3, 3, 2]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 3, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = [1, 1]
Si_comp2 = [1, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 4, 3, 2]
Si_comp1 = [1, 4]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 4  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 4  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 4  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 4  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 1, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [1, 3]
Si_comp2 = [1, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 1, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23097802558886682, 0.7690219744111332]
probh = 0.5628843479846765
sampled gamma:
probh = 0.5628843479846765
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.7927634350231418
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.4975601797328481
sampled gamma:
probh = 0.4975601797328481
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.4975601797328481
sampled gamma:
probh = 0.4975601797328481
gt = true
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.5636855454597635
sampled gamma:
probh = 0.5636855454597635
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update rho]
movable_units = [1, 2, 3, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 3, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 2, 3]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9524660924154821
sampled gamma:
probh = 0.9524660924154821
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.042550025020024, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3002037241891629, 0.6997962758108371]
probh = 0.9114054136031136
sampled gamma:
probh = 0.9114054136031136
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.926122790119647, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27632690354652595, 0.723673096453474]
probh = 0.9178731194211586
sampled gamma:
probh = 0.9178731194211586
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.016741987143638, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.29481004528354227, 0.7051899547164576]
probh = 0.9128584605392728
sampled gamma:
probh = 0.9128584605392728
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.905619920808277, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2722457963545019, 0.7277542036454981]
probh = 0.8092917996086592
sampled gamma:
probh = 0.8092917996086592
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update rho]
movable_units = [1]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 44.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 1.71431  3.6779   2.64053  0.0
 2.64268  4.83337  4.04064  0.0
 1.41996  1.60325  5.90404  0.0
 3.49372  4.36612  4.88948  0.0
 1.67301  3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 2.8802    10.5895    2.11672  1.0
 3.76516   14.3319    4.62264  1.0
 0.933986   1.87592  11.6439   1.0
 2.53101    4.51461   7.35894  1.0
 1.70788    7.98588   2.02516  1.0
alpha_iter
4-element Vector{Float64}:
 0.06636330846324721
 0.23723862490459158
 0.594712216743065
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 1, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [2, 2, 3, 1, 2]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [3, 2, 3, 1, 2]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [4, 2, 3, 1, 2]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 1, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 3, 1, 2]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 3, 3, 1, 2]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 4, 3, 1, 2]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 1, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 1, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [3]
Si_comp2 = [2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 4, 2]
Si_comp1 = [4]
Si_comp2 = [2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 1, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 1, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23097802558886682, 0.7690219744111332]
probh = 0.2879742497188217
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.5457577392174662
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.5673648587847282
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 1, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.23723862490459158
sampled gamma:
probh = 0.23723862490459158
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.23723862490459158
sampled gamma:
probh = 0.23723862490459158
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 1]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 3  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 1]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 3  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 1]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 3  3  1  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 2, 2, 3]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 3  3  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2, 2, 2, 3]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 3  3  1  0
rho_tmp = [1, 3, 2, 2, 3]
Si_comp1 = [3, 2, 2, 3]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 3  3  1  0
rho_tmp = [1, 4, 2, 2, 3]
Si_comp1 = [4, 2, 2, 3]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 3  3  1  0
rho_tmp = [1, 2, 1, 2, 3]
Si_comp1 = [2, 1, 2, 3]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 3  3  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2, 2, 2, 3]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 3  3  1  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [2, 3, 2, 3]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 3  3  1  0
rho_tmp = [1, 2, 4, 2, 3]
Si_comp1 = [2, 4, 2, 3]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 3  3  1  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = [2, 2, 1, 3]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 3  3  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2, 2, 2, 3]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 3  3  1  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = [2, 2, 3, 3]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 3  3  1  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [2, 2, 4, 3]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 3  3  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 1]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 3  3  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [2, 2, 2, 2]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  0  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 3  3  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2, 2, 2, 3]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.5]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9049492861610506
sampled gamma:
probh = 0.9049492861610506
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.8036554614671118
sampled gamma:
probh = 0.8036554614671118
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.8125012855033267
sampled gamma:
probh = 0.8125012855033267
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.8055973826261564
sampled gamma:
probh = 0.8055973826261564
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9043305589298462
sampled gamma:
probh = 0.9043305589298462
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 45.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 3  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 2.39145  4.23226  2.64053  0.0
 2.9771   4.83337  4.04064  0.0
 1.89517  3.6779   5.90404  0.0
 3.49372  4.36612  4.88948  0.0
 1.67301  3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 4.80606   4.37142   1.26062  1.0
 8.40997   7.67895   5.97029  1.0
 1.96899  10.5895   11.6439   1.0
 2.53101   4.51461   7.35894  1.0
 1.70788   7.98588   2.02516  1.0
alpha_iter
4-element Vector{Float64}:
 0.2649938152633841
 0.0861473002432197
 0.9359365200233782
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 1, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 3, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 3  1  1  0
rho_tmp = [2, 2, 3, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 3  1  1  0
rho_tmp = [3, 2, 3, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 3  1  1  0
rho_tmp = [4, 2, 3, 1, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 4, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 1, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 3, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 4  2  2  0
 3  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 4, 3, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 4, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 3, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 3  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 3  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 3  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 2, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 1, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 2, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.0861473002432197
sampled gamma:
probh = 0.0861473002432197
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.0861473002432197
sampled gamma:
probh = 0.0861473002432197
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.0861473002432197
sampled gamma:
probh = 0.0861473002432197
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.0861473002432197
sampled gamma:
probh = 0.0861473002432197
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.0861473002432197
sampled gamma:
probh = 0.0861473002432197
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 3, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 3, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 2, 3]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9895604697098626
sampled gamma:
probh = 0.9895604697098626
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.9760487645070639
sampled gamma:
probh = 0.9760487645070639
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.9773467564914325
sampled gamma:
probh = 0.9773467564914325
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.976335857030182
sampled gamma:
probh = 0.976335857030182
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9894861152018856
sampled gamma:
probh = 0.9894861152018856
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 46.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 2  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 -0.00517495  4.23226  2.64053  0.0
  0.711005    4.83337  4.04064  0.0
  2.39145     3.6779   5.90404  0.0
  2.9771      4.36612  4.88948  0.0
  1.67301     3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 0.931297   5.83214   1.07175  1.0
 5.60861    9.55513   3.44857  1.0
 4.80606   10.5895   11.6439   1.0
 8.40997    4.51461   7.35894  1.0
 1.70788    7.98588   2.02516  1.0
alpha_iter
4-element Vector{Float64}:
 0.12368415542853159
 0.29634524216212266
 0.8439417354596477
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 1, 2, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [2, 2, 1, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [3, 2, 1, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 1, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  2  2  0
 1  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  2  2  0
 1  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  2  2  0
 1  2  2  0
 1  1  1  0
rho_tmp = [1, 3, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 1, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 1  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 1, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 1  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 1  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 1  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 2, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.29634524216212266
sampled gamma:
probh = 0.29634524216212266
gt = false
gamma_iter[:, t] = Bool[0, 0, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = Int64[]
Si_red1 = [1]
j_label = 1
before exp and normalization:
lg_weights = [5.8888779583328805]
after exp and normalization:
lg_weights = [1.0]
probh = 0.29634524216212266
sampled gamma:
probh = 0.29634524216212266
gt = true
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.639737242927846
sampled gamma:
probh = 0.639737242927846
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25395099810962674, 0.7460490018903733]
probh = 0.6238334080871025
sampled gamma:
probh = 0.6238334080871025
gt = true
gamma_iter[:, t] = Bool[0, 1, 0, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.021142492881014, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2957257229117288, 0.7042742770882712]
probh = 0.374215248667979
sampled gamma:
probh = 0.374215248667979
gt = true
gamma_iter[:, t] = Bool[0, 1, 0, 1, 1]
												[update rho]
movable_units = [1, 3]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 3, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9722894981289324
sampled gamma:
probh = 0.9722894981289324
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.9378286796878054
sampled gamma:
probh = 0.9378286796878054
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.9410728882483741
sampled gamma:
probh = 0.9410728882483741
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9385450538894562
sampled gamma:
probh = 0.9385450538894562
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9720956016107205
sampled gamma:
probh = 0.9720956016107205
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 47.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
  1.7864   4.23226  2.64053  0.0
 -0.38579  4.83337  4.04064  0.0
  2.14504  3.6779   5.90404  0.0
  2.9771   4.36612  4.88948  0.0
  1.67301  3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 0.159706   9.00873   1.3292   1.0
 3.28891   12.1813   15.0507   1.0
 1.95618   10.5895   11.6439   1.0
 8.40997    4.51461   7.35894  1.0
 1.70788    7.98588   2.02516  1.0
alpha_iter
4-element Vector{Float64}:
 0.152971892478998
 0.7317794826925097
 0.9698201480062855
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 2, 1]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 1]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [2, 2, 1]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 2, 3]
Si_comp2 = [2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2, 2, 3]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 3, 2, 2, 3]
Si_comp1 = [3, 2, 3]
Si_comp2 = [2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 4, 2, 2, 3]
Si_comp1 = [4, 2, 3]
Si_comp2 = [2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 1, 2, 3]
Si_comp1 = [2, 2, 3]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2, 2, 3]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [2, 2, 3]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 4, 2, 3]
Si_comp1 = [2, 2, 3]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 2, 4]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 3, 1, 4]
Si_comp1 = [2, 1, 4]
Si_comp2 = [2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [2, 2, 4]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [2, 3, 4]
Si_comp2 = [2, 2, 1]
rho_comp = 0
Assigning to cluster k=4 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 3, 4, 4]
Si_comp1 = [2, 4, 4]
Si_comp2 = [2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=5) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 3, 5, 4]
Si_comp1 = [2, 5, 4]
Si_comp2 = [2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 3, 2, 4]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [2, 2, 1]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 3, 2, 2]
Si_comp1 = [2, 2, 2]
Si_comp2 = [2, 2, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [2, 2, 3]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 3, 2, 4]
Si_comp1 = [2, 2, 4]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.0, 0.3333333333333333, 0.3333333333333333]
new_label = 4
Si_iter[:, t] = [1, 2, 3, 2, 4]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.630780450086686, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18955129186518385, 0.17935357105104527, 0.6310951370837709]
probh = 0.9350368266057452
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.158072597092759, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.32501802132358387, 0.6749819786764162]
probh = 0.8935516639929861
sampled gamma:
probh = 0.8935516639929861
gt = true
gamma_iter[:, t] = Bool[0, 1, 0, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.926122790119647, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27632690354652595, 0.723673096453474]
probh = 0.9080321251538603
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.132264559216373, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.31938198507206067, 0.6806180149279393]
probh = 0.8952041100084918
sampled gamma:
probh = 0.8952041100084918
gt = true
gamma_iter[:, t] = Bool[0, 1, 0, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.021142492881014, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2957257229117288, 0.7042742770882712]
probh = 0.7948247483560811
sampled gamma:
probh = 0.7948247483560811
gt = true
gamma_iter[:, t] = Bool[0, 1, 0, 1, 1]
												[update rho]
movable_units = [1, 3]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  2  2  0
 4  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  2  2  0
 4  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  2  2  0
 4  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 3, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9952266597490311
sampled gamma:
probh = 0.9952266597490311
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.9889668402695013
sampled gamma:
probh = 0.9889668402695013
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.9895722408365717
sampled gamma:
probh = 0.9895722408365717
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9891008187934232
sampled gamma:
probh = 0.9891008187934232
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.995192466047759
sampled gamma:
probh = 0.995192466047759
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 48.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 2  2  2  0
 4  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 0.872384  4.23226  2.64053  0.0
 0.126848  4.83337  4.04064  0.0
 2.3268    3.6779   5.90404  0.0
 0.281712  4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 7.89339   8.20959   0.968626  1.0
 1.38481  12.8381    5.28928   1.0
 2.18566  10.5895   11.6439    1.0
 4.32271   4.51461   7.35894   1.0
 1.70788   7.98588   2.02516   1.0
alpha_iter
4-element Vector{Float64}:
 0.07642695166301981
 0.6598541220915932
 0.9310309131319882
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 2, 4]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [2, 2, 1]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 3, 2, 1]
Si_comp1 = [2, 2, 1]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 3, 2, 1]
Si_comp1 = [2, 2, 1]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 4  1  1  0
 2  2  2  0
 3  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [4, 2, 3, 2, 1]
Si_comp1 = [2, 2, 1]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 1, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  2  2  0
 1  2  2  0
 3  1  1  0
rho_tmp = [1, 1, 2, 1, 3]
Si_comp1 = [1, 1, 3]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  2  2  0
 1  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = [2, 1, 3]
Si_comp2 = [2, 2, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  2  2  0
 1  2  2  0
 3  1  1  0
rho_tmp = [1, 3, 2, 1, 3]
Si_comp1 = [3, 1, 3]
Si_comp2 = [2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  2  2  0
 1  2  2  0
 3  1  1  0
rho_tmp = [1, 4, 2, 1, 3]
Si_comp1 = [4, 1, 3]
Si_comp2 = [2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 2, 1, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 3  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 3, 1, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 1, 2, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 1, 3, 2]
Si_comp1 = [1, 3, 2]
Si_comp2 = [2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 1, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=2) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5]
After exp and normalization:
ph = [0.0, 1.0]
new_label = 2
Si_iter[:, t] = [1, 1, 1, 1, 2]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.630780450086686, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18955129186518385, 0.17935357105104527, 0.6310951370837709]
probh = 0.9109864831457869
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.158072597092759, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.32501802132358387, 0.6749819786764162]
probh = 0.8564999472221758
sampled gamma:
probh = 0.8564999472221758
gt = true
gamma_iter[:, t] = Bool[0, 1, 0, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.926122790119647, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27632690354652595, 0.723673096453474]
probh = 0.8753173597100595
sampled gamma:
probh = 0.8753173597100595
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.016741987143638, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.29481004528354227, 0.7051899547164576]
probh = 0.8680777155349029
sampled gamma:
probh = 0.8680777155349029
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.905619920808277, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2722457963545019, 0.7277542036454981]
probh = 0.7271947445701278
sampled gamma:
probh = 0.7271947445701278
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update rho]
movable_units = [1]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9887115459664677
sampled gamma:
probh = 0.9887115459664677
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.9741298179752587
sampled gamma:
probh = 0.9741298179752587
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.9755291963876656
sampled gamma:
probh = 0.9755291963876656
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9744393096717545
sampled gamma:
probh = 0.9744393096717545
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9886312145493441
sampled gamma:
probh = 0.9886312145493441
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 49.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 1.87575   4.23226  2.64053  0.0
 2.81192   4.83337  4.04064  0.0
 2.3268    3.6779   5.90404  0.0
 0.872384  4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 1.77014   9.4649    1.20376  1.0
 7.45635  16.3713    4.97315  1.0
 2.18566  10.5895   11.6439   1.0
 7.89339   4.51461   7.35894  1.0
 1.70788   7.98588   2.02516  1.0
alpha_iter
4-element Vector{Float64}:
 0.4673460658885502
 0.5706634881427155
 0.8840272387014914
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 1, 1, 2]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 1, 1, 2]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [2, 1, 1, 1, 2]
Si_comp1 = [1, 1, 1, 2]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [3, 1, 1, 1, 2]
Si_comp1 = [1, 1, 1, 2]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 1]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [3, 2, 2, 1]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [2, 1, 2, 1]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 1]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [2, 3, 2, 1]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [2, 2, 1, 1]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 1]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [2, 2, 3, 1]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 1]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [2, 2, 2, 2]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2, 2, 2, 3]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.5]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.8960928920003299
sampled gamma:
probh = 0.8960928920003299
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.7875764237401693
sampled gamma:
probh = 0.7875764237401693
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.7969636359458537
sampled gamma:
probh = 0.7969636359458537
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.7896357456391024
sampled gamma:
probh = 0.7896357456391024
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.8954231766864991
sampled gamma:
probh = 0.8954231766864991
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9801814749707752
sampled gamma:
probh = 0.9801814749707752
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.9550817162259008
sampled gamma:
probh = 0.9550817162259008
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.9574664622796866
sampled gamma:
probh = 0.9574664622796866
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9556087008835707
sampled gamma:
probh = 0.9556087008835707
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9800416668137715
sampled gamma:
probh = 0.9800416668137715
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 50.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 0.544977  4.23226  2.64053  0.0
 2.71872   4.83337  4.04064  0.0
 2.3268    3.6779   5.90404  0.0
 0.872384  4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 4.81859  15.1891    2.87037  1.0
 3.41027  15.0991    1.8718   1.0
 2.18566  10.5895   11.6439   1.0
 7.89339   4.51461   7.35894  1.0
 1.70788   7.98588   2.02516  1.0
alpha_iter
4-element Vector{Float64}:
 0.11417308596821515
 0.9402109460515818
 0.6985655256237214
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 3, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 3, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 2, 3]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9902941166899826
sampled gamma:
probh = 0.9902941166899826
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.9777105700674635
sampled gamma:
probh = 0.9777105700674635
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.9789204486127463
sampled gamma:
probh = 0.9789204486127463
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9779781927094786
sampled gamma:
probh = 0.9779781927094786
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.990224935892315
sampled gamma:
probh = 0.990224935892315
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9376413088218105
sampled gamma:
probh = 0.9376413088218105
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.8660290857243963
sampled gamma:
probh = 0.8660290857243963
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.8725106024780106
sampled gamma:
probh = 0.8725106024780106
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.8674558513047295
sampled gamma:
probh = 0.8674558513047295
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9372206253301691
sampled gamma:
probh = 0.9372206253301691
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 51.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 1.88363   4.23226  2.64053  0.0
 0.909883  4.83337  4.04064  0.0
 2.3268    3.6779   5.90404  0.0
 0.872384  4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 12.3433    9.98752   0.512273  1.0
  2.87021  22.2168    2.796     1.0
  2.18566  10.5895   11.6439    1.0
  7.89339   4.51461   7.35894   1.0
  1.70788   7.98588   2.02516   1.0
alpha_iter
4-element Vector{Float64}:
 0.13233117023289603
 0.9574851114023775
 0.7147334203182469
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 3, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 3, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 2, 3]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9932029338307193
sampled gamma:
probh = 0.9932029338307193
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.9843309584356477
sampled gamma:
probh = 0.9843309584356477
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.9851869243786732
sampled gamma:
probh = 0.9851869243786732
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9845203505323253
sampled gamma:
probh = 0.9845203505323253
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9931543429372426
sampled gamma:
probh = 0.9931543429372426
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9420497728610849
sampled gamma:
probh = 0.9420497728610849
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.8748243285697177
sampled gamma:
probh = 0.8748243285697177
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.8809388306461282
sampled gamma:
probh = 0.8809388306461282
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.8761708195123301
sampled gamma:
probh = 0.8761708195123301
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9416569791614967
sampled gamma:
probh = 0.9416569791614967
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 52.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 0.320426  4.23226  2.64053  0.0
 1.0962    4.83337  4.04064  0.0
 2.3268    3.6779   5.90404  0.0
 0.872384  4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 4.49066   9.35101   1.57183  1.0
 1.35188  15.5177    6.36981  1.0
 2.18566  10.5895   11.6439   1.0
 7.89339   4.51461   7.35894  1.0
 1.70788   7.98588   2.02516  1.0
alpha_iter
4-element Vector{Float64}:
 0.16486185104683648
 0.875607544814262
 0.925403576686224
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 3, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 3, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 2, 3]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9785734397276337
sampled gamma:
probh = 0.9785734397276337
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.9515378279492428
sampled gamma:
probh = 0.9515378279492428
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.9541016799354838
sampled gamma:
probh = 0.9541016799354838
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9521043047459583
sampled gamma:
probh = 0.9521043047459583
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9784225375365306
sampled gamma:
probh = 0.9784225375365306
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9877284650396585
sampled gamma:
probh = 0.9877284650396585
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.971912928328319
sampled gamma:
probh = 0.971912928328319
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.9734289525335273
sampled gamma:
probh = 0.9734289525335273
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9722481856919987
sampled gamma:
probh = 0.9722481856919987
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9876412252239388
sampled gamma:
probh = 0.9876412252239388
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 53.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 1.0359    4.23226  2.64053  0.0
 1.17046   4.83337  4.04064  0.0
 2.3268    3.6779   5.90404  0.0
 0.872384  4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 7.43054   7.83557   1.4802   1.0
 7.51099  11.7891    8.14442  1.0
 2.18566  10.5895   11.6439   1.0
 7.89339   4.51461   7.35894  1.0
 1.70788   7.98588   2.02516  1.0
alpha_iter
4-element Vector{Float64}:
 0.10271734948115482
 0.7335331552317036
 0.556467138625878
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 3, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 3, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 2, 3]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9469801152995132
sampled gamma:
probh = 0.9469801152995132
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.8847745705769926
sampled gamma:
probh = 0.8847745705769926
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.8904638866257814
sampled gamma:
probh = 0.8904638866257814
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.8860279728856981
sampled gamma:
probh = 0.8860279728856981
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.946618846407934
sampled gamma:
probh = 0.946618846407934
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.8905941362930802
sampled gamma:
probh = 0.8905941362930802
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.777759233013468
sampled gamma:
probh = 0.777759233013468
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 4.665308262143196, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19370004475101535, 0.18327912406712002, 0.6230208311818646]
probh = 0.8725372569914003
sampled gamma:
probh = 0.8725372569914003
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 4.755927459167184, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20475153441693866, 0.19373605167501418, 0.6015124139080472]
probh = 0.8662376793664326
sampled gamma:
probh = 0.8662376793664326
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 4.644805392831826, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.191232086979981, 0.18094394061844687, 0.6278239724015722]
probh = 0.8677378480380267
sampled gamma:
probh = 0.8677378480380267
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update rho]
movable_units = [2]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 1]

▶ iteration 54.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 2  2  3  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 0.557167  4.23226  2.64053  0.0
 0.423942  4.83337  1.6562   0.0
 2.29746   3.6779   4.04064  0.0
 0.872384  4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 15.3611     4.51477  1.62791   1.0
  0.932047  16.3344   0.669079  1.0
  2.18566   10.5895   3.66952   1.0
  7.89339    4.51461  7.35894   1.0
  1.70788    7.98588  2.02516   1.0
alpha_iter
4-element Vector{Float64}:
 0.631988869522826
 0.9763558520763608
 0.5978458740835645
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 2  2  3  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 2  2  3  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 3, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 3, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 2, 3]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.996281463299321
sampled gamma:
probh = 0.996281463299321
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.9913929636219442
sampled gamma:
probh = 0.9913929636219442
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.99186633522586
sampled gamma:
probh = 0.99186633522586
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9914977343800505
sampled gamma:
probh = 0.9914977343800505
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9962547972217077
sampled gamma:
probh = 0.9962547972217077
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.686080992604418, 4.630780450086686, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18955129186518385, 0.17935357105104527, 0.6310951370837709]
probh = 0.7019908602514999
sampled gamma:
probh = 0.7019908602514999
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3, 3]
Si_red1 = [1, 2, 3, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 4.837036039561302, 5.199262169971763, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15874418675883215, 0.15874418675883215, 0.22803979396763885, 0.4544718325146968]
probh = 0.9035196792008617
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 4.665308262143196, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19370004475101535, 0.18327912406712002, 0.6230208311818646]
probh = 0.8902446575748132
sampled gamma:
probh = 0.8902446575748132
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 4.755927459167184, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20475153441693866, 0.19373605167501418, 0.6015124139080472]
probh = 0.8847045901479862
sampled gamma:
probh = 0.8847045901479862
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 4.644805392831826, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.191232086979981, 0.18094394061844687, 0.6278239724015722]
probh = 0.8860248995042358
sampled gamma:
probh = 0.8860248995042358
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update rho]
movable_units = [2]
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  3  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  3  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  3  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 55.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 1.3058    4.23226  2.64053  0.0
 2.71498   4.83337  4.04064  0.0
 2.29746   3.6779   1.6562   0.0
 0.872384  4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 2.99102  18.0172   0.920015  1.0
 1.28056  12.023    4.0766    1.0
 2.18566  10.5895   0.669079  1.0
 7.89339   4.51461  7.35894   1.0
 1.70788   7.98588  2.02516   1.0
alpha_iter
4-element Vector{Float64}:
 0.029866220241196832
 0.9435618248504297
 0.6230821440750892
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 3, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 3, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 2, 3]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9908653537633466
sampled gamma:
probh = 0.9908653537633466
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.9790067082524787
sampled gamma:
probh = 0.9790067082524787
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.9801476604852867
sampled gamma:
probh = 0.9801476604852867
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.979259098679512
sampled gamma:
probh = 0.979259098679512
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9908002067572023
sampled gamma:
probh = 0.9908002067572023
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.891594978063139, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.26947595511830563, 0.7305240448816943]
probh = 0.6935235372769346
sampled gamma:
probh = 0.6935235372769346
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.8217824257844659
sampled gamma:
probh = 0.8217824257844659
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.8299843517746801
sampled gamma:
probh = 0.8299843517746801
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.8235844199149559
sampled gamma:
probh = 0.8235844199149559
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9141557918966947
sampled gamma:
probh = 0.9141557918966947
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 56.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 0.889453  4.23226  2.64053  0.0
 2.14849   4.83337  4.04064  0.0
 2.29746   3.6779   1.6562   0.0
 0.872384  4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 2.3454    6.07917   0.703584  1.0
 2.03431   4.92061  11.3484    1.0
 2.18566  10.5895    0.669079  1.0
 7.89339   4.51461   7.35894   1.0
 1.70788   7.98588   2.02516   1.0
alpha_iter
4-element Vector{Float64}:
 0.0011578423390491764
 0.6289550802271199
 0.8754525430719153
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 3, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 3, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 2, 3]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9166536438145948
sampled gamma:
probh = 0.9166536438145948
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.8254267584151931
sampled gamma:
probh = 0.8254267584151931
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 4.665308262143196, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19370004475101535, 0.18327912406712002, 0.6230208311818646]
probh = 0.9024265370261795
sampled gamma:
probh = 0.9024265370261795
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 4.755927459167184, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20475153441693866, 0.19373605167501418, 0.6015124139080472]
probh = 0.8974305229182217
sampled gamma:
probh = 0.8974305229182217
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 4.644805392831826, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.191232086979981, 0.18094394061844687, 0.6278239724015722]
probh = 0.8986218001684858
sampled gamma:
probh = 0.8986218001684858
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update rho]
movable_units = [2]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9785435967215181
sampled gamma:
probh = 0.9785435967215181
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.9514721969662465
sampled gamma:
probh = 0.9514721969662465
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.9540393533964829
sampled gamma:
probh = 0.9540393533964829
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9520394022593112
sampled gamma:
probh = 0.9520394022593112
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9783924889940327
sampled gamma:
probh = 0.9783924889940327
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 57.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 0.00458904  4.23226  2.64053  0.0
 2.81668     4.83337  4.04064  0.0
 2.29746     3.6779   1.6562   0.0
 0.872384    4.36612  4.88948  0.0
 1.67301     3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 6.55709   5.79752  1.27708   1.0
 2.42436   7.32246  3.77275   1.0
 2.18566  10.5895   0.669079  1.0
 7.89339   4.51461  7.35894   1.0
 1.70788   7.98588  2.02516   1.0
alpha_iter
4-element Vector{Float64}:
 0.1932568894328771
 0.6154006693932866
 0.7981484204907427
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [1, 1, 3, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 3, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 3, 3, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 4, 3, 1]
Si_comp1 = [1, 4, 3, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = [1, 3, 1, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 3, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 3, 3, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [1, 3, 4, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 3, 3, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 3, 3, 2]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 3, 3, 3]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 3, 3, 4]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 3, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.891594978063139, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.26947595511830563, 0.7305240448816943]
probh = 0.6865554644385927
sampled gamma:
probh = 0.6865554644385927
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.8169608201684834
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 4.665308262143196, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19370004475101535, 0.18327912406712002, 0.6230208311818646]
probh = 0.8972297897838976
sampled gamma:
probh = 0.8972297897838976
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 4.755927459167184, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20475153441693866, 0.19373605167501418, 0.6015124139080472]
probh = 0.8919995334633652
sampled gamma:
probh = 0.8919995334633652
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 4.644805392831826, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.191232086979981, 0.18094394061844687, 0.6278239724015722]
probh = 0.8932463847428315
sampled gamma:
probh = 0.8932463847428315
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update rho]
movable_units = [2]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9624840022211728
sampled gamma:
probh = 0.9624840022211728
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.9168716236822911
sampled gamma:
probh = 0.9168716236822911
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.9211174254131276
sampled gamma:
probh = 0.9211174254131276
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9178083139480459
sampled gamma:
probh = 0.9178083139480459
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.962224160191617
sampled gamma:
probh = 0.962224160191617
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 58.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 1.26894   4.23226  2.64053  0.0
 1.80687   4.83337  4.04064  0.0
 2.20895   3.6779   1.6562   0.0
 0.872384  4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 5.15389   7.12292  1.80808   1.0
 5.75732   9.39518  4.64427   1.0
 1.80956  10.5895   0.669079  1.0
 7.89339   4.51461  7.35894   1.0
 1.70788   7.98588  2.02516   1.0
alpha_iter
4-element Vector{Float64}:
 0.14053915823446617
 0.9064355664288669
 0.9515027393343258
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 3, 3, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = [2, 3, 3, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = [3, 3, 3, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = [4, 3, 3, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 1, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 3, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 3, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 3]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.891594978063139, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.26947595511830563, 0.7305240448816943]
probh = 0.9298809954687379
sampled gamma:
probh = 0.9298809954687379
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.042550025020024, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3002037241891629, 0.6997962758108371]
probh = 0.969943636892233
sampled gamma:
probh = 0.969943636892233
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.926122790119647, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27632690354652595, 0.723673096453474]
probh = 0.972267886636227
sampled gamma:
probh = 0.972267886636227
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.016741987143638, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.29481004528354227, 0.7051899547164576]
probh = 0.9704677035486866
sampled gamma:
probh = 0.9704677035486866
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.905619920808277, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2722457963545019, 0.7277542036454981]
probh = 0.9301282811403265
sampled gamma:
probh = 0.9301282811403265
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update rho]
movable_units = [1]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9922055886386685
sampled gamma:
probh = 0.9922055886386685
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.9820553332965484
sampled gamma:
probh = 0.9820553332965484
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.9830334690062401
sampled gamma:
probh = 0.9830334690062401
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9822717355434093
sampled gamma:
probh = 0.9822717355434093
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9921499242726448
sampled gamma:
probh = 0.9921499242726448
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 59.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 1.85956   4.23226  2.64053  0.0
 1.92256   4.83337  4.04064  0.0
 1.80687   3.6779   1.6562   0.0
 0.872384  4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 2.95698    8.26086  1.12146   1.0
 0.678085  27.0371   2.82903   1.0
 5.75732   10.5895   0.669079  1.0
 7.89339    4.51461  7.35894   1.0
 1.70788    7.98588  2.02516   1.0
alpha_iter
4-element Vector{Float64}:
 0.14149972163801924
 0.7336900698149604
 0.8763588337361429
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 1]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 1]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 1]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [1, 2, 2, 3]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2, 2, 2, 3]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 3, 2, 2, 3]
Si_comp1 = [3, 2, 2, 3]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 4, 2, 2, 3]
Si_comp1 = [4, 2, 2, 3]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 1, 2, 3]
Si_comp1 = [2, 1, 2, 3]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2, 2, 2, 3]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [2, 3, 2, 3]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 4, 2, 3]
Si_comp1 = [2, 4, 2, 3]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = [2, 2, 1, 3]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2, 2, 2, 3]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = [2, 2, 3, 3]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [2, 2, 4, 3]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 1]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [2, 2, 2, 2]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2, 2, 2, 3]
Si_comp2 = [2, 2, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, -Inf, 0.5]
After exp and normalization:
ph = [0.5, 0.0, 0.5]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9470204153516019
sampled gamma:
probh = 0.9470204153516019
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.8848564036048644
sampled gamma:
probh = 0.8848564036048644
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.8905421789720076
sampled gamma:
probh = 0.8905421789720076
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.8861090303329463
sampled gamma:
probh = 0.8861090303329463
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9466594055907431
sampled gamma:
probh = 0.9466594055907431
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9787179640670917
sampled gamma:
probh = 0.9787179640670917
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.9518557385312573
sampled gamma:
probh = 0.9518557385312573
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.9544035776500175
sampled gamma:
probh = 0.9544035776500175
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9524186850759166
sampled gamma:
probh = 0.9524186850759166
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9785680574345321
sampled gamma:
probh = 0.9785680574345321
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 60.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 2.12605   4.23226  2.64053  0.0
 2.28085   4.83337  4.04064  0.0
 1.85956   3.6779   1.6562   0.0
 0.872384  4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 4.97267  18.3883   0.722602  1.0
 3.45167  30.0382   4.93721   1.0
 2.95698  10.5895   0.669079  1.0
 7.89339   4.51461  7.35894   1.0
 1.70788   7.98588  2.02516   1.0
alpha_iter
4-element Vector{Float64}:
 0.06460565149062845
 0.9410782429661315
 0.9866074408308931
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 3, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 3, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 2, 3]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9904422949976084
sampled gamma:
probh = 0.9904422949976084
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.9780466007205929
sampled gamma:
probh = 0.9780466007205929
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.9792386267148859
sampled gamma:
probh = 0.9792386267148859
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9783102782460269
sampled gamma:
probh = 0.9783102782460269
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.990374160106912
sampled gamma:
probh = 0.990374160106912
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9979122138434317
sampled gamma:
probh = 0.9979122138434317
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.995157126589681
sampled gamma:
probh = 0.995157126589681
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.995424431432129
sampled gamma:
probh = 0.995424431432129
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.995216298462958
sampled gamma:
probh = 0.995216298462958
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9978972173933514
sampled gamma:
probh = 0.9978972173933514
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 61.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 0.97575   4.23226  2.64053  0.0
 2.8116    4.83337  4.04064  0.0
 1.85956   3.6779   1.6562   0.0
 0.872384  4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 7.24891   5.19284  2.78675   1.0
 0.74112  27.567    4.35288   1.0
 2.95698  10.5895   0.669079  1.0
 7.89339   4.51461  7.35894   1.0
 1.70788   7.98588  2.02516   1.0
alpha_iter
4-element Vector{Float64}:
 0.06871645991252444
 0.8923638460698086
 0.9901007034534051
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 3, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 3, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 2, 3]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9817488145418687
sampled gamma:
probh = 0.9817488145418687
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.9585501177055589
sampled gamma:
probh = 0.9585501177055589
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.9607582894865069
sampled gamma:
probh = 0.9607582894865069
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9590381560099452
sampled gamma:
probh = 0.9590381560099452
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9816198557209581
sampled gamma:
probh = 0.9816198557209581
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9984613822948478
sampled gamma:
probh = 0.9984613822948478
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.996428395735149
sampled gamma:
probh = 0.996428395735149
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.99662577015172
sampled gamma:
probh = 0.99662577015172
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9964720898749294
sampled gamma:
probh = 0.9964720898749294
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9984503243650354
sampled gamma:
probh = 0.9984503243650354
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 62.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 2.23424   4.23226  2.64053  0.0
 2.1904    4.83337  4.04064  0.0
 1.85956   3.6779   1.6562   0.0
 0.872384  4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 11.7582    7.91341  1.6983    1.0
  1.09014   8.05485  5.02866   1.0
  2.95698  10.5895   0.669079  1.0
  7.89339   4.51461  7.35894   1.0
  1.70788   7.98588  2.02516   1.0
alpha_iter
4-element Vector{Float64}:
 0.21453149823848003
 0.9564432531890082
 0.7517827658730051
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 3, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 3, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 2, 3]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9930299951143875
sampled gamma:
probh = 0.9930299951143875
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.983935939765026
sampled gamma:
probh = 0.983935939765026
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.9848131517919577
sampled gamma:
probh = 0.9848131517919577
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9841300294832838
sampled gamma:
probh = 0.9841300294832838
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 4.644805392831826, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.191232086979981, 0.18094394061844687, 0.6278239724015722]
probh = 0.9913664145057607
sampled gamma:
probh = 0.9913664145057607
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update rho]
movable_units = [4]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 3, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9515763317039658
sampled gamma:
probh = 0.9515763317039658
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.89416060025055
sampled gamma:
probh = 0.89416060025055
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.8994391493887328
sampled gamma:
probh = 0.8994391493887328
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.8953239821634714
sampled gamma:
probh = 0.8953239821634714
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9512447682858302
sampled gamma:
probh = 0.9512447682858302
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 63.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 1.18244   4.23226  2.64053  0.0
 2.27183   4.83337  4.04064  0.0
 1.85956   3.6779   1.6562   0.0
 0.872384  4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 2.52441   4.96057  1.1815    1.0
 3.88807  14.4773   4.04477   1.0
 2.95698  10.5895   0.669079  1.0
 7.89339   4.51461  7.35894   1.0
 1.70788   7.98588  2.02516   1.0
alpha_iter
4-element Vector{Float64}:
 0.2544543584347153
 0.8040265773031614
 0.7021787811127183
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 3, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 3]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.630780450086686, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18955129186518385, 0.17935357105104527, 0.6310951370837709]
probh = 0.955839061326051
sampled gamma:
probh = 0.955839061326051
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 4.78173549704357, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20793823935157388, 0.1967513142157692, 0.5953104464326568]
probh = 0.954238389589704
sampled gamma:
probh = 0.954238389589704
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 4.665308262143196, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19370004475101535, 0.18327912406712002, 0.6230208311818646]
probh = 0.9572378402309861
sampled gamma:
probh = 0.9572378402309861
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9205487096256749
sampled gamma:
probh = 0.9205487096256749
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9635424885948666
sampled gamma:
probh = 0.9635424885948666
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9386405132176231
sampled gamma:
probh = 0.9386405132176231
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.868014245301451
sampled gamma:
probh = 0.868014245301451
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.8744136474237808
sampled gamma:
probh = 0.8744136474237808
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.8694230569543593
sampled gamma:
probh = 0.8694230569543593
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9382261264471405
sampled gamma:
probh = 0.9382261264471405
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 64.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 0.725213  4.23226  2.64053  0.0
 1.6087    4.83337  4.04064  0.0
 1.85956   3.6779   1.6562   0.0
 0.872384  4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 18.6986   10.4302   0.803637  1.0
  2.52126   9.34395  6.38807   1.0
  2.95698  10.5895   0.669079  1.0
  7.89339   4.51461  7.35894   1.0
  1.70788   7.98588  2.02516   1.0
alpha_iter
4-element Vector{Float64}:
 0.17087689894012642
 0.9730074219501241
 0.4572270956017238
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 3, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 3, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 2, 3]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9957425479454322
sampled gamma:
probh = 0.9957425479454322
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.9901525766947175
sampled gamma:
probh = 0.9901525766947175
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.9906935269700108
sampled gamma:
probh = 0.9906935269700108
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9902722981422193
sampled gamma:
probh = 0.9902722981422193
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9957120338737067
sampled gamma:
probh = 0.9957120338737067
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.8453357546798873
sampled gamma:
probh = 0.8453357546798873
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.042550025020024, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3002037241891629, 0.6997962758108371]
probh = 0.737261448652026
sampled gamma:
probh = 0.737261448652026
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.926122790119647, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27632690354652595, 0.723673096453474]
probh = 0.7529968336228888
sampled gamma:
probh = 0.7529968336228888
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.016741987143638, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.29481004528354227, 0.7051899547164576]
probh = 0.7407582366532808
sampled gamma:
probh = 0.7407582366532808
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.905619920808277, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2722457963545019, 0.7277542036454981]
probh = 0.5365052043539161
sampled gamma:
probh = 0.5365052043539161
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update rho]
movable_units = [1]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 2, 3]

▶ iteration 65.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 2.10322   4.23226  3.26607  0.0
 1.56195   4.83337  4.04064  0.0
 2.06318   3.6779   2.64053  0.0
 0.872384  4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 4.95232  15.1881   2.46928   1.0
 1.83686   9.02102  2.87183   1.0
 2.95698  10.5895   0.206721  1.0
 7.89339   4.51461  7.35894   1.0
 1.70788   7.98588  2.02516   1.0
alpha_iter
4-element Vector{Float64}:
 0.04129718093627076
 0.7275414678807967
 0.6720485313751209
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 3, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 3, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 2, 3]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9454308821706512
sampled gamma:
probh = 0.9454308821706512
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.8816348910815358
sampled gamma:
probh = 0.8816348910815358
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.887459511983615
sampled gamma:
probh = 0.887459511983615
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.8829179268347768
sampled gamma:
probh = 0.8829179268347768
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9450596694894494
sampled gamma:
probh = 0.9450596694894494
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9300496988808388
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.042550025020024, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3002037241891629, 0.6997962758108371]
probh = 0.872223034254075
sampled gamma:
probh = 0.872223034254075
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.926122790119647, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27632690354652595, 0.723673096453474]
probh = 0.8811782647544162
sampled gamma:
probh = 0.8811782647544162
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.016741987143638, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.29481004528354227, 0.7051899547164576]
probh = 0.874230033949014
sampled gamma:
probh = 0.874230033949014
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.905619920808277, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2722457963545019, 0.7277542036454981]
probh = 0.7379337741572971
sampled gamma:
probh = 0.7379337741572971
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update rho]
movable_units = [1]
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  3  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  3  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  3  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 2, 3]

▶ iteration 66.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 2.31326   4.23226  3.027    0.0
 2.61858   4.83337  4.04064  0.0
 1.38047   3.6779   2.64053  0.0
 0.872384  4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 3.60128  10.3236   1.57485   1.0
 1.21716  10.6526   6.92437   1.0
 2.95698  10.5895   0.338335  1.0
 7.89339   4.51461  7.35894   1.0
 1.70788   7.98588  2.02516   1.0
alpha_iter
4-element Vector{Float64}:
 0.05230460189783406
 0.962186147535987
 0.6418977511451012
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 3, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 3, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  3  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 2, 3]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9939793459427588
sampled gamma:
probh = 0.9939793459427588
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.9861066181836876
sampled gamma:
probh = 0.9861066181836876
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.9868668778624736
sampled gamma:
probh = 0.9868668778624736
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9862748471011583
sampled gamma:
probh = 0.9862748471011583
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9939362715806987
sampled gamma:
probh = 0.9939362715806987
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9208242089781725
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.042550025020024, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3002037241891629, 0.6997962758108371]
probh = 0.8565473301339951
sampled gamma:
probh = 0.8565473301339951
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.926122790119647, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.27632690354652595, 0.723673096453474]
probh = 0.8664329525451465
sampled gamma:
probh = 0.8664329525451465
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.016741987143638, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.29481004528354227, 0.7051899547164576]
probh = 0.8587606786262368
sampled gamma:
probh = 0.8587606786262368
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.905619920808277, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2722457963545019, 0.7277542036454981]
probh = 0.7112376085279302
sampled gamma:
probh = 0.7112376085279302
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update rho]
movable_units = [1, 5]
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 1
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  3  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  3  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  3  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 67.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
muh_iter
5×4 Matrix{Float64}:
 1.34578   4.23226  2.64053  0.0
 1.07598   4.83337  4.04064  0.0
 1.38047   3.6779   3.027    0.0
 0.872384  4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 9.05031    7.59973  1.49682  1.0
 0.961866  12.8261   3.14596  1.0
 2.95698   10.5895   1.57485  1.0
 7.89339    4.51461  7.35894  1.0
 1.70788    7.98588  2.02516  1.0
alpha_iter
4-element Vector{Float64}:
 0.01863735836553026
 0.9425784984549979
 0.6318151250791625
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 3, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 3, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 2, 3]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9906980752125114
sampled gamma:
probh = 0.9906980752125114
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.9786269520122178
sampled gamma:
probh = 0.9786269520122178
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.9797881172952108
sampled gamma:
probh = 0.9797881172952108
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9788838095576433
sampled gamma:
probh = 0.9788838095576433
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.990631746478806
sampled gamma:
probh = 0.990631746478806
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.630780450086686, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18955129186518385, 0.17935357105104527, 0.6310951370837709]
probh = 0.9005281970153862
sampled gamma:
probh = 0.9005281970153862
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 4.78173549704357, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20793823935157388, 0.1967513142157692, 0.5953104464326568]
probh = 0.8971384556837294
sampled gamma:
probh = 0.8971384556837294
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 4.665308262143196, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19370004475101535, 0.18327912406712002, 0.6230208311818646]
probh = 0.9035020538265301
sampled gamma:
probh = 0.9035020538265301
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 4.755927459167184, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20475153441693866, 0.19373605167501418, 0.6015124139080472]
probh = 0.8985549184290222
sampled gamma:
probh = 0.8985549184290222
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 4.644805392831826, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.191232086979981, 0.18094394061844687, 0.6278239724015722]
probh = 0.8997345955919135
sampled gamma:
probh = 0.8997345955919135
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update rho]
movable_units = [4]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 1]

▶ iteration 68.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  3  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 2.34965   4.23226  2.64053  0.0
 2.54001   4.83337  4.04064  0.0
 3.06414   3.6779   3.65799  0.0
 0.872384  4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 4.45478   9.45348  1.95205  1.0
 0.78288  13.1725   3.01018  1.0
 2.95698  10.5895   2.3394   1.0
 7.89339   4.51461  7.35894  1.0
 1.70788   7.98588  2.02516  1.0
alpha_iter
4-element Vector{Float64}:
 0.07816414282457763
 0.4998057370886365
 0.49188356778313325
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  3  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  3  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 3, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 3, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 2, 3]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.8663669624641405
sampled gamma:
probh = 0.8663669624641405
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.7359536336147978
sampled gamma:
probh = 0.7359536336147978
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 4.665308262143196, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19370004475101535, 0.18327912406712002, 0.6230208311818646]
probh = 0.8450073944335947
sampled gamma:
probh = 0.8450073944335947
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 4.755927459167184, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20475153441693866, 0.19373605167501418, 0.6015124139080472]
probh = 0.837600451767345
sampled gamma:
probh = 0.837600451767345
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 4.644805392831826, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.191232086979981, 0.18094394061844687, 0.6278239724015722]
probh = 0.839362233074353
sampled gamma:
probh = 0.839362233074353
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update rho]
movable_units = [2]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.686080992604418, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.1579924549734541, 0.1579924549734541, 0.1579924549734541, 0.5260226350796378]
probh = 0.8596926320635785
sampled gamma:
probh = 0.8596926320635785
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 4.837036039561302, 4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.17056348716992353, 0.17056348716992353, 0.17056348716992353, 0.4883095384902295]
probh = 0.850201091089775
sampled gamma:
probh = 0.850201091089775
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 3]
Si_red1 = [1, 2, 3, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 4.720608804660927, 4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16086427386558605, 0.16086427386558605, 0.16086427386558605, 0.5174071784032418]
probh = 0.857505685424223
sampled gamma:
probh = 0.857505685424223
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 3]
Si_red1 = [1, 2, 2, 3, 3]
j_label = 3
before exp and normalization:
lg_weights = [4.811228001684916, 4.755927459167184, 4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16995332943570962, 0.1608099646611168, 0.16995332943570962, 0.49928337646746385]
probh = 0.8506569381440895
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 4.644805392831826, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.191232086979981, 0.18094394061844687, 0.6278239724015722]
probh = 0.8350430696860591
sampled gamma:
probh = 0.8350430696860591
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update rho]
movable_units = [4]
Si_iter[:, t] = [1, 2, 2, 3, 1]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 1, 1]

▶ iteration 69.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  1  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 1.18757   4.23226  2.64053  0.0
 2.63612   4.83337  4.04064  0.0
 3.06414   3.6779   3.65799  0.0
 0.872384  4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 5.28835   7.81637  1.1901   1.0
 2.63501  18.4857   3.38383  1.0
 2.95698  10.5895   2.3394   1.0
 7.89339   4.51461  7.35894  1.0
 1.70788   7.98588  2.02516  1.0
alpha_iter
4-element Vector{Float64}:
 0.2489079095096502
 0.9279808211898948
 0.780591823895491
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  1  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  1  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  1  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  1  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  1  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  1  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  1  0
 1  1  1  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [1, 1, 3, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  1  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 3, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  1  0
 1  1  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 3, 3, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  1  0
 1  1  1  0
rho_tmp = [1, 2, 4, 3, 1]
Si_comp1 = [1, 4, 3, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  1  0
 1  1  1  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = [1, 3, 1, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  1  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 3, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  1  0
 1  1  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 3, 3, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  1  0
 1  1  1  0
rho_tmp = [1, 2, 3, 4, 1]
Si_comp1 = [1, 3, 4, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, -Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 0.0, 1.0, 0.0]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  1  0
 1  1  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 3, 3, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  1  0
 1  1  1  0
rho_tmp = [1, 2, 3, 3, 2]
Si_comp1 = [1, 3, 3, 2]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  1  0
 1  1  1  0
rho_tmp = [1, 2, 3, 3, 3]
Si_comp1 = [1, 3, 3, 3]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  1  0
 1  1  1  0
rho_tmp = [1, 2, 3, 3, 4]
Si_comp1 = [1, 3, 3, 4]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 3, 3, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.891594978063139, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.26947595511830563, 0.7305240448816943]
probh = 0.9463469907906711
sampled gamma:
probh = 0.9463469907906711
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.042550025020024, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3002037241891629, 0.6997962758108371]
probh = 0.9772321005655424
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.0416453621923845, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.30001370567070174, 0.6999862943292982]
probh = 0.9772461839423681
sampled gamma:
probh = 0.9772461839423681
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.132264559216373, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.31938198507206067, 0.6806180149279393]
probh = 0.9758127730914786
sampled gamma:
probh = 0.9758127730914786
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.021142492881014, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2957257229117288, 0.7042742770882712]
probh = 0.9481749795753801
sampled gamma:
probh = 0.9481749795753801
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update rho]
movable_units = [1, 2]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  1  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  1  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  1  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  1  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  1  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  1  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 1]
Si_red1 = [1, 2, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.121516012445618, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.11608916008199593, 0.20416398060085753, 0.6797468593171466]
probh = 0.968400833111063
sampled gamma:
probh = 0.968400833111063
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 1]
Si_red1 = [1, 2, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.272471059402502, 4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.12830959876149897, 0.22565585291463583, 0.6460345483238652]
probh = 0.9403558773078219
sampled gamma:
probh = 0.9403558773078219
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 1]
Si_red1 = [1, 2, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.156043824502127, 4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.11883053396548796, 0.20898518702507168, 0.6721842790094403]
probh = 0.9445177050730516
sampled gamma:
probh = 0.9445177050730516
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 1]
Si_red1 = [1, 2, 2, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.730653137162982, 4.755927459167184, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19194329450088776, 0.19685635675906446, 0.6112003487400478]
probh = 0.9488104610225322
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 4.644805392831826, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.191232086979981, 0.18094394061844687, 0.6278239724015722]
probh = 0.9489904585170562
sampled gamma:
probh = 0.9489904585170562
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update rho]
movable_units = [4]
Si_iter[:, t] = [1, 2, 2, 1, 1]
j = 4
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  1  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  1  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  1  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 70.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
  1.20967    4.23226  2.64053  0.0
 -0.828346   4.83337  4.04064  0.0
  0.0797946  3.6779   3.65799  0.0
  0.872384   4.36612  4.88948  0.0
  1.67301    3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 7.01298    4.23395  1.35162  1.0
 1.99854    4.33999  4.6133   1.0
 0.523584  10.5895   2.3394   1.0
 7.89339    4.51461  7.35894  1.0
 1.70788    7.98588  2.02516  1.0
alpha_iter
4-element Vector{Float64}:
 0.046883656325572357
 0.6999152239151896
 0.8769547269238326
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 3, 3, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [3, 3, 1]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 3, 3, 1]
Si_comp1 = [3, 3, 1]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 3, 3, 1]
Si_comp1 = [3, 3, 1]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 3  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [4, 2, 3, 3, 1]
Si_comp1 = [3, 3, 1]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 1, 1, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 3  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 3, 1, 1, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 1, 1, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [2, 1, 2]
Si_comp2 = [2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = [3, 1, 2]
Si_comp2 = [2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 1, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 1, 2, 2]
Si_comp1 = [1, 2, 2]
Si_comp2 = [2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 1, 3, 2]
Si_comp1 = [1, 3, 2]
Si_comp2 = [2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 1, 1, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [1, 1, 1]
Si_comp2 = [2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = [1, 1, 2]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 1, 1, 3]
Si_comp1 = [1, 1, 3]
Si_comp2 = [2, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [-Inf, 0.5, 0.5]
After exp and normalization:
ph = [0.0, 0.5, 0.5]
new_label = 3
Si_iter[:, t] = [1, 2, 1, 1, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.891594978063139, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.26947595511830563, 0.7305240448816943]
probh = 0.7614939099417144
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 1, 1]
Si_red1 = [1, 1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.042550025020024, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.3002037241891629, 0.6997962758108371]
probh = 0.8859666290015619
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.0416453621923845, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.30001370567070174, 0.6999862943292982]
probh = 0.8860305819434359
sampled gamma:
probh = 0.8860305819434359
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.132264559216373, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.31938198507206067, 0.6806180149279393]
probh = 0.8795591065173594
sampled gamma:
probh = 0.8795591065173594
gt = true
gamma_iter[:, t] = Bool[0, 0, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.021142492881014, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2957257229117288, 0.7042742770882712]
probh = 0.7680764708287079
sampled gamma:
probh = 0.7680764708287079
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 1, 0]
												[update rho]
movable_units = [1, 2, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 1  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 1  2  2  0
 3  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 1  2  2  0
 3  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 1  2  2  0
 3  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 1  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 1  2  2  0
 3  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 1  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 1  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  0  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 1  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 3]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.630780450086686, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18955129186518385, 0.17935357105104527, 0.6310951370837709]
probh = 0.9740931274248644
sampled gamma:
probh = 0.9740931274248644
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 4.78173549704357, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20793823935157388, 0.1967513142157692, 0.5953104464326568]
probh = 0.973135502586585
sampled gamma:
probh = 0.973135502586585
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 4.665308262143196, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19370004475101535, 0.18327912406712002, 0.6230208311818646]
probh = 0.9749288821588968
sampled gamma:
probh = 0.9749288821588968
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9526678036342976
sampled gamma:
probh = 0.9526678036342976
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9786833315723676
sampled gamma:
probh = 0.9786833315723676
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 71.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 1  2  2  0
 3  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 1.08433   4.23226  2.64053  0.0
 1.47105   4.83337  4.04064  0.0
 1.44466   3.6779   3.65799  0.0
 0.872384  4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 2.29084   5.61724  0.78082  1.0
 1.14404  21.4347   4.4483   1.0
 2.06688  10.5895   2.3394   1.0
 7.89339   4.51461  7.35894  1.0
 1.70788   7.98588  2.02516  1.0
alpha_iter
4-element Vector{Float64}:
 0.042265083559084
 0.5466999791507375
 0.7559067219601824
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 1, 1, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 1  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 1, 1, 3]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 1  2  2  0
 3  1  1  0
rho_tmp = [2, 2, 1, 1, 3]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 1  2  2  0
 3  1  1  0
rho_tmp = [3, 2, 1, 1, 3]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 1  2  2  0
 1  2  2  0
 3  1  1  0
rho_tmp = [4, 2, 1, 1, 3]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 1, 2, 2, 3]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 1, 2, 2, 3]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 3, 2, 2, 3]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 4, 2, 2, 3]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 1, 2, 3]
Si_comp1 = [1, 2]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 3, 2, 3]
Si_comp1 = [3, 2]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 4, 2, 3]
Si_comp1 = [4, 2]
Si_comp2 = [2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = [2, 1]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = [2, 3]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 4, 3]
Si_comp1 = [2, 4]
Si_comp2 = [2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 3]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.007117550135875, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.29281311194311704, 0.7071868880568829]
probh = 0.6303704261690036
sampled gamma:
probh = 0.6303704261690036
gt = false
gamma_iter[:, t] = Bool[0, 0, 1, 1, 0]
												[update gamma]
▸ subject 2
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.158072597092759, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.32501802132358387, 0.6749819786764162]
probh = 0.7877173367164445
sampled gamma:
probh = 0.7877173367164445
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.0416453621923845, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.30001370567070174, 0.6999862943292982]
probh = 0.8007954059259672
sampled gamma:
probh = 0.8007954059259672
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 1, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.132264559216373, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.31938198507206067, 0.6806180149279393]
probh = 0.7906277382491982
sampled gamma:
probh = 0.7906277382491982
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.021142492881014, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2957257229117288, 0.7042742770882712]
probh = 0.6313315347951677
sampled gamma:
probh = 0.6313315347951677
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update rho]
movable_units = [1, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 3, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 2, 3]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9525901909917087
sampled gamma:
probh = 0.9525901909917087
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.8962455147818326
sampled gamma:
probh = 0.8962455147818326
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.901431545029904
sampled gamma:
probh = 0.901431545029904
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.8973886093324228
sampled gamma:
probh = 0.8973886093324228
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9522652213661066
sampled gamma:
probh = 0.9522652213661066
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 72.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 0.676522  4.23226  2.64053  0.0
 1.92229   4.83337  4.04064  0.0
 1.44466   3.6779   3.65799  0.0
 0.872384  4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 9.56688  10.2388   1.52741  1.0
 1.35549  24.1059   2.46791  1.0
 2.06688  10.5895   2.3394   1.0
 7.89339   4.51461  7.35894  1.0
 1.70788   7.98588  2.02516  1.0
alpha_iter
4-element Vector{Float64}:
 0.44471996518729073
 0.5368097319141589
 0.943655263705718
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 1, 1, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = [2, 1]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 3, 1, 1, 2]
Si_comp1 = [3, 1]
Si_comp2 = [2, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 2]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 3, 1, 2]
Si_comp1 = [1, 3]
Si_comp2 = [2, 2]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 1, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 1, 1, 2]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 1, 2, 2]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 1, 3, 2]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 1, 1, 2, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 1, 2, 2]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 1, 2, 3]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 1, 1, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18763781382561492, 0.18763781382561492, 0.6247243723487702]
probh = 0.8606557964112578
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.8174146937096199
sampled gamma:
probh = 0.8174146937096199
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.8301220343331581
sampled gamma:
probh = 0.8301220343331581
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 1]
Si_red1 = [1, 1, 1]
j_label = 1
before exp and normalization:
lg_weights = [5.132264559216373, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.31938198507206067, 0.6806180149279393]
probh = 0.7839564133688781
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 1]
Si_red1 = [1, 1, 2]
j_label = 2
before exp and normalization:
lg_weights = [5.021142492881014, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2957257229117288, 0.7042742770882712]
probh = 0.6220111215271364
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update rho]
movable_units = [1, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 3, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 2, 3]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9908812339102568
sampled gamma:
probh = 0.9908812339102568
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.9790427680583683
sampled gamma:
probh = 0.9790427680583683
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.9801818001701416
sampled gamma:
probh = 0.9801818001701416
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.979294734127595
sampled gamma:
probh = 0.979294734127595
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9908161991093763
sampled gamma:
probh = 0.9908161991093763
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 73.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
 1.18845   4.23226  2.64053  0.0
 2.15883   4.83337  4.04064  0.0
 1.44466   3.6779   3.65799  0.0
 0.872384  4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 10.7531    9.73416  2.33365  1.0
  2.39939  24.3328   3.0308   1.0
  2.06688  10.5895   2.3394   1.0
  7.89339   4.51461  7.35894  1.0
  1.70788   7.98588  2.02516  1.0
alpha_iter
4-element Vector{Float64}:
 0.16527205841719694
 0.4307207829871049
 0.762607437909264
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 1, 1, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 1, 2, 1]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [2, 1, 1, 2, 1]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 1  2  2  0
 1  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [3, 1, 1, 2, 1]
Si_comp1 = [1, 1]
Si_comp2 = [2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 1, 2]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 1, 2, 1, 2]
Si_comp1 = [1, 2]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 3, 2, 1, 2]
Si_comp1 = [3, 2]
Si_comp2 = [2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 1, 2]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 1, 1, 2]
Si_comp1 = [2, 1]
Si_comp2 = [2, 2]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 3, 1, 2]
Si_comp1 = [2, 3]
Si_comp2 = [2, 2]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 1, 2]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 1  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 2]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 2  1  1  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [2, 2]
Si_comp2 = [2, 2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.25, 0.25, 0.25, 0.25]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 3]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2]
Si_red1 = [1, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18763781382561492, 0.18763781382561492, 0.6247243723487702]
probh = 0.8012827167735218
sampled gamma:
probh = 0.8012827167735218
gt = false
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.745074386127895
sampled gamma:
probh = 0.745074386127895
gt = true
gamma_iter[:, t] = Bool[0, 1, 1, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23716798536558295, 0.7628320146344171]
probh = 0.7613464525228555
sampled gamma:
probh = 0.7613464525228555
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.811228001684916, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25395099810962674, 0.7460490018903733]
probh = 0.7487022657710852
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update gamma]
▸ subject 5
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.700105935349557, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.2334786304180145, 0.7665213695819855]
probh = 0.4967454753193849
sampled gamma:
probh = 0.4967454753193849
gt = false
gamma_iter[:, t] = Bool[0, 1, 0, 0, 0]
												[update rho]
movable_units = [1, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 3  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 3  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 3, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 3, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 3  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 2, 3]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9542186636229385
sampled gamma:
probh = 0.9542186636229385
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.8996053910242802
sampled gamma:
probh = 0.8996053910242802
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.9046413506711252
sampled gamma:
probh = 0.9046413506711252
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9007155694519663
sampled gamma:
probh = 0.9007155694519663
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9539043161881828
sampled gamma:
probh = 0.9539043161881828
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 74.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 3  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
muh_iter
5×4 Matrix{Float64}:
  2.66353   4.23226  2.64053  0.0
  2.66411   4.83337  4.04064  0.0
 -0.356677  3.6779   3.65799  0.0
  0.872384  4.36612  4.88948  0.0
  1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 7.0913   37.4431   1.23039  1.0
 1.35451   9.44997  2.50766  1.0
 4.09359  10.5895   2.3394   1.0
 7.89339   4.51461  7.35894  1.0
 1.70788   7.98588  2.02516  1.0
alpha_iter
4-element Vector{Float64}:
 0.10771685896266922
 0.3080009240824629
 0.8893173617271467
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 3, 3]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  2  2  0
 2  2  2  0
 1  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  2  2  0
 2  2  2  0
 1  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 2, 1, 1]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 3  1  1  0
 2  2  2  0
 2  2  2  0
 1  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 2, 1, 1]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 1, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 1  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 2, 1, 1]
Si_comp1 = [1]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 1  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 1  2  2  0
 1  1  1  0
rho_tmp = [1, 3, 2, 1, 1]
Si_comp1 = [3]
Si_comp2 = [2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 1, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 1  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 1, 1, 1]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 1  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 1  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 1, 1]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 1, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 1  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 1  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 1  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  0  1  0
 0  1  1  0
 0  0  1  0
 0  0  1  0
 0  0  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [2]
Si_comp2 = [2]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1]
Si_red1 = [1, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.23097802558886682, 0.7690219744111332]
probh = 0.6583502203659867
sampled gamma:
probh = 0.6583502203659867
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 0, 0]
												[update gamma]
▸ subject 2
Si_red = [1]
Si_red1 = [1, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.25887155874840784, 0.741128441251592]
probh = 0.37521685016650796
sampled gamma:
probh = 0.37521685016650796
gt = true
gamma_iter[:, t] = Bool[1, 1, 0, 0, 0]
												[update gamma]
▸ subject 3
Si_red = [1, 2]
Si_red1 = [1, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 4.720608804660927, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19170232997542352, 0.19170232997542352, 0.616595340049153]
probh = 0.6989556376639856
sampled gamma:
probh = 0.6989556376639856
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 0]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 4.755927459167184, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20475153441693866, 0.19373605167501418, 0.6015124139080472]
probh = 0.6967304868876556
sampled gamma:
probh = 0.6967304868876556
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 0]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.741414597524722
sampled gamma:
probh = 0.741414597524722
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9811788822309363
sampled gamma:
probh = 0.9811788822309363
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.9572872740243241
sampled gamma:
probh = 0.9572872740243241
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.9595598833587223
sampled gamma:
probh = 0.9595598833587223
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9577895265101503
sampled gamma:
probh = 0.9577895265101503
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9810459741420843
sampled gamma:
probh = 0.9810459741420843
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 75.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 0.829416  4.23226  2.64053  0.0
 2.02354   4.83337  4.04064  0.0
 2.66353   3.6779   3.65799  0.0
 0.872384  4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 28.6056    8.94408  1.51312  1.0
  1.90625  11.8107   5.86315  1.0
  7.0913   10.5895   2.3394   1.0
  7.89339   4.51461  7.35894  1.0
  1.70788   7.98588  2.02516  1.0
alpha_iter
4-element Vector{Float64}:
 0.08339901545624835
 0.8355588376113493
 0.8192248962276221
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 3, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 3, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 2]
Si_comp1 = [1, 2, 2, 2, 2]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 3]
Si_comp1 = [1, 2, 2, 2, 3]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9705604886957795
sampled gamma:
probh = 0.9705604886957795
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.9340952188209669
sampled gamma:
probh = 0.9340952188209669
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.9375212669863645
sampled gamma:
probh = 0.9375212669863645
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9348516237161912
sampled gamma:
probh = 0.9348516237161912
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 4.644805392831826, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.191232086979981, 0.18094394061844687, 0.6278239724015722]
probh = 0.963729831911577
sampled gamma:
probh = 0.963729831911577
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update rho]
movable_units = [4]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 3, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9671083911378185
sampled gamma:
probh = 0.9671083911378185
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.9266901553655765
sampled gamma:
probh = 0.9266901553655765
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 5.49016270427149, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15685724134095283, 0.338623882565073, 0.5045188760939742]
probh = 0.9304725013743658
sampled gamma:
probh = 0.9304725013743658
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.9275249557190304
sampled gamma:
probh = 0.9275249557190304
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 5.46965983496012, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15523490390983316, 0.3351215756581048, 0.5096435204320621]
probh = 0.9668794762177659
sampled gamma:
probh = 0.9668794762177659
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update rho]
movable_units = Int64[]
Si_iter[:, t] = [1, 2, 2, 2, 1]

▶ iteration 76.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 0.608814  4.23226  2.64053  0.0
 1.90961   4.83337  4.04064  0.0
 2.66353   3.6779   3.65799  0.0
 0.872384  4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 1.58889   7.6998   1.06519  1.0
 1.76023  19.4986   3.84539  1.0
 7.0913   10.5895   2.3394   1.0
 7.89339   4.51461  7.35894  1.0
 1.70788   7.98588  2.02516  1.0
alpha_iter
4-element Vector{Float64}:
 0.22910908479569417
 0.5873960478504645
 0.6878078634464525
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [2, 2, 2, 2, 1]
Si_comp1 = [2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [3, 2, 2, 2, 1]
Si_comp1 = [3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = [1, 1, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = [1, 3, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 1, 2, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 3, 2, 1]
Si_comp1 = [1, 2, 3, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 2  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 2, 3, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 2]
Si_comp1 = [1, 2, 2, 2]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 3]
Si_comp1 = [1, 2, 2, 3]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 4]
Si_comp1 = [1, 2, 2, 4]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 3, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.630780450086686, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18955129186518385, 0.17935357105104527, 0.6310951370837709]
probh = 0.8824985770740638
sampled gamma:
probh = 0.8824985770740638
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 4.78173549704357, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20793823935157388, 0.1967513142157692, 0.5953104464326568]
probh = 0.8785772760024169
sampled gamma:
probh = 0.8785772760024169
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 4.665308262143196, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19370004475101535, 0.18327912406712002, 0.6230208311818646]
probh = 0.8859431859622
sampled gamma:
probh = 0.8859431859622
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 5.58078190129548, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16402664288253357, 0.3541012080932015, 0.48187214902426495]
probh = 0.8008130382474061
sampled gamma:
probh = 0.0
gt = false
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 4.644805392831826, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.191232086979981, 0.18094394061844687, 0.6278239724015722]
probh = 0.8815800480011252
sampled gamma:
probh = 0.8815800480011252
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update rho]
movable_units = [4]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 4
t = 2
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 3, 1]
Si_comp2 = [1, 2, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 2, 1]
► time 3
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 5.455634892214982, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.15412549632909878, 0.33272658324893206, 0.5131479204219692]
probh = 0.9346172611425949
sampled gamma:
probh = 0.9346172611425949
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 1, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 5.606589939171866, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.16606543986377958, 0.35850256912473216, 0.47543199101148825]
probh = 0.860050583962784
sampled gamma:
probh = 0.860050583962784
gt = false
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 4.665308262143196, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19370004475101535, 0.18327912406712002, 0.6230208311818646]
probh = 0.9231996082372684
sampled gamma:
probh = 0.9231996082372684
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.811228001684916, 4.755927459167184, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20475153441693866, 0.19373605167501418, 0.6015124139080472]
probh = 0.9191719621226121
sampled gamma:
probh = 0.9191719621226121
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update gamma]
▸ subject 5
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.700105935349557, 4.644805392831826, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.191232086979981, 0.18094394061844687, 0.6278239724015722]
probh = 0.9201331991541148
sampled gamma:
probh = 0.9201331991541148
gt = true
gamma_iter[:, t] = Bool[1, 0, 1, 1, 1]
												[update rho]
movable_units = [2]
Si_iter[:, t] = [1, 2, 2, 2, 1]
j = 2
t = 3
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 1, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  2  0
 3  2  2  0
 1  1  1  0
rho_tmp = [1, 3, 2, 2, 1]
Si_comp1 = Int64[]
Si_comp2 = Int64[]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 3
Si_iter[:, t] = [1, 2, 3, 3, 1]

▶ iteration 77.0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  2  3  0
 1  1  1  0
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
muh_iter
5×4 Matrix{Float64}:
 1.42054   4.23226  2.64053  0.0
 1.60962   4.83337  3.08962  0.0
 2.49465   3.6779   4.04064  0.0
 0.872384  4.36612  4.88948  0.0
 1.67301   3.4783   4.26372  0.0
sig2h_iter
5×4 Matrix{Float64}:
 15.0165    7.61709  1.20654  1.0
  2.63439  15.8838   5.84759  1.0
  1.39195  10.5895   3.19202  1.0
  7.89339   4.51461  7.35894  1.0
  1.70788   7.98588  2.02516  1.0
alpha_iter
4-element Vector{Float64}:
 0.3886146517236268
 0.8770545445143573
 0.9504879176207612
 0.5
► time 1
												[update gamma]
▸ subject 1
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 2
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 3
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 4
we are at time t=1 so nothing to do
												[update gamma]
▸ subject 5
we are at time t=1 so nothing to do
												[update rho]
movable_units = [1, 2, 3, 4, 5]
Si_iter[:, t] = [1, 2, 2, 3, 1]
j = 1
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  2  3  0
 1  1  1  0
rho_tmp = [2, 2, 2, 3, 1]
Si_comp1 = [2, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  2  3  0
 1  1  1  0
rho_tmp = [3, 2, 2, 3, 1]
Si_comp1 = [3, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  2  3  0
 1  1  1  0
rho_tmp = [4, 2, 2, 3, 1]
Si_comp1 = [4, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 3, 1]
j = 2
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  2  3  0
 1  1  1  0
rho_tmp = [1, 1, 2, 3, 1]
Si_comp1 = [1, 1, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  2  3  0
 1  1  1  0
rho_tmp = [1, 3, 2, 3, 1]
Si_comp1 = [1, 3, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  2  3  0
 1  1  1  0
rho_tmp = [1, 4, 2, 3, 1]
Si_comp1 = [1, 4, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 3, 1]
j = 3
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 1, 3, 1]
Si_comp1 = [1, 2, 1, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=3 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 3, 3, 1]
Si_comp1 = [1, 2, 3, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=4) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 4, 3, 1]
Si_comp1 = [1, 2, 4, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [-Inf, 0.5, -Inf, -Inf]
After exp and normalization:
ph = [0.0, 1.0, 0.0, 0.0]
new_label = 2
Si_iter[:, t] = [1, 2, 2, 3, 1]
j = 4
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 2, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 3  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 3, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Before exp and normalization:
ph = [0.5, 0.5, 0.5]
After exp and normalization:
ph = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 1, 1]
j = 5
t = 1
Assigning to cluster k=1 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 1  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 1]
Si_comp1 = [1, 2, 2, 1]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 1
Assigning to cluster k=2 :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 1  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 2]
Si_comp1 = [1, 2, 2, 2]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Assigning to NEW SINGLETON cluster (k=3) :
gamma_iter
5×4 Matrix{Bool}:
 0  1  1  0
 0  1  0  0
 0  1  1  0
 0  0  1  0
 0  1  1  0
Si_iter
5×4 Matrix{Int64}:
 1  1  1  0
 2  2  2  0
 2  2  3  0
 1  2  3  0
 1  1  1  0
rho_tmp = [1, 2, 2, 1, 3]
Si_comp1 = [1, 2, 2, 3]
Si_comp2 = [1, 2, 2, 1]
rho_comp = 0
Before exp and normalization:
ph = [0.5, -Inf, -Inf]
After exp and normalization:
ph = [1.0, 0.0, 0.0]
new_label = 1
Si_iter[:, t] = [1, 2, 2, 1, 1]
► time 2
												[update gamma]
▸ subject 1
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 1]
j_label = 1
before exp and normalization:
lg_weights = [4.686080992604418, 4.630780450086686, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.18955129186518385, 0.17935357105104527, 0.6310951370837709]
probh = 0.9741164696051888
sampled gamma:
probh = 0.9741164696051888
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 2
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.837036039561302, 4.78173549704357, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.20793823935157388, 0.1967513142157692, 0.5953104464326568]
probh = 0.9731596838157786
sampled gamma:
probh = 0.9731596838157786
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 3
Si_red = [1, 2, 2]
Si_red1 = [1, 2, 2, 2]
j_label = 2
before exp and normalization:
lg_weights = [4.720608804660927, 4.665308262143196, 5.8888779583328805]
after exp and normalization:
lg_weights = [0.19370004475101535, 0.18327912406712002, 0.6230208311818646]
probh = 0.9749514906849885
sampled gamma:
probh = 0.9749514906849885
gt = true
gamma_iter[:, t] = Bool[1, 1, 1, 0, 1]
												[update gamma]
▸ subject 4
Si_red = [1, 2, 2, 2]
Si_red1 = [1, 2, 2, 2, 2]
j_label = 2
before exp and normalization:
